---
title: Bereitstellen von SAP NetWeaver (Windows) für AnyDB in Azure Virtual Machines
description: Bewährte Methoden zum Ausführen von SAP S/4HANA in einer Linux-Umgebung in Azure mit Hochverfügbarkeit.
author: lbrader
ms.date: 05/11/2018
ms.openlocfilehash: b4a254980dd9aac2847bb194f22f99f3f05376de
ms.sourcegitcommit: 94d50043db63416c4d00cebe927a0c88f78c3219
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 09/28/2018
ms.locfileid: "47428804"
---
# <a name="deploy-sap-netweaver-windows-for-anydb-on-azure-virtual-machines"></a><span data-ttu-id="42da4-103">Bereitstellen von SAP NetWeaver (Windows) für AnyDB in Azure Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="42da4-103">Deploy SAP NetWeaver (Windows) for AnyDB on Azure Virtual Machines</span></span>

<span data-ttu-id="42da4-104">Anhand dieser Referenzarchitektur werden einige bewährte Methoden veranschaulicht, wie SAP NetWeaver in einer Windows-Umgebung in Azure mit Hochverfügbarkeit ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="42da4-104">This reference architecture shows a set of proven practices for running SAP NetWeaver in a Windows environment on Azure with high availability.</span></span> <span data-ttu-id="42da4-105">Die Datenbank ist AnyDB. „AnyDB“ ist der SAP-Begriff für alle unterstützten Datenbank-Managementsysteme neben SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="42da4-105">The database is AnyDB, the SAP term for any supported DBMS besides SAP HANA.</span></span> <span data-ttu-id="42da4-106">Diese Architektur wird mit virtuellen Computern bestimmter Größen bereitgestellt, die an die Anforderungen Ihres Unternehmens angepasst werden können.</span><span class="sxs-lookup"><span data-stu-id="42da4-106">This architecture is deployed with specific virtual machine (VM) sizes that can be changed to accommodate your organization's needs.</span></span>

![](./images/sap-netweaver.png)

<span data-ttu-id="42da4-107">*Laden Sie eine [Visio-Datei][visio-download] mit dieser Architektur herunter.*</span><span class="sxs-lookup"><span data-stu-id="42da4-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE] 
> <span data-ttu-id="42da4-108">Zum Bereitstellen dieser Referenzarchitektur ist eine geeignete Lizenzierung von SAP-Produkten und anderen nicht von Microsoft stammenden Technologiekomponenten erforderlich.</span><span class="sxs-lookup"><span data-stu-id="42da4-108">Deploying this reference architecture requires appropriate licensing of SAP products and other non-Microsoft technologies.</span></span>

## <a name="architecture"></a><span data-ttu-id="42da4-109">Architecture</span><span class="sxs-lookup"><span data-stu-id="42da4-109">Architecture</span></span>
<span data-ttu-id="42da4-110">Diese Architektur umfasst die folgenden Infrastruktur- und Schlüsselsoftwarekomponenten.</span><span class="sxs-lookup"><span data-stu-id="42da4-110">The architecture consists of the following infrastructure and key software components.</span></span>

<span data-ttu-id="42da4-111">**Virtuelles Netzwerk**.</span><span class="sxs-lookup"><span data-stu-id="42da4-111">**Virtual network**.</span></span> <span data-ttu-id="42da4-112">Der „Azure Virtual Network“-Dienst verbindet Azure-Ressourcen sicher miteinander.</span><span class="sxs-lookup"><span data-stu-id="42da4-112">The Azure Virtual Network service securely connects Azure resources to each other.</span></span> <span data-ttu-id="42da4-113">In dieser Architektur wird das virtuelle Netzwerk über ein VPN-Gateway mit einer lokalen Umgebung verbunden, und dieses Gateway wird im Hub einer [Hub-Spoke-Topologie](../hybrid-networking/hub-spoke.md) bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="42da4-113">In this architecture, the virtual network connects to an on-premises environment through a VPN gateway deployed in the hub of a [hub-spoke](../hybrid-networking/hub-spoke.md).</span></span> <span data-ttu-id="42da4-114">Die Speiche (Spoke) ist das virtuelle Netzwerk, das für die SAP-Anwendungen und die Datenbankschicht verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="42da4-114">The spoke is the virtual network used for the SAP applications and database tier.</span></span>

<span data-ttu-id="42da4-115">**Subnetze:**</span><span class="sxs-lookup"><span data-stu-id="42da4-115">**Subnets**.</span></span> <span data-ttu-id="42da4-116">Das virtuelle Netzwerk wird für jede Schicht in getrennte Subnetze unterteilt: Anwendung (SAP NetWeaver), Datenbank, gemeinsame Dienste (Jumpbox) und Active Directory.</span><span class="sxs-lookup"><span data-stu-id="42da4-116">The virtual network is subdivided into separate subnets for each tier: application (SAP NetWeaver), database, shared services (the jumpbox), and Active Directory.</span></span>
    
<span data-ttu-id="42da4-117">**Virtuelle Computer:**</span><span class="sxs-lookup"><span data-stu-id="42da4-117">**Virtual machines**.</span></span> <span data-ttu-id="42da4-118">In dieser Architektur werden virtuelle Computer für die Logikschicht und die Datenbankschicht verwendet, die wie folgt gruppiert sind:</span><span class="sxs-lookup"><span data-stu-id="42da4-118">This architecture uses virtual machines for the application tier and database tier, grouped as follows:</span></span>

- <span data-ttu-id="42da4-119">**SAP NetWeaver**:</span><span class="sxs-lookup"><span data-stu-id="42da4-119">**SAP NetWeaver**.</span></span> <span data-ttu-id="42da4-120">Auf der Logikschicht werden virtuelle Windows-Computer verwendet und werden SAP Central Services und SAP-Anwendungsserver ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="42da4-120">The application tier uses Windows virtual machines and runs SAP Central Services and SAP application servers.</span></span> <span data-ttu-id="42da4-121">Die virtuellen Computer, auf denen Central Services ausgeführt wird, sind für Hochverfügbarkeit als Windows Server-Failovercluster konfiguriert, mit Unterstützung durch SIOS DataKeeper Cluster Edition.</span><span class="sxs-lookup"><span data-stu-id="42da4-121">The VMs that run Central Services are configured as a Windows Server Failover Cluster for high availability, supported by SIOS DataKeeper Cluster Edition.</span></span>
- <span data-ttu-id="42da4-122">**AnyDB**.</span><span class="sxs-lookup"><span data-stu-id="42da4-122">**AnyDB**.</span></span> <span data-ttu-id="42da4-123">Auf der Datenbankschicht wird AnyDB als Quelldatenbank ausgeführt, z. B. Microsoft SQL Server, Oracle oder IBM DB2.</span><span class="sxs-lookup"><span data-stu-id="42da4-123">The database tier runs AnyDB as the source database, such as Microsoft SQL Server, Oracle, or IBM DB2.</span></span>
- <span data-ttu-id="42da4-124">**Jumpbox**:</span><span class="sxs-lookup"><span data-stu-id="42da4-124">**Jumpbox**.</span></span> <span data-ttu-id="42da4-125">Wird auch als „geschützter Host“ bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="42da4-125">Also called a bastion host.</span></span> <span data-ttu-id="42da4-126">Dies ist ein geschützter virtueller Computer im Netzwerk, der von Administratoren zum Herstellen von Verbindungen mit anderen virtuellen Computern verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="42da4-126">This is a secure virtual machine on the network that administrators use to connect to the other virtual machines.</span></span>
- <span data-ttu-id="42da4-127">**Windows Server Active Directory-Domänencontroller**.</span><span class="sxs-lookup"><span data-stu-id="42da4-127">**Windows Server Active Directory domain controllers**.</span></span> <span data-ttu-id="42da4-128">Die Domänencontroller werden auf allen virtuellen Computern und für alle Benutzer in der Domäne verwendet.</span><span class="sxs-lookup"><span data-stu-id="42da4-128">The domain controllers are used on all VMs and users in the domain.</span></span>

<span data-ttu-id="42da4-129">**Lastenausgleichsmodule**.</span><span class="sxs-lookup"><span data-stu-id="42da4-129">**Load balancers**.</span></span> <span data-ttu-id="42da4-130">[Azure Load Balancer](/azure/load-balancer/load-balancer-overview)-Instanzen werden dazu verwendet, Datenverkehr auf virtuelle Computer im Logikschichtsubnetz zu verteilen.</span><span class="sxs-lookup"><span data-stu-id="42da4-130">[Azure Load Balancer](/azure/load-balancer/load-balancer-overview) instances are used to distribute traffic to virtual machines in the application tier subnet.</span></span> <span data-ttu-id="42da4-131">In der Datenschicht kann Hochverfügbarkeit abhängig vom DBMS mithilfe von integrierten SAP-Lastenausgleichsmodulen, Azure Load Balancer oder anderen Mechanismen erzielt werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-131">At the data tier, high availability may be achieved using built-in SAP load balancers, Azure Load Balancer, or other mechanisms, depending on the DBMS.</span></span> <span data-ttu-id="42da4-132">Weitere Informationen finden Sie unter [Azure Virtual Machines – DBMS-Bereitstellung für SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span><span class="sxs-lookup"><span data-stu-id="42da4-132">For more information, see [Azure Virtual Machines DBMS deployment for SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span></span> 

<span data-ttu-id="42da4-133">**Verfügbarkeitsgruppen**:</span><span class="sxs-lookup"><span data-stu-id="42da4-133">**Availability sets**.</span></span> <span data-ttu-id="42da4-134">Virtuelle Computer für die Rollen SAP Web Dispatcher, SAP-Anwendungsserver und (A)SCS werden in getrennten [Verfügbarkeitsgruppen](/azure/virtual-machines/windows/tutorial-availability-sets) gruppiert, und pro Rolle werden mindestens zwei virtuelle Computer bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="42da4-134">Virtual machines for the SAP Web Dispatcher, SAP application server, and (A)SCS, roles are grouped into separate [availability sets](/azure/virtual-machines/windows/tutorial-availability-sets), and at least two virtual machines are provisioned per role.</span></span> <span data-ttu-id="42da4-135">Dies bewirkt, dass die virtuellen Computer für eine höhere [Vereinbarung zum Servicelevel](https://azure.microsoft.com/support/legal/sla/virtual-machines) (Service Level Agreement, SLA) auswählbar sind.</span><span class="sxs-lookup"><span data-stu-id="42da4-135">This makes the virtual machines eligible for a higher [service level agreement](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLA).</span></span>

<span data-ttu-id="42da4-136">**NICs**.</span><span class="sxs-lookup"><span data-stu-id="42da4-136">**NICs**.</span></span> <span data-ttu-id="42da4-137">[Netzwerkschnittstellenkarten](/azure/virtual-network/virtual-network-network-interface) (NICs) ermöglichen die gesamte Kommunikation von virtuellen Computern in einem virtuellen Netzwerk.</span><span class="sxs-lookup"><span data-stu-id="42da4-137">[Network interface cards](/azure/virtual-network/virtual-network-network-interface) (NICs) enable all communication of virtual machines on a virtual network.</span></span>

<span data-ttu-id="42da4-138">**Netzwerksicherheitsgruppen**.</span><span class="sxs-lookup"><span data-stu-id="42da4-138">**Network security groups**.</span></span> <span data-ttu-id="42da4-139">Um eingehenden, ausgehenden und subnetzinternen Datenverkehr im virtuellen Netzwerk einzuschränken, können Sie [Netzwerksicherheitsgruppen](/azure/virtual-network/virtual-networks-nsg) (NSGs) erstellen.</span><span class="sxs-lookup"><span data-stu-id="42da4-139">To restrict incoming, outgoing, and intra-subnet traffic in the virtual network, you can create [network security groups](/azure/virtual-network/virtual-networks-nsg) (NSGs).</span></span>

<span data-ttu-id="42da4-140">**Gateway**.</span><span class="sxs-lookup"><span data-stu-id="42da4-140">**Gateway**.</span></span> <span data-ttu-id="42da4-141">Über ein Gateway wird Ihr lokales Netzwerk in das virtuelle Azure-Netzwerk erweitert.</span><span class="sxs-lookup"><span data-stu-id="42da4-141">A gateway extends your on-premises network to the Azure virtual network.</span></span> <span data-ttu-id="42da4-142">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) ist der empfohlene Azure-Dienst für das Erstellen von privaten Verbindungen, die nicht über das öffentliche Internet laufen, es kann aber auch eine [Standort-zu-Standort](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal)-Verbindung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-142">[ExpressRoute](/azure/architecture/reference-architectures/hybrid-networking/expressroute) is the recommended Azure service for creating private connections that do not go over the public Internet, but a [Site-to-Site](/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal) connection can also be used.</span></span>

<span data-ttu-id="42da4-143">**Azure Storage**.</span><span class="sxs-lookup"><span data-stu-id="42da4-143">**Azure Storage**.</span></span> <span data-ttu-id="42da4-144">Soll permanenter Speicher einer virtuellen Festplatte (VHD) eines virtuellen Computers bereitgestellt werden, ist [Azure Storage](/azure/storage/storage-standard-storage) erforderlich.</span><span class="sxs-lookup"><span data-stu-id="42da4-144">To provide persistent storage of a virtual machine's virtual hard disk (VHD), [Azure Storage](/azure/storage/storage-standard-storage) is required.</span></span> <span data-ttu-id="42da4-145">Dieser Dienst wird auch von [Cloudzeuge](/windows-server/failover-clustering/deploy-cloud-witness) verwendet, um einen Failoverclustervorgang zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="42da4-145">It is also used by [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) to implement a failover cluster operation.</span></span> 

## <a name="recommendations"></a><span data-ttu-id="42da4-146">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="42da4-146">Recommendations</span></span>
<span data-ttu-id="42da4-147">Ihre Anforderungen können von der hier beschriebenen Architektur abweichen.</span><span class="sxs-lookup"><span data-stu-id="42da4-147">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="42da4-148">Verwenden Sie diese Empfehlungen als Startpunkt.</span><span class="sxs-lookup"><span data-stu-id="42da4-148">Use these recommendations as a starting point.</span></span>

### <a name="sap-web-dispatcher-pool"></a><span data-ttu-id="42da4-149">SAP Web Dispatcher-Pool</span><span class="sxs-lookup"><span data-stu-id="42da4-149">SAP Web Dispatcher pool</span></span>

<span data-ttu-id="42da4-150">Die Web Dispatcher-Komponente wird als Lastenausgleichsmodul für SAP-Datenverkehr zwischen den SAP-Anwendungsservern verwendet.</span><span class="sxs-lookup"><span data-stu-id="42da4-150">The Web Dispatcher component is used as a load balancer for SAP traffic among the SAP application servers.</span></span> <span data-ttu-id="42da4-151">Um Hochverfügbarkeit für die Web Dispatcher-Komponente zu erreichen, wird mit Azure Load Balancer das parallele Web Dispatcher-Setup implementiert.</span><span class="sxs-lookup"><span data-stu-id="42da4-151">To achieve high availability for the Web Dispatcher component, Azure Load Balancer is used to implement the parallel Web Dispatcher setup.</span></span> <span data-ttu-id="42da4-152">Für Web Dispatcher wird eine Roundrobin-Konfiguration für HTTP(S)-Datenverkehrsverteilung zwischen den verfügbaren Web Dispatcher-Instanzen im Pool der Lastenausgleichsmodule verwendet.</span><span class="sxs-lookup"><span data-stu-id="42da4-152">Web Dispatcher uses in a round-robin configuration for HTTP(S) traffic distribution among the available Web Dispatchers in the balancers pool.</span></span>

<span data-ttu-id="42da4-153">Ausführliche Informationen zum Ausführen von SAP NetWeaver in virtuellen Azure-Computern finden Sie unter [Azure Virtual Machines – Planung und Implementierung für SAP NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide).</span><span class="sxs-lookup"><span data-stu-id="42da4-153">For details about running SAP NetWeaver in Azure VMs, see [Azure Virtual Machines planning and implementation for SAP NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide).</span></span>

### <a name="application-servers-pool"></a><span data-ttu-id="42da4-154">Anwendungsserverpool</span><span class="sxs-lookup"><span data-stu-id="42da4-154">Application servers pool</span></span>

<span data-ttu-id="42da4-155">Um Anmeldegruppen für ABAP-Anwendungsserver zu verwalten, wird die SMLG-Transaktion verwendet.</span><span class="sxs-lookup"><span data-stu-id="42da4-155">To manage logon groups for ABAP application servers, the SMLG transaction is used.</span></span> <span data-ttu-id="42da4-156">In ihr wird die Lastenausgleichsfunktion im Nachrichtenserver der Central Services verwendet, um Arbeitslast im SAP-Anwendungsserverpool für SAPGUIs und RFC-Datenverkehr zu verteilen.</span><span class="sxs-lookup"><span data-stu-id="42da4-156">It uses the load balancing function within the message server of the Central Services to distribute workload among SAP application servers pool for SAPGUIs and RFC traffic.</span></span> <span data-ttu-id="42da4-157">Die Anwendungsserververbindung mit den hochverfügbaren Central Services erfolgt über den Namen des virtuellen Netzwerkclusters.</span><span class="sxs-lookup"><span data-stu-id="42da4-157">The application server connection to the highly available Central Services is through the cluster virtual network name.</span></span>

### <a name="sap-central-services-cluster"></a><span data-ttu-id="42da4-158">SAP Central Services-Cluster</span><span class="sxs-lookup"><span data-stu-id="42da4-158">SAP Central Services cluster</span></span>

<span data-ttu-id="42da4-159">In dieser Referenzarchitektur wird Central Services auf virtuellen Computern auf der Logikschicht ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="42da4-159">This reference architecture runs Central Services on VMs in the application tier.</span></span> <span data-ttu-id="42da4-160">Die Central Services-Komponente ist ein möglicher Single Point of Failure (SPOF), wenn sie auf einem einzelnen virtuellen Computer bereitgestellt wird – dies ist die typische Bereitstellung, wenn Hochverfügbarkeitnicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="42da4-160">The Central Services is a potential single point of failure (SPOF) when deployed to a single VM—typical deployment when high availability is not a requirement.</span></span> <span data-ttu-id="42da4-161">Soll eine Hochverfügbarkeitslösung implementiert werden, kann ein Cluster mit freigegebenen Datenträgern oder ein Dateifreigabecluster verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-161">To implement a high availability solution, either a shared disk cluster or a file share cluster can be used.</span></span>

<span data-ttu-id="42da4-162">Um virtuelle Computer für einen Cluster mit freigegebenen Datenträgern zu konfigurieren, verwenden Sie [Windows Server-Failovercluster](https://blogs.sap.com/2018/01/25/how-to-create-sap-resources-in-windows-failover-cluster/).</span><span class="sxs-lookup"><span data-stu-id="42da4-162">To configure VMs for a shared disk cluster, use [Windows Server Failover Cluster](https://blogs.sap.com/2018/01/25/how-to-create-sap-resources-in-windows-failover-cluster/).</span></span> <span data-ttu-id="42da4-163">[Cloudzeuge](/windows-server/failover-clustering/deploy-cloud-witness) wird als ein Quorumzeuge empfohlen.</span><span class="sxs-lookup"><span data-stu-id="42da4-163">[Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) is recommended as a quorum witness.</span></span> <span data-ttu-id="42da4-164">Zur Unterstützung der Failoverclusterumgebung führt [SIOS DataKeeper Cluster Edition](https://azuremarketplace.microsoft.com/marketplace/apps/sios_datakeeper.sios-datakeeper-8) die Funktion zur Clustererstellung der freigegebenen Volumes aus, indem unabhängige Datenträger repliziert werden, die sich im Besitz der Clusterknoten befinden.</span><span class="sxs-lookup"><span data-stu-id="42da4-164">To support the failover cluster environment, [SIOS DataKeeper Cluster Edition](https://azuremarketplace.microsoft.com/marketplace/apps/sios_datakeeper.sios-datakeeper-8) performs the cluster shared volume function by replicating independent disks owned by the cluster nodes.</span></span> <span data-ttu-id="42da4-165">Azure selbst unterstützt keine freigegebenen Datenträger und erfordert daher Lösungen, die von SIOS bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-165">Azure does not natively support shared disks and therefore requires solutions provided by SIOS.</span></span>

<span data-ttu-id="42da4-166">Einzelheiten dazu finden Sie unter „3.</span><span class="sxs-lookup"><span data-stu-id="42da4-166">For details, see "3.</span></span> <span data-ttu-id="42da4-167">Important Update for SAP Customers Running ASCS on SIOS on Azure“ im Blog [Running SAP applications on the Microsoft Platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/).</span><span class="sxs-lookup"><span data-stu-id="42da4-167">Important Update for SAP Customers Running ASCS on SIOS on Azure” at [Running SAP applications on the Microsoft platform](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/).</span></span>

<span data-ttu-id="42da4-168">Eine weitere Möglichkeit zur Verwaltung von Clustering besteht darin, mit Windows Server Failovercluster ein Dateifreigabecluster zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="42da4-168">Another way to handle clustering is to implement a file share cluster using Windows Server Failover Cluster.</span></span> <span data-ttu-id="42da4-169">[SAP](https://blogs.sap.com/2018/03/19/migration-from-a-shared-disk-cluster-to-a-file-share-cluster/) hat kürzlich das Bereitstellungsmuster von Central Services so geändert, dass über einen UNC-Pfad auf die globalen „/sapmnt“-Verzeichnisse zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="42da4-169">[SAP](https://blogs.sap.com/2018/03/19/migration-from-a-shared-disk-cluster-to-a-file-share-cluster/) recently modified the Central Services deployment pattern to access the /sapmnt global directories via a UNC path.</span></span> <span data-ttu-id="42da4-170">Mit dieser Änderung [entfällt die Forderung](https://blogs.msdn.microsoft.com/saponsqlserver/2017/08/10/high-available-ascs-for-windows-on-file-share-shared-disk-no-longer-required/) nach SIOS oder anderen Lösungen für freigegebene Datenträger auf den virtuellen Computern mit Central Services.</span><span class="sxs-lookup"><span data-stu-id="42da4-170">This change [removes the requirement](https://blogs.msdn.microsoft.com/saponsqlserver/2017/08/10/high-available-ascs-for-windows-on-file-share-shared-disk-no-longer-required/) for SIOS or other shared disk solutions on the Central Services VMs.</span></span> <span data-ttu-id="42da4-171">Es wird weiterhin empfohlen sicherzustellen, dass die UNC-Freigabe für „/sapmnt“ [hochverfügbar](https://blogs.sap.com/2017/07/21/how-to-create-a-high-available-sapmnt-share/) ist.</span><span class="sxs-lookup"><span data-stu-id="42da4-171">It is still recommended to ensure that the /sapmnt UNC share is [highly available](https://blogs.sap.com/2017/07/21/how-to-create-a-high-available-sapmnt-share/).</span></span> <span data-ttu-id="42da4-172">Dies lässt sich in der Central Services-Instanz erreichen, indem Windows Server-Failovercluster mit [Scale Out File Server](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS) und der [Storage Spaces Direct](https://blogs.sap.com/2018/03/07/your-sap-on-azure-part-5-ascs-high-availability-with-storage-spaces-direct/)-Funktion (S2D, „Direkte Speicherplätze“) in Windows Server 2016 verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="42da4-172">This can be done on the Central Services instance by using Windows Server Failover Cluster with [Scale Out File Server](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS) and the [Storage Spaces Direct](https://blogs.sap.com/2018/03/07/your-sap-on-azure-part-5-ascs-high-availability-with-storage-spaces-direct/) (S2D) feature in Windows Server 2016.</span></span> 

### <a name="availability-sets"></a><span data-ttu-id="42da4-173">Verfügbarkeitsgruppen</span><span class="sxs-lookup"><span data-stu-id="42da4-173">Availability sets</span></span>

<span data-ttu-id="42da4-174">Verfügbarkeitsgruppen verteilen Server auf verschiedene physische Infrastruktur und aktualisieren Gruppen, um die Verfügbarkeit des Diensts zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="42da4-174">Availability sets distribute servers to different physical infrastructure and update groups to improve service availability.</span></span> <span data-ttu-id="42da4-175">Ordnen Sie virtuelle Computer, die dieselbe Rolle ausführen, in einer Verfügbarkeitsgruppe an, um vor Ausfallzeiten aufgrund von Wartung der Azure-Infrastruktur zu schützen und [SLAs](https://azure.microsoft.com/support/legal/sla/virtual-machines) (Vereinbarungen zum Servicelevel) zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="42da4-175">Put virtual machines that perform the same role into an availability sets to help guard against downtime caused by Azure infrastructure maintenance and to meet [SLAs](https://azure.microsoft.com/support/legal/sla/virtual-machines) (SLAs).</span></span> <span data-ttu-id="42da4-176">Es empfiehlt sich, mindestens zwei virtuelle Computer pro Verfügbarkeitsgruppe zu haben.</span><span class="sxs-lookup"><span data-stu-id="42da4-176">Two or more virtual machines per availability set is recommended.</span></span>

<span data-ttu-id="42da4-177">Alle virtuellen Computer in einer Gruppe müssen dieselbe Rolle ausführen.</span><span class="sxs-lookup"><span data-stu-id="42da4-177">All virtual machines in a set must perform the same role.</span></span> <span data-ttu-id="42da4-178">Mischen Sie keine Server mit unterschiedlichen Rollen in derselben Verfügbarkeitsgruppe.</span><span class="sxs-lookup"><span data-stu-id="42da4-178">Do not mix servers of different roles in the same availability set.</span></span> <span data-ttu-id="42da4-179">Ordnen Sie z. B. keinen Central Services-Knoten in derselben Verfügbarkeitsgruppe mit dem Anwendungsserver an.</span><span class="sxs-lookup"><span data-stu-id="42da4-179">For example, don't place a Central Services node in the same availability set with the application server.</span></span>

### <a name="nics"></a><span data-ttu-id="42da4-180">NICs</span><span class="sxs-lookup"><span data-stu-id="42da4-180">NICs</span></span>

<span data-ttu-id="42da4-181">In herkömmlichen lokalen SAP-Bereitstellungen sind mehrere Netzwerkschnittstellenkarten (NICs) pro Computer implementiert, um administrativen Datenverkehr von Geschäftsdatenverkehr zu trennen.</span><span class="sxs-lookup"><span data-stu-id="42da4-181">Traditional on-premises SAP deployments implement multiple network interface cards (NICs) per machine to segregate administrative traffic from business traffic.</span></span> <span data-ttu-id="42da4-182">In Azure ist das virtuelle Netzwerk eine softwaredefiniertes Netzwerk, in dem der gesamte Datenverkehr über dieselbe Netzwerkstruktur gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="42da4-182">On Azure, the virtual network is a software-defined network that sends all traffic through the same network fabric.</span></span> <span data-ttu-id="42da4-183">Aus diesem Grund ist die Verwendung von mehreren NICs nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="42da4-183">Therefore, the use of multiple NICs is unnecessary.</span></span> <span data-ttu-id="42da4-184">Wenn Ihre Organisation den Datenverkehr jedoch aufteilen muss, können Sie mehrere NICs pro virtueller Maschine bereitstellen, jede NIC mit einem anderen Subnetz verbinden und dann Netzwerksicherheitsgruppen verwenden, um verschiedene Zugriffssteuerungsrichtlinien zu erzwingen.</span><span class="sxs-lookup"><span data-stu-id="42da4-184">However, if your organization needs to segregate traffic, you can deploy multiple NICs per VM, connect each NIC to a different subnet, and then use NSGs to enforce different access control policies.</span></span>

### <a name="subnets-and-nsgs"></a><span data-ttu-id="42da4-185">Subnetze und Netzwerksicherheitsgruppen</span><span class="sxs-lookup"><span data-stu-id="42da4-185">Subnets and NSGs</span></span>

<span data-ttu-id="42da4-186">In dieser Architektur wird der Adressraum des virtuellen Netzwerks in Subnetze unterteilt.</span><span class="sxs-lookup"><span data-stu-id="42da4-186">This architecture subdivides the virtual network address space into subnets.</span></span> <span data-ttu-id="42da4-187">In dieser Referenzarchitektur liegt der Fokus hauptsächlich auf dem Logikschichtsubnetz.</span><span class="sxs-lookup"><span data-stu-id="42da4-187">This reference architecture focuses primarily on the application tier subnet.</span></span> <span data-ttu-id="42da4-188">Jedes Subnetz kann einer Netzwerksicherheitsgruppe (NSG) zugeordnet werden, in der die Zugriffsrichtlinien für das Subnetz definiert sind.</span><span class="sxs-lookup"><span data-stu-id="42da4-188">Each subnet can be associated with a NSG that defines the access policies for the subnet.</span></span> <span data-ttu-id="42da4-189">Platzieren Sie Anwendungsserver in einem separaten Subnetz, sodass Sie diese leichter schützen können, indem Sie die Sicherheitsrichtlinien des Subnetzes und nicht die einzelnen Server verwalten.</span><span class="sxs-lookup"><span data-stu-id="42da4-189">Place application servers on a separate subnet so you can secure them more easily by managing the subnet security policies, not the individual servers.</span></span>

<span data-ttu-id="42da4-190">Wenn eine NSG einem Subnetz zugeordnet ist, gilt sie für alle Server im Subnetz.</span><span class="sxs-lookup"><span data-stu-id="42da4-190">When a NSG is associated with a subnet, it applies to all the servers within the subnet.</span></span> <span data-ttu-id="42da4-191">Weitere Informationen zur Verwendung von Netzwerksicherheitsgruppen für eine differenziertere Kontrolle über die Server in einem Subnetz finden Sie unter [Filtern des Netzwerkdatenverkehrs mit Netzwerksicherheitsgruppen](https://azure.microsoft.com/en-us/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure/).</span><span class="sxs-lookup"><span data-stu-id="42da4-191">For more information about using NSGs for fine-grained control over the servers in a subnet, see [Filter network traffic with network security groups](https://azure.microsoft.com/en-us/blog/multiple-vm-nics-and-network-virtual-appliances-in-azure/).</span></span>

### <a name="load-balancers"></a><span data-ttu-id="42da4-192">Load Balancer</span><span class="sxs-lookup"><span data-stu-id="42da4-192">Load balancers</span></span>

<span data-ttu-id="42da4-193">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) verwaltet den Lastenausgleich von HTTP(S)-Datenverkehr in einem Pool von SAP-Anwendungsservern.</span><span class="sxs-lookup"><span data-stu-id="42da4-193">[SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm) handles load balancing of HTTP(S) traffic to a pool of SAP application servers.</span></span>

<span data-ttu-id="42da4-194">Für Datenverkehr von SAP GUI-Clients, die sich über das DIAG-Protokoll oder RFC (Remote Function Calls) mit einem SAP-Server verbinden, verteilt der Central Services-Nachrichtenserver die Last über SAP-Anwendungsserver-[Anmeldungsgruppen](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing), sodass kein zusätzliches Lastenausgleichsmodul erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="42da4-194">For traffic from SAP GUI clients connecting a SAP server via DIAG protocol or Remote Function Calls (RFC), the Central Services message server balances the load through SAP application server [logon groups](https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing), so no additional load balancer is needed.</span></span>

### <a name="azure-storage"></a><span data-ttu-id="42da4-195">Azure Storage</span><span class="sxs-lookup"><span data-stu-id="42da4-195">Azure Storage</span></span>

<span data-ttu-id="42da4-196">Für alle virtuellen Computer, die als Datenbankserver fungieren, sollte Azure Storage Premium verwendet werden, um eine einheitliche Wartezeit für Lese- und Schreibvorgänge zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="42da4-196">For all database server virtual machines, we recommend using Azure Premium Storage for consistent read/write latency.</span></span> <span data-ttu-id="42da4-197">Informationen zu einem virtuellen Einzelinstanzcomputer, auf dem Storage Premium für alle Betriebssystemdatenträger und Daten-Datenträger verwendet wird, finden Sie unter [SLA für virtuelle Computer](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="42da4-197">For any single instance virtual machine using Premium Storage for all operating system disks and data disks, see [SLA for Virtual Machines](https://azure.microsoft.com/support/legal/sla/virtual-machines).</span></span> <span data-ttu-id="42da4-198">Außerdem sollten Sie für Produktions-SAP-Systeme in allen Fällen [Azure Managed Disks](/azure/storage/storage-managed-disks-overview) in der Variante Premium verwenden.</span><span class="sxs-lookup"><span data-stu-id="42da4-198">Also, for production SAP systems, we recommend using Premium [Azure Managed Disks](/azure/storage/storage-managed-disks-overview) in all cases.</span></span> <span data-ttu-id="42da4-199">Aus Gründen der Zuverlässigkeit wird Managed Disks verwendet, um die VHD-Dateien für die Datenträger zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="42da4-199">For reliability, Managed Disks are used to manage the VHD files for the disks.</span></span> <span data-ttu-id="42da4-200">Außerdem wird von Managed Disks sichergestellt, dass die Datenträger für virtuelle Computer in einer Verfügbarkeitsgruppe isoliert sind, um Single Points of Failure zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="42da4-200">Managed disks ensure that the disks for virtual machines within an availability set are isolated to avoid single points of failure.</span></span>

<span data-ttu-id="42da4-201">Für SAP-Anwendungsserver, etwa die virtuellen Central Services-Computer, können Sie zur Kostensenkung Azure-Standardspeicher verwenden, da die Anwendung im Arbeitsspeicher ausgeführt wird und Datenträger nur zur Protokollierung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-201">For SAP application servers, including the Central Services virtual machines, you can use Azure Standard Storage to reduce cost, because application execution takes place in memory and disks are used for logging only.</span></span> <span data-ttu-id="42da4-202">Allerdings ist Standardspeicher derzeit nur für nicht verwalteten Speicher zertifiziert.</span><span class="sxs-lookup"><span data-stu-id="42da4-202">However, at this time, Standard Storage is only certified for unmanaged storage.</span></span> <span data-ttu-id="42da4-203">Da Anwendungsserver keine Daten hosten, können Sie auch die kleineren P4- und P6-Storage Premium-Datenträger verwenden, um die Kosten zu minimieren.</span><span class="sxs-lookup"><span data-stu-id="42da4-203">Since application servers do not host any data, you can also use the smaller P4 and P6 Premium Storage disks to help minimize cost.</span></span>

<span data-ttu-id="42da4-204">Azure Storage wird auch von [Cloudzeuge](/windows-server/failover-clustering/deploy-cloud-witness) verwendet, um das Quorum mit einem Gerät in einer Azure-Remoteregion außerhalb der primären Region zu verwalten, in der sich der Cluster befindet.</span><span class="sxs-lookup"><span data-stu-id="42da4-204">Azure Storage is also used by [Cloud Witness](/windows-server/failover-clustering/deploy-cloud-witness) to maintain quorum with a device in a remote Azure region away from the primary region where the cluster resides.</span></span>

<span data-ttu-id="42da4-205">Für den Sicherungsdatenspeicher empfiehlt es sich, Azure-[Speicher des Typs „kalte Zugriffsebene“](/azure/storage/storage-blob-storage-tiers) und [„Archivzugriffsebene“](/azure/storage/storage-blob-storage-tiers) zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="42da4-205">For the backup data store, we recommend using Azure [coolaccess tier](/azure/storage/storage-blob-storage-tiers) and [archive access tier storage](/azure/storage/storage-blob-storage-tiers).</span></span> <span data-ttu-id="42da4-206">Diese Speicherebenen sind kostengünstige Möglichkeiten, langlebige Daten zu speichern, auf die eher selten zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="42da4-206">These storage tiers are cost-effective ways to store long-lived data that is infrequently accessed.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="42da4-207">Überlegungen zur Leistung</span><span class="sxs-lookup"><span data-stu-id="42da4-207">Performance considerations</span></span>

<span data-ttu-id="42da4-208">SAP-Anwendungsserver kommunizieren ständig mit den Datenbankservern.</span><span class="sxs-lookup"><span data-stu-id="42da4-208">SAP application servers carry on constant communications with the database servers.</span></span> <span data-ttu-id="42da4-209">Für leistungskritische Anwendungen, die auf einer beliebigen Datenbankplattform, z. B. SAP HANA, ausgeführt werden, sollten Sie [Schreibbeschleunigung](/azure/virtual-machines/linux/how-to-enable-write-accelerator) aktivieren, um die Latenz der Protokollschreibvorgänge zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="42da4-209">For performance-critical applications running on any database platforms, including SAP HANA, consider enabling [Write Accelerator](/azure/virtual-machines/linux/how-to-enable-write-accelerator) to improve log write latency.</span></span> <span data-ttu-id="42da4-210">Um die serverübergreifende Kommunikation zu optimieren, verwenden Sie [Accelerated Networking](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span><span class="sxs-lookup"><span data-stu-id="42da4-210">To optimize inter-server communications, use the [Accelerated Network](https://azure.microsoft.com/blog/linux-and-windows-networking-performance-enhancements-accelerated-networking/).</span></span> <span data-ttu-id="42da4-211">Beachten Sie, dass diese Beschleunigungskomponenten nur für bestimmte VM-Serien verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="42da4-211">Note that these accelerators are available only for certain VM series.</span></span>

<span data-ttu-id="42da4-212">Zur Erreichung eines hohen Durchsatzes in Bezug auf IOPS und die Datenträger-Bandbreite gelten für das Azure-Speicherlayout die gängigen Vorgehensweisen zur [Leistungsoptimierung](/azure/virtual-machines/windows/premium-storage-performance) für Speichervolumes.</span><span class="sxs-lookup"><span data-stu-id="42da4-212">To achieve high IOPS and disk bandwidth throughput, the common practices in storage volume [performance optimization](/azure/virtual-machines/windows/premium-storage-performance) apply to Azure storage layout.</span></span> <span data-ttu-id="42da4-213">Wenn beispielsweise mehrere Datenträger kombiniert werden, um ein Stripeset-Datenträgervolume zu erstellen, verbessert sich die E/A-Leistung.</span><span class="sxs-lookup"><span data-stu-id="42da4-213">For example, combining multiple disks together to create a striped disk volume improves IO performance.</span></span> <span data-ttu-id="42da4-214">Eine Aktivierung des Lesecaches für Speicherinhalte, die sich in unregelmäßigen Abständen ändern, bewirkt eine höhere Geschwindigkeit beim Datenabruf.</span><span class="sxs-lookup"><span data-stu-id="42da4-214">Enabling the read cache on storage content that changes infrequently enhances the speed of data retrieval.</span></span>

<span data-ttu-id="42da4-215">Für SAP auf SQL bietet der Blogbeitrag [Top 10 Key Considerations for Deploying SAP Applications on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/25/top-10-key-considerations-for-deploying-sap-applications-on-azure/) hervorragende Ratschläge zum Optimieren von Azure-Speicher für SAP-Workloads auf SQL Server.</span><span class="sxs-lookup"><span data-stu-id="42da4-215">For SAP on SQL, the [Top 10 Key Considerations for Deploying SAP Applications on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/25/top-10-key-considerations-for-deploying-sap-applications-on-azure/) blog offers excellent advice on optimizing Azure storage for SAP workloads on SQL Server.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="42da4-216">Überlegungen zur Skalierbarkeit</span><span class="sxs-lookup"><span data-stu-id="42da4-216">Scalability considerations</span></span>

<span data-ttu-id="42da4-217">Auf der SAP-Anwendungsschicht sind in Azure viele verschiedene VM-Größen für zentrales Hochskalieren und horizontales Hochskalieren verfügbar. Eine umfassende Liste finden Sie unter [SAP Note 1928533 – SAP Applications on Azure: Supported Products and Azure VM Types](https://launchpad.support.sap.com/#/notes/1928533) (SAP-Hinweis 1928533 – SAP-Anwendungen in Azure: Unterstützte Produkte und Azure-VM-Typen).</span><span class="sxs-lookup"><span data-stu-id="42da4-217">At the SAP application layer, Azure offers a wide range of virtual machine sizes for scaling up and scaling out. For an inclusive list, see [SAP note 1928533](https://launchpad.support.sap.com/#/notes/1928533) - SAP Applications on Azure: Supported Products and Azure VM Types.</span></span> <span data-ttu-id="42da4-218">(Für den Zugriff ist ein SAP Service Marketplace-Konto erforderlich.)</span><span class="sxs-lookup"><span data-stu-id="42da4-218">(SAP Service Marketplace account required for access).</span></span> <span data-ttu-id="42da4-219">SAP-Anwendungsserver und die Central Services-können zentral hoch-/herunterskaliert oder horizontal hochskaliert werden, indem weitere Instanzen hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-219">SAP application servers and the Central Services clusters can scale up/down or scale out by adding more instances.</span></span> <span data-ttu-id="42da4-220">Die AnyDB-Datenbank kann zentral hoch-/herunterskaliert, aber nicht horizontal hochskaliert werden. Der SAP-Datenbankcontainer für AnyDB unterstützt Sharding nicht.</span><span class="sxs-lookup"><span data-stu-id="42da4-220">The AnyDB database can scale up/down but does not scale out. The SAP database container for AnyDB does not support sharding.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="42da4-221">Überlegungen zur Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="42da4-221">Availability considerations</span></span>

<span data-ttu-id="42da4-222">Ressourcenredundanz ist das allgemeine Thema bei hochverfügbaren Infrastrukturlösungen.</span><span class="sxs-lookup"><span data-stu-id="42da4-222">Resource redundancy is the general theme in highly available infrastructure solutions.</span></span> <span data-ttu-id="42da4-223">Für Unternehmen, die über eine weniger strenge SLA verfügen, bieten virtuelle Azure-Computer mit einer einzigen Instanz eine Uptime-SLA.</span><span class="sxs-lookup"><span data-stu-id="42da4-223">For enterprises that have a less stringent SLA, single-instance Azure VMs offer an uptime SLA.</span></span> <span data-ttu-id="42da4-224">Weitere Informationen finden Sie unter [Vereinbarung zum Azure-Servicelevel](https://azure.microsoft.com/support/legal/sla/).</span><span class="sxs-lookup"><span data-stu-id="42da4-224">For more information, see [Azure Service Level Agreement](https://azure.microsoft.com/support/legal/sla/).</span></span>

<span data-ttu-id="42da4-225">Bei dieser verteilten Installation der SAP-Anwendung wird die Basisinstallation repliziert, um Hochverfügbarkeit zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="42da4-225">In this distributed installation of the SAP application, the base installation is replicated to achieve high availability.</span></span> <span data-ttu-id="42da4-226">Der Entwurf für die Hochverfügbarkeit variiert für jede Ebene der Architektur.</span><span class="sxs-lookup"><span data-stu-id="42da4-226">For each layer of the architecture, the high availability design varies.</span></span>

### <a name="application-tier"></a><span data-ttu-id="42da4-227">Logikschicht</span><span class="sxs-lookup"><span data-stu-id="42da4-227">Application tier</span></span>

<span data-ttu-id="42da4-228">Hochverfügbarkeit für SAP Web Dispatcher wird mit redundanten Instanzen erzielt.</span><span class="sxs-lookup"><span data-stu-id="42da4-228">High availability for SAP Web Dispatcher is achieved with redundant instances.</span></span> <span data-ttu-id="42da4-229">Informationen hierzu finden Sie in der SAP-Dokumentation unter [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm).</span><span class="sxs-lookup"><span data-stu-id="42da4-229">See [SAP Web Dispatcher](https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm) in the SAP Documentation.</span></span>

<span data-ttu-id="42da4-230">Hochverfügbarkeit von Central Services wird mit Windows Server-Failovercluster implementiert.</span><span class="sxs-lookup"><span data-stu-id="42da4-230">High availability of the Central Services is implemented with Windows Server Failover Cluster.</span></span> <span data-ttu-id="42da4-231">Wenn der Clusterspeicher in Azure bereitgestellt wird, kann er für den Failovercluster auf zwei Arten konfiguriert werden: als freigegebenes Clustervolumes oder als Dateifreigabe.</span><span class="sxs-lookup"><span data-stu-id="42da4-231">When deployed on Azure, the cluster storage for the failover cluster can be configured using two approaches: either a clustered shared volume or a file share.</span></span>

<span data-ttu-id="42da4-232">Da Azure freigegebene Datenträger nicht unterstützt, wird SIOS Datakeeper verwendet, um die Inhalte unabhängiger Datenträger, die den Clusterknoten zugeordnet sind, zu replizieren und die Datenträger für den Cluster-Manager als ein freigegebenes Clustervolume zu abstrahieren.</span><span class="sxs-lookup"><span data-stu-id="42da4-232">Since shared disks are not possible on Azure, SIOS Datakeeper is used to replicate the content of independent disks attached to the cluster nodes and to abstract the drives as a cluster shared volume for the cluster manager.</span></span> <span data-ttu-id="42da4-233">Implementierungsdetails finden Sie unter [Clustering SAP ASCS on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/).</span><span class="sxs-lookup"><span data-stu-id="42da4-233">For implementation details, see [Clustering SAP ASCS on Azure](https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/).</span></span>

<span data-ttu-id="42da4-234">Eine andere Möglichkeit besteht darin, eine Dateifreigabe zu verwenden, die vom [Scale Out File Server](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS) bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="42da4-234">Another option is to use a file share served up by the [Scale Out Fileserver](https://blogs.msdn.microsoft.com/saponsqlserver/2017/11/14/file-server-with-sofs-and-s2d-as-an-alternative-to-cluster-shared-disk-for-clustering-of-an-sap-ascs-instance-in-azure-is-generally-available/) (SOFS).</span></span> <span data-ttu-id="42da4-235">SOFS bietet robuste Dateifreigaben, die Sie als freigegebenes Clustervolume für den Windows-Cluster verwenden können.</span><span class="sxs-lookup"><span data-stu-id="42da4-235">SOFS offers resilient file shares you can use as a cluster shared volume for the Windows cluster.</span></span> <span data-ttu-id="42da4-236">Ein SOFS-Cluster kann für mehrere Central Services-Knoten freigegeben werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-236">A SOFS cluster can be shared among multiple Central Services nodes.</span></span> <span data-ttu-id="42da4-237">Zum jetzigen Zeitpunkt wird SOFS nur für Hochverfügbarkeitsentwürfe verwendet, da sich der SOFS-Cluster nicht über Regionen erstreckt, um Unterstützung für Notfallwiederherstellung zu bieten.</span><span class="sxs-lookup"><span data-stu-id="42da4-237">As of this writing, SOFS is used only for high availability design, because the SOFS cluster does not extend across regions to provide disaster recovery support.</span></span>

<span data-ttu-id="42da4-238">Hochverfügbarkeit für die SAP-Anwendungsserver wird erzielt, indem für Datenverkehr in einem Pool mit Anwendungsservern ein Lastenausgleich durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="42da4-238">High availability for the SAP application servers is achieved by load balancing traffic within a pool of application servers.</span></span>
<span data-ttu-id="42da4-239">Weitere Informationen finden Sie unter [SAP-Zertifizierungen und -Konfigurationen in Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span><span class="sxs-lookup"><span data-stu-id="42da4-239">See [SAP certifications and configurations running on Microsoft Azure](/azure/virtual-machines/workloads/sap/sap-certifications).</span></span>

### <a name="database-tier"></a><span data-ttu-id="42da4-240">Datenbankschicht</span><span class="sxs-lookup"><span data-stu-id="42da4-240">Database tier</span></span>

<span data-ttu-id="42da4-241">Für diese Referenzarchitektur wird angenommen, dass die Quelldatenbank in AnyDB ausgeführt wird – also ein DBMS wie SQL Server, SAP ASE, IBM DB2 oder Oracle.</span><span class="sxs-lookup"><span data-stu-id="42da4-241">This reference architecture assumes the source database is running on AnyDB—that is, a DBMS such as SQL Server, SAP ASE, IBM DB2, or Oracle.</span></span> <span data-ttu-id="42da4-242">Die native Replikationsfunktion der Datenbankschicht bietet entweder manuelles oder automatisches Failover zwischen replizierten Knoten.</span><span class="sxs-lookup"><span data-stu-id="42da4-242">The database tier's native replication feature provides either manual or automatic failover between replicated nodes.</span></span>

<span data-ttu-id="42da4-243">Implementierungsdetails zu bestimmten Datenbanksystemen finden Sie unter [Azure Virtual Machines – DBMS-Bereitstellung für SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span><span class="sxs-lookup"><span data-stu-id="42da4-243">For implementation details about specific database systems, see [Azure Virtual Machines DBMS deployment for SAP NetWeaver](/azure/virtual-machines/workloads/sap/dbms-guide).</span></span>

## <a name="disaster-recovery-considerations"></a><span data-ttu-id="42da4-244">Überlegungen zur Notfallwiederherstellung</span><span class="sxs-lookup"><span data-stu-id="42da4-244">Disaster recovery considerations</span></span>

<span data-ttu-id="42da4-245">Zur Notfallwiederherstellung muss es möglich sein, ein Failover zu einer sekundären Region ausführen zu können.</span><span class="sxs-lookup"><span data-stu-id="42da4-245">For disaster recovery (DR), you must be able to fail over to a secondary region.</span></span> <span data-ttu-id="42da4-246">Für jede Ebene wird eine andere Strategie genutzt, um per Notfallwiederherstellung für den erforderlichen Schutz zu sorgen.</span><span class="sxs-lookup"><span data-stu-id="42da4-246">Each tier uses a different strategy to provide disaster recovery (DR) protection.</span></span>

- <span data-ttu-id="42da4-247">**Anwendungsserverschicht**.</span><span class="sxs-lookup"><span data-stu-id="42da4-247">**Application servers tier**.</span></span> <span data-ttu-id="42da4-248">SAP-Anwendungsserver enthalten keine Geschäftsdaten.</span><span class="sxs-lookup"><span data-stu-id="42da4-248">SAP application servers do not contain business data.</span></span> <span data-ttu-id="42da4-249">In Azure besteht eine einfache Strategie für die Notfallwiederherstellung darin, SAP-Anwendungsserver in der sekundären Region zu erstellen und die Server dann herunterzufahren.</span><span class="sxs-lookup"><span data-stu-id="42da4-249">On Azure, a simple DR strategy is to create SAP application servers in the secondary region, then shut them down.</span></span> <span data-ttu-id="42da4-250">Bei Konfigurationsänderungen oder Kernel-Updates auf dem primären Anwendungsserver müssen die gleichen Änderungen auf die virtuellen Computern in der sekundären Region kopiert werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-250">Upon any configuration changes or kernel updates on the primary application server, the same changes must be copied to the virtual machines in the secondary region.</span></span> <span data-ttu-id="42da4-251">Beispielsweise werden die ausführbaren Kerneldateien auf die virtuellen Computer für die Notfallwiederherstellung kopiert.</span><span class="sxs-lookup"><span data-stu-id="42da4-251">For example, the kernel executables copied to the DR virtual machines.</span></span> <span data-ttu-id="42da4-252">Sollen Anwendungsserver automatisch in einer sekundären Region repliziert werden, ist [Azure Site Recovery](/azure/site-recovery/site-recovery-overview) die empfohlene Lösung.</span><span class="sxs-lookup"><span data-stu-id="42da4-252">For automatic replication of application servers to a secondary region, [Azure Site Recovery](/azure/site-recovery/site-recovery-overview) is the recommended solution.</span></span>

- <span data-ttu-id="42da4-253">**Central Services**.</span><span class="sxs-lookup"><span data-stu-id="42da4-253">**Central Services**.</span></span> <span data-ttu-id="42da4-254">Auch bei dieser Komponente des SAP-Anwendungsstapels werden keine Geschäftsdaten beibehalten.</span><span class="sxs-lookup"><span data-stu-id="42da4-254">This component of the SAP application stack also does not persist business data.</span></span> <span data-ttu-id="42da4-255">Sie können einen virtuellen Computer in der Notfallwiederherstellungregion erstellen, um die Central Services-Rolle auszuführen.</span><span class="sxs-lookup"><span data-stu-id="42da4-255">You can build a VM in the disaster recovery region to run the Central Services role.</span></span> <span data-ttu-id="42da4-256">Der einzige Inhalt, der vom primären Central Services-Knoten synchronisiert wird, ist der Inhalt der Freigabe „/sapmnt“.</span><span class="sxs-lookup"><span data-stu-id="42da4-256">The only content from the primary Central Services node to synchronize is the /sapmnt share content.</span></span> <span data-ttu-id="42da4-257">Wenn Konfigurationsänderungen oder Kernel-Updates auf den primären Central Services-Servern stattfinden, müssen sie auf dem virtuellen Computer in der Notfallwiederherstellungsregion, auf dem Central Services ausgeführt wird, wiederholt werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-257">Also, if configuration changes or kernel updates take place on the primary Central Services servers, they must be repeated on the VM in the disaster recovery region running Central Services.</span></span> <span data-ttu-id="42da4-258">Um die beiden Server zu synchronisieren, können Sie entweder Azure Site Recovery verwenden, um die Clusterknoten zu replizieren, oder einfach einen regelmäßig geplanten Kopierauftrag verwenden, um „/sapmnt“ in die Notfallwiederherstellungsregion zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="42da4-258">To synchronize the two servers, you can use either Azure Site Recovery to replicate the cluster nodes or simply use a regularly scheduled copy job to copy /sapmnt to the disaster recovery region.</span></span> <span data-ttu-id="42da4-259">Ausführliche Informationen zum Erstellungs-, Kopier- und Testfailoverprozess für diese einfache Replikationsmethode erhalten Sie, indem Sie den Artikel [SAP NetWeaver: Building a Hyper-V and Microsoft Azure-based Disaster Recovery Solution](https://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx) (SAP NetWeaver: Erstellen einer Lösung für die Notfallwiederherstellung auf Basis von Hyper-V und Microsoft Azure) herunterladen und unter „4.3.</span><span class="sxs-lookup"><span data-stu-id="42da4-259">For details about this simple replication method's build, copy, and test failover process, download [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution](https://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx), and refer to "4.3.</span></span> <span data-ttu-id="42da4-260">SAP SPOF layer (ASCS)“ (4.3. SAP-SPOF-Schicht (ASCS)) nachsehen.</span><span class="sxs-lookup"><span data-stu-id="42da4-260">SAP SPOF layer (ASCS)."</span></span>

- <span data-ttu-id="42da4-261">**Datenbankschicht**.</span><span class="sxs-lookup"><span data-stu-id="42da4-261">**Database tier**.</span></span> <span data-ttu-id="42da4-262">Notfallwiederherstellung lässt sich am besten mit der in die Datenbank integrierten Replikationstechnologie implementieren.</span><span class="sxs-lookup"><span data-stu-id="42da4-262">DR is best implemented with the database's own integrated replication technology.</span></span> <span data-ttu-id="42da4-263">Im Fall von SQL Server empfiehlt sich beispielsweise die Verwendung einer AlwaysOn-Verfügbarkeitsgruppe, um ein Replikat in einer Remoteregion einzurichten, wozu Transaktionen asynchron mit manuellem Failover repliziert werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-263">In the case of SQL Server, for example, we recommend using AlwaysOn Availability Group to establish a replica in a remote region, replicating transactions asynchronously with manual failover.</span></span> <span data-ttu-id="42da4-264">Asynchrone Replikation vermeidet Auswirkungen auf die Leistung von interaktiven Workloads am primären Standort.</span><span class="sxs-lookup"><span data-stu-id="42da4-264">Asynchronous replication avoids an impact to the performance of interactive workloads at the primary site.</span></span> <span data-ttu-id="42da4-265">Manuelles Failover bietet für eine Person die Möglichkeit, die Notfallwiederherstellungsauswirkungen zu bewerten und zu entscheiden, ob ein Betrieb aus dem Notfallwiederherstellungsstandort gerechtfertigt ist.</span><span class="sxs-lookup"><span data-stu-id="42da4-265">Manual failover offers the opportunity for a person to evaluate the DR impact and decide if operating from the DR site is justified.</span></span>

<span data-ttu-id="42da4-266">Um Azure Site Recovery zu verwenden, automatisch einen vollständig replizierten Produktionsstandort Ihres Originals einzurichten, müssen Sie benutzerdefinierte [Bereitstellungsskripts](/azure/site-recovery/site-recovery-runbook-automation) ausführen.</span><span class="sxs-lookup"><span data-stu-id="42da4-266">To use Azure Site Recovery to automatically build out a fully replicated production site of your original, you must run customized [deployment scripts](/azure/site-recovery/site-recovery-runbook-automation).</span></span> <span data-ttu-id="42da4-267">Site Recovery stellt zunächst die virtuellen Computer in Verfügbarkeitsgruppen bereit, und führt dann Skripts aus, um Ressourcen, etwa Lastenausgleichsmodule, hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="42da4-267">Site Recovery first deploys the VMs in availability sets, then runs scripts to add resources such as load balancers.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="42da4-268">Überlegungen zur Verwaltbarkeit</span><span class="sxs-lookup"><span data-stu-id="42da4-268">Manageability considerations</span></span>

<span data-ttu-id="42da4-269">In Azure sind mehrere Funktionen für die [Überwachung und Diagnose](/azure/architecture/best-practices/monitoring) der Gesamtstruktur enthalten.</span><span class="sxs-lookup"><span data-stu-id="42da4-269">Azure provides several functions for [monitoring and diagnostics](/azure/architecture/best-practices/monitoring) of the overall infrastructure.</span></span> <span data-ttu-id="42da4-270">Außerdem wird die erweiterte Überwachung von virtuellen Azure-Computern von der Azure Operations Management Suite (OMS) durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="42da4-270">Also, enhanced monitoring of Azure virtual machines is handled by Azure Operations Management Suite (OMS).</span></span>

<span data-ttu-id="42da4-271">Um SAP-basierte Überwachung von Ressourcen sowie der Leistung von Diensten der SAP-Infrastruktur bereitzustellen, wird die [Azure-Erweiterung zur verbesserten Überwachung für SAP](/azure/virtual-machines/workloads/sap/deployment-guide#detailed-tasks-for-sap-software-deployment) verwendet.</span><span class="sxs-lookup"><span data-stu-id="42da4-271">To provide SAP-based monitoring of resources and service performance of the SAP infrastructure, the [Azure SAP Enhanced Monitoring](/azure/virtual-machines/workloads/sap/deployment-guide#detailed-tasks-for-sap-software-deployment) extension is used.</span></span> <span data-ttu-id="42da4-272">Mit dieser Erweiterung werden statistische Daten zur Azure-Überwachung in die SAP-Anwendung eingespeist, damit die Betriebssystemüberwachung und DBA Cockpit-Funktionen ermöglicht werden.</span><span class="sxs-lookup"><span data-stu-id="42da4-272">This extension feeds Azure monitoring statistics into the SAP application for operating system monitoring and DBA Cockpit functions.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="42da4-273">Sicherheitshinweise</span><span class="sxs-lookup"><span data-stu-id="42da4-273">Security considerations</span></span>

<span data-ttu-id="42da4-274">SAP verfügt über ein eigenes Modul für die Benutzerverwaltung (Users Management Engine, UME), um den rollenbasierten Zugriff und die Autorisierung in der SAP-Anwendung zu steuern.</span><span class="sxs-lookup"><span data-stu-id="42da4-274">SAP has its own Users Management Engine (UME) to control role-based access and authorization within the SAP application.</span></span> <span data-ttu-id="42da4-275">Ausführliche Informationen finden Sie im [SAP NetWeaver Application Server for ABAP Security Guide](https://help.sap.com/doc/7b932ef4728810148a4b1a83b0e91070/1610 001/en-US/frameset.htm?4dde53b3e9142e51e10000000a42189c.html) und im [SAP NetWeaver Application Server Java Security Guide](https://help.sap.com/doc/saphelp_snc_uiaddon_10/1.0/en-US/57/d8bfcf38f66f48b95ce1f52b3f5184/frameset.htm).</span><span class="sxs-lookup"><span data-stu-id="42da4-275">For details, see [SAP NetWeaver Application Server for ABAP Security Guide](https://help.sap.com/doc/7b932ef4728810148a4b1a83b0e91070/1610 001/en-US/frameset.htm?4dde53b3e9142e51e10000000a42189c.html) and [SAP NetWeaver Application Server Java Security Guide](https://help.sap.com/doc/saphelp_snc_uiaddon_10/1.0/en-US/57/d8bfcf38f66f48b95ce1f52b3f5184/frameset.htm).</span></span>

<span data-ttu-id="42da4-276">Um zusätzliche Netzwerksicherheit zu erreichen, können Sie eine [Netzwerk-DMZ](../dmz/secure-vnet-hybrid.md) implementieren, für die ein virtuelles Netzwerkgerät verwendet wird, um eine Firewall vor dem Subnetz für Web Dispatcher zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="42da4-276">For additional network security, consider implementing a [network DMZ](../dmz/secure-vnet-hybrid.md), which uses a network virtual appliance to create a firewall in front of the subnet for Web Dispatcher.</span></span>

<span data-ttu-id="42da4-277">Um die Sicherheit der Infrastruktur zu gewährleisten, sind die Daten während der Übertragung und im Ruhezustand verschlüsselt.</span><span class="sxs-lookup"><span data-stu-id="42da4-277">For infrastructure security, data is encrypted in transit and at rest.</span></span> <span data-ttu-id="42da4-278">Im Abschnitt „Sicherheitshinweise“ des Artikels [Azure Virtual Machines – Planung und Implementierung für SAP NetWeaver](/azure/virtual-machines/workloads/sap/planning-guide) geht es um die Netzwerksicherheit.</span><span class="sxs-lookup"><span data-stu-id="42da4-278">The "Security considerations” section of the [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide](/azure/virtual-machines/workloads/sap/planning-guide) begins to address network security.</span></span> <span data-ttu-id="42da4-279">In diesem Artikel sind auch die Netzwerkports angegeben, die Sie in den Firewalls öffnen müssen, um die Anwendungskommunikation zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="42da4-279">The guide also specifies the network ports you must open on the firewalls to allow application communication.</span></span>

<span data-ttu-id="42da4-280">Um Datenträger eines virtuellen Windows-Computers zu verschlüsseln, können Sie [Azure Disk Encryption](/azure/security/azure-security-disk-encryption) verwenden.</span><span class="sxs-lookup"><span data-stu-id="42da4-280">To encrypt Windows virtual machine disks, you can use [Azure Disk Encryption](/azure/security/azure-security-disk-encryption).</span></span> <span data-ttu-id="42da4-281">Dieser Dienst verwendet das BitLocker-Feature von Windows, um die Volumeverschlüsselung für die Betriebssystem- und die Daten-Datenträger bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="42da4-281">It uses the BitLocker feature of Windows to provide volume encryption for the operating system and the data disks.</span></span> <span data-ttu-id="42da4-282">Die Lösung funktioniert auch für Azure Key Vault, damit Sie die Verschlüsselungsschlüssel und Geheimnisse für die Datenträgerverschlüsselung in Ihrem Key Vault-Abonnement steuern und verwalten können.</span><span class="sxs-lookup"><span data-stu-id="42da4-282">The solution also works with Azure Key Vault to help you control and manage the disk-encryption keys and secrets in your key vault subscription.</span></span> <span data-ttu-id="42da4-283">Daten auf den VM-Datenträgern werden in Ihrem Azure-Speicher im ruhenden Zustand verschlüsselt.</span><span class="sxs-lookup"><span data-stu-id="42da4-283">Data on the virtual machine disks are encrypted at rest in your Azure storage.</span></span>

## <a name="communities"></a><span data-ttu-id="42da4-284">Communitys</span><span class="sxs-lookup"><span data-stu-id="42da4-284">Communities</span></span>

<span data-ttu-id="42da4-285">Communitys können Fragen beantworten und Sie beim Einrichten einer erfolgreichen Bereitstellung unterstützen.</span><span class="sxs-lookup"><span data-stu-id="42da4-285">Communities can answer questions and help you set up a successful deployment.</span></span> <span data-ttu-id="42da4-286">Beachten Sie Folgendes:</span><span class="sxs-lookup"><span data-stu-id="42da4-286">Consider the following:</span></span>

- [<span data-ttu-id="42da4-287">Running SAP Applications on the Microsoft Platform (Blog)</span><span class="sxs-lookup"><span data-stu-id="42da4-287">Running SAP Applications on the Microsoft Platform Blog</span></span>](https://blogs.msdn.microsoft.com/saponsqlserver/2017/05/04/sap-on-azure-general-update-for-customers-partners-april-2017/)
- [<span data-ttu-id="42da4-288">Azure-Communitysupport</span><span class="sxs-lookup"><span data-stu-id="42da4-288">Azure Community Support</span></span>](https://azure.microsoft.com/support/community/)
- [<span data-ttu-id="42da4-289">SAP Community</span><span class="sxs-lookup"><span data-stu-id="42da4-289">SAP Community</span></span>](https://www.sap.com/community.html)
- [<span data-ttu-id="42da4-290">Stapelüberlauf</span><span class="sxs-lookup"><span data-stu-id="42da4-290">Stack Overflow</span></span>](https://stackoverflow.com/tags/sap/)

[visio-download]: https://archcenter.blob.core.windows.net/cdn/sap-reference-architectures.vsdx
