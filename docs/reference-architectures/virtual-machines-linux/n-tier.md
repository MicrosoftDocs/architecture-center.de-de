---
title: Ausführen von Linux-VMs für eine n-schichtige Anwendung in Azure
description: Vorgehensweise zum Ausführen von Linux-VMs in einer n-schichtigen Architektur in Microsoft Azure
author: MikeWasson
ms.date: 11/22/2017
pnp.series.title: Linux VM workloads
pnp.series.next: multi-region-application
pnp.series.prev: multi-vm
ms.openlocfilehash: 8d3e6e5124a0abb27a3c72e1ecbd52a1a1da2a33
ms.sourcegitcommit: e67b751f230792bba917754d67789a20810dc76b
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
---
# <a name="run-linux-vms-for-an-n-tier-application"></a><span data-ttu-id="f5483-103">Ausführen von Linux-VMs für eine n-schichtige Anwendung</span><span class="sxs-lookup"><span data-stu-id="f5483-103">Run Linux VMs for an N-tier application</span></span>

<span data-ttu-id="f5483-104">Anhand dieser Referenzarchitektur werden einige bewährte Methoden für die Ausführung virtueller Linux-Computer (VMs) für eine n-schichtige Anwendung veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="f5483-104">This reference architecture shows a set of proven practices for running Linux virtual machines (VMs) for an N-tier application.</span></span> [<span data-ttu-id="f5483-105">**So stellen Sie diese Lösung bereit**.</span><span class="sxs-lookup"><span data-stu-id="f5483-105">**Deploy this solution**.</span></span>](#deploy-the-solution)  

<span data-ttu-id="f5483-106">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="f5483-106">![[0]][0]</span></span>

<span data-ttu-id="f5483-107">*Laden Sie eine [Visio-Datei][visio-download] mit dieser Architektur herunter.*</span><span class="sxs-lookup"><span data-stu-id="f5483-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="f5483-108">Architecture</span><span class="sxs-lookup"><span data-stu-id="f5483-108">Architecture</span></span>

<span data-ttu-id="f5483-109">Es gibt viele Möglichkeiten für die Implementierung einer n-schichtigen Architektur.</span><span class="sxs-lookup"><span data-stu-id="f5483-109">There are many ways to implement an N-tier architecture.</span></span> <span data-ttu-id="f5483-110">Das Diagramm zeigt eine typische 3-schichtige Webanwendung.</span><span class="sxs-lookup"><span data-stu-id="f5483-110">The diagram shows a typical 3-tier web application.</span></span> <span data-ttu-id="f5483-111">Diese Architektur baut auf den Informationen unter [Run load-balanced VMs for scalability and availability][multi-vm] (Ausführen von VMs mit Lastenausgleich zur Erzielung von Skalierbarkeit und Verfügbarkeit) auf.</span><span class="sxs-lookup"><span data-stu-id="f5483-111">This architecture builds on [Run load-balanced VMs for scalability and availability][multi-vm].</span></span> <span data-ttu-id="f5483-112">In der Internet- und Unternehmensschicht werden VMs mit Lastenausgleich verwendet.</span><span class="sxs-lookup"><span data-stu-id="f5483-112">The web and business tiers use load-balanced VMs.</span></span>

* <span data-ttu-id="f5483-113">**Verfügbarkeitsgruppen:**</span><span class="sxs-lookup"><span data-stu-id="f5483-113">**Availability sets.**</span></span> <span data-ttu-id="f5483-114">Erstellen Sie eine [Verfügbarkeitsgruppe][azure-availability-sets] für jede Schicht, und stellen Sie mindestens zwei VMs in jeder Schicht bereit.</span><span class="sxs-lookup"><span data-stu-id="f5483-114">Create an [availability set][azure-availability-sets] for each tier, and provision at least two VMs in each tier.</span></span>  <span data-ttu-id="f5483-115">Dies berechtigt die VMs zu einer höheren [Vereinbarung zum Servicelevel (SLA)][vm-sla] für VMs.</span><span class="sxs-lookup"><span data-stu-id="f5483-115">This makes the VMs eligible for a higher [service level agreement (SLA)][vm-sla] for VMs.</span></span> <span data-ttu-id="f5483-116">Sie können eine einzelne VM in einer Verfügbarkeitsgruppe bereitstellen, die einzelne VM ist jedoch nicht für eine SLA-Garantie qualifiziert, es sei denn, die VM verwendet Azure Premium Storage für alle Betriebssystem- und Datenfestplatten.</span><span class="sxs-lookup"><span data-stu-id="f5483-116">You can deploy a single VM in an availability set, but the single VM will not qualify for an SLA guarantee unless the single VM is using Azure Premium Storage for all OS and data disks.</span></span>  
* <span data-ttu-id="f5483-117">**Subnetze:**</span><span class="sxs-lookup"><span data-stu-id="f5483-117">**Subnets.**</span></span> <span data-ttu-id="f5483-118">Erstellen Sie für jede Schicht ein separates Subnetz.</span><span class="sxs-lookup"><span data-stu-id="f5483-118">Create a separate subnet for each tier.</span></span> <span data-ttu-id="f5483-119">Geben Sie mit der [CIDR]-Notation den Adressbereich und die Subnetzmaske an.</span><span class="sxs-lookup"><span data-stu-id="f5483-119">Specify the address range and subnet mask using [CIDR] notation.</span></span> 
* <span data-ttu-id="f5483-120">**Lastenausgleichsmodule:**</span><span class="sxs-lookup"><span data-stu-id="f5483-120">**Load balancers.**</span></span> <span data-ttu-id="f5483-121">Verwenden Sie ein [Lastenausgleichsmodul mit Internetzugriff][load-balancer-external], um eingehenden Internetdatenverkehr auf die Internetschicht zu verteilen, und ein [internes Lastenausgleichsmodul][load-balancer-internal], um den Netzwerkdatenverkehr von der Internetschicht auf die Unternehmensschicht zu verteilen.</span><span class="sxs-lookup"><span data-stu-id="f5483-121">Use an [Internet-facing load balancer][load-balancer-external] to distribute incoming Internet traffic to the web tier, and an [internal load balancer][load-balancer-internal] to distribute network traffic from the web tier to the business tier.</span></span>
* <span data-ttu-id="f5483-122">**Azure DNS:**</span><span class="sxs-lookup"><span data-stu-id="f5483-122">**Azure DNS**.</span></span> <span data-ttu-id="f5483-123">[Azure DNS][azure-dns] ist ein Hostingdienst für DNS-Domänen, der die Namensauflösung unter Verwendung der Microsoft Azure-Infrastruktur durchführt.</span><span class="sxs-lookup"><span data-stu-id="f5483-123">[Azure DNS][azure-dns] is a hosting service for DNS domains, providing name resolution using Microsoft Azure infrastructure.</span></span> <span data-ttu-id="f5483-124">Durch das Hosten Ihrer Domänen in Azure können Sie Ihre DNS-Einträge mithilfe der gleichen Anmeldeinformationen, APIs, Tools und Abrechnung wie für die anderen Azure-Dienste verwalten.</span><span class="sxs-lookup"><span data-stu-id="f5483-124">By hosting your domains in Azure, you can manage your DNS records using the same credentials, APIs, tools, and billing as your other Azure services.</span></span>
* <span data-ttu-id="f5483-125">**Jumpbox:**</span><span class="sxs-lookup"><span data-stu-id="f5483-125">**Jumpbox.**</span></span> <span data-ttu-id="f5483-126">Wird auch als [geschützter Host] bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="f5483-126">Also called a [bastion host].</span></span> <span data-ttu-id="f5483-127">Dies ist eine geschützte VM im Netzwerk, die von Administratoren zum Herstellen der Verbindung mit anderen VMs verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="f5483-127">A secure VM on the network that administrators use to connect to the other VMs.</span></span> <span data-ttu-id="f5483-128">Die Jumpbox verfügt über eine NSG, die Remotedatenverkehr nur von öffentlichen IP-Adressen zulässt, die in einer Liste mit sicheren Absendern aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="f5483-128">The jumpbox has an NSG that allows remote traffic only from public IP addresses on a safe list.</span></span> <span data-ttu-id="f5483-129">Die NSG sollte SSH-Datenverkehr (Secure Shell) zulassen.</span><span class="sxs-lookup"><span data-stu-id="f5483-129">The NSG should permit secure shell (SSH) traffic.</span></span>
* <span data-ttu-id="f5483-130">**Überwachung:**</span><span class="sxs-lookup"><span data-stu-id="f5483-130">**Monitoring.**</span></span> <span data-ttu-id="f5483-131">Mit Überwachungssoftware wie [Nagios], [Zabbix] oder [Icinga] können Informationen über die Antwortzeit, die VM-Betriebszeit und die allgemeine Integrität Ihres Systems bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="f5483-131">Monitoring software such as [Nagios], [Zabbix], or [Icinga] can give you insight into response time, VM uptime, and the overall health of your system.</span></span> <span data-ttu-id="f5483-132">Installieren Sie die Überwachungssoftware auf einer VM, die sich in einem separaten Verwaltungssubnetz befindet.</span><span class="sxs-lookup"><span data-stu-id="f5483-132">Install the monitoring software on a VM that's placed in a separate management subnet.</span></span>
* <span data-ttu-id="f5483-133"><strong>NSGs:</strong></span><span class="sxs-lookup"><span data-stu-id="f5483-133"><strong>NSGs.</strong></span></span> <span data-ttu-id="f5483-134">Verwenden Sie [Netzwerksicherheitsgruppen][nsg] (NSGs), um den Netzwerkdatenverkehr im VNET zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="f5483-134">Use [network security groups][nsg] (NSGs) to restrict network traffic within the VNet.</span></span> <span data-ttu-id="f5483-135">In der hier gezeigten 3-schichtigen Architektur akzeptiert die Datenbankschicht beispielsweise keinen Datenverkehr vom Web-Front-End, sondern nur von der Unternehmensschicht und dem Verwaltungssubnetz.</span><span class="sxs-lookup"><span data-stu-id="f5483-135">For example, in the 3-tier architecture shown here, the database tier does not accept traffic from the web front end, only from the business tier and the management subnet.</span></span>
* <span data-ttu-id="f5483-136">**Apache Cassandra-Datenbank**:</span><span class="sxs-lookup"><span data-stu-id="f5483-136">**Apache Cassandra database**.</span></span> <span data-ttu-id="f5483-137">Stellt Hochverfügbarkeit in der Datenschicht durch Replikation und Failover bereit.</span><span class="sxs-lookup"><span data-stu-id="f5483-137">Provides high availability at the data tier, by enabling replication and failover.</span></span>

## <a name="recommendations"></a><span data-ttu-id="f5483-138">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="f5483-138">Recommendations</span></span>

<span data-ttu-id="f5483-139">Ihre Anforderungen können von der hier beschriebenen Architektur abweichen.</span><span class="sxs-lookup"><span data-stu-id="f5483-139">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="f5483-140">Verwenden Sie diese Empfehlungen als Startpunkt.</span><span class="sxs-lookup"><span data-stu-id="f5483-140">Use these recommendations as a starting point.</span></span> 

### <a name="vnet--subnets"></a><span data-ttu-id="f5483-141">VNET/Subnetze</span><span class="sxs-lookup"><span data-stu-id="f5483-141">VNet / Subnets</span></span>

<span data-ttu-id="f5483-142">Legen Sie bei der Erstellung des VNET fest, wie viele IP-Adressen Ihre Ressourcen in jedem Subnetz benötigen.</span><span class="sxs-lookup"><span data-stu-id="f5483-142">When you create the VNet, determine how many IP addresses your resources in each subnet require.</span></span> <span data-ttu-id="f5483-143">Geben Sie mithilfe der [CIDR-Notation] eine Subnetzmaske und einen VNET-Adressbereich an, der für die erforderlichen IP-Adressen groß genug ist.</span><span class="sxs-lookup"><span data-stu-id="f5483-143">Specify a subnet mask and a VNet address range large enough for the required IP addresses using [CIDR] notation.</span></span> <span data-ttu-id="f5483-144">Verwenden Sie einen Adressraum, der in die standardmäßigen [privaten IP-Adressblöcke][private-ip-space] 10.0.0.0/8, 172.16.0.0/12 und 192.168.0.0/16 fällt.</span><span class="sxs-lookup"><span data-stu-id="f5483-144">Use an address space that falls within the standard [private IP address blocks][private-ip-space], which are 10.0.0.0/8, 172.16.0.0/12, and 192.168.0.0/16.</span></span>

<span data-ttu-id="f5483-145">Wählen Sie einen Adressbereich, der sich nicht mit Ihrem lokalen Netzwerk überschneidet, für den Fall, dass Sie später ein Gateway zwischen dem VNET und dem lokalen Netzwerk einrichten müssen.</span><span class="sxs-lookup"><span data-stu-id="f5483-145">Choose an address range that does not overlap with your on-premises network, in case you need to set up a gateway between the VNet and your on-premises network later.</span></span> <span data-ttu-id="f5483-146">Sobald Sie das VNET erstellt haben, können Sie den Adressbereich nicht mehr ändern.</span><span class="sxs-lookup"><span data-stu-id="f5483-146">Once you create the VNet, you can't change the address range.</span></span>

<span data-ttu-id="f5483-147">Entwerfen Sie Subnetze unter Berücksichtigung der Funktionalität und Sicherheitsanforderungen.</span><span class="sxs-lookup"><span data-stu-id="f5483-147">Design subnets with functionality and security requirements in mind.</span></span> <span data-ttu-id="f5483-148">Alle VMs innerhalb derselben Schicht oder Rolle sollten im selben Subnetz platziert werden, was eine Sicherheitsbegrenzung darstellen kann.</span><span class="sxs-lookup"><span data-stu-id="f5483-148">All VMs within the same tier or role should go into the same subnet, which can be a security boundary.</span></span> <span data-ttu-id="f5483-149">Weitere Informationen zum Entwerfen von VNETs und Subnetzen finden Sie unter [Planen und Entwerfen von Azure Virtual Networks][plan-network].</span><span class="sxs-lookup"><span data-stu-id="f5483-149">For more information about designing VNets and subnets, see [Plan and design Azure Virtual Networks][plan-network].</span></span>

<span data-ttu-id="f5483-150">Geben Sie für jedes Subnetz den Adressraum für das Subnetz in CIDR-Notation an.</span><span class="sxs-lookup"><span data-stu-id="f5483-150">For each subnet, specify the address space for the subnet in CIDR notation.</span></span> <span data-ttu-id="f5483-151">Mit „10.0.0.0/24“ wird beispielsweise ein Bereich von 256 IP-Adressen erstellt.</span><span class="sxs-lookup"><span data-stu-id="f5483-151">For example, '10.0.0.0/24' creates a range of 256 IP addresses.</span></span> <span data-ttu-id="f5483-152">Von diesen sind 251 für VMs nutzbar; die restlichen fünf sind reserviert.</span><span class="sxs-lookup"><span data-stu-id="f5483-152">VMs can use 251 of these; five are reserved.</span></span> <span data-ttu-id="f5483-153">Achten Sie darauf, dass sich die Adressbereiche nicht mit anderen Subnetzen überlappen.</span><span class="sxs-lookup"><span data-stu-id="f5483-153">Make sure the address ranges don't overlap across subnets.</span></span> <span data-ttu-id="f5483-154">Weitere Informationen finden Sie unter [Azure Virtual Network – häufig gestellte Fragen][vnet faq].</span><span class="sxs-lookup"><span data-stu-id="f5483-154">See the [Virtual Network FAQ][vnet faq].</span></span>

### <a name="network-security-groups"></a><span data-ttu-id="f5483-155">Netzwerksicherheitsgruppen</span><span class="sxs-lookup"><span data-stu-id="f5483-155">Network security groups</span></span>

<span data-ttu-id="f5483-156">Verwenden Sie NSG-Regeln, um den Datenverkehr zwischen den Schichten zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="f5483-156">Use NSG rules to restrict traffic between tiers.</span></span> <span data-ttu-id="f5483-157">In der oben gezeigten 3-schichtigen Architektur kommuniziert die Internetschicht beispielsweise nicht direkt mit der Datenbankschicht.</span><span class="sxs-lookup"><span data-stu-id="f5483-157">For example, in the 3-tier architecture shown above, the web tier does not communicate directly with the database tier.</span></span> <span data-ttu-id="f5483-158">Um dies zu erzwingen, sollte die Datenbankschicht eingehenden Datenverkehr aus dem Subnetz der Internetschicht blockieren.</span><span class="sxs-lookup"><span data-stu-id="f5483-158">To enforce this, the database tier should block incoming traffic from the web tier subnet.</span></span>  

1. <span data-ttu-id="f5483-159">Erstellen Sie eine NSG, und ordnen Sie diese dem Subnetz der Datenbankschicht zu.</span><span class="sxs-lookup"><span data-stu-id="f5483-159">Create an NSG and associate it to the database tier subnet.</span></span>
2. <span data-ttu-id="f5483-160">Fügen Sie eine Regel hinzu, die den gesamten eingehenden Datenverkehr vom VNET ablehnt.</span><span class="sxs-lookup"><span data-stu-id="f5483-160">Add a rule that denies all inbound traffic from the VNet.</span></span> <span data-ttu-id="f5483-161">(Verwenden Sie den `VIRTUAL_NETWORK`-Tag in der Regel.)</span><span class="sxs-lookup"><span data-stu-id="f5483-161">(Use the `VIRTUAL_NETWORK` tag in the rule.)</span></span> 
3. <span data-ttu-id="f5483-162">Fügen Sie eine Regel mit einer höheren Priorität hinzu, die eingehenden Datenverkehr aus dem Subnetz der Unternehmensschicht zulässt.</span><span class="sxs-lookup"><span data-stu-id="f5483-162">Add a rule with a higher priority that allows inbound traffic from the business tier subnet.</span></span> <span data-ttu-id="f5483-163">Diese Regel überschreibt die vorherige Regel und ermöglicht die Kommunikation zwischen der Unternehmens- und Datenbankschicht.</span><span class="sxs-lookup"><span data-stu-id="f5483-163">This rule overrides the previous rule, and allows the business tier to talk to the database tier.</span></span>
4. <span data-ttu-id="f5483-164">Fügen Sie eine Regel hinzu, die eingehenden Datenverkehr innerhalb des Subnetzes der Datenbankschicht selbst zulässt.</span><span class="sxs-lookup"><span data-stu-id="f5483-164">Add a rule that allows inbound traffic from within the database tier subnet itself.</span></span> <span data-ttu-id="f5483-165">Diese Regel ermöglicht die Kommunikation zwischen VMs in der Datenbankschicht, die für die Replikation und das Failover der Datenbank erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="f5483-165">This rule allows communication between VMs in the database tier, which is needed for database replication and failover.</span></span>
5. <span data-ttu-id="f5483-166">Fügen Sie eine Regel hinzu, die SSH-Datenverkehr vom Subnetz der Jumpbox zulässt.</span><span class="sxs-lookup"><span data-stu-id="f5483-166">Add a rule that allows SSH traffic from the jumpbox subnet.</span></span> <span data-ttu-id="f5483-167">Diese Regel erlaubt Administratoren, über die Jumpbox eine Verbindung mit der Datenbankschicht herzustellen.</span><span class="sxs-lookup"><span data-stu-id="f5483-167">This rule lets administrators connect to the database tier from the jumpbox.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="f5483-168">Eine NSG ist mit [Standardregeln][nsg-rules] versehen, die sämtlichen eingehenden Datenverkehr im VNET zulassen.</span><span class="sxs-lookup"><span data-stu-id="f5483-168">An NSG has [default rules][nsg-rules] that allow any inbound traffic from within the VNet.</span></span> <span data-ttu-id="f5483-169">Diese Regeln können nicht gelöscht, aber durch die Erstellung von Regeln mit höherer Priorität überschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="f5483-169">These rules can't be deleted, but you can override them by creating higher-priority rules.</span></span>
   > 
   > 

### <a name="load-balancers"></a><span data-ttu-id="f5483-170">Load Balancer</span><span class="sxs-lookup"><span data-stu-id="f5483-170">Load balancers</span></span>

<span data-ttu-id="f5483-171">Das externe Lastenausgleichsmodul verteilt den Internetdatenverkehr auf die Internetschicht.</span><span class="sxs-lookup"><span data-stu-id="f5483-171">The external load balancer distributes Internet traffic to the web tier.</span></span> <span data-ttu-id="f5483-172">Erstellen Sie eine öffentliche IP-Adresse für dieses Lastenausgleichsmodul.</span><span class="sxs-lookup"><span data-stu-id="f5483-172">Create a public IP address for this load balancer.</span></span> <span data-ttu-id="f5483-173">Weitere Informationen finden Sie unter [Erstellen eines Load Balancers mit Internetzugriff im Azure-Portal][lb-external-create].</span><span class="sxs-lookup"><span data-stu-id="f5483-173">See [Creating an Internet-facing load balancer][lb-external-create].</span></span>

<span data-ttu-id="f5483-174">Das interne Lastenausgleichsmodul verteilt den Netzwerkdatenverkehr von der Internetschicht auf die Unternehmensschicht.</span><span class="sxs-lookup"><span data-stu-id="f5483-174">The internal load balancer distributes network traffic from the web tier to the business tier.</span></span> <span data-ttu-id="f5483-175">Um diesem Lastenausgleichsmodul eine private IP-Adresse zuzuweisen, erstellen Sie eine Front-End-IP-Konfiguration, und ordnen Sie diese dem Subnetz für die Unternehmensschicht zu.</span><span class="sxs-lookup"><span data-stu-id="f5483-175">To give this load balancer a private IP address, create a frontend IP configuration and associate it with the subnet for the business tier.</span></span> <span data-ttu-id="f5483-176">Weitere Informationen finden Sie unter [Erstellen eines internen Lastenausgleichs über das Azure-Portal][lb-internal-create].</span><span class="sxs-lookup"><span data-stu-id="f5483-176">See [Get started creating an Internal load balancer][lb-internal-create].</span></span>

### <a name="cassandra"></a><span data-ttu-id="f5483-177">Cassandra</span><span class="sxs-lookup"><span data-stu-id="f5483-177">Cassandra</span></span>

<span data-ttu-id="f5483-178">Für die Produktion wird [DataStax Enterprise][datastax] empfohlen, wobei diese Empfehlungen für alle Cassandra-Editionen gelten.</span><span class="sxs-lookup"><span data-stu-id="f5483-178">We recommend [DataStax Enterprise][datastax] for production use, but these recommendations apply to any Cassandra edition.</span></span> <span data-ttu-id="f5483-179">Weitere Informationen zur Ausführung von DataStax in Azure finden Sie im [DataStax Enterprise-Bereitstellungshandbuch für Azure][cassandra-in-azure].</span><span class="sxs-lookup"><span data-stu-id="f5483-179">For more information on running DataStax in Azure, see [DataStax Enterprise Deployment Guide for Azure][cassandra-in-azure].</span></span> 

<span data-ttu-id="f5483-180">Fassen Sie die VMs für einen Cassandra-Cluster in einer Verfügbarkeitsgruppe zusammen, um sicherzustellen, dass die Cassandra-Replikate auf verschiedene Fehler- und Upgradedomänen verteilt werden.</span><span class="sxs-lookup"><span data-stu-id="f5483-180">Put the VMs for a Cassandra cluster in an availability set to ensure that the Cassandra replicas are distributed across multiple fault domains and upgrade domains.</span></span> <span data-ttu-id="f5483-181">Weitere Informationen zu Fehler- und Upgradedomänen finden Sie unter [Verwalten der Verfügbarkeit virtueller Computer][azure-availability-sets].</span><span class="sxs-lookup"><span data-stu-id="f5483-181">For more information about fault domains and upgrade domains, see [Manage the availability of virtual machines][azure-availability-sets].</span></span> 

<span data-ttu-id="f5483-182">Konfigurieren Sie jeweils drei Fehlerdomänen (Maximalwert) und 18 Upgradedomänen pro Verfügbarkeitsgruppe.</span><span class="sxs-lookup"><span data-stu-id="f5483-182">Configure three fault domains (the maximum) per availability set and 18 upgrade domains per availability set.</span></span> <span data-ttu-id="f5483-183">Dadurch wird die maximale Anzahl von Upgradedomänen erreicht, die nach wie vor gleichmäßig auf die Fehlerdomänen verteilt werden können.</span><span class="sxs-lookup"><span data-stu-id="f5483-183">This provides the maximum number of upgrade domains that can still be distributed evenly across the fault domains.</span></span>   

<span data-ttu-id="f5483-184">Konfigurieren Sie Knoten im rackfähigen Modus.</span><span class="sxs-lookup"><span data-stu-id="f5483-184">Configure nodes in rack-aware mode.</span></span> <span data-ttu-id="f5483-185">Ordnen Sie Fehlerdomänen den Racks in der Datei `cassandra-rackdc.properties` zu.</span><span class="sxs-lookup"><span data-stu-id="f5483-185">Map fault domains to racks in the `cassandra-rackdc.properties` file.</span></span>

<span data-ttu-id="f5483-186">Es ist kein vor dem Cluster geschaltetes Lastenausgleichsmodul erforderlich.</span><span class="sxs-lookup"><span data-stu-id="f5483-186">You don't need a load balancer in front of the cluster.</span></span> <span data-ttu-id="f5483-187">Der Client stellt eine direkte Verbindung mit einem Knoten im Cluster her.</span><span class="sxs-lookup"><span data-stu-id="f5483-187">The client connects directly to a node in the cluster.</span></span>

### <a name="jumpbox"></a><span data-ttu-id="f5483-188">Jumpbox</span><span class="sxs-lookup"><span data-stu-id="f5483-188">Jumpbox</span></span>

<span data-ttu-id="f5483-189">Die Jumpbox setzt minimale Leistungsanforderungen voraus. Wählen Sie daher eine kleine VM-Größe für die Jumpbox wie „Standard A1“.</span><span class="sxs-lookup"><span data-stu-id="f5483-189">The jumpbox will have minimal performance requirements, so select a small VM size for the jumpbox such as Standard A1.</span></span> 

<span data-ttu-id="f5483-190">Erstellen Sie eine [öffentliche IP-Adresse] für die Jumpbox.</span><span class="sxs-lookup"><span data-stu-id="f5483-190">Create a [public IP address] for the jumpbox.</span></span> <span data-ttu-id="f5483-191">Platzieren Sie die Jumpbox in dasselbe VNET wie die anderen VMs, jedoch in ein separates Verwaltungssubnetz.</span><span class="sxs-lookup"><span data-stu-id="f5483-191">Place the jumpbox in the same VNet as the other VMs, but in a separate management subnet.</span></span>

<span data-ttu-id="f5483-192">Verweigern Sie den SSH-Zugriff über das öffentliche Internet auf die VMs, auf denen die Anwendungsworkload ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="f5483-192">Do not allow SSH access from the public Internet to the VMs that run the application workload.</span></span> <span data-ttu-id="f5483-193">Der gesamte SSH-Zugriff auf diese VMs muss stattdessen über die Jumpbox erfolgen.</span><span class="sxs-lookup"><span data-stu-id="f5483-193">Instead, all SSH access to these VMs must come through the jumpbox.</span></span> <span data-ttu-id="f5483-194">Ein Administrator meldet sich bei der Jumpbox und von der Jumpbox aus dann bei der anderen VM an.</span><span class="sxs-lookup"><span data-stu-id="f5483-194">An administrator logs into the jumpbox, and then logs into the other VM from the jumpbox.</span></span> <span data-ttu-id="f5483-195">Die Jumpbox lässt SSH-Datenverkehr aus dem Internet zu, jedoch nur von bekannten, sicheren IP-Adressen.</span><span class="sxs-lookup"><span data-stu-id="f5483-195">The jumpbox allows SSH traffic from the Internet, but only from known, safe IP addresses.</span></span>

<span data-ttu-id="f5483-196">Erstellen Sie zum Schutz der Jumpbox eine NSG, und wenden Sie diese auf das Subnetz der Jumpbox an.</span><span class="sxs-lookup"><span data-stu-id="f5483-196">To secure the jumpbox, create an NSG and apply it to the jumpbox subnet.</span></span> <span data-ttu-id="f5483-197">Fügen Sie eine NSG-Regel hinzu, die ausschließlich SSH-Verbindungen von einer sicheren Gruppe öffentlicher IP-Adressen zulässt.</span><span class="sxs-lookup"><span data-stu-id="f5483-197">Add an NSG rule that allows SSH connections only from a safe set of public IP addresses.</span></span> <span data-ttu-id="f5483-198">Die NSG kann entweder dem Subnetz oder der Jumpbox-NIC hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="f5483-198">The NSG can be attached either to the subnet or to the jumpbox NIC.</span></span> <span data-ttu-id="f5483-199">In diesem Fall empfehlen wir, diese der NIC hinzuzufügen, sodass SSH-Datenverkehr nur an die Jumpbox erlaubt ist, auch wenn Sie andere VMs zum selben Subnetz hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="f5483-199">In this case, we recommend attaching it to the NIC, so SSH traffic is permitted only to the jumpbox, even if you add other VMs to the same subnet.</span></span>

<span data-ttu-id="f5483-200">Konfigurieren Sie die NSGs für die anderen Subnetze, um SSH-Datenverkehr aus dem Verwaltungssubnetz zuzulassen.</span><span class="sxs-lookup"><span data-stu-id="f5483-200">Configure the NSGs for the other subnets to allow SSH traffic from the management subnet.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="f5483-201">Überlegungen zur Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="f5483-201">Availability considerations</span></span>

<span data-ttu-id="f5483-202">Platzieren Sie jede Schicht oder VM-Rolle in eine separate Verfügbarkeitsgruppe.</span><span class="sxs-lookup"><span data-stu-id="f5483-202">Put each tier or VM role into a separate availability set.</span></span> 

<span data-ttu-id="f5483-203">Durch das Vorhandensein mehrerer VMs in der Datenbankschicht wird nicht automatisch eine hochverfügbare Datenbank erstellt.</span><span class="sxs-lookup"><span data-stu-id="f5483-203">At the database tier, having multiple VMs does not automatically translate into a highly available database.</span></span> <span data-ttu-id="f5483-204">Bei einer relationalen Datenbank müssen Sie in der Regel Replikation und Failover einsetzen, um Hochverfügbarkeit zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="f5483-204">For a relational database, you will typically need to use replication and failover to achieve high availability.</span></span>  

<span data-ttu-id="f5483-205">Wenn Sie eine höhere Verfügbarkeit benötigen, als die [Azure-SLA für VMs][vm-sla] bietet, replizieren Sie die Anwendung über zwei Regionen, und verwenden Sie für das Failover den Azure Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="f5483-205">If you need higher availability than the [Azure SLA for VMs][vm-sla] provides, replicate the application across two regions and use Azure Traffic Manager for failover.</span></span> <span data-ttu-id="f5483-206">Weitere Informationen finden Sie unter [Ausführen von Linux-VMs in mehreren Regionen für Hochverfügbarkeit][multi-dc].</span><span class="sxs-lookup"><span data-stu-id="f5483-206">For more information, see [Run Linux VMs in multiple regions for high availability][multi-dc].</span></span>  

## <a name="security-considerations"></a><span data-ttu-id="f5483-207">Sicherheitshinweise</span><span class="sxs-lookup"><span data-stu-id="f5483-207">Security considerations</span></span>

<span data-ttu-id="f5483-208">Für die Erstellung einer DMZ zwischen dem öffentlichen Internet und dem virtuellen Azure-Netzwerk sollten Sie eventuell eine virtuelle Netzwerkappliance (Network Virtual Appliance, NVA) hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="f5483-208">Consider adding a network virtual appliance (NVA) to create a DMZ between the public Internet and the Azure virtual network.</span></span> <span data-ttu-id="f5483-209">NVA ist ein Oberbegriff für eine virtuelle Appliance, die netzwerkbezogene Aufgaben wie Erstellung von Firewalls, Paketüberprüfung, Überwachung und benutzerdefiniertes Routing ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="f5483-209">NVA is a generic term for a virtual appliance that can perform network-related tasks such as firewall, packet inspection, auditing, and custom routing.</span></span> <span data-ttu-id="f5483-210">Weitere Informationen finden Sie unter [Implementieren einer DMZ zwischen Azure und dem Internet][dmz].</span><span class="sxs-lookup"><span data-stu-id="f5483-210">For more information, see [Implementing a DMZ between Azure and the Internet][dmz].</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="f5483-211">Überlegungen zur Skalierbarkeit</span><span class="sxs-lookup"><span data-stu-id="f5483-211">Scalability considerations</span></span>

<span data-ttu-id="f5483-212">Die Lastenausgleichsmodule verteilen den Netzwerkdatenverkehr auf die Internet- und Unternehmensschicht.</span><span class="sxs-lookup"><span data-stu-id="f5483-212">The load balancers distribute network traffic to the web and business tiers.</span></span> <span data-ttu-id="f5483-213">Führen Sie eine horizontale Skalierung durch, indem Sie neue VM-Instanzen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="f5483-213">Scale horizontally by adding new VM instances.</span></span> <span data-ttu-id="f5483-214">Beachten Sie, dass die Internet- und Unternehmensschicht je nach Auslastung unabhängig voneinander skaliert werden können.</span><span class="sxs-lookup"><span data-stu-id="f5483-214">Note that you can scale the web and business tiers independently, based on load.</span></span> <span data-ttu-id="f5483-215">Um das Risiko von Komplikationen zu reduzieren, die durch die Notwendigkeit zur Aufrechterhaltung der Clientaffinität verursacht werden, sollten die VMs in der Internetschicht zustandslos sein.</span><span class="sxs-lookup"><span data-stu-id="f5483-215">To reduce possible complications caused by the need to maintain client affinity, the VMs in the web tier should be stateless.</span></span> <span data-ttu-id="f5483-216">Die VMs, die die Geschäftslogik hosten, sollten ebenfalls zustandslos sein.</span><span class="sxs-lookup"><span data-stu-id="f5483-216">The VMs hosting the business logic should also be stateless.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="f5483-217">Überlegungen zur Verwaltbarkeit</span><span class="sxs-lookup"><span data-stu-id="f5483-217">Manageability considerations</span></span>

<span data-ttu-id="f5483-218">Vereinfachen Sie die Verwaltung des gesamten Systems durch den Einsatz von zentralisierten Verwaltungstools wie [Azure Automation][azure-administration], [Microsoft Operations Management Suite][operations-management-suite], [Chef][chef] oder [Puppet][puppet].</span><span class="sxs-lookup"><span data-stu-id="f5483-218">Simplify management of the entire system by using centralized administration tools such as [Azure Automation][azure-administration], [Microsoft Operations Management Suite][operations-management-suite], [Chef][chef], or [Puppet][puppet].</span></span> <span data-ttu-id="f5483-219">Diese Tools können Diagnose- und Integritätsinformationen konsolidieren, die von mehreren VMs erfasst wurden, um einen allgemeinen Überblick über das System bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="f5483-219">These tools can consolidate diagnostic and health information captured from multiple VMs to provide an overall view of the system.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="f5483-220">Bereitstellen der Lösung</span><span class="sxs-lookup"><span data-stu-id="f5483-220">Deploy the solution</span></span>

<span data-ttu-id="f5483-221">Eine Bereitstellung für diese Referenzarchitektur ist auf [GitHub][github-folder] verfügbar.</span><span class="sxs-lookup"><span data-stu-id="f5483-221">A deployment for this reference architecture is available on [GitHub][github-folder].</span></span> 

### <a name="prerequisites"></a><span data-ttu-id="f5483-222">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="f5483-222">Prerequisites</span></span>

<span data-ttu-id="f5483-223">Bevor Sie die Referenzarchitektur in Ihrem eigenen Abonnement bereitstellen können, müssen Sie die folgenden Schritte ausführen.</span><span class="sxs-lookup"><span data-stu-id="f5483-223">Before you can deploy the reference architecture to your own subscription, you must perform the following steps.</span></span>

1. <span data-ttu-id="f5483-224">Klonen oder Forken Sie das GitHub-Repository [Referenzarchitekturen][ref-arch-repo], oder laden Sie die entsprechende ZIP-Datei herunter.</span><span class="sxs-lookup"><span data-stu-id="f5483-224">Clone, fork, or download the zip file for the [reference architectures][ref-arch-repo] GitHub repository.</span></span>

2. <span data-ttu-id="f5483-225">Vergewissern Sie sich, dass Azure CLI 2.0 auf Ihrem Computer installiert ist.</span><span class="sxs-lookup"><span data-stu-id="f5483-225">Make sure you have the Azure CLI 2.0 installed on your computer.</span></span> <span data-ttu-id="f5483-226">Um die Befehlszeilenschnittstelle zu installieren, befolgen Sie die Anweisungen unter [Installieren von Azure CLI 2.0][azure-cli-2].</span><span class="sxs-lookup"><span data-stu-id="f5483-226">To install the CLI, follow the instructions in [Install Azure CLI 2.0][azure-cli-2].</span></span>

3. <span data-ttu-id="f5483-227">Installieren Sie das npm-Paket mit den [Azure Bausteinen][azbb].</span><span class="sxs-lookup"><span data-stu-id="f5483-227">Install the [Azure building blocks][azbb] npm package.</span></span>

   ```bash
   npm install -g @mspnp/azure-building-blocks
   ```

4. <span data-ttu-id="f5483-228">Melden Sie sich über eine Eingabeaufforderung, eine bash-Eingabeaufforderung oder die PowerShell-Eingabeaufforderung bei Ihrem Azure-Konto an. Verwenden Sie dazu die unten aufgeführten Befehle, und befolgen Sie die Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="f5483-228">From a command prompt, bash prompt, or PowerShell prompt, login to your Azure account by using one of the commands below, and follow the prompts.</span></span>

   ```bash
   az login
   ```

### <a name="deploy-the-solution-using-azbb"></a><span data-ttu-id="f5483-229">Bereitstellen der Lösung mit azbb</span><span class="sxs-lookup"><span data-stu-id="f5483-229">Deploy the solution using azbb</span></span>

<span data-ttu-id="f5483-230">Um die Linux VMs für eine n-schichtige Anwendungsreferenzarchitektur bereitzustellen, führen Sie die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="f5483-230">To deploy the Linux VMs for an N-tier application reference architecture, follow these steps:</span></span>

1. <span data-ttu-id="f5483-231">Navigieren Sie zum `virtual-machines\n-tier-linux`-Ordner für das Repository, das Sie oben in Schritt 1 der Voraussetzungen als Klon erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="f5483-231">Navigate to the `virtual-machines\n-tier-linux` folder for the repository you cloned in step 1 of the pre-requisites above.</span></span>

2. <span data-ttu-id="f5483-232">Die Parameterdatei gibt einen Standard-Administratorbenutzernamen und ein Standardkennwort für jede VM in der Bereitstellung an.</span><span class="sxs-lookup"><span data-stu-id="f5483-232">The parameter file specifies a default adminstrator user name and password for each VM in the deployment.</span></span> <span data-ttu-id="f5483-233">Sie müssen diese vor der Bereitstellung der Referenzarchitektur ändern.</span><span class="sxs-lookup"><span data-stu-id="f5483-233">You must change these before you deploy the reference architecture.</span></span> <span data-ttu-id="f5483-234">Öffnen Sie die `n-tier-linux.json`-Datei, und ersetzen Sie jedes Feld **adminUsername** und **adminPassword** durch neue Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="f5483-234">Open the `n-tier-linux.json` file and replace each **adminUsername** and **adminPassword** field with your new settings.</span></span>   <span data-ttu-id="f5483-235">Speichern Sie die Datei .</span><span class="sxs-lookup"><span data-stu-id="f5483-235">Save the file.</span></span>

3. <span data-ttu-id="f5483-236">Stellen Sie die Referenzarchitektur mithilfe des Befehlszeilentools **azbb** bereit, wie unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="f5483-236">Deploy the reference architecture using the **azbb** command line tool as shown below.</span></span>

   ```bash
   azbb -s <your subscription_id> -g <your resource_group_name> -l <azure region> -p n-tier-linux.json --deploy
   ```

<span data-ttu-id="f5483-237">Weitere Informationen zum Bereitstellen dieser Beispielreferenzarchitektur mithilfe von Azure-Bausteinen finden Sie im [GitHub-Repository][git].</span><span class="sxs-lookup"><span data-stu-id="f5483-237">For more information on deploying this sample reference architecture using Azure Building Blocks, visit the [GitHub repository][git].</span></span>

<!-- links -->
[multi-dc]: multi-region-application.md
[dmz]: ../dmz/secure-vnet-dmz.md
[multi-vm]: ./multi-vm.md
[naming conventions]: /azure/guidance/guidance-naming-conventions
[azbb]: https://github.com/mspnp/template-building-blocks/wiki/Install-Azure-Building-Blocks
[azure-administration]: /azure/automation/automation-intro
[azure-availability-sets]: /azure/virtual-machines/virtual-machines-linux-manage-availability
[azure-cli-2]: https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest
[azure-dns]: /azure/dns/dns-overview
[geschützter Host]: https://en.wikipedia.org/wiki/Bastion_host
[bastion host]: https://en.wikipedia.org/wiki/Bastion_host
[cassandra-in-azure]: https://docs.datastax.com/en/datastax_enterprise/4.5/datastax_enterprise/install/installAzure.html
[CIDR]: https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing
[cidr]: https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing
[chef]: https://www.chef.io/solutions/azure/
[datastax]: http://www.datastax.com/products/datastax-enterprise
[git]: https://github.com/mspnp/template-building-blocks
[github-folder]: https://github.com/mspnp/reference-architectures/tree/master/virtual-machines/n-tier-linux
[lb-external-create]: /azure/load-balancer/load-balancer-get-started-internet-portal
[lb-internal-create]: /azure/load-balancer/load-balancer-get-started-ilb-arm-portal
[load-balancer-external]: /azure/load-balancer/load-balancer-internet-overview
[load-balancer-internal]: /azure/load-balancer/load-balancer-internal-overview
[nsg]: /azure/virtual-network/virtual-networks-nsg
[nsg-rules]: /azure/azure-resource-manager/best-practices-resource-manager-security#network-security-groups
[operations-management-suite]: https://www.microsoft.com/server-cloud/operations-management-suite/overview.aspx
[plan-network]: /azure/virtual-network/virtual-network-vnet-plan-design-arm
[private-ip-space]: https://en.wikipedia.org/wiki/Private_network#Private_IPv4_address_spaces
[öffentliche IP-Adresse]: /azure/virtual-network/virtual-network-ip-addresses-overview-arm
[public IP address]: /azure/virtual-network/virtual-network-ip-addresses-overview-arm
[puppet]: https://puppetlabs.com/blog/managing-azure-virtual-machines-puppet
[ref-arch-repo]: https://github.com/mspnp/reference-architectures
[vm-sla]: https://azure.microsoft.com/support/legal/sla/virtual-machines
[vnet faq]: /azure/virtual-network/virtual-networks-faq
[visio-download]: https://archcenter.blob.core.windows.net/cdn/vm-reference-architectures.vsdx
[Nagios]: https://www.nagios.org/
[Zabbix]: http://www.zabbix.com/
[Icinga]: http://www.icinga.org/
[0]: ./images/n-tier-diagram.png "n-schichtige Architektur mit Microsoft Azure"

