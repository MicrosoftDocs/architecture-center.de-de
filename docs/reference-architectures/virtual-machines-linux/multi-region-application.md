---
title: "Ausführen virtueller Linux-Computer in mehreren Azure-Regionen für Hochverfügbarkeit"
description: "Erfahren Sie, wie Sie virtuelle Computer für Hochverfügbarkeit und Resilienz in mehreren Regionen in Azure bereitstellen."
author: MikeWasson
ms.date: 11/22/2016
pnp.series.title: Linux VM workloads
pnp.series.prev: n-tier
ms.openlocfilehash: 3b68f6fc79ba4b29e41ba2b04537b834bb8859b0
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/14/2017
---
# <a name="run-linux-vms-in-multiple-regions-for-high-availability"></a><span data-ttu-id="e10d6-103">Ausführen virtueller Linux-Computer in mehreren Regionen für Hochverfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="e10d6-103">Run Linux VMs in multiple regions for high availability</span></span>

<span data-ttu-id="e10d6-104">Diese Referenzarchitektur zeigt eine Reihe bewährter Methoden zum Ausführen einer n-schichtigen Anwendung in mehreren Azure-Regionen, um Verfügbarkeit und eine stabile Infrastruktur für die Notfallwiederherstellung zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-104">This reference architecture shows a set of proven practices for running an N-tier application in multiple Azure regions, in order to achieve availability and a robust disaster recovery infrastructure.</span></span> 

<span data-ttu-id="e10d6-105">![[0]][0]</span><span class="sxs-lookup"><span data-stu-id="e10d6-105">![[0]][0]</span></span>

<span data-ttu-id="e10d6-106">*Laden Sie eine [Visio-Datei][visio-download] mit dieser Architektur herunter.*</span><span class="sxs-lookup"><span data-stu-id="e10d6-106">*Download a [Visio file][visio-download] of this architecture.*</span></span>

## <a name="architecture"></a><span data-ttu-id="e10d6-107">Architektur</span><span class="sxs-lookup"><span data-stu-id="e10d6-107">Architecture</span></span> 

<span data-ttu-id="e10d6-108">Diese Architektur basiert auf der in [Ausführen virtueller Linux-Computer in einer n-schichtigen Anwendung](n-tier.md) gezeigten Architektur.</span><span class="sxs-lookup"><span data-stu-id="e10d6-108">This architecture builds on the one shown in [Run Linux VMs for an N-tier application](n-tier.md).</span></span> 

* <span data-ttu-id="e10d6-109">**Primäre und sekundäre Regionen**.</span><span class="sxs-lookup"><span data-stu-id="e10d6-109">**Primary and secondary regions**.</span></span> <span data-ttu-id="e10d6-110">Verwenden Sie zwei Regionen, um eine höhere Verfügbarkeit zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-110">Use two regions to achieve higher availability.</span></span> <span data-ttu-id="e10d6-111">Eine ist die primäre Region. Die andere Region ist für Failover vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-111">One is the primary region.The other region is for failover.</span></span>
* <span data-ttu-id="e10d6-112">**Azure Traffic Manager**.</span><span class="sxs-lookup"><span data-stu-id="e10d6-112">**Azure Traffic Manager**.</span></span> <span data-ttu-id="e10d6-113">[Traffic Manager][traffic-manager] leitet eingehende Anforderungen an eine der Regionen weiter.</span><span class="sxs-lookup"><span data-stu-id="e10d6-113">[Traffic Manager][traffic-manager] routes incoming requests to one of the regions.</span></span> <span data-ttu-id="e10d6-114">Während des normalen Betriebs werden Anforderungen an die primäre Region weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="e10d6-114">During normal operations, it routes requests to the primary region.</span></span> <span data-ttu-id="e10d6-115">Wenn diese Region nicht mehr verfügbar ist, führt Traffic Manager ein Failover zur sekundären Region aus.</span><span class="sxs-lookup"><span data-stu-id="e10d6-115">If that region becomes unavailable, Traffic Manager fails over to the secondary region.</span></span> <span data-ttu-id="e10d6-116">Weitere Informationen finden Sie im Abschnitt [Traffic Manager-Konfiguration](#traffic-manager-configuration).</span><span class="sxs-lookup"><span data-stu-id="e10d6-116">For more information, see the section [Traffic Manager configuration](#traffic-manager-configuration).</span></span>
* <span data-ttu-id="e10d6-117">**Ressourcengruppen:**</span><span class="sxs-lookup"><span data-stu-id="e10d6-117">**Resource groups**.</span></span> <span data-ttu-id="e10d6-118">Erstellen Sie separate [Ressourcengruppen][resource groups] für die primäre Region, die sekundäre Region und für Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="e10d6-118">Create separate [resource groups][resource groups] for the primary region, the secondary region, and for Traffic Manager.</span></span> <span data-ttu-id="e10d6-119">Dies bietet Ihnen die Flexibilität, jede Region als eine einzelne Ressourcensammlung zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="e10d6-119">This gives you the flexibility to manage each region as a single collection of resources.</span></span> <span data-ttu-id="e10d6-120">Sie können beispielsweise eine Region erneut bereitstellen, ohne die andere außer Betrieb zu nehmen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-120">For example, you could redeploy one region, without taking down the other one.</span></span> <span data-ttu-id="e10d6-121">[Verknüpfen Sie die Ressourcengruppen][resource-group-links], damit Sie eine Abfrage zum Auflisten aller Ressourcen für die Anwendung ausführen können.</span><span class="sxs-lookup"><span data-stu-id="e10d6-121">[Link the resource groups][resource-group-links], so that you can run a query to list all the resources for the application.</span></span>
* <span data-ttu-id="e10d6-122">**VNETs:**</span><span class="sxs-lookup"><span data-stu-id="e10d6-122">**VNets**.</span></span> <span data-ttu-id="e10d6-123">Erstellen Sie für jede Region ein separates VNET.</span><span class="sxs-lookup"><span data-stu-id="e10d6-123">Create a separate VNet for each region.</span></span> <span data-ttu-id="e10d6-124">Stellen Sie sicher, dass sich die Adressräume nicht überschneiden.</span><span class="sxs-lookup"><span data-stu-id="e10d6-124">Make sure the address spaces do not overlap.</span></span>
* <span data-ttu-id="e10d6-125">**Apache Cassandra:**</span><span class="sxs-lookup"><span data-stu-id="e10d6-125">**Apache Cassandra**.</span></span> <span data-ttu-id="e10d6-126">Stellen Sie Cassandra für Hochverfügbarkeit in Rechenzentren mehrerer Azure-Regionen bereit.</span><span class="sxs-lookup"><span data-stu-id="e10d6-126">Deploy Cassandra in data centers across Azure regions for high availability.</span></span> <span data-ttu-id="e10d6-127">In jeder Region werden die Knoten in unterschiedlichen Racks und in Fehler- und Upgradedomänen konfiguriert, um Resilienz innerhalb der Region zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-127">Within each region, nodes are configured in rack-aware mode with fault and upgrade domains, for resiliency inside the region.</span></span>

## <a name="recommendations"></a><span data-ttu-id="e10d6-128">Recommendations</span><span class="sxs-lookup"><span data-stu-id="e10d6-128">Recommendations</span></span>

<span data-ttu-id="e10d6-129">Eine Architektur mit mehreren Regionen kann eine höhere Verfügbarkeit als eine Bereitstellung in einer einzelnen Region bieten.</span><span class="sxs-lookup"><span data-stu-id="e10d6-129">A multi-region architecture can provide higher availability than deploying to a single region.</span></span> <span data-ttu-id="e10d6-130">Wenn ein regionaler Ausfall die primäre Region beeinträchtigt, können Sie mit [Traffic Manager][traffic-manager] ein Failover zur sekundären Region ausführen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-130">If a regional outage affects the primary region, you can use [Traffic Manager][traffic-manager] to fail over to the secondary region.</span></span> <span data-ttu-id="e10d6-131">Diese Architektur kann auch hilfreich sein, wenn bei einem einzelnen Subsystem der Anwendung ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="e10d6-131">This architecture can also help if an individual subsystem of the application fails.</span></span>

<span data-ttu-id="e10d6-132">Es gibt mehrere allgemeine Vorgehensweisen für das Erreichen von Hochverfügbarkeit mit mehreren Regionen:</span><span class="sxs-lookup"><span data-stu-id="e10d6-132">There are several general approaches to achieving high availability across regions:</span></span>   

* <span data-ttu-id="e10d6-133">Aktiv/passiv mit Hot Standby.</span><span class="sxs-lookup"><span data-stu-id="e10d6-133">Active/passive with hot standby.</span></span> <span data-ttu-id="e10d6-134">Der Datenverkehr wird an eine Region weitergeleitet, während die andere im Hot Standby wartet.</span><span class="sxs-lookup"><span data-stu-id="e10d6-134">Traffic goes to one region, while the other waits on hot standby.</span></span> <span data-ttu-id="e10d6-135">Hot Standby (unmittelbar betriebsbereit) bedeutet, dass die virtuellen Computer in der sekundären Region jederzeit zugeordnet sind und ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="e10d6-135">Hot standby means the VMs in the secondary region are allocated and running at all times.</span></span>
* <span data-ttu-id="e10d6-136">Aktiv/passiv mit Cold Standby.</span><span class="sxs-lookup"><span data-stu-id="e10d6-136">Active/passive with cold standby.</span></span> <span data-ttu-id="e10d6-137">Der Datenverkehr wird an eine Region weitergeleitet, während die andere im Cold Standby wartet.</span><span class="sxs-lookup"><span data-stu-id="e10d6-137">Traffic goes to one region, while the other waits on cold standby.</span></span> <span data-ttu-id="e10d6-138">Cold Standby (verzögert betriebsbereit) bedeutet, dass die virtuellen Computer in der sekundären Region erst zugewiesen werden, wenn sie für das Failover benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="e10d6-138">Cold standby means the VMs in the secondary region are not allocated until needed for failover.</span></span> <span data-ttu-id="e10d6-139">Dieser Ansatz erfordert weniger Ausführungszeit, es dauert aber im Allgemeinen länger, bis bei einem Ausfall alle Komponenten online geschaltet sind.</span><span class="sxs-lookup"><span data-stu-id="e10d6-139">This approach costs less to run, but will generally take longer to come online during a failure.</span></span>
* <span data-ttu-id="e10d6-140">Aktiv/aktiv.</span><span class="sxs-lookup"><span data-stu-id="e10d6-140">Active/active.</span></span> <span data-ttu-id="e10d6-141">Beide Regionen sind aktiv, und Anforderungen werden per Lastenausgleich zwischen ihnen verteilt.</span><span class="sxs-lookup"><span data-stu-id="e10d6-141">Both regions are active, and requests are load balanced between them.</span></span> <span data-ttu-id="e10d6-142">Wenn eine Region nicht verfügbar ist, wird sie aus der Rotation entfernt.</span><span class="sxs-lookup"><span data-stu-id="e10d6-142">If one region becomes unavailable, it is taken out of rotation.</span></span> 

<span data-ttu-id="e10d6-143">Bei dieser Architektur liegt der Schwerpunkt auf aktiv/passiv mit Hot Standby, wobei Traffic Manager für das Failover verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="e10d6-143">This architecture focuses on active/passive with hot standby, using Traffic Manager for failover.</span></span> <span data-ttu-id="e10d6-144">Beachten Sie, dass Sie eine kleine Anzahl virtueller Computer für Hot Standby bereitstellen und dann nach Bedarf horizontal hochskalieren können.</span><span class="sxs-lookup"><span data-stu-id="e10d6-144">Note that you could deploy a small number of VMs for hot standby and then scale out as needed.</span></span>


### <a name="regional-pairing"></a><span data-ttu-id="e10d6-145">Regionspaare</span><span class="sxs-lookup"><span data-stu-id="e10d6-145">Regional pairing</span></span>

<span data-ttu-id="e10d6-146">Jede Azure-Region ist mit einer anderen Region innerhalb desselben Gebiets gepaart.</span><span class="sxs-lookup"><span data-stu-id="e10d6-146">Each Azure region is paired with another region within the same geography.</span></span> <span data-ttu-id="e10d6-147">Sie wählen im Allgemeinen Regionen aus dem gleichen Regionspaar aus (z.B. „USA, Osten 2“ und „USA, Mitte“).</span><span class="sxs-lookup"><span data-stu-id="e10d6-147">In general, choose regions from the same regional pair (for example, East US 2 and US Central).</span></span> <span data-ttu-id="e10d6-148">Das bietet die folgenden Vorteile:</span><span class="sxs-lookup"><span data-stu-id="e10d6-148">Benefits of doing so include:</span></span>

* <span data-ttu-id="e10d6-149">Bei einem umfassenden Ausfall wird die Wiederherstellung mindestens einer Region aus jedem Paar priorisiert.</span><span class="sxs-lookup"><span data-stu-id="e10d6-149">If there is a broad outage, recovery of at least one region out of every pair is prioritized.</span></span>
* <span data-ttu-id="e10d6-150">Geplante Azure-Systemupdates werden in Regionspaaren nacheinander ausgeführt, um mögliche Ausfallzeiten zu minimieren.</span><span class="sxs-lookup"><span data-stu-id="e10d6-150">Planned Azure system updates are rolled out to paired regions sequentially, to minimize possible downtime.</span></span>
* <span data-ttu-id="e10d6-151">Regionspaare befinden sich innerhalb des gleichen geografischen Gebiets, um Anforderungen in Bezug auf den Datenspeicherort zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-151">Pairs reside within the same geography, to meet data residency requirements.</span></span>

<span data-ttu-id="e10d6-152">Sie sollten allerdings sicherstellen, dass beide Regionen alle Azure-Dienste, die für Ihre Anwendung erforderlich sind, unterstützen (siehe [Dienste nach Region][services-by-region]).</span><span class="sxs-lookup"><span data-stu-id="e10d6-152">However, make sure that both regions support all of the Azure services needed for your application (see [Services by region][services-by-region]).</span></span> <span data-ttu-id="e10d6-153">Weitere Informationen zu Regionspaaren finden Sie unter [Geschäftskontinuität und Notfallwiederherstellung: Azure-Regionspaare][regional-pairs].</span><span class="sxs-lookup"><span data-stu-id="e10d6-153">For more information about regional pairs, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions][regional-pairs].</span></span>

### <a name="traffic-manager-configuration"></a><span data-ttu-id="e10d6-154">Traffic Manager-Konfiguration</span><span class="sxs-lookup"><span data-stu-id="e10d6-154">Traffic Manager configuration</span></span>

<span data-ttu-id="e10d6-155">Beachten Sie beim Konfigurieren von Traffic Manager die folgenden Punkte:</span><span class="sxs-lookup"><span data-stu-id="e10d6-155">Consider the following points when configuring Traffic Manager:</span></span>

* <span data-ttu-id="e10d6-156">**Routing:**</span><span class="sxs-lookup"><span data-stu-id="e10d6-156">**Routing**.</span></span> <span data-ttu-id="e10d6-157">Traffic Manager unterstützt mehrere [Routingalgorithmen][tm-routing].</span><span class="sxs-lookup"><span data-stu-id="e10d6-157">Traffic Manager supports several [routing algorithms][tm-routing].</span></span> <span data-ttu-id="e10d6-158">Verwenden Sie für das in diesem Artikel beschriebenen Szenario Routing nach *Priorität* (ehemals Routingmethode *Failover*).</span><span class="sxs-lookup"><span data-stu-id="e10d6-158">For the scenario described in this article, use *priority* routing (formerly called *failover* routing).</span></span> <span data-ttu-id="e10d6-159">Bei dieser Einstellung sendet Traffic Manager alle Anforderungen an die primäre Region, bis die primäre Region nicht mehr erreichbar ist.</span><span class="sxs-lookup"><span data-stu-id="e10d6-159">With this setting, Traffic Manager sends all requests to the primary region, unless the primary region becomes unreachable.</span></span> <span data-ttu-id="e10d6-160">Zu diesem Zeitpunkt wird automatisch ein Failover zur sekundären Region ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="e10d6-160">At that point, it automatically fails over to the secondary region.</span></span> <span data-ttu-id="e10d6-161">Weitere Informationen finden Sie unter [Konfigurieren der Routingmethode „Failover“][tm-configure-failover].</span><span class="sxs-lookup"><span data-stu-id="e10d6-161">See [Configure Failover routing method][tm-configure-failover].</span></span>
* <span data-ttu-id="e10d6-162">**Integritätstest:**</span><span class="sxs-lookup"><span data-stu-id="e10d6-162">**Health probe**.</span></span> <span data-ttu-id="e10d6-163">Traffic Manager verwendet einen HTTP- oder HTTPS-[Test][tm-monitoring], um die Verfügbarkeit jeder Region zu überwachen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-163">Traffic Manager uses an HTTP (or HTTPS) [probe][tm-monitoring] to monitor the availability of each region.</span></span> <span data-ttu-id="e10d6-164">Der Test prüft auf eine HTTP 200-Antwort für einen angegebenen URL-Pfad.</span><span class="sxs-lookup"><span data-stu-id="e10d6-164">The probe checks for an HTTP 200 response for a specified URL path.</span></span> <span data-ttu-id="e10d6-165">Es hat sich bewährt, einen Endpunkt zu erstellen, der die Gesamtintegrität der Anwendung meldet, und diesen Endpunkt für den Integritätstest zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="e10d6-165">As a best practice, create an endpoint that reports the overall health of the application, and use this endpoint for the health probe.</span></span> <span data-ttu-id="e10d6-166">Andernfalls meldet der Test eventuell einen fehlerfreien Endpunkt, obwohl wichtige Teile der Anwendung fehlerhaft sind.</span><span class="sxs-lookup"><span data-stu-id="e10d6-166">Otherwise, the probe might report a healthy endpoint when critical parts of the application are actually failing.</span></span> <span data-ttu-id="e10d6-167">Weitere Informationen finden Sie unter [Überwachungsmuster für den Integritätsendpunkt][health-endpoint-monitoring-pattern].</span><span class="sxs-lookup"><span data-stu-id="e10d6-167">For more information, see [Health Endpoint Monitoring Pattern][health-endpoint-monitoring-pattern].</span></span>

<span data-ttu-id="e10d6-168">Wenn Traffic Manager ein Failover ausführt, können die Clients die Anwendung für eine bestimmte Zeit nicht erreichen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-168">When Traffic Manager fails over there is a period of time when clients cannot reach the application.</span></span> <span data-ttu-id="e10d6-169">Die Dauer wird durch folgende Faktoren beeinflusst:</span><span class="sxs-lookup"><span data-stu-id="e10d6-169">The duration is affected by the following factors:</span></span>

* <span data-ttu-id="e10d6-170">Der Integritätstest muss erkennen, dass die primäre Region nicht erreichbar ist.</span><span class="sxs-lookup"><span data-stu-id="e10d6-170">The health probe must detect that the primary region has become unreachable.</span></span>
* <span data-ttu-id="e10d6-171">Die DNS-Server müssen die zwischengespeicherten DNS-Einträge für die IP-Adresse aktualisieren, die von der DNS-Gültigkeitsdauer (TTL) abhängig ist.</span><span class="sxs-lookup"><span data-stu-id="e10d6-171">DNS servers must update the cached DNS records for the IP address, which depends on the DNS time-to-live (TTL).</span></span> <span data-ttu-id="e10d6-172">Die Standardgültigkeitsdauer beträgt 300 Sekunden (5 Minuten), Sie können diesen Wert aber bei der Erstellung des Traffic Manager-Profils anpassen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-172">The default TTL is 300 seconds (5 minutes), but you can configure this value when you create the Traffic Manager profile.</span></span>

<span data-ttu-id="e10d6-173">Weitere Informationen finden Sie unter [Traffic Manager-Überwachung][tm-monitoring].</span><span class="sxs-lookup"><span data-stu-id="e10d6-173">For details, see [About Traffic Manager Monitoring][tm-monitoring].</span></span>

<span data-ttu-id="e10d6-174">Bei Failovern durch Traffic Manager sollten Sie ein manuelles Failback ausführen, anstatt ein automatisches Failback zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="e10d6-174">If Traffic Manager fails over, we recommend performing a manual failback rather than implementing an automatic failback.</span></span> <span data-ttu-id="e10d6-175">Andernfalls könnte eine Situation eintreten, bei der die Anwendung zwischen den Regionen hin und her wechselt.</span><span class="sxs-lookup"><span data-stu-id="e10d6-175">Otherwise, you can create a situation where the application flips back and forth between regions.</span></span> <span data-ttu-id="e10d6-176">Überprüfen Sie vor einem Failback, ob alle Subsysteme der Anwendung fehlerfrei sind.</span><span class="sxs-lookup"><span data-stu-id="e10d6-176">Verify that all application subsystems are healthy before failing back.</span></span>

<span data-ttu-id="e10d6-177">Beachten Sie, dass Traffic Manager in der Standardeinstellung automatisch Failbacks ausführt.</span><span class="sxs-lookup"><span data-stu-id="e10d6-177">Note that Traffic Manager automatically fails back by default.</span></span> <span data-ttu-id="e10d6-178">Um dies zu verhindern, verringern Sie die Priorität der primären Region nach einem Failover manuell.</span><span class="sxs-lookup"><span data-stu-id="e10d6-178">To prevent this, manually lower the priority of the primary region after a failover event.</span></span> <span data-ttu-id="e10d6-179">Angenommen, die primäre Region hat die Priorität 1 und die sekundäre Datenbank die Priorität 2.</span><span class="sxs-lookup"><span data-stu-id="e10d6-179">For example, suppose the primary region is priority 1 and the secondary is priority 2.</span></span> <span data-ttu-id="e10d6-180">Nach einem Failover legen Sie dann die Priorität der primären Region auf 3 fest, um ein automatisches Failback zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="e10d6-180">After a failover, set the primary region to priority 3, to prevent automatic failback.</span></span> <span data-ttu-id="e10d6-181">Wenn Sie wieder zurück wechseln möchten, ändern Sie die Priorität wieder in 1.</span><span class="sxs-lookup"><span data-stu-id="e10d6-181">When you are ready to switch back, update the priority to 1.</span></span>

<span data-ttu-id="e10d6-182">Mit dem folgenden Befehl für die [Azure-Befehlszeilenschnittstelle][install-azure-cli] wird die Priorität aktualisiert:</span><span class="sxs-lookup"><span data-stu-id="e10d6-182">The following [Azure CLI][install-azure-cli] command updates the priority:</span></span>

```bat
azure network traffic-manager  endpoint set --resource-group <resource-group> --profile-name <profile>
    --name <traffic-manager-name> --type AzureEndpoints --priority 3
```    

<span data-ttu-id="e10d6-183">Ein anderer Ansatz besteht darin, den Endpunkt vorübergehend zu deaktivieren, bis Sie zum Ausführen eines Failbacks bereit sind:</span><span class="sxs-lookup"><span data-stu-id="e10d6-183">Another approach is to temporarily disable the endpoint until you are ready to fail back:</span></span>

```bat
azure network traffic-manager  endpoint set --resource-group <resource-group> --profile-name <profile>
    --name <traffic-manager-name> --type AzureEndpoints --status Disabled
```    

<span data-ttu-id="e10d6-184">Je nach Ursache eines Failovers müssen Sie die Ressourcen innerhalb einer Region möglicherweise erneut bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-184">Depending on the cause of a failover, you might need to redeploy the resources within a region.</span></span> <span data-ttu-id="e10d6-185">Testen Sie vor dem Failback die Betriebsbereitschaft.</span><span class="sxs-lookup"><span data-stu-id="e10d6-185">Before failing back, perform an operational readiness test.</span></span> <span data-ttu-id="e10d6-186">Beim Test sollten z.B. folgende Punkte geprüft werden:</span><span class="sxs-lookup"><span data-stu-id="e10d6-186">The test should verify things like:</span></span>

* <span data-ttu-id="e10d6-187">Virtuelle Computer sind richtig konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="e10d6-187">VMs are configured correctly.</span></span> <span data-ttu-id="e10d6-188">(Alle erforderliche Software ist installiert, IIS wird ausgeführt usw.)</span><span class="sxs-lookup"><span data-stu-id="e10d6-188">(All required software is installed, IIS is running, and so on.)</span></span>
* <span data-ttu-id="e10d6-189">Subsysteme der Anwendung sind fehlerfrei.</span><span class="sxs-lookup"><span data-stu-id="e10d6-189">Application subsystems are healthy.</span></span>
* <span data-ttu-id="e10d6-190">Funktionstests.</span><span class="sxs-lookup"><span data-stu-id="e10d6-190">Functional testing.</span></span> <span data-ttu-id="e10d6-191">(Beispielsweise, dass die Datenbankebene von der Webebene aus erreichbar ist.)</span><span class="sxs-lookup"><span data-stu-id="e10d6-191">(For example, the database tier is reachable from the web tier.)</span></span>

### <a name="cassandra-deployment-across-multiple-regions"></a><span data-ttu-id="e10d6-192">Cassandra-Bereitstellung über mehrere Regionen</span><span class="sxs-lookup"><span data-stu-id="e10d6-192">Cassandra deployment across multiple regions</span></span>

<span data-ttu-id="e10d6-193">Cassandra-Rechenzentren sind eine Gruppe zusammengehöriger Datenknoten, die gemeinsam in einem Cluster konfiguriert sind, um Replikation und Workload zu trennen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-193">Cassandra data centers are a group of related data nodes that are configured together within a cluster for replication and workload segregation.</span></span>

<span data-ttu-id="e10d6-194">Wir empfehlen [DataStax Enterprise][datastax] für die Verwendung in der Produktion.</span><span class="sxs-lookup"><span data-stu-id="e10d6-194">We recommend [DataStax Enterprise][datastax] for production use.</span></span> <span data-ttu-id="e10d6-195">Weitere Informationen zur Ausführung von DataStax in Azure finden Sie im [DataStax Enterprise-Bereitstellungshandbuch für Azure][cassandra-in-azure].</span><span class="sxs-lookup"><span data-stu-id="e10d6-195">For more information on running DataStax in Azure, see [DataStax Enterprise Deployment Guide for Azure][cassandra-in-azure].</span></span> <span data-ttu-id="e10d6-196">Die folgenden allgemeinen Empfehlungen gelten für alle Cassandra-Editionen:</span><span class="sxs-lookup"><span data-stu-id="e10d6-196">The following general recommendations apply to any Cassandra edition:</span></span> 

* <span data-ttu-id="e10d6-197">Weisen Sie jedem Knoten eine öffentliche IP-Adresse zu.</span><span class="sxs-lookup"><span data-stu-id="e10d6-197">Assign a public IP address to each node.</span></span> <span data-ttu-id="e10d6-198">Dadurch können die Cluster über Regionen hinweg über die Azure-Backbone-Infrastruktur kommunizieren, die einen hohen Durchsatz zu niedrigen Preisen bietet.</span><span class="sxs-lookup"><span data-stu-id="e10d6-198">This enables the clusters to communicate across regions using the Azure backbone infrastructure, providing high throughput at low cost.</span></span>
* <span data-ttu-id="e10d6-199">Schützen Sie die Knoten durch geeignete Firewall- und NSG-Konfigurationen, die Datenverkehr nur von und zu bekannten Hosts (einschließlich Clients und anderer Clusterknoten) zulassen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-199">Secure nodes using the appropriate firewall and network security group (NSG) configurations, allowing traffic only to and from known hosts, including clients and other cluster nodes.</span></span> <span data-ttu-id="e10d6-200">Beachten Sie, dass Cassandra verschiedene Ports für Kommunikation, OpsCenter, Spark usw. verwendet.</span><span class="sxs-lookup"><span data-stu-id="e10d6-200">Note that Cassandra uses different ports for communication, OpsCenter, Spark, and so forth.</span></span> <span data-ttu-id="e10d6-201">Informationen zur Portverwendung in Cassandra finden Sie unter [Konfigurieren des Portzugriffs in der Firewall][cassandra-ports].</span><span class="sxs-lookup"><span data-stu-id="e10d6-201">For port usage in Cassandra, see [Configuring firewall port access][cassandra-ports].</span></span>
* <span data-ttu-id="e10d6-202">Verwenden Sie SSL-Verschlüsselung für alle Kommunikationen der Arten [Client-zu-Knoten][ssl-client-node] und [Knoten-zu-Knoten][ssl-node-node].</span><span class="sxs-lookup"><span data-stu-id="e10d6-202">Use SSL encryption for all [client-to-node][ssl-client-node] and [node-to-node][ssl-node-node] communications.</span></span>
* <span data-ttu-id="e10d6-203">Befolgen Sie innerhalb einer Region die Richtlinien in den [Empfehlungen für Cassandra](n-tier.md#cassandra).</span><span class="sxs-lookup"><span data-stu-id="e10d6-203">Within a region, follow the guidelines in [Cassandra recommendations](n-tier.md#cassandra).</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="e10d6-204">Überlegungen zur Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="e10d6-204">Availability considerations</span></span>

<span data-ttu-id="e10d6-205">Bei einer komplexen n-schichtigen Anwendung müssen Sie möglicherweise nicht die gesamte Anwendung in der sekundären Region replizieren.</span><span class="sxs-lookup"><span data-stu-id="e10d6-205">With a complex N-tier app, you may not need to replicate the entire application in the secondary region.</span></span> <span data-ttu-id="e10d6-206">Stattdessen replizieren Sie nur ein kritisches Subsystem, das zur Unterstützung der Geschäftskontinuität erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="e10d6-206">Instead, you might just replicate a critical subsystem that is needed to support business continuity.</span></span>

<span data-ttu-id="e10d6-207">Traffic Manager ist eine mögliche Schwachstelle im System.</span><span class="sxs-lookup"><span data-stu-id="e10d6-207">Traffic Manager is a possible failure point in the system.</span></span> <span data-ttu-id="e10d6-208">Wenn beim Traffic Manager-Dienst ein Fehler auftritt, können Clients während der Ausfallzeit nicht auf Ihre Anwendung zugreifen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-208">If the Traffic Manager service fails, clients cannot access your application during the downtime.</span></span> <span data-ttu-id="e10d6-209">In der [SLA für Traffic Manager][tm-sla] erfahren Sie, ob Ihre geschäftlichen Anforderungen für Hochverfügbarkeit mit Traffic Manager allein erfüllt werden.</span><span class="sxs-lookup"><span data-stu-id="e10d6-209">Review the [Traffic Manager SLA][tm-sla], and determine whether using Traffic Manager alone meets your business requirements for high availability.</span></span> <span data-ttu-id="e10d6-210">Wenn dies nicht der Fall ist, erwägen Sie als Failback eine andere Verwaltungslösung für den Datenverkehr.</span><span class="sxs-lookup"><span data-stu-id="e10d6-210">If not, consider adding another traffic management solution as a failback.</span></span> <span data-ttu-id="e10d6-211">Wenn der Azure Traffic Manager-Dienst fehlerhaft ist, ändern Sie die CNAME-Einträge im DNS, sodass diese auf die andere Verwaltungslösung für den Datenverkehr verweisen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-211">If the Azure Traffic Manager service fails, change your CNAME records in DNS to point to the other traffic management service.</span></span> <span data-ttu-id="e10d6-212">(Dieser Schritt muss manuell durchgeführt werden. Bis die DNS-Änderungen weitergegeben wurden, ist die Anwendung nicht verfügbar.)</span><span class="sxs-lookup"><span data-stu-id="e10d6-212">(This step must be performed manually, and your application will be unavailable until the DNS changes are propagated.)</span></span>

<span data-ttu-id="e10d6-213">Für den Cassandra-Cluster hängen die relevanten Failoverszenarien von den Konsistenzebenen, die von der Anwendung verwendet werden, und der Anzahl der verwendeten Replikate ab.</span><span class="sxs-lookup"><span data-stu-id="e10d6-213">For the Cassandra cluster, the failover scenarios to consider depend on the consistency levels used by the application, as well as the number of replicas used.</span></span> <span data-ttu-id="e10d6-214">Weitere Informationen zu Konsistenzebenen und der Verwendung in Cassandra finden Sie unter [Konfigurieren der Datenkonsistenz][cassandra-consistency] und [Cassandra: Wie viele Knoten kommunizieren mit Quorum?][cassandra-consistency-usage].</span><span class="sxs-lookup"><span data-stu-id="e10d6-214">For consistency levels and usage in Cassandra, see [Configuring data consistency][cassandra-consistency] and [Cassandra: How many nodes are talked to with Quorum?][cassandra-consistency-usage]</span></span> <span data-ttu-id="e10d6-215">Die Verfügbarkeit der Daten wird in Cassandra durch die Konsistenzebene, die von der Anwendung verwendet wird, und vom Replikationsverfahren bestimmt.</span><span class="sxs-lookup"><span data-stu-id="e10d6-215">Data availability in Cassandra is determined by the consistency level used by the application and the replication mechanism.</span></span> <span data-ttu-id="e10d6-216">Weitere Informationen zur Replikation in Cassandra finden Sie unter [Datenreplikation in NoSQL-Datenbanken im Überblick][cassandra-replication].</span><span class="sxs-lookup"><span data-stu-id="e10d6-216">For replication in Cassandra, see [Data Replication in NoSQL Databases Explained][cassandra-replication].</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="e10d6-217">Überlegungen zur Verwaltbarkeit</span><span class="sxs-lookup"><span data-stu-id="e10d6-217">Manageability considerations</span></span>

<span data-ttu-id="e10d6-218">Beim Aktualisieren der Bereitstellung aktualisieren Sie immer jeweils eine Region, um die Möglichkeit eines globalen Fehlers aufgrund einer falschen Konfiguration oder eines Fehlers in der Anwendung zu reduzieren.</span><span class="sxs-lookup"><span data-stu-id="e10d6-218">When you update your deployment, update one region at a time to reduce the chance of a global failure from an incorrect configuration or an error in the application.</span></span>

<span data-ttu-id="e10d6-219">Testen Sie die Resilienz des Systems gegenüber Fehlern.</span><span class="sxs-lookup"><span data-stu-id="e10d6-219">Test the resiliency of the system to failures.</span></span> <span data-ttu-id="e10d6-220">Hier sind einige häufige Fehlerszenarien aufgeführt, die getestet werden können:</span><span class="sxs-lookup"><span data-stu-id="e10d6-220">Here are some common failure scenarios to test:</span></span>

* <span data-ttu-id="e10d6-221">Herunterfahren von VM-Instanzen</span><span class="sxs-lookup"><span data-stu-id="e10d6-221">Shut down VM instances.</span></span>
* <span data-ttu-id="e10d6-222">Auslasten von Ressourcen, z.B. CPU und Speicher</span><span class="sxs-lookup"><span data-stu-id="e10d6-222">Pressure resources such as CPU and memory.</span></span>
* <span data-ttu-id="e10d6-223">Trennen/Verzögern des Netzwerks</span><span class="sxs-lookup"><span data-stu-id="e10d6-223">Disconnect/delay network.</span></span>
* <span data-ttu-id="e10d6-224">Absturz von Prozessen</span><span class="sxs-lookup"><span data-stu-id="e10d6-224">Crash processes.</span></span>
* <span data-ttu-id="e10d6-225">Ablauf von Zertifikaten</span><span class="sxs-lookup"><span data-stu-id="e10d6-225">Expire certificates.</span></span>
* <span data-ttu-id="e10d6-226">Simulieren von Hardwarefehlern</span><span class="sxs-lookup"><span data-stu-id="e10d6-226">Simulate hardware faults.</span></span>
* <span data-ttu-id="e10d6-227">Herunterfahren des DNS-Diensts auf den Domänencontrollern</span><span class="sxs-lookup"><span data-stu-id="e10d6-227">Shut down the DNS service on the domain controllers.</span></span>

<span data-ttu-id="e10d6-228">Messen Sie die Wiederherstellungszeiten, und stellen Sie sicher, dass diese Ihren geschäftlichen Anforderungen entsprechen.</span><span class="sxs-lookup"><span data-stu-id="e10d6-228">Measure the recovery times and verify they meet your business requirements.</span></span> <span data-ttu-id="e10d6-229">Testen Sie auch Kombinationen von Fehlermodi.</span><span class="sxs-lookup"><span data-stu-id="e10d6-229">Test combinations of failure modes, as well.</span></span>


<!-- Links -->
[hybrid-vpn]: ../hybrid-networking/vpn.md

[cassandra-in-azure]: https://academy.datastax.com/resources/deployment-guide-azure
[cassandra-consistency]: http://docs.datastax.com/en/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html
[cassandra-replication]: http://www.planetcassandra.org/data-replication-in-nosql-databases-explained/
[cassandra-consistency-usage]: https://medium.com/@foundev/cassandra-how-many-nodes-are-talked-to-with-quorum-also-should-i-use-it-98074e75d7d5#.b4pb4alb2
[cassandra-ports]: https://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/sec/configFirewallPorts.html
[datastax]: https://www.datastax.com/products/datastax-enterprise
[health-endpoint-monitoring-pattern]: https://msdn.microsoft.com/library/dn589789.aspx
[install-azure-cli]: /azure/xplat-cli-install
[regional-pairs]: /azure/best-practices-availability-paired-regions
[resource groups]: /azure/azure-resource-manager/resource-group-overview
[resource-group-links]: /azure/resource-group-link-resources
[services-by-region]: https://azure.microsoft.com/regions/#services
[ssl-client-node]: http://docs.datastax.com/en/cassandra/2.0/cassandra/security/secureSSLClientToNode_t.html
[ssl-node-node]: http://docs.datastax.com/en/cassandra/2.0/cassandra/security/secureSSLNodeToNode_t.html
[tablediff]: https://msdn.microsoft.com/library/ms162843.aspx
[tm-configure-failover]: /azure/traffic-manager/traffic-manager-configure-failover-routing-method
[tm-monitoring]: /azure/traffic-manager/traffic-manager-monitoring
[tm-routing]: /azure/traffic-manager/traffic-manager-routing-methods
[tm-sla]: https://azure.microsoft.com/support/legal/sla/traffic-manager/v1_0/
[traffic-manager]: https://azure.microsoft.com/services/traffic-manager/
[visio-download]: https://archcenter.azureedge.net/cdn/vm-reference-architectures.vsdx
[wsfc]: https://msdn.microsoft.com/library/hh270278.aspx
[0]: ./images/multi-region-application-diagram.png "Architektur eines hochverfügbaren Netzwerks für n-schichtige Azure-Anwendungen"
