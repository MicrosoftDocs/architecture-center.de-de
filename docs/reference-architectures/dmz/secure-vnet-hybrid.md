---
title: Implementieren einer sicheren hybriden Netzwerkarchitektur
titleSuffix: Azure Reference Architectures
description: Implementieren Sie eine sichere hybride Netzwerkarchitektur in Azure.
author: telmosampaio
ms.date: 10/22/2018
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seodec18, networking
ms.openlocfilehash: 82327cca08e614bfe5226c9ca1a414388878a7c2
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/20/2019
ms.locfileid: "58243511"
---
# <a name="implement-a-dmz-between-azure-and-your-on-premises-datacenter"></a><span data-ttu-id="16cdf-103">Implementieren einer DMZ zwischen Azure und Ihrem lokalen Datencenter</span><span class="sxs-lookup"><span data-stu-id="16cdf-103">Implement a DMZ between Azure and your on-premises datacenter</span></span>

<span data-ttu-id="16cdf-104">Diese Referenzarchitektur zeigt ein sicheres Hybridnetzwerk, das ein lokales Netzwerk in Azure erweitert.</span><span class="sxs-lookup"><span data-stu-id="16cdf-104">This reference architecture shows a secure hybrid network that extends an on-premises network to Azure.</span></span> <span data-ttu-id="16cdf-105">Die Architektur implementiert eine DMZ, auch als *Umkreisnetzwerk* bezeichnet, zwischen dem lokalen Netzwerk und einem virtuellen Azure-Netzwerk (VNet).</span><span class="sxs-lookup"><span data-stu-id="16cdf-105">The architecture implements a DMZ, also called a *perimeter network*, between the on-premises network and an Azure virtual network (VNet).</span></span> <span data-ttu-id="16cdf-106">Die DMZ umfasst virtuelle Netzwerkgeräte (Network Virtual Appliances, NVAs), die Sicherheitsfunktionen wie z.B. Firewalls und Paketüberprüfung implementieren.</span><span class="sxs-lookup"><span data-stu-id="16cdf-106">The DMZ includes network virtual appliances (NVAs) that implement security functionality such as firewalls and packet inspection.</span></span> <span data-ttu-id="16cdf-107">Der gesamte ausgehende Datenverkehr vom VNet wird zwangsweise durch das lokale Netzwerk in das Internet getunnelt, sodass er überwacht werden kann.</span><span class="sxs-lookup"><span data-stu-id="16cdf-107">All outgoing traffic from the VNet is force-tunneled to the Internet through the on-premises network, so that it can be audited.</span></span> <span data-ttu-id="16cdf-108">[**Stellen Sie diese Lösung bereit**](#deploy-the-solution).</span><span class="sxs-lookup"><span data-stu-id="16cdf-108">[**Deploy this solution**](#deploy-the-solution).</span></span>

> [!NOTE]
> <span data-ttu-id="16cdf-109">Dieses Szenario kann auch mithilfe von [Azure Firewall](/azure/firewall/), einem cloudbasierten Netzwerksicherheitsdienst, erreicht werden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-109">This scenario can also be accomplished using [Azure Firewall](/azure/firewall/), a cloud-based network security service.</span></span>

![Sichere Hybrid-Netzwerkarchitektur](./images/dmz-private.png)

<span data-ttu-id="16cdf-111">*Laden Sie eine [Visio-Datei][visio-download] mit dieser Architektur herunter.*</span><span class="sxs-lookup"><span data-stu-id="16cdf-111">*Download a [Visio file][visio-download] of this architecture.*</span></span>

<span data-ttu-id="16cdf-112">Für diese Architektur ist eine Verbindung mit Ihrem lokalen Rechenzentrum erforderlich, entweder mithilfe eines [VPN-Gateways][ra-vpn] oder einer [ExpressRoute][ra-expressroute]-Verbindung.</span><span class="sxs-lookup"><span data-stu-id="16cdf-112">This architecture requires a connection to your on-premises datacenter, using either a [VPN gateway][ra-vpn] or an [ExpressRoute][ra-expressroute] connection.</span></span> <span data-ttu-id="16cdf-113">Typische Einsatzmöglichkeiten für diese Architektur sind:</span><span class="sxs-lookup"><span data-stu-id="16cdf-113">Typical uses for this architecture include:</span></span>

- <span data-ttu-id="16cdf-114">Hybridanwendungen, in denen Workloads teilweise lokal und teilweise in Azure ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-114">Hybrid applications where workloads run partly on-premises and partly in Azure.</span></span>
- <span data-ttu-id="16cdf-115">Infrastruktur, die eine präzise Kontrolle des aus einem lokalen Rechenzentrum in ein Azure VNet eingehenden Verkehrs erfordert.</span><span class="sxs-lookup"><span data-stu-id="16cdf-115">Infrastructure that requires granular control over traffic entering an Azure VNet from an on-premises datacenter.</span></span>
- <span data-ttu-id="16cdf-116">Anwendungen, die ausgehenden Verkehr überwachen müssen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-116">Applications that must audit outgoing traffic.</span></span> <span data-ttu-id="16cdf-117">Dies ist ein oftmals auf behördliche Bestimmungen zurückgehendes Erfordernis vieler kommerzieller Systeme und kann dabei helfen, die Offenlegung privater Informationen zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="16cdf-117">This is often a regulatory requirement of many commercial systems and can help to prevent public disclosure of private information.</span></span>

## <a name="architecture"></a><span data-ttu-id="16cdf-118">Architecture</span><span class="sxs-lookup"><span data-stu-id="16cdf-118">Architecture</span></span>

<span data-ttu-id="16cdf-119">Die Architektur umfasst die folgenden Komponenten.</span><span class="sxs-lookup"><span data-stu-id="16cdf-119">The architecture consists of the following components.</span></span>

- <span data-ttu-id="16cdf-120">**Lokales Netzwerk**.</span><span class="sxs-lookup"><span data-stu-id="16cdf-120">**On-premises network**.</span></span> <span data-ttu-id="16cdf-121">Ein privates lokales Netzwerk innerhalb einer Organisation.</span><span class="sxs-lookup"><span data-stu-id="16cdf-121">A private local-area network implemented in an organization.</span></span>
- <span data-ttu-id="16cdf-122">**Azure Virtual Network (VNet)**.</span><span class="sxs-lookup"><span data-stu-id="16cdf-122">**Azure virtual network (VNet)**.</span></span> <span data-ttu-id="16cdf-123">Das VNet hostet die Anwendung und weitere Ressourcen, die in Azure ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-123">The VNet hosts the application and other resources running in Azure.</span></span>
- <span data-ttu-id="16cdf-124">**Gateway**.</span><span class="sxs-lookup"><span data-stu-id="16cdf-124">**Gateway**.</span></span> <span data-ttu-id="16cdf-125">Das Gateway stellt Verbindungen zwischen den Routern im lokalen Netzwerk und dem VNet bereit.</span><span class="sxs-lookup"><span data-stu-id="16cdf-125">The gateway provides connectivity between the routers in the on-premises network and the VNet.</span></span>
- <span data-ttu-id="16cdf-126">**Virtuelles Netzwerkgerät**.</span><span class="sxs-lookup"><span data-stu-id="16cdf-126">**Network virtual appliance (NVA)**.</span></span> <span data-ttu-id="16cdf-127">Virtuelles Netzwerkgerät ist ein generischer Begriff zur Beschreibung eines virtuellen Computers, der Aufgaben wie das Erteilen oder Ablehnen von Zugriff als Firewall, das Optimieren von WAN-Vorgängen (Wide Area Network) (einschließlich Netzwerkkomprimierung), benutzerdefiniertes Routing oder andere Netzwerkfunktionen ausführt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-127">NVA is a generic term that describes a VM performing tasks such as allowing or denying access as a firewall, optimizing wide area network (WAN) operations (including network compression), custom routing, or other network functionality.</span></span>
- <span data-ttu-id="16cdf-128">**Subnetze für die Webschicht, die Geschäftsschicht und die Datenschicht**.</span><span class="sxs-lookup"><span data-stu-id="16cdf-128">**Web tier, business tier, and data tier subnets**.</span></span> <span data-ttu-id="16cdf-129">Subnetze, in denen die VMs und Dienste gehostet sind, die eine 3-schichtige Beispielanwendung implementieren, die in der Cloud ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="16cdf-129">Subnets hosting the VMs and services that implement an example 3-tier application running in the cloud.</span></span> <span data-ttu-id="16cdf-130">Weitere Informationen finden Sie unter [Ausführen von Windows-VMs für eine n-schichtige Architektur in Azure][ra-n-tier].</span><span class="sxs-lookup"><span data-stu-id="16cdf-130">See [Running Windows VMs for an N-tier architecture on Azure][ra-n-tier] for more information.</span></span>
- <span data-ttu-id="16cdf-131">**Benutzerdefinierte Routen (UDR)**.</span><span class="sxs-lookup"><span data-stu-id="16cdf-131">**User defined routes (UDR)**.</span></span> <span data-ttu-id="16cdf-132">[Benutzerdefinierte Routen][udr-overview] definieren den Fluss von IP-Datenverkehr innerhalb von Azure-VNets.</span><span class="sxs-lookup"><span data-stu-id="16cdf-132">[User defined routes][udr-overview] define the flow of IP traffic within Azure VNets.</span></span>

    > [!NOTE]
    > <span data-ttu-id="16cdf-133">Je nach den Anforderungen Ihrer VPN-Verbindung können Sie BGP-Routen (Border Gateway Protocol) anstelle von UDRs konfigurieren, um die Weiterleitungsregeln zu implementieren, die Datenverkehr zurück durch das lokale Netzwerk leiten.</span><span class="sxs-lookup"><span data-stu-id="16cdf-133">Depending on the requirements of your VPN connection, you can configure Border Gateway Protocol (BGP) routes instead of using UDRs to implement the forwarding rules that direct traffic back through the on-premises network.</span></span>
    >

- <span data-ttu-id="16cdf-134">**Verwaltungssubnetz:**</span><span class="sxs-lookup"><span data-stu-id="16cdf-134">**Management subnet**.</span></span> <span data-ttu-id="16cdf-135">Dieses Subnetz enthält VMs, die Verwaltungs- und Überwachungsfunktionen für die Komponenten implementieren, die im VNet ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-135">This subnet contains VMs that implement management and monitoring capabilities for the components running in the VNet.</span></span>

## <a name="recommendations"></a><span data-ttu-id="16cdf-136">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="16cdf-136">Recommendations</span></span>

<span data-ttu-id="16cdf-137">Die folgenden Empfehlungen gelten für die meisten Szenarios.</span><span class="sxs-lookup"><span data-stu-id="16cdf-137">The following recommendations apply for most scenarios.</span></span> <span data-ttu-id="16cdf-138">Sofern Sie keine besonderen Anforderungen haben, die Vorrang haben, sollten Sie diese Empfehlungen befolgen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-138">Follow these recommendations unless you have a specific requirement that overrides them.</span></span>

### <a name="access-control-recommendations"></a><span data-ttu-id="16cdf-139">Empfehlungen für die Zugriffssteuerung</span><span class="sxs-lookup"><span data-stu-id="16cdf-139">Access control recommendations</span></span>

<span data-ttu-id="16cdf-140">Verwenden Sie die [rollenbasierte Zugriffssteuerung][rbac] (Role-Based Access Control, RBAC), um die Ressourcen in Ihrer Anwendung zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="16cdf-140">Use [Role-Based Access Control][rbac] (RBAC) to manage the resources in your application.</span></span> <span data-ttu-id="16cdf-141">Ziehen Sie die Erstellung der folgenden [benutzerdefinierten Rollen][rbac-custom-roles] in Erwägung:</span><span class="sxs-lookup"><span data-stu-id="16cdf-141">Consider creating the following [custom roles][rbac-custom-roles]:</span></span>

- <span data-ttu-id="16cdf-142">Eine DevOps-Rolle mit Berechtigungen zum Verwalten der Infrastruktur für die Anwendung, zum Bereitstellen der Anwendungskomponenten und zum Überwachen und Neustarten von VMs.</span><span class="sxs-lookup"><span data-stu-id="16cdf-142">A DevOps role with permissions to administer the infrastructure for the application, deploy the application components, and monitor and restart VMs.</span></span>

- <span data-ttu-id="16cdf-143">Eine zentrale IT-Administratorrolle zum Verwalten und Überwachen von Netzwerkressourcen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-143">A centralized IT administrator role to manage and monitor network resources.</span></span>

- <span data-ttu-id="16cdf-144">Eine IT-Sicherheitsadministratorrolle zum Verwalten der sicheren Netzwerkressourcen, wie etwa der NVAs.</span><span class="sxs-lookup"><span data-stu-id="16cdf-144">A security IT administrator role to manage secure network resources such as the NVAs.</span></span>

<span data-ttu-id="16cdf-145">Die DevOps- und IT-Administratorrollen sollten keinen Zugriff auf die NVA-Ressourcen besitzen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-145">The DevOps and IT administrator roles should not have access to the NVA resources.</span></span> <span data-ttu-id="16cdf-146">Dieser sollte auf die IT-Sicherheitsadministratorrolle beschränkt sein.</span><span class="sxs-lookup"><span data-stu-id="16cdf-146">This should be restricted to the security IT administrator role.</span></span>

### <a name="resource-group-recommendations"></a><span data-ttu-id="16cdf-147">Empfehlungen für Ressourcengruppen</span><span class="sxs-lookup"><span data-stu-id="16cdf-147">Resource group recommendations</span></span>

<span data-ttu-id="16cdf-148">Azure-Ressourcen, wie etwa VMs, VNets und Lastenausgleichsmodule, können durch Zusammenfassung in Ressourcengruppen komfortabel verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-148">Azure resources such as VMs, VNets, and load balancers can be easily managed by grouping them together into resource groups.</span></span> <span data-ttu-id="16cdf-149">Weisen Sie jeder Ressourcengruppe RBAC-Rollen zu, um den Zugriff einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="16cdf-149">Assign RBAC roles to each resource group to restrict access.</span></span>

<span data-ttu-id="16cdf-150">Es empfiehlt sich, die folgenden Ressourcengruppen zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="16cdf-150">We recommend creating the following resource groups:</span></span>

- <span data-ttu-id="16cdf-151">Eine Ressourcengruppe, die das VNet (ohne die VMs), NSGs, und die Gatewayressourcen für die Verbindung mit dem lokalen Netzwerk enthält.</span><span class="sxs-lookup"><span data-stu-id="16cdf-151">A resource group containing the VNet (excluding the VMs), NSGs, and the gateway resources for connecting to the on-premises network.</span></span> <span data-ttu-id="16cdf-152">Weisen Sie dieser Ressourcengruppe die zentrale IT-Administratorrolle zu.</span><span class="sxs-lookup"><span data-stu-id="16cdf-152">Assign the centralized IT administrator role to this resource group.</span></span>
- <span data-ttu-id="16cdf-153">Eine Ressourcengruppe, die die VMs für die NVAs (einschließlich des Lastenausgleichsmoduls), die Jumpbox und anderen Verwaltungs-VMs und die UDR für das Gatewaysubnetz enthält, das den gesamten Datenverkehr zwangsweise durch die NVAs leitet.</span><span class="sxs-lookup"><span data-stu-id="16cdf-153">A resource group containing the VMs for the NVAs (including the load balancer), the jumpbox and other management VMs, and the UDR for the gateway subnet that forces all traffic through the NVAs.</span></span> <span data-ttu-id="16cdf-154">Weisen Sie dieser Ressourcengruppe die IT-Sicherheitsadministratorrolle zu.</span><span class="sxs-lookup"><span data-stu-id="16cdf-154">Assign the security IT administrator role to this resource group.</span></span>
- <span data-ttu-id="16cdf-155">Getrennte Ressourcengruppen für jede Logikschicht, die das Lastenausgleichsmodul und die VMs enthalten.</span><span class="sxs-lookup"><span data-stu-id="16cdf-155">Separate resource groups for each application tier that contain the load balancer and VMs.</span></span> <span data-ttu-id="16cdf-156">Beachten Sie, dass diese Ressourcengruppen nicht die Subnetze für die einzelnen Schichten enthalten sollten.</span><span class="sxs-lookup"><span data-stu-id="16cdf-156">Note that this resource group shouldn't include the subnets for each tier.</span></span> <span data-ttu-id="16cdf-157">Weisen Sie dieser Ressourcengruppe die DevOps-Rolle zu.</span><span class="sxs-lookup"><span data-stu-id="16cdf-157">Assign the DevOps role to this resource group.</span></span>

### <a name="virtual-network-gateway-recommendations"></a><span data-ttu-id="16cdf-158">Empfehlungen für das Gateway des virtuellen Netzwerks</span><span class="sxs-lookup"><span data-stu-id="16cdf-158">Virtual network gateway recommendations</span></span>

<span data-ttu-id="16cdf-159">Der lokale Netzwerkverkehr wird durch ein virtuelles Netzwerkgateway in das VNet übermittelt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-159">On-premises traffic passes to the VNet through a virtual network gateway.</span></span> <span data-ttu-id="16cdf-160">Zu diesem Zweck empfiehlt sich ein [Azure VPN-Gateway][guidance-vpn-gateway] oder ein [Azure ExpressRoute-Gateway][guidance-expressroute].</span><span class="sxs-lookup"><span data-stu-id="16cdf-160">We recommend an [Azure VPN gateway][guidance-vpn-gateway] or an [Azure ExpressRoute gateway][guidance-expressroute].</span></span>

### <a name="nva-recommendations"></a><span data-ttu-id="16cdf-161">Empfehlungen für virtuelle Netzwerkgeräte</span><span class="sxs-lookup"><span data-stu-id="16cdf-161">NVA recommendations</span></span>

<span data-ttu-id="16cdf-162">Virtuelle Netzwerkgeräte stellen verschiedene Dienste zum Verwalten und Überwachen des Netzwerkverkehrs bereit.</span><span class="sxs-lookup"><span data-stu-id="16cdf-162">NVAs provide different services for managing and monitoring network traffic.</span></span> <span data-ttu-id="16cdf-163">Im [Azure Marketplace][azure-marketplace-nva] werden verschiedene virtuelle Netzwerkgeräte von Drittanbietern angeboten, die Sie verwenden können.</span><span class="sxs-lookup"><span data-stu-id="16cdf-163">The [Azure Marketplace][azure-marketplace-nva] offers several third-party vendor NVAs that you can use.</span></span> <span data-ttu-id="16cdf-164">Wenn keins dieser Drittanbieter-NVAs Ihren Anforderungen entspricht, können Sie mithilfe von virtuellen Computern ein benutzerdefiniertes virtuelles Netzwerkgerät erstellen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-164">If none of these third-party NVAs meet your requirements, you can create a custom NVA using VMs.</span></span>

<span data-ttu-id="16cdf-165">Beispielsweise implementiert die Lösungsbereitstellung für diese Referenzarchitektur ein virtuelles Netzwerkgerät mit folgenden Funktionen in einem virtuellen Computer:</span><span class="sxs-lookup"><span data-stu-id="16cdf-165">For example, the solution deployment for this reference architecture implements an NVA with the following functionality on a VM:</span></span>

- <span data-ttu-id="16cdf-166">Der Datenverkehr wird mithilfe von [IP-Weiterleitung][ip-forwarding] zu den NVA-Netzwerkschnittstellen (NICs) geroutet.</span><span class="sxs-lookup"><span data-stu-id="16cdf-166">Traffic is routed using [IP forwarding][ip-forwarding] on the NVA network interfaces (NICs).</span></span>
- <span data-ttu-id="16cdf-167">Die Durchleitung von Datenverkehr durch das virtuelle Netzwerkgerät wird nur zugelassen, wenn dies angemessen ist.</span><span class="sxs-lookup"><span data-stu-id="16cdf-167">Traffic is permitted to pass through the NVA only if it is appropriate to do so.</span></span> <span data-ttu-id="16cdf-168">Alle NVA-VMs in der virtuellen Referenzarchitektur stellen einfache Linux-Router dar.</span><span class="sxs-lookup"><span data-stu-id="16cdf-168">Each NVA VM in the reference architecture is a simple Linux router.</span></span> <span data-ttu-id="16cdf-169">Eingehender Datenverkehr kommt an der Netzwerkschnittstelle *eth0* an, und ausgehender Datenverkehr, der den in benutzerdefinierten Skripts definierten Regeln entspricht, wird durch die Netzwerkschnittstelle *eth1* versendet.</span><span class="sxs-lookup"><span data-stu-id="16cdf-169">Inbound traffic arrives on network interface *eth0*, and outbound traffic matches rules defined by custom scripts dispatched through network interface *eth1*.</span></span>
- <span data-ttu-id="16cdf-170">Die NVAs können nur aus dem Verwaltungssubnetz konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-170">The NVAs can only be configured from the management subnet.</span></span>
- <span data-ttu-id="16cdf-171">Durch das Verwaltungssubnetz gerouteter Datenverkehr durchläuft die NVAs nicht.</span><span class="sxs-lookup"><span data-stu-id="16cdf-171">Traffic routed to the management subnet does not pass through the NVAs.</span></span> <span data-ttu-id="16cdf-172">Andernfalls würde beim Ausfall der NVAs keine Route mehr zu ihrer Instandsetzung bestehen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-172">Otherwise, if the NVAs fail, there would be no route to the management subnet to fix them.</span></span>
- <span data-ttu-id="16cdf-173">Die VMs für das NVA werden in einer [Verfügbarkeitsgruppe][availability-set] hinter einem Lastenausgleichsmodul platziert.</span><span class="sxs-lookup"><span data-stu-id="16cdf-173">The VMs for the NVA are placed in an [availability set][availability-set] behind a load balancer.</span></span> <span data-ttu-id="16cdf-174">Die UDR im Gatewaysubnetz leitet NVA-Anforderungen an das Lastenausgleichsmodul.</span><span class="sxs-lookup"><span data-stu-id="16cdf-174">The UDR in the gateway subnet directs NVA requests to the load balancer.</span></span>

<span data-ttu-id="16cdf-175">Schließen Sie ein Schicht-7-NVA ein, um Anwendungsverbindungen auf der NVA-Ebene zu beenden und die Affinität mit den Back-End-Schichten aufrechtzuerhalten.</span><span class="sxs-lookup"><span data-stu-id="16cdf-175">Include a layer-7 NVA to terminate application connections at the NVA level and maintain affinity with the backend tiers.</span></span> <span data-ttu-id="16cdf-176">Dies garantiert symmetrische Konnektivität, bei der Antwortdatenverkehr von den Back-End-Schichten durch das NVA zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="16cdf-176">This guarantees symmetric connectivity, in which response traffic from the backend tiers returns through the NVA.</span></span>

<span data-ttu-id="16cdf-177">Eine andere Möglichkeit besteht darin, mehrere NVAs in Serie zu verbinden, wobei jedes NVA eine spezialisierte Sicherheitsaufgabe ausführt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-177">Another option to consider is connecting multiple NVAs in series, with each NVA performing a specialized security task.</span></span> <span data-ttu-id="16cdf-178">Dadurch kann jede Sicherheitsfunktion getrennt auf NVA-Basis verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-178">This allows each security function to be managed on a per-NVA basis.</span></span> <span data-ttu-id="16cdf-179">Beispielsweise kann ein NVA, das eine Firewall implementiert, in Serie mit einem NVA platziert werden, das Identitätsdienste ausführt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-179">For example, an NVA implementing a firewall could be placed in series with an NVA running identity services.</span></span> <span data-ttu-id="16cdf-180">Die komfortable Verwaltung wird um den Preis zusätzlicher Netzwerkhops erkauft, die die Latenz erhöhten können – stellen Sie also sicher, dass sich dies nicht nachteilig auf die Leistung Ihrer Anwendung auswirkt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-180">The tradeoff for ease of management is the addition of extra network hops that may increase latency, so ensure that this doesn't affect your application's performance.</span></span>

### <a name="nsg-recommendations"></a><span data-ttu-id="16cdf-181">NSG-Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="16cdf-181">NSG recommendations</span></span>

<span data-ttu-id="16cdf-182">Das VPN-Gateway macht eine öffentliche IP-Adresse für die Verbindung mit dem lokalen Netzwerk verfügbar.</span><span class="sxs-lookup"><span data-stu-id="16cdf-182">The VPN gateway exposes a public IP address for the connection to the on-premises network.</span></span> <span data-ttu-id="16cdf-183">Es wird empfohlen, eine Netzwerksicherheitsgruppe (NSG) für das eingehende NVA-Subnetz zu erstellen, mit Regeln zum Blockieren jeglichen Datenverkehrs, der nicht aus dem lokalen Netzwerk stammt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-183">We recommend creating a network security group (NSG) for the inbound NVA subnet, with rules to block all traffic not originating from the on-premises network.</span></span>

<span data-ttu-id="16cdf-184">Außerdem werden NSGs für jedes Subnetz empfohlen, um eine zweite Schutzebene vor eingehendem Verkehr bereitzustellen, der ein fehlerhaft konfiguriertes oder deaktiviertes NVA umgeht.</span><span class="sxs-lookup"><span data-stu-id="16cdf-184">We also recommend NSGs for each subnet to provide a second level of protection against inbound traffic bypassing an incorrectly configured or disabled NVA.</span></span> <span data-ttu-id="16cdf-185">Beispielsweise implementiert das Subnetz der Webschicht in der Referenzarchitektur eine NSG mit einer Regel zum Ignorieren aller Anforderungen, die nicht vom lokalen Netzwerk (192.168.0.0/16) oder vom VNet empfangen werden, und eine weitere Regel ignoriert alle Anforderungen, die nicht an Port 80 erfolgen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-185">For example, the web tier subnet in the reference architecture implements an NSG with a rule to ignore all requests other than those received from the on-premises network (192.168.0.0/16) or the VNet, and another rule that ignores all requests not made on port 80.</span></span>

### <a name="internet-access-recommendations"></a><span data-ttu-id="16cdf-186">Empfehlungen zum Zugriff auf das Internet</span><span class="sxs-lookup"><span data-stu-id="16cdf-186">Internet access recommendations</span></span>

<span data-ttu-id="16cdf-187">[Zwangsweises Tunneln][azure-forced-tunneling] des gesamten ausgehenden Internetdatenverkehrs durch Ihr lokales Netzwerk mithilfe des Site-zu-Site-VPN-Tunnels und Routen in das Internet mithilfe von Netzwerkadressenübersetzung (Network Address Translation, NAT).</span><span class="sxs-lookup"><span data-stu-id="16cdf-187">[Force-tunnel][azure-forced-tunneling] all outbound Internet traffic through your on-premises network using the site-to-site VPN tunnel, and route to the Internet using network address translation (NAT).</span></span> <span data-ttu-id="16cdf-188">Dadurch wird die versehentliche Offenlegung jeglicher vertraulicher Informationen verhindert, die in Ihrer Datenschicht gespeichert sind, und zugleich die Untersuchung und Überwachung des gesamten ausgehenden Verkehrs ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="16cdf-188">This prevents accidental leakage of any confidential information stored in your data tier and allows inspection and auditing of all outgoing traffic.</span></span>

> [!NOTE]
> <span data-ttu-id="16cdf-189">Blockieren Sie nicht den gesamten Internetverkehr von den Logikschichten, da diese Schichten dadurch auch an der Verwendung von Azure PaaS-Diensten gehindert werden, die auf öffentlichen IP-Adressen aufbauen, wie etwa VM-Diagnoseprotokollierung, Herunterladen von VM-Erweiterungen und weitere Funktionen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-189">Don't completely block Internet traffic from the application tiers, as this will prevent these tiers from using Azure PaaS services that rely on public IP addresses, such as VM diagnostics logging, downloading of VM extensions, and other functionality.</span></span> <span data-ttu-id="16cdf-190">Für Azure-Diagnose ist außerdem erforderlich, dass Komponenten Lese- und Schreibzugriff auf ein Azure Storage-Konto besitzen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-190">Azure diagnostics also requires that components can read and write to an Azure Storage account.</span></span>

<span data-ttu-id="16cdf-191">Überprüfen Sie, ob der ausgehende Internetdatenverkehr ordnungsgemäß zwangsweise getunnelt wird.</span><span class="sxs-lookup"><span data-stu-id="16cdf-191">Verify that outbound internet traffic is force-tunneled correctly.</span></span> <span data-ttu-id="16cdf-192">Wenn Sie eine VPN-Verbindung mit dem [Routing- und RAS-Dienst][routing-and-remote-access-service] auf einem lokalen Server verwenden, setzen Sie ein Tool wie [WireShark][wireshark] oder [Microsoft Message Analyzer](https://www.microsoft.com/download/details.aspx?id=44226) ein.</span><span class="sxs-lookup"><span data-stu-id="16cdf-192">If you're using a VPN connection with the [routing and remote access service][routing-and-remote-access-service] on an on-premises server, use a tool such as [WireShark][wireshark] or [Microsoft Message Analyzer](https://www.microsoft.com/download/details.aspx?id=44226).</span></span>

### <a name="management-subnet-recommendations"></a><span data-ttu-id="16cdf-193">Empfehlungen für das Verwaltungssubnetz</span><span class="sxs-lookup"><span data-stu-id="16cdf-193">Management subnet recommendations</span></span>

<span data-ttu-id="16cdf-194">Das Verwaltungssubnetz enthält eine Jumpbox, die Verwaltungs- und Überwachungsfunktionen ausführt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-194">The management subnet contains a jumpbox that performs management and monitoring functionality.</span></span> <span data-ttu-id="16cdf-195">Schränken Sie die Ausführung aller sicheren Verwaltungsaufgaben auf die Jumpbox ein.</span><span class="sxs-lookup"><span data-stu-id="16cdf-195">Restrict execution of all secure management tasks to the jumpbox.</span></span>

<span data-ttu-id="16cdf-196">Erstellen Sie für die Jumpbox keine öffentliche IP-Adresse.</span><span class="sxs-lookup"><span data-stu-id="16cdf-196">Do not create a public IP address for the jumpbox.</span></span> <span data-ttu-id="16cdf-197">Erstellen Sie stattdessen eine Route für den Zugriff auf die Jumpbox durch das Eingangsgateway.</span><span class="sxs-lookup"><span data-stu-id="16cdf-197">Instead, create one route to access the jumpbox through the incoming gateway.</span></span> <span data-ttu-id="16cdf-198">Erstellen Sie NSG-Regeln, damit das Verwaltungssubnetz nur auf Anforderungen von der zugelassenen Route reagiert.</span><span class="sxs-lookup"><span data-stu-id="16cdf-198">Create NSG rules so the management subnet only responds to requests from the allowed route.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="16cdf-199">Überlegungen zur Skalierbarkeit</span><span class="sxs-lookup"><span data-stu-id="16cdf-199">Scalability considerations</span></span>

<span data-ttu-id="16cdf-200">Die Referenzarchitektur verwendet ein Lastenausgleichsmodul, um lokalen Netzwerkverkehr zu einem Pool von NVA-Geräten zu leiten, die das Routen des Verkehrs übernehmen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-200">The reference architecture uses a load balancer to direct on-premises network traffic to a pool of NVA devices, which route the traffic.</span></span> <span data-ttu-id="16cdf-201">Die NVAs sind in einer [Verfügbarkeitsgruppe][availability-set] platziert.</span><span class="sxs-lookup"><span data-stu-id="16cdf-201">The NVAs are placed in an [availability set][availability-set].</span></span> <span data-ttu-id="16cdf-202">Diese Auslegung ermöglicht es Ihnen, den Durchsatz der NVAs im zeitlichen Ablauf zu überwachen, und als Reaktion auf einen Anstieg der Last NVA-Geräte hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-202">This design allows you to monitor the throughput of the NVAs over time and add NVA devices in response to increases in load.</span></span>

<span data-ttu-id="16cdf-203">Das SKU-VPN-Standardgateway unterstützt den anhaltenden Durchsatz von bis zu 100 Mbit/s.</span><span class="sxs-lookup"><span data-stu-id="16cdf-203">The standard SKU VPN gateway supports sustained throughput of up to 100 Mbps.</span></span> <span data-ttu-id="16cdf-204">Die SKU für hohe Leistung bietet bis zu 200 Mbit/s.</span><span class="sxs-lookup"><span data-stu-id="16cdf-204">The High Performance SKU provides up to 200 Mbps.</span></span> <span data-ttu-id="16cdf-205">Für größere Bandbreiten können Sie das Upgrade auf ein ExpressRoute-Gateway in Erwägung ziehen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-205">For higher bandwidths, consider upgrading to an ExpressRoute gateway.</span></span> <span data-ttu-id="16cdf-206">ExpressRoute stellt bis zu 10 Gb/s Bandbreite mit geringerer Latenz als eine VPN-Verbindung zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="16cdf-206">ExpressRoute provides up to 10 Gbps bandwidth with lower latency than a VPN connection.</span></span>

<span data-ttu-id="16cdf-207">Weitere Informationen zur Skalierbarkeit von Azure-Gateways finden Sie im Abschnitt mit den Überlegungen zur Skalierbarkeit in [Implementieren einer sicheren Hybrid-Netzwerkarchitektur mit Azure und lokalem VPN][guidance-vpn-gateway-scalability] und [Implementieren einer Hybrid-Netzwerkarchitektur mit Azure ExpressRoute][guidance-expressroute-scalability].</span><span class="sxs-lookup"><span data-stu-id="16cdf-207">For more information about the scalability of Azure gateways, see the scalability consideration section in [Implementing a hybrid network architecture with Azure and on-premises VPN][guidance-vpn-gateway-scalability] and [Implementing a hybrid network architecture with Azure ExpressRoute][guidance-expressroute-scalability].</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="16cdf-208">Überlegungen zur Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="16cdf-208">Availability considerations</span></span>

<span data-ttu-id="16cdf-209">Wie bereits erwähnt, verwendet die Referenzarchitektur einen Pool von NVA-Geräten hinter einem Lastenausgleichsmodul.</span><span class="sxs-lookup"><span data-stu-id="16cdf-209">As mentioned, the reference architecture uses a pool of NVA devices behind a load balancer.</span></span> <span data-ttu-id="16cdf-210">Das Lastenausgleichsmodul verwendet eine Integritätssonde zum Überwachen der einzelnen NVA und entfernt alle nicht reagierenden NVAs aus dem Pool.</span><span class="sxs-lookup"><span data-stu-id="16cdf-210">The load balancer uses a health probe to monitor each NVA and will remove any unresponsive NVAs from the pool.</span></span>

<span data-ttu-id="16cdf-211">Wenn Sie Azure ExpressRoute verwenden, um Konnektivität zwischen dem VNet und dem lokalen Netzwerk bereitzustellen, [konfigurieren Sie ein VPN-Gateway zum Bereitstellen von Failover][ra-vpn-failover] für den Fall, dass die ExpressRoute-Verbindung nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="16cdf-211">If you're using Azure ExpressRoute to provide connectivity between the VNet and on-premises network, [configure a VPN gateway to provide failover][ra-vpn-failover] if the ExpressRoute connection becomes unavailable.</span></span>

<span data-ttu-id="16cdf-212">Spezifische Informationen zum Aufrechterhalten der Verfügbarkeit von VPN- und ExpressRoute-Verbindungen finden Sie in den Überlegungen zur Verfügbarkeit in [Implementieren einer sicheren Hybrid-Netzwerkarchitektur mit Azure und lokalem VPN][guidance-vpn-gateway-availability] und [Implementieren einer Hybrid-Netzwerkarchitektur mit Azure ExpressRoute][guidance-expressroute-availability].</span><span class="sxs-lookup"><span data-stu-id="16cdf-212">For specific information on maintaining availability for VPN and ExpressRoute connections, see the availability considerations in [Implementing a hybrid network architecture with Azure and on-premises VPN][guidance-vpn-gateway-availability] and [Implementing a hybrid network architecture with Azure ExpressRoute][guidance-expressroute-availability].</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="16cdf-213">Überlegungen zur Verwaltbarkeit</span><span class="sxs-lookup"><span data-stu-id="16cdf-213">Manageability considerations</span></span>

<span data-ttu-id="16cdf-214">Die gesamte Anwendungs- und Ressourcenüberwachung sollte durch die Jumpbox im Verwaltungssubnetz erfolgen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-214">All application and resource monitoring should be performed by the jumpbox in the management subnet.</span></span> <span data-ttu-id="16cdf-215">Je nach Ihren Anwendungsanforderungen benötigen Sie möglicherweise zusätzliche Überwachungsressourcen im Verwaltungssubnetz.</span><span class="sxs-lookup"><span data-stu-id="16cdf-215">Depending on your application requirements, you may need additional monitoring resources in the management subnet.</span></span> <span data-ttu-id="16cdf-216">In diesem Fall sollte der Zugriff auf diese Ressourcen über die Jumpbox erfolgen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-216">If so, these resources should be accessed through the jumpbox.</span></span>

<span data-ttu-id="16cdf-217">Wenn keine Gatewaykonnektivität zwischen Ihrem lokalen Netzwerk und Azure besteht, können Sie weiterhin auf die Jumpbox zugreifen, indem Sie eine öffentliche IP-Adresse bereitstellen, diese der Jumpbox hinzufügen und sich dann remote über das Internet anmelden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-217">If gateway connectivity from your on-premises network to Azure is down, you can still reach the jumpbox by deploying a public IP address, adding it to the jumpbox, and remoting in from the internet.</span></span>

<span data-ttu-id="16cdf-218">Das Subnetz jeder einzelnen Schicht in der Referenzarchitektur wird durch NSG-Regeln geschützt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-218">Each tier's subnet in the reference architecture is protected by NSG rules.</span></span> <span data-ttu-id="16cdf-219">Möglicherweise müssen Sie eine Regel zum Öffnen von Port 3389 für RDP-Zugriff (Remote Desktop Protocol) auf Windows-VMs oder Port 22 für SSH-Zugriff (Secure Shell) auf Linux-VMs erstellen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-219">You may need to create a rule to open port 3389 for remote desktop protocol (RDP) access on Windows VMs or port 22 for secure shell (SSH) access on Linux VMs.</span></span> <span data-ttu-id="16cdf-220">Andere Verwaltungs- und Überwachungstools erfordern möglicherweise Regeln zum Öffnen zusätzlicher Ports.</span><span class="sxs-lookup"><span data-stu-id="16cdf-220">Other management and monitoring tools may require rules to open additional ports.</span></span>

<span data-ttu-id="16cdf-221">Wenn Sie die Konnektivität zwischen Ihrem lokalen Rechenzentrum und Azure mithilfe von ExpressRoute bereitstellen, verwenden Sie das [Azure Connectivity Toolkit (AzureCT)][azurect] für die Überwachung und Problembehandlung von Verbindungsproblemen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-221">If you're using ExpressRoute to provide the connectivity between your on-premises datacenter and Azure, use the [Azure Connectivity Toolkit (AzureCT)][azurect] to monitor and troubleshoot connection issues.</span></span>

<span data-ttu-id="16cdf-222">Sie finden weitere Informationen speziell zum Überwachen und Verwalten von VPN- und ExpressRoute-Verbindungen in den Artikeln [Implementieren einer sicheren Hybrid-Netzwerkarchitektur mit Azure und lokalem VPN][guidance-vpn-gateway-manageability] und [Implementieren einer Hybrid-Netzwerkarchitektur mit Azure ExpressRoute][guidance-expressroute-manageability].</span><span class="sxs-lookup"><span data-stu-id="16cdf-222">You can find additional information specifically aimed at monitoring and managing VPN and ExpressRoute connections in the articles [Implementing a hybrid network architecture with Azure and on-premises VPN][guidance-vpn-gateway-manageability] and [Implementing a hybrid network architecture with Azure ExpressRoute][guidance-expressroute-manageability].</span></span>

## <a name="security-considerations"></a><span data-ttu-id="16cdf-223">Sicherheitshinweise</span><span class="sxs-lookup"><span data-stu-id="16cdf-223">Security considerations</span></span>

<span data-ttu-id="16cdf-224">Diese Referenzarchitektur implementiert mehrere Sicherheitsebenen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-224">This reference architecture implements multiple levels of security.</span></span>

### <a name="routing-all-on-premises-user-requests-through-the-nva"></a><span data-ttu-id="16cdf-225">Routen aller lokalen Benutzeranforderungen durch das NVA</span><span class="sxs-lookup"><span data-stu-id="16cdf-225">Routing all on-premises user requests through the NVA</span></span>

<span data-ttu-id="16cdf-226">Die UDR im Gatewaysubnetz blockiert alle Benutzeranfragen, die nicht aus dem lokalen Netzwerk stammen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-226">The UDR in the gateway subnet blocks all user requests other than those received from on-premises.</span></span> <span data-ttu-id="16cdf-227">Die UDR leitet zulässige Anfragen an die NVAs im privaten DMZ-Subnetz weiter, und diese Anfragen werden an die Anforderungen weitergeleitet, wenn sie aufgrund der NVA-Regeln zugelassen werden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-227">The UDR passes allowed requests to the NVAs in the private DMZ subnet, and these requests are passed on to the application if they are allowed by the NVA rules.</span></span> <span data-ttu-id="16cdf-228">Sie können der UDR andere Routen hinzufügen, achten Sie jedoch darauf, dass die NVAs nicht unabsichtlich umgangen werden und Verwaltungsdatenverkehr für das Verwaltungssubnetz dadurch nicht blockiert wird.</span><span class="sxs-lookup"><span data-stu-id="16cdf-228">You can add other routes to the UDR, but make sure they don't inadvertently bypass the NVAs or block administrative traffic intended for the management subnet.</span></span>

<span data-ttu-id="16cdf-229">Das Lastenausgleichsmodul vor den NVAs fungiert außerdem als Sicherheitsgerät, indem Datenverkehr an Ports ignoriert wird, die in den Regeln für den Lastenausgleich nicht als offen definiert sind.</span><span class="sxs-lookup"><span data-stu-id="16cdf-229">The load balancer in front of the NVAs also acts as a security device by ignoring traffic on ports that are not open in the load balancing rules.</span></span> <span data-ttu-id="16cdf-230">Die Lastenausgleichsmodule in der Referenzarchitektur lauschen nur auf HTTP-Anforderungen an Port 80 und auf HTTPS-Anforderungen an Port 443.</span><span class="sxs-lookup"><span data-stu-id="16cdf-230">The load balancers in the reference architecture only listen for HTTP requests on port 80 and HTTPS requests on port 443.</span></span> <span data-ttu-id="16cdf-231">Dokumentieren Sie alle zusätzlichen Regeln, die Sie den Lastenausgleichsmodulen hinzufügen, und überwachen Sie den Datenverkehr, um sicherzustellen, dass keine Sicherheitsprobleme vorliegen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-231">Document any additional rules that you add to the load balancers, and monitor traffic to ensure there are no security issues.</span></span>

### <a name="using-nsgs-to-blockpass-traffic-between-application-tiers"></a><span data-ttu-id="16cdf-232">Verwenden Sie NSGs, um den Datenverkehr zwischen Logikschichten zu blockieren/übergeben</span><span class="sxs-lookup"><span data-stu-id="16cdf-232">Using NSGs to block/pass traffic between application tiers</span></span>

<span data-ttu-id="16cdf-233">Der Datenverkehr zwischen den Schichten wird mithilfe von NSGs eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-233">Traffic between tiers is restricted by using NSGs.</span></span> <span data-ttu-id="16cdf-234">Die Geschäftsschicht blockiert jeglichen Verkehr, der nicht aus der Webschicht stammt, und die Datenschicht blockiert jeglichen Verkehr, der nicht aus der Geschäftsschicht stammt.</span><span class="sxs-lookup"><span data-stu-id="16cdf-234">The business tier blocks all traffic that doesn't originate in the web tier, and the data tier blocks all traffic that doesn't originate in the business tier.</span></span> <span data-ttu-id="16cdf-235">Wenn bei Ihnen das Erfordernis besteht, die NSG-Regeln zu erweitern, um einen breiteren Zugriff auf diese Schichten zuzulassen, wägen Sie diese Erfordernisse gegen die Sicherheitsrisiken ab.</span><span class="sxs-lookup"><span data-stu-id="16cdf-235">If you have a requirement to expand the NSG rules to allow broader access to these tiers, weigh these requirements against the security risks.</span></span> <span data-ttu-id="16cdf-236">Jeder neue eingehende Kommunikationsweg stellt eine Gelegenheit für die zufällige oder absichtliche Offenlegung von Daten oder Beschädigung von Anwendungen dar.</span><span class="sxs-lookup"><span data-stu-id="16cdf-236">Each new inbound pathway represents an opportunity for accidental or purposeful data leakage or application damage.</span></span>

### <a name="devops-access"></a><span data-ttu-id="16cdf-237">DevOps-Zugriff</span><span class="sxs-lookup"><span data-stu-id="16cdf-237">DevOps access</span></span>

<span data-ttu-id="16cdf-238">Verwenden Sie [RBAC][rbac], um die Vorgänge einzuschränken, die DevOps in den einzelnen Schichten ausführen können.</span><span class="sxs-lookup"><span data-stu-id="16cdf-238">Use [RBAC][rbac] to restrict the operations that DevOps can perform on each tier.</span></span> <span data-ttu-id="16cdf-239">Verwenden Sie beim Erteilen von Berechtigungen den [Ansatz der geringsten Rechte][security-principle-of-least-privilege].</span><span class="sxs-lookup"><span data-stu-id="16cdf-239">When granting permissions, use the [principle of least privilege][security-principle-of-least-privilege].</span></span> <span data-ttu-id="16cdf-240">Protokollieren Sie alle Verwaltungsvorgänge, und führen Sie regelmäßig Überwachungen durch, um sicherzustellen, dass alle Konfigurationsänderungen auf Planung beruhen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-240">Log all administrative operations and perform regular audits to ensure any configuration changes were planned.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="16cdf-241">Bereitstellen der Lösung</span><span class="sxs-lookup"><span data-stu-id="16cdf-241">Deploy the solution</span></span>

<span data-ttu-id="16cdf-242">Eine Bereitstellung für eine Referenzarchitektur, die diese Empfehlungen implementiert, steht auf [GitHub][github-folder] zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="16cdf-242">A deployment for a reference architecture that implements these recommendations is available on [GitHub][github-folder].</span></span>

### <a name="prerequisites"></a><span data-ttu-id="16cdf-243">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="16cdf-243">Prerequisites</span></span>

[!INCLUDE [ref-arch-prerequisites.md](../../../includes/ref-arch-prerequisites.md)]

### <a name="deploy-resources"></a><span data-ttu-id="16cdf-244">Bereitstellen von Ressourcen</span><span class="sxs-lookup"><span data-stu-id="16cdf-244">Deploy resources</span></span>

1. <span data-ttu-id="16cdf-245">Navigieren Sie zum Ordner `/dmz/secure-vnet-hybrid` des GitHub-Repositorys für Referenzarchitekturen.</span><span class="sxs-lookup"><span data-stu-id="16cdf-245">Navigate to the `/dmz/secure-vnet-hybrid` folder of the reference architectures GitHub repository.</span></span>

2. <span data-ttu-id="16cdf-246">Führen Sie den folgenden Befehl aus:</span><span class="sxs-lookup"><span data-stu-id="16cdf-246">Run the following command:</span></span>

    ```bash
    azbb -s <subscription_id> -g <resource_group_name> -l <region> -p onprem.json --deploy
    ```

3. <span data-ttu-id="16cdf-247">Führen Sie den folgenden Befehl aus:</span><span class="sxs-lookup"><span data-stu-id="16cdf-247">Run the following command:</span></span>

    ```bash
    azbb -s <subscription_id> -g <resource_group_name> -l <region> -p secure-vnet-hybrid.json --deploy
    ```

### <a name="connect-the-on-premises-and-azure-gateways"></a><span data-ttu-id="16cdf-248">Verbinden der lokalen und der Azure-Gateways</span><span class="sxs-lookup"><span data-stu-id="16cdf-248">Connect the on-premises and Azure gateways</span></span>

<span data-ttu-id="16cdf-249">In diesem Schritt verbinden Sie die zwei Gateways des lokalen Netzwerks.</span><span class="sxs-lookup"><span data-stu-id="16cdf-249">In this step, you will connect the two local network gateways.</span></span>

1. <span data-ttu-id="16cdf-250">Navigieren Sie im Azure-Portal zu der Ressourcengruppe, die Sie erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="16cdf-250">In the Azure Portal, navigate to the resource group that you created.</span></span>

2. <span data-ttu-id="16cdf-251">Suchen Sie nach der Ressource mit dem Namen `ra-vpn-vgw-pip`, und kopieren Sie die auf dem Blatt **Übersicht** angezeigte IP-Adresse.</span><span class="sxs-lookup"><span data-stu-id="16cdf-251">Find the resource named `ra-vpn-vgw-pip` and copy the IP address shown in the **Overview** blade.</span></span>

3. <span data-ttu-id="16cdf-252">Suchen Sie nach der Ressource mit dem Namen `onprem-vpn-lgw`.</span><span class="sxs-lookup"><span data-stu-id="16cdf-252">Find the resource named `onprem-vpn-lgw`.</span></span>

4. <span data-ttu-id="16cdf-253">Klicken Sie auf das Blatt **Konfiguration**.</span><span class="sxs-lookup"><span data-stu-id="16cdf-253">Click the **Configuration** blade.</span></span> <span data-ttu-id="16cdf-254">Fügen Sie unter **IP-Adresse** die IP-Adresse aus Schritt 2 ein.</span><span class="sxs-lookup"><span data-stu-id="16cdf-254">Under **IP address**, paste in the IP address from step 2.</span></span>

    ![Screenshot des Felds für die IP-Adresse](./images/local-net-gw.png)

5. <span data-ttu-id="16cdf-256">Klicken Sie auf **Speichern**, und warten Sie, bis der Vorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="16cdf-256">Click **Save** and wait for the operation to complete.</span></span> <span data-ttu-id="16cdf-257">Dies dauert etwa fünf Minuten.</span><span class="sxs-lookup"><span data-stu-id="16cdf-257">It can take about 5 minutes.</span></span>

6. <span data-ttu-id="16cdf-258">Suchen Sie nach der Ressource mit dem Namen `onprem-vpn-gateway1-pip`.</span><span class="sxs-lookup"><span data-stu-id="16cdf-258">Find the resource named `onprem-vpn-gateway1-pip`.</span></span> <span data-ttu-id="16cdf-259">Kopieren Sie die auf dem Blatt **Übersicht** angezeigte IP-Adresse.</span><span class="sxs-lookup"><span data-stu-id="16cdf-259">Copy the IP address shown in the **Overview** blade.</span></span>

7. <span data-ttu-id="16cdf-260">Suchen Sie nach der Ressource mit dem Namen `ra-vpn-lgw`.</span><span class="sxs-lookup"><span data-stu-id="16cdf-260">Find the resource named `ra-vpn-lgw`.</span></span>

8. <span data-ttu-id="16cdf-261">Klicken Sie auf das Blatt **Konfiguration**.</span><span class="sxs-lookup"><span data-stu-id="16cdf-261">Click the **Configuration** blade.</span></span> <span data-ttu-id="16cdf-262">Fügen Sie unter **IP-Adresse** die IP-Adresse aus Schritt 6 ein.</span><span class="sxs-lookup"><span data-stu-id="16cdf-262">Under **IP address**, paste in the IP address from step 6.</span></span>

9. <span data-ttu-id="16cdf-263">Klicken Sie auf **Speichern**, und warten Sie, bis der Vorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="16cdf-263">Click **Save** and wait for the operation to complete.</span></span>

10. <span data-ttu-id="16cdf-264">Zum Überprüfen der Verbindung rufen Sie das Blatt **Verbindungen** für jedes Gateway auf.</span><span class="sxs-lookup"><span data-stu-id="16cdf-264">To verify the connection, go to the **Connections** blade for each gateway.</span></span> <span data-ttu-id="16cdf-265">Der Status sollte **Verbunden** lauten.</span><span class="sxs-lookup"><span data-stu-id="16cdf-265">The status should be **Connected**.</span></span>

### <a name="verify-that-network-traffic-reaches-the-web-tier"></a><span data-ttu-id="16cdf-266">Sicherstellen, dass Netzwerkdatenverkehr die Webebene erreicht</span><span class="sxs-lookup"><span data-stu-id="16cdf-266">Verify that network traffic reaches the web tier</span></span>

1. <span data-ttu-id="16cdf-267">Navigieren Sie im Azure-Portal zu der Ressourcengruppe, die Sie erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="16cdf-267">In the Azure Portal, navigate to the resource group that you created.</span></span>

2. <span data-ttu-id="16cdf-268">Suchen Sie nach der Ressource mit dem Namen `int-dmz-lb`, d.h. dem Lastenausgleich vor der privaten DMZ.</span><span class="sxs-lookup"><span data-stu-id="16cdf-268">Find the resource named `int-dmz-lb`, which is the load balancer in front of the private DMZ.</span></span> <span data-ttu-id="16cdf-269">Kopieren Sie die private IP-Adresse aus dem Blatt **Übersicht**.</span><span class="sxs-lookup"><span data-stu-id="16cdf-269">Copy the private IP address from the **Overview** blade.</span></span>

3. <span data-ttu-id="16cdf-270">Suchen Sie den virtuellen Computer mit dem Namen `jb-vm1`.</span><span class="sxs-lookup"><span data-stu-id="16cdf-270">Find the VM named `jb-vm1`.</span></span> <span data-ttu-id="16cdf-271">Klicken Sie auf **Verbinden**, und stellen Sie über Remotedesktop eine Verbindung zum virtuellen Computer her.</span><span class="sxs-lookup"><span data-stu-id="16cdf-271">Click **Connect** and use Remote Desktop to connect to the VM.</span></span> <span data-ttu-id="16cdf-272">Der Benutzername und das Kennwort sind in der Datei „onprem.json“ angegeben.</span><span class="sxs-lookup"><span data-stu-id="16cdf-272">The user name and password are specified in the onprem.json file.</span></span>

4. <span data-ttu-id="16cdf-273">Öffnen Sie in der Remotedesktopsitzung einen Webbrowser, und navigieren Sie zur IP-Adresse aus Schritt 2.</span><span class="sxs-lookup"><span data-stu-id="16cdf-273">From the Remote Desktop Session, open a web browser and navigate to the IP address from step 2.</span></span> <span data-ttu-id="16cdf-274">Daraufhin sollte die standardmäßige Apache2-Serverhomepage angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="16cdf-274">You should see the default Apache2 server home page.</span></span>

## <a name="next-steps"></a><span data-ttu-id="16cdf-275">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="16cdf-275">Next steps</span></span>

- <span data-ttu-id="16cdf-276">Erfahren Sie, wie Sie eine [DMZ zwischen Azure und dem Internet](./secure-vnet-dmz.md) implementieren.</span><span class="sxs-lookup"><span data-stu-id="16cdf-276">Learn how to implement a [DMZ between Azure and the Internet](./secure-vnet-dmz.md).</span></span>
- <span data-ttu-id="16cdf-277">Erfahren Sie, wie Sie eine [hoch verfügbare Hybrid-Netzwerkarchitektur][ra-vpn-failover] implementieren.</span><span class="sxs-lookup"><span data-stu-id="16cdf-277">Learn how to implement a [highly available hybrid network architecture][ra-vpn-failover].</span></span>
- <span data-ttu-id="16cdf-278">Weitere Informationen zum Verwalten der Netzwerksicherheit mit Azure finden Sie unter [Microsoft-Clouddienste und Netzwerksicherheit][cloud-services-network-security].</span><span class="sxs-lookup"><span data-stu-id="16cdf-278">For more information about managing network security with Azure, see [Microsoft cloud services and network security][cloud-services-network-security].</span></span>
- <span data-ttu-id="16cdf-279">Ausführliche Informationen über den Schutz von Ressourcen in Azure finden Sie unter [Erste Schritte mit Microsoft Azure-Sicherheit][getting-started-with-azure-security].</span><span class="sxs-lookup"><span data-stu-id="16cdf-279">For detailed information about protecting resources in Azure, see [Getting started with Microsoft Azure security][getting-started-with-azure-security].</span></span>
- <span data-ttu-id="16cdf-280">Weitere Details zur Behandlung von Sicherheitsrisiken über Azure-Gatewayverbindungen finden Sie unter [Implementieren einer sicheren Hybrid-Netzwerkarchitektur mit Azure und lokalem VPN][guidance-vpn-gateway-security] und [Implementieren einer Hybrid-Netzwerkarchitektur mit Azure ExpressRoute][guidance-expressroute-security].</span><span class="sxs-lookup"><span data-stu-id="16cdf-280">For additional details on addressing security concerns across an Azure gateway connection, see [Implementing a hybrid network architecture with Azure and on-premises VPN][guidance-vpn-gateway-security] and [Implementing a hybrid network architecture with Azure ExpressRoute][guidance-expressroute-security].</span></span>
- [<span data-ttu-id="16cdf-281">Behandeln von Problemen mit virtuellen Netzwerkappliances in Azure</span><span class="sxs-lookup"><span data-stu-id="16cdf-281">Troubleshoot network virtual appliance issues in Azure</span></span>](/azure/virtual-network/virtual-network-troubleshoot-nva)

<!-- links -->

[availability-set]: /azure/virtual-machines/virtual-machines-windows-create-availability-set
[azurect]: https://github.com/Azure/NetworkMonitoring/tree/master/AzureCT
[azure-forced-tunneling]: https://azure.microsoft.com/en-gb/documentation/articles/vpn-gateway-forced-tunneling-rm/
[azure-marketplace-nva]: https://azuremarketplace.microsoft.com/marketplace/apps/category/networking
[cloud-services-network-security]: /azure/best-practices-network-security
[getting-started-with-azure-security]: /azure/security/azure-security-getting-started
[github-folder]: https://github.com/mspnp/reference-architectures/tree/master/dmz/secure-vnet-hybrid
[guidance-expressroute]: ../hybrid-networking/expressroute.md
[guidance-expressroute-availability]: ../hybrid-networking/expressroute.md#availability-considerations
[guidance-expressroute-manageability]: ../hybrid-networking/expressroute.md#manageability-considerations
[guidance-expressroute-security]: ../hybrid-networking/expressroute.md#security-considerations
[guidance-expressroute-scalability]: ../hybrid-networking/expressroute.md#scalability-considerations
[guidance-vpn-gateway]: ../hybrid-networking/vpn.md
[guidance-vpn-gateway-availability]: ../hybrid-networking/vpn.md#availability-considerations
[guidance-vpn-gateway-manageability]: ../hybrid-networking/vpn.md#manageability-considerations
[guidance-vpn-gateway-scalability]: ../hybrid-networking/vpn.md#scalability-considerations
[guidance-vpn-gateway-security]: ../hybrid-networking/vpn.md#security-considerations
[ip-forwarding]: /azure/virtual-network/virtual-networks-udr-overview#ip-forwarding
[ra-expressroute]: ../hybrid-networking/expressroute.md
[ra-n-tier]: ../virtual-machines-windows/n-tier.md
[ra-vpn]: ../hybrid-networking/vpn.md
[ra-vpn-failover]: ../hybrid-networking/expressroute-vpn-failover.md
[rbac]: /azure/active-directory/role-based-access-control-configure
[rbac-custom-roles]: /azure/active-directory/role-based-access-control-custom-roles
[routing-and-remote-access-service]: https://technet.microsoft.com/library/dd469790(v=ws.11).aspx
[security-principle-of-least-privilege]: https://msdn.microsoft.com/library/hdb58b2f(v=vs.110).aspx#Anchor_1
[udr-overview]: /azure/virtual-network/virtual-networks-udr-overview
[visio-download]: https://archcenter.blob.core.windows.net/cdn/dmz-reference-architectures.vsdx
[wireshark]: https://www.wireshark.org/
