---
title: Echtzeitbewertung von Python-Modellen
titleSuffix: Azure Reference Architectures
description: Diese Referenzarchitektur zeigt, wie Sie Python-Modelle als Webdienste in Azure bereitstellen, um in Echtzeit Vorhersagen zu treffen.
author: msalvaris
ms.date: 01/28/2019
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: azcat-ai
ms.openlocfilehash: ba2d9a295e5a231f0ffca9e3cf2d53ace4deddfe
ms.sourcegitcommit: 1ee873aaf40010eb2a38314ac56974bc9e227736
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 01/28/2019
ms.locfileid: "55141027"
---
# <a name="real-time-scoring-of-python-scikit-learn-and-deep-learning-models-on-azure"></a><span data-ttu-id="a1624-103">Echtzeitbewertung von Python-Modellen (Scikit-learn) und Deep Learning-Modellen in Azure</span><span class="sxs-lookup"><span data-stu-id="a1624-103">Real-time scoring of Python Scikit-Learn and deep learning models on Azure</span></span>

<span data-ttu-id="a1624-104">Diese Referenzarchitektur zeigt, wie Sie Python-Modelle als Webdienste bereitstellen, um mithilfe von Azure Machine Learning Service in Echtzeit Vorhersagen zu treffen.</span><span class="sxs-lookup"><span data-stu-id="a1624-104">This reference architecture shows how to deploy Python models as web services to make real-time predictions using the Azure Machine Learning service.</span></span> <span data-ttu-id="a1624-105">In diesem Artikel werden zwei Szenarien behandelt: die Bereitstellung von regulären Python-Modellen und die spezifischen Anforderungen der Bereitstellung von Deep Learning-Modellen.</span><span class="sxs-lookup"><span data-stu-id="a1624-105">Two scenarios are covered: deploying regular Python models, and the specific requirements of deploying deep learning models.</span></span> <span data-ttu-id="a1624-106">Für beide Szenarien wird die hier dargestellte Architektur verwendet.</span><span class="sxs-lookup"><span data-stu-id="a1624-106">Both scenarios use the architecture shown.</span></span>

<span data-ttu-id="a1624-107">Auf GitHub sind zwei Referenzimplementierungen für diese Architektur verfügbar – eine für [reguläre Python-Modelle][github-python] und eine für [Deep Learning-Modelle][github-dl].</span><span class="sxs-lookup"><span data-stu-id="a1624-107">Two reference implementations for this architecture are available on GitHub, one for [regular Python models][github-python] and one for [deep learning models][github-dl].</span></span>

![Architekturdiagramm für die Echtzeitbewertung von Python-Modellen in Azure](./_images/python-model-architecture.png)

## <a name="scenarios"></a><span data-ttu-id="a1624-109">Szenarien</span><span class="sxs-lookup"><span data-stu-id="a1624-109">Scenarios</span></span>

<span data-ttu-id="a1624-110">Die Referenzimplementierungen veranschaulichen zwei Szenarien, in denen diese Architektur verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="a1624-110">The reference implementations demonstrate two scenarios using this architecture.</span></span>

<span data-ttu-id="a1624-111">**Szenario 1: Abgleich von häufig gestellten Fragen (FAQ):**</span><span class="sxs-lookup"><span data-stu-id="a1624-111">**Scenario 1: FAQ matching**.</span></span> <span data-ttu-id="a1624-112">Dieses Szenario zeigt, wie Sie ein Modell zum Abgleichen von häufig gestellten Fragen (FAQ) als Webdienst bereitstellen, um die Fragen von Benutzern vorherzusagen.</span><span class="sxs-lookup"><span data-stu-id="a1624-112">This scenario shows how to deploy a frequently asked questions (FAQ) matching model as a web service to provide predictions for user questions.</span></span> <span data-ttu-id="a1624-113">In diesem Szenario bezieht sich der Begriff „Eingabedaten“ im Architekturdiagramm auf Textzeichenfolgen mit Fragen von Benutzern, die mit einer Liste von häufig gestellten Fragen abgeglichen werden.</span><span class="sxs-lookup"><span data-stu-id="a1624-113">For this scenario, "Input Data" in the architecture diagram refers to text strings containing user questions to match with a list of FAQs.</span></span> <span data-ttu-id="a1624-114">Dieses Szenario ist für die [scikit-learn][scikit]-Bibliothek für maschinelles Lernen für Python konzipiert, es kann jedoch für beliebige Szenarien mit Python-Modellen generalisiert werden, um in Echtzeit Vorhersagen zu treffen.</span><span class="sxs-lookup"><span data-stu-id="a1624-114">This scenario is designed for the [scikit-learn][scikit] machine learning library for Python, but can be generalized to any scenario that uses Python models to make real-time predictions.</span></span>

<span data-ttu-id="a1624-115">In diesem Szenario wird eine Teilmenge der Stack Overflow-Fragedaten verwendet, die die ursprünglichen Fragen (als JavaScript markiert), die zugehörigen doppelten Fragen und Antworten umfasst.</span><span class="sxs-lookup"><span data-stu-id="a1624-115">This scenario uses a subset of Stack Overflow question data that includes original questions tagged as JavaScript, their duplicate questions, and their answers.</span></span> <span data-ttu-id="a1624-116">Das Szenario trainiert eine scikit-learn-Pipeline zum Vorhersagen der Übereinstimmungswahrscheinlichkeit einer doppelten Frage mit den einzelnen ursprünglichen Fragen.</span><span class="sxs-lookup"><span data-stu-id="a1624-116">It trains a scikit-learn pipeline to predict the match probability of a duplicate question with each of the original questions.</span></span> <span data-ttu-id="a1624-117">Diese Vorhersagen werden in Echtzeit mithilfe eines REST-API-Endpunkts getroffen.</span><span class="sxs-lookup"><span data-stu-id="a1624-117">These predictions are made in real time using a REST API endpoint.</span></span>

<span data-ttu-id="a1624-118">Der Anwendungsfluss für diese Architektur sieht wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="a1624-118">The application flow for this architecture is as follows:</span></span>

1. <span data-ttu-id="a1624-119">Das trainierte Modell wird in der Machine Learning-Modellregistrierung registriert.</span><span class="sxs-lookup"><span data-stu-id="a1624-119">The trained model is registered to the Machine Learning model registry.</span></span>
2. <span data-ttu-id="a1624-120">Machine Learning Service erstellt ein Docker-Image, das das Modell und das Bewertungsskript enthält.</span><span class="sxs-lookup"><span data-stu-id="a1624-120">The Machine Learning service creates a Docker image that includes the model and scoring script.</span></span>
3. <span data-ttu-id="a1624-121">Machine Learning stellt das Bewertungsbild in Azure Kubernetes Service (AKS) als Webdienst bereit.</span><span class="sxs-lookup"><span data-stu-id="a1624-121">Machine Learning deploys the scoring image on Azure Kubernetes Service (AKS) as a web service.</span></span>
4. <span data-ttu-id="a1624-122">Der Client sendet eine HTTP-POST-Anforderung mit den codierten Fragedaten.</span><span class="sxs-lookup"><span data-stu-id="a1624-122">The client sends an HTTP POST request with the encoded question data.</span></span>
5. <span data-ttu-id="a1624-123">Der von Machine Learning erstellte Webdienst extrahiert die Frage aus der Anforderung.</span><span class="sxs-lookup"><span data-stu-id="a1624-123">The web service created by Machine Learning extracts the question from the request.</span></span>
6. <span data-ttu-id="a1624-124">Die Frage wird zur Featurebereitstellung und Bewertung an das Scikit-learn-Pipelinemodell gesendet.</span><span class="sxs-lookup"><span data-stu-id="a1624-124">The question is sent to the Scikit-learn pipeline model for featurization and scoring.</span></span> 
7. <span data-ttu-id="a1624-125">Die übereinstimmenden häufig gestellten Fragen und die zugehörigen Bewertungen werden an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="a1624-125">The matching FAQ questions with their scores are returned to the client.</span></span>

<span data-ttu-id="a1624-126">Hier sehen Sie einen Screenshot der Beispiel-App, die die Ergebnisse nutzt:</span><span class="sxs-lookup"><span data-stu-id="a1624-126">Here is a screenshot of the example app that consumes the results:</span></span>

![Screenshot der Beispiel-App](./_images/python-faq-matches.png)

<span data-ttu-id="a1624-128">**Szenario 2: Bildklassifizierung:**</span><span class="sxs-lookup"><span data-stu-id="a1624-128">**Scenario 2: Image classification**.</span></span> <span data-ttu-id="a1624-129">Dieses Szenario zeigt, wie Sie ein Modell für ein künstliches neuronales Netzwerk (Convolutional Neural Network, CNN) als Webdienst bereitstellen, um Vorhersagen für Bilder zu generieren.</span><span class="sxs-lookup"><span data-stu-id="a1624-129">This scenario shows how to deploy a Convolutional Neural Network (CNN) model as a web service to provide predictions on images.</span></span> <span data-ttu-id="a1624-130">In diesem Szenario bezieht sich der Begriff „Eingabedaten“ im Architekturdiagramm auf Bilddateien.</span><span class="sxs-lookup"><span data-stu-id="a1624-130">For this scenario, "Input Data" in the architecture diagram refers to image files.</span></span> <span data-ttu-id="a1624-131">Für Aufgaben wie die Bildklassifizierung und Erkennung von Objekten sind CNNs eine äußerst effektive Lösung für maschinelles Sehen.</span><span class="sxs-lookup"><span data-stu-id="a1624-131">CNNs are very effective in computer vision for tasks such as image classification and object detection.</span></span> <span data-ttu-id="a1624-132">Dieses Szenario ist für die Frameworks TensorFlow, Keras (mit dem TensorFlow-Back-End) und PyTorch konzipiert.</span><span class="sxs-lookup"><span data-stu-id="a1624-132">This scenario is designed for the frameworks TensorFlow, Keras (with the TensorFlow back end), and PyTorch.</span></span> <span data-ttu-id="a1624-133">Es kann jedoch für beliebige Szenarien generalisiert werden, die mithilfe von Deep Learning-Modellen in Echtzeit Vorhersagen treffen.</span><span class="sxs-lookup"><span data-stu-id="a1624-133">However, it can be generalized to any scenario that uses deep learning models to make real-time predictions.</span></span>

<span data-ttu-id="a1624-134">In diesem Szenario wird ein für ein ImageNet-1K-Dataset (1.000 Klassen) vortrainiertes ResNet-152-Modell verwendet, um die Kategorie vorherzusagen, zu der ein Bild gehört (siehe unten stehende Abbildung).</span><span class="sxs-lookup"><span data-stu-id="a1624-134">This scenario uses a pre-trained ResNet-152 model trained on ImageNet-1K (1,000 classes) dataset to predict which category (see figure below) an image belongs to.</span></span> <span data-ttu-id="a1624-135">Diese Vorhersagen werden in Echtzeit mithilfe eines REST-API-Endpunkts getroffen.</span><span class="sxs-lookup"><span data-stu-id="a1624-135">These predictions are made in real time using a REST API endpoint.</span></span>

![Beispiel für Vorhersagen](./_images/python-example-predictions.png)

<span data-ttu-id="a1624-137">Der Anwendungsfluss für das Deep Learning-Modell sieht wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="a1624-137">The application flow for the deep learning model is as follows:</span></span>

1. <span data-ttu-id="a1624-138">Das Deep Learning-Modell wird in der Machine Learning-Modellregistrierung registriert.</span><span class="sxs-lookup"><span data-stu-id="a1624-138">The deep learning model is registered to the Machine Learning model registry.</span></span>
2. <span data-ttu-id="a1624-139">Machine Learning Service erstellt ein Docker-Image, das das Modell und das Bewertungsskript enthält.</span><span class="sxs-lookup"><span data-stu-id="a1624-139">The Machine Learning service creates a docker image including the model and scoring script.</span></span>
3. <span data-ttu-id="a1624-140">Machine Learning stellt das Bewertungsbild in Azure Kubernetes Service (AKS) als Webdienst bereit.</span><span class="sxs-lookup"><span data-stu-id="a1624-140">Machine Learning deploys the scoring image on Azure Kubernetes Service (AKS) as a web service.</span></span>
4. <span data-ttu-id="a1624-141">Der Client sendet eine HTTP-POST-Anforderung mit den codierten Bilddaten.</span><span class="sxs-lookup"><span data-stu-id="a1624-141">The client sends an HTTP POST request with the encoded image data.</span></span>
5. <span data-ttu-id="a1624-142">Der von Machine Learning erstellte Webdienst führt eine Vorverarbeitung der Bilddaten durch und sendet sie zur Bewertung an das Modell.</span><span class="sxs-lookup"><span data-stu-id="a1624-142">The web service created by Machine Learning preprocesses the image data and sends it to the model for scoring.</span></span> 
6. <span data-ttu-id="a1624-143">Die vorhergesagten Kategorien mit den zugehörigen Bewertungen werden an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="a1624-143">The predicted categories with their scores are returned to the client.</span></span>

## <a name="architecture"></a><span data-ttu-id="a1624-144">Architecture</span><span class="sxs-lookup"><span data-stu-id="a1624-144">Architecture</span></span>

<span data-ttu-id="a1624-145">Diese Architektur umfasst die folgenden Komponenten.</span><span class="sxs-lookup"><span data-stu-id="a1624-145">This architecture consists of the following components.</span></span>

<span data-ttu-id="a1624-146">**[Azure Machine Learning Service][aml]** ist ein Clouddienst, mit dem Sie Modelle für maschinelles Lernen trainieren, bereitstellen, automatisieren und verwalten und dabei von den Vorteilen der Cloud profitieren können.</span><span class="sxs-lookup"><span data-stu-id="a1624-146">**[Azure Machine Learning service][aml]** is a cloud service that is used to train, deploy, automate and manage machine learning models, all at the broad scale that the cloud provides.</span></span> <span data-ttu-id="a1624-147">Er wird in dieser Architektur zum Verwalten der Bereitstellung von Modellen sowie für die Authentifizierung, das Routing und den Lastenausgleich des Webdiensts verwendet.</span><span class="sxs-lookup"><span data-stu-id="a1624-147">It is used in this architecture to manage the deployment of models as well as authentication, routing, and load balancing of the web service.</span></span>

<span data-ttu-id="a1624-148">**[VM][vm]**.</span><span class="sxs-lookup"><span data-stu-id="a1624-148">**[Virtual machine][vm]** (VM).</span></span> <span data-ttu-id="a1624-149">Die VM dient als Beispiel für ein Gerät (lokal oder in der Cloud), das eine HTTP-Anforderung senden kann.</span><span class="sxs-lookup"><span data-stu-id="a1624-149">The VM is shown as an example of a device &mdash; local or in the cloud &mdash; that can send an HTTP request.</span></span>

<span data-ttu-id="a1624-150">**[Azure Kubernetes Service][aks]** (AKS) wird verwendet, um die Anwendung in einem Kubernetes-Cluster bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="a1624-150">**[Azure Kubernetes Service][aks]** (AKS) is used to deploy the application on a Kubernetes cluster.</span></span> <span data-ttu-id="a1624-151">AKS vereinfacht die Bereitstellung und den Betrieb von Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="a1624-151">AKS simplifies the deployment and operations of Kubernetes.</span></span> <span data-ttu-id="a1624-152">Der Cluster kann für reguläre Python-Modelle mit reinen CPU-VMs oder für Deep Learning-Modelle mit GPU-fähigen VMs konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="a1624-152">The cluster can be configured using CPU-only VMs for regular Python models or GPU-enabled VMs for deep learning models.</span></span>

<span data-ttu-id="a1624-153">**[Azure Container Registry][acr]** ermöglicht das Speichern von Bildern für alle Arten von Docker-Containerbereitstellungen, einschließlich DC/OS, Docker Swarm und Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="a1624-153">**[Azure Container Registry][acr]** enables storage of images for all types of Docker container deployments including DC/OS, Docker Swarm and Kubernetes.</span></span> <span data-ttu-id="a1624-154">Die Bewertungsbilder werden als Container in Azure Kubernetes Service bereitgestellt und zum Ausführen des Bewertungsskripts verwendet.</span><span class="sxs-lookup"><span data-stu-id="a1624-154">The scoring images are deployed as containers on Azure Kubernetes Service and used to run the scoring script.</span></span> <span data-ttu-id="a1624-155">Das hier verwendete Bild wird von Machine Learning aus dem trainierten Modell und Bewertungsskript erstellt und anschließend in Azure Container Registry gepusht.</span><span class="sxs-lookup"><span data-stu-id="a1624-155">The image used here is created by Machine Learning from the trained model and scoring script, and then is pushed to the Azure Container Registry.</span></span>

## <a name="performance-considerations"></a><span data-ttu-id="a1624-156">Überlegungen zur Leistung</span><span class="sxs-lookup"><span data-stu-id="a1624-156">Performance considerations</span></span>

<span data-ttu-id="a1624-157">Für Architekturen zur Echtzeitbewertung ist die Durchsatzleistung ein entscheidender Faktor.</span><span class="sxs-lookup"><span data-stu-id="a1624-157">For real-time scoring architectures, throughput performance becomes a dominant consideration.</span></span> <span data-ttu-id="a1624-158">Für reguläre Python-Modelle sind CPUs, die zum Bewältigen der Workload ausreichen, in der Regel akzeptabel.</span><span class="sxs-lookup"><span data-stu-id="a1624-158">For regular Python models, it's generally accepted that CPUs are sufficient to handle the workload.</span></span>

<span data-ttu-id="a1624-159">Für Deep Learning-Workloads, bei denen sich die Geschwindigkeit als Engpass erweisen kann, bieten GPUs im Allgemeinen jedoch eine bessere [Leistung][gpus-vs-cpus] als CPUs.</span><span class="sxs-lookup"><span data-stu-id="a1624-159">However for deep learning workloads, when speed is a bottleneck, GPUs generally provide better [performance][gpus-vs-cpus] compared to CPUs.</span></span> <span data-ttu-id="a1624-160">Um die GPU-Leistung mit CPUs zu erreichen, ist normalerweise ein Cluster mit einer großen Anzahl von CPUs erforderlich.</span><span class="sxs-lookup"><span data-stu-id="a1624-160">To match GPU performance using CPUs, a cluster with large number of CPUs is usually needed.</span></span>

<span data-ttu-id="a1624-161">Sie können in beiden Szenarien CPUs für diese Architektur verwenden. Für Deep Learning-Modelle bieten GPUs jedoch deutlich höhere Durchsatzwerte als ein CPU-Cluster mit vergleichbaren Kosten.</span><span class="sxs-lookup"><span data-stu-id="a1624-161">You can use CPUs for this architecture in either scenario, but for deep learning models, GPUs provide significantly higher throughput values compared to a CPU cluster of similar cost.</span></span> <span data-ttu-id="a1624-162">AKS unterstützt die Verwendung von GPUs. Dies ist einer der Vorteile, die die Verwendung von AKS für diese Architektur bietet.</span><span class="sxs-lookup"><span data-stu-id="a1624-162">AKS supports the use of GPUs, which is one advantage of using AKS for this architecture.</span></span> <span data-ttu-id="a1624-163">Zudem werden bei Deep Learning-Bereitstellungen in der Regel Modelle mit einer hohen Anzahl von Parametern verwendet.</span><span class="sxs-lookup"><span data-stu-id="a1624-163">Also, deep learning deployments typically use models with a high number of parameters.</span></span> <span data-ttu-id="a1624-164">Durch die Verwendung von GPUs werden Ressourcenkonflikte zwischen dem Modell und dem Webdienst vermieden, die bei reinen CPU-Bereitstellungen ein Problem darstellen.</span><span class="sxs-lookup"><span data-stu-id="a1624-164">Using GPUs prevents contention for resources between the model and the web service, which is an issue in CPU-only deployments.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="a1624-165">Überlegungen zur Skalierbarkeit</span><span class="sxs-lookup"><span data-stu-id="a1624-165">Scalability considerations</span></span>

<span data-ttu-id="a1624-166">Bei regulären Python-Modellen mit einer AKS-Clusterbereitstellung mit reinen CPU-VMs ist beim [Erhöhen der Anzahl von Pods][manually-scale-pods] Vorsicht geboten.</span><span class="sxs-lookup"><span data-stu-id="a1624-166">For regular Python models, where the AKS cluster is provisioned with CPU-only VMs, take care when [scaling out the number of pods][manually-scale-pods].</span></span> <span data-ttu-id="a1624-167">Das Ziel ist es, den Cluster vollständig zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="a1624-167">The goal is to fully utilize the cluster.</span></span> <span data-ttu-id="a1624-168">Die Skalierung ist von den CPU-Anforderungen und den für die Pods definierten Grenzwerten abhängig.</span><span class="sxs-lookup"><span data-stu-id="a1624-168">Scaling depends on the CPU requests and limits defined for the pods.</span></span> <span data-ttu-id="a1624-169">Machine Learning über Kubernetes unterstützt auch die [automatische Skalierung von Pods][autoscale-pods] auf Grundlage der CPU-Auslastung oder anderer Metriken.</span><span class="sxs-lookup"><span data-stu-id="a1624-169">Machine Learning through Kubernetes also supports [pod autoscaling][autoscale-pods] based on CPU utilization or other metrics.</span></span> <span data-ttu-id="a1624-170">Die [automatische Clusterskalierung][autoscaler] (Vorschauversion) kann Agent-Knoten basierend auf den ausstehenden Pods skalieren.</span><span class="sxs-lookup"><span data-stu-id="a1624-170">The [cluster autoscaler][autoscaler] (in preview) can scale agent nodes based on the pending pods.</span></span>

<span data-ttu-id="a1624-171">Für Deep Learning-Szenarien mit GPU-fähigen VMs sind die Ressourceneinschränkungen für Pods so ausgelegt, dass eine GPU einem Pod zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="a1624-171">For deep learning scenarios, using GPU-enabled VMs, resource limits on pods are such that one GPU is assigned to one pod.</span></span> <span data-ttu-id="a1624-172">Je nach verwendetem VM-Typ müssen Sie die [Knoten des Clusters skalieren][scale-cluster], um die Anforderungen für den Dienst zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="a1624-172">Depending on the type of VM used, you must [scale the nodes of the cluster][scale-cluster] to meet the demand for the service.</span></span> <span data-ttu-id="a1624-173">Dies ist mithilfe der Azure-Befehlszeilenschnittstelle (Azure CLI) und Kubectl ganz einfach möglich.</span><span class="sxs-lookup"><span data-stu-id="a1624-173">You can do this easily using the Azure CLI and kubectl.</span></span>

## <a name="monitoring-and-logging-considerations"></a><span data-ttu-id="a1624-174">Überlegungen zur Überwachung und Protokollierung</span><span class="sxs-lookup"><span data-stu-id="a1624-174">Monitoring and logging considerations</span></span>

### <a name="aks-monitoring"></a><span data-ttu-id="a1624-175">AKS-Überwachung</span><span class="sxs-lookup"><span data-stu-id="a1624-175">AKS monitoring</span></span>

<span data-ttu-id="a1624-176">Verwenden Sie das Feature [Azure Monitor für Container][monitor-containers], um Einblick in die AKS-Leistung zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a1624-176">For visibility into AKS performance, use the [Azure Monitor for containers][monitor-containers] feature.</span></span> <span data-ttu-id="a1624-177">Das Feature erfasst anhand der Metrik-API die in Kubernetes verfügbaren Speicher- und Prozessormetriken von Controllern, Knoten und Containern.</span><span class="sxs-lookup"><span data-stu-id="a1624-177">It collects memory and processor metrics from controllers, nodes, and containers that are available in Kubernetes through the Metrics API.</span></span>

<span data-ttu-id="a1624-178">Überwachen Sie während der Bereitstellung Ihrer Anwendung den AKS-Cluster, um sicherzustellen, dass er wie erwartet funktioniert, alle Knoten funktionsfähig sind und alle Pods ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="a1624-178">While deploying your application, monitor the AKS cluster to make sure it's working as expected, all the nodes are operational, and all pods are running.</span></span> <span data-ttu-id="a1624-179">Sie können den Podstatus mit dem Befehlszeilentool [Kubectl][kubectl] abrufen, Kubernetes enthält jedoch auch ein Webdashboard für die grundlegende Überwachung des Clusterstatus und Verwaltung.</span><span class="sxs-lookup"><span data-stu-id="a1624-179">Although you can use the [kubectl][kubectl] command-line tool to retrieve pod status, Kubernetes also includes a web dashboard for basic monitoring of the cluster status and management.</span></span>

![Screenshot des Kubernetes-Dashboards](./_images/python-kubernetes-dashboard.png)

<span data-ttu-id="a1624-181">Den Gesamtzustand des Clusters und der Knoten können Sie im Abschnitt **Knoten** des Kubernetes-Dashboards einsehen.</span><span class="sxs-lookup"><span data-stu-id="a1624-181">To see the overall state of the cluster and nodes, go to the **Nodes** section of the Kubernetes dashboard.</span></span> <span data-ttu-id="a1624-182">Wenn ein Knoten inaktiv oder ausgefallen ist, können Sie die Fehlerprotokolle auf dieser Seite anzeigen.</span><span class="sxs-lookup"><span data-stu-id="a1624-182">If a node is inactive or has failed, you can display the error logs from that page.</span></span> <span data-ttu-id="a1624-183">Informationen zur Anzahl von Pods und zum Status Ihrer Bereitstellung finden Sie in den Abschnitten **Pods** und **Bereitstellungen**.</span><span class="sxs-lookup"><span data-stu-id="a1624-183">Similarly, go to the **Pods** and **Deployments** sections for information about the number of pods and status of your deployment.</span></span>

### <a name="aks-logs"></a><span data-ttu-id="a1624-184">AKS-Protokolle</span><span class="sxs-lookup"><span data-stu-id="a1624-184">AKS logs</span></span>

<span data-ttu-id="a1624-185">AKS protokolliert automatisch alle stdout-/stderr-Meldungen in den Protokollen der Pods im Cluster.</span><span class="sxs-lookup"><span data-stu-id="a1624-185">AKS automatically logs all stdout/stderr to the logs of the pods in the cluster.</span></span> <span data-ttu-id="a1624-186">Verwenden Sie Kubectl, um diese Meldungen und auch Ereignisse sowie Protokolle auf Knotenebene anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="a1624-186">Use kubectl to see these and also node-level events and logs.</span></span> <span data-ttu-id="a1624-187">Ausführliche Informationen finden Sie in den Bereitstellungsschritten.</span><span class="sxs-lookup"><span data-stu-id="a1624-187">For details, see the deployment steps.</span></span>

<span data-ttu-id="a1624-188">Verwenden Sie [Azure Monitor für Container][monitor-containers], um Metriken und Protokolle über eine Containerversion des Log Analytics-Agents für Linux zu erfassen, die in Ihrem Log Analytics-Arbeitsbereich gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="a1624-188">Use [Azure Monitor for containers][monitor-containers] to collect metrics and logs through a containerized version of the Log Analytics agent for Linux, which is stored in your Log Analytics workspace.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="a1624-189">Sicherheitshinweise</span><span class="sxs-lookup"><span data-stu-id="a1624-189">Security considerations</span></span>

<span data-ttu-id="a1624-190">Verwenden Sie [Azure Security Center][security-center], um sich eine zentrale Übersicht über den Sicherheitszustand Ihrer Azure-Ressourcen zu verschaffen.</span><span class="sxs-lookup"><span data-stu-id="a1624-190">Use [Azure Security Center][security-center] to get a central view of the security state of your Azure resources.</span></span> <span data-ttu-id="a1624-191">Das Azure Security Center überwacht potenzielle Sicherheitsprobleme und bietet eine umfassende Darstellung der Sicherheitsintegrität Ihrer Bereitstellung, überwacht jedoch keine AKS-Agent-Knoten.</span><span class="sxs-lookup"><span data-stu-id="a1624-191">Security Center monitors potential security issues and provides a comprehensive picture of the security health of your deployment, although it doesn't monitor AKS agent nodes.</span></span> <span data-ttu-id="a1624-192">Security Center wird für jedes Azure-Abonnement individuell konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="a1624-192">Security Center is configured per Azure subscription.</span></span> <span data-ttu-id="a1624-193">Aktivieren Sie die Erfassung von Sicherheitsdaten wie unter [Einbinden Ihres Azure-Abonnements in Security Center Standard][get-started] beschrieben.</span><span class="sxs-lookup"><span data-stu-id="a1624-193">Enable security data collection as described in [Onboard your Azure subscription to Security Center Standard][get-started].</span></span> <span data-ttu-id="a1624-194">Nachdem die Datensammlung aktiviert wurde, durchsucht Security Center VMs automatisch, die unter diesem Abonnement erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="a1624-194">When data collection is enabled, Security Center automatically scans any VMs created under that subscription.</span></span>

<span data-ttu-id="a1624-195">**Vorgänge**.</span><span class="sxs-lookup"><span data-stu-id="a1624-195">**Operations**.</span></span> <span data-ttu-id="a1624-196">Wenn Sie sich mit Ihrem Azure Active Directory-Authentifizierungstoken (Azure AD) bei einem AKS-Cluster anmelden möchten, konfigurieren Sie AKS zur Verwendung von Azure AD für die [Benutzerauthentifizierung][aad-auth].</span><span class="sxs-lookup"><span data-stu-id="a1624-196">To sign in to an AKS cluster using your Azure Active Directory (Azure AD) authentication token, configure AKS to use Azure AD for [user authentication][aad-auth].</span></span> <span data-ttu-id="a1624-197">Clusteradministratoren können auch die rollenbasierte Zugriffssteuerung (Role-Based Access Control, RBAC) von Kubernetes auf der Grundlage einer Benutzeridentität oder Verzeichnisgruppenmitgliedschaft konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="a1624-197">Cluster administrators can also configure Kubernetes role-based access control (RBAC) based on a user's identity or directory group membership.</span></span>

<span data-ttu-id="a1624-198">Steuern Sie den Zugriff auf die von Ihnen bereitgestellten Azure-Ressourcen mit [RBAC][rbac].</span><span class="sxs-lookup"><span data-stu-id="a1624-198">Use [RBAC][rbac] to control access to the Azure resources that you deploy.</span></span> <span data-ttu-id="a1624-199">Mithilfe der RBAC können Sie Mitglieder Ihres DevOps-Teams Autorisierungsrollen zuweisen.</span><span class="sxs-lookup"><span data-stu-id="a1624-199">RBAC lets you assign authorization roles to members of your DevOps team.</span></span> <span data-ttu-id="a1624-200">Ein Benutzer kann mehreren Rollen zugewiesen werden. Außerdem können Sie für noch präzisere [Berechtigungen] benutzerdefinierte Rollen erstellen.</span><span class="sxs-lookup"><span data-stu-id="a1624-200">A user can be assigned to multiple roles, and you can create custom roles for even more fine-grained [permissions].</span></span>

<span data-ttu-id="a1624-201">**HTTPS**.</span><span class="sxs-lookup"><span data-stu-id="a1624-201">**HTTPS**.</span></span> <span data-ttu-id="a1624-202">Als bewährte Sicherheitsmethode sollte die Anwendung HTTPS erzwingen und HTTP-Anforderungen umleiten.</span><span class="sxs-lookup"><span data-stu-id="a1624-202">As a security best practice, the application should enforce HTTPS and redirect HTTP requests.</span></span> <span data-ttu-id="a1624-203">Verwenden Sie einen [Eingangscontroller][ingress-controller], um einen Reverseproxy bereitzustellen, der SSL beendet und HTTP-Anforderungen umleitet.</span><span class="sxs-lookup"><span data-stu-id="a1624-203">Use an [ingress controller][ingress-controller] to deploy a reverse proxy that terminates SSL and redirects HTTP requests.</span></span> <span data-ttu-id="a1624-204">Weitere Informationen finden Sie unter [Erstellen eines HTTPS-Eingangscontrollers in Azure Kubernetes Service (AKS)][https-ingress].</span><span class="sxs-lookup"><span data-stu-id="a1624-204">For more information, see [Create an HTTPS ingress controller on Azure Kubernetes Service (AKS)][https-ingress].</span></span>

<span data-ttu-id="a1624-205">**Authentifizierung**.</span><span class="sxs-lookup"><span data-stu-id="a1624-205">**Authentication**.</span></span> <span data-ttu-id="a1624-206">Diese Lösung beschränkt den Zugriff auf die Endpunkte nicht.</span><span class="sxs-lookup"><span data-stu-id="a1624-206">This solution doesn't restrict access to the endpoints.</span></span> <span data-ttu-id="a1624-207">Wenn Sie die Architektur in einer Unternehmensumgebung bereitstellen, sichern Sie die Endpunkte über API-Schlüssel, und fügen Sie der Clientanwendung eine Benutzerauthentifizierung hinzu.</span><span class="sxs-lookup"><span data-stu-id="a1624-207">To deploy the architecture in an enterprise setting, secure the endpoints through API keys and add some form of user authentication to the client application.</span></span>

<span data-ttu-id="a1624-208">**Containerregistrierung**.</span><span class="sxs-lookup"><span data-stu-id="a1624-208">**Container registry**.</span></span> <span data-ttu-id="a1624-209">Diese Lösung verwendet Azure Container Registry zum Speichern des Docker-Images.</span><span class="sxs-lookup"><span data-stu-id="a1624-209">This solution uses Azure Container Registry to store the Docker image.</span></span> <span data-ttu-id="a1624-210">Der Code, von dem die Anwendung abhängig ist, und das Modell sind in diesem Image enthalten.</span><span class="sxs-lookup"><span data-stu-id="a1624-210">The code that the application depends on, and the model, are contained within this image.</span></span> <span data-ttu-id="a1624-211">Unternehmensanwendungen sollten eine private Registrierung verwenden, um Schutz vor Schadsoftware bereitzustellen und zu verhindern, dass die Informationen im Container kompromittiert werden.</span><span class="sxs-lookup"><span data-stu-id="a1624-211">Enterprise applications should use a private registry to help guard against running malicious code and to help keep the information inside the container from being compromised.</span></span>

<span data-ttu-id="a1624-212">**DDoS Protection**.</span><span class="sxs-lookup"><span data-stu-id="a1624-212">**DDoS protection**.</span></span> <span data-ttu-id="a1624-213">Aktivieren Sie ggf. [Azure DDoS Protection Standard][ddos].</span><span class="sxs-lookup"><span data-stu-id="a1624-213">Consider enabling [DDoS Protection Standard][ddos].</span></span> <span data-ttu-id="a1624-214">DDoS Protection Basic wird als Teil der Azure-Plattform aktiviert. DDoS Protection Standard bietet jedoch Funktionen zur Risikominderung, die speziell für Azure Virtual Network-Ressourcen optimiert sind.</span><span class="sxs-lookup"><span data-stu-id="a1624-214">Although basic DDoS protection is enabled as part of the Azure platform, DDoS Protection Standard provides mitigation capabilities that are tuned specifically to Azure virtual network resources.</span></span>

<span data-ttu-id="a1624-215">**Protokollierung**:</span><span class="sxs-lookup"><span data-stu-id="a1624-215">**Logging**.</span></span> <span data-ttu-id="a1624-216">Wenden Sie vor dem Speichern von Protokolldaten bewährte Methoden an. Bereinigen Sie beispielsweise Benutzerkennwörter und andere Informationen, die ein potenzielles Sicherheitsrisiko darstellen und zu betrügerischen Zwecken verwendet werden könnten.</span><span class="sxs-lookup"><span data-stu-id="a1624-216">Use best practices before storing log data, such as scrubbing user passwords and other information that could be used to commit security fraud.</span></span>

## <a name="deployment"></a><span data-ttu-id="a1624-217">Bereitstellung</span><span class="sxs-lookup"><span data-stu-id="a1624-217">Deployment</span></span>

<span data-ttu-id="a1624-218">Befolgen Sie die Schritte im GitHub-Repository, um diese Referenzarchitektur bereitzustellen:</span><span class="sxs-lookup"><span data-stu-id="a1624-218">To deploy this reference architecture, follow the steps described in the GitHub repos:</span></span>

- <span data-ttu-id="a1624-219">[Reguläre Python-Modelle][github-python]</span><span class="sxs-lookup"><span data-stu-id="a1624-219">[Regular Python models][github-python]</span></span>
- <span data-ttu-id="a1624-220">[Deep Learning-Modelle][github-dl]</span><span class="sxs-lookup"><span data-stu-id="a1624-220">[Deep learning models][github-dl]</span></span>

<!-- links -->

[aad-auth]: /azure/aks/aad-integration
[acr]: /azure/container-registry/
[something]: https://kubernetes.io/docs/reference/access-authn-authz/authentication/
[aks]: /azure/aks/intro-kubernetes
[autoscaler]: /azure/aks/autoscaler
[autoscale-pods]: /azure/aks/tutorial-kubernetes-scale#autoscale-pods
[azcopy]: /azure/storage/common/storage-use-azcopy-linux
[ddos]: /azure/virtual-network/ddos-protection-overview
[get-started]: /azure/security-center/security-center-get-started
[github-python]: https://github.com/Microsoft/MLAKSDeployAML
[github-dl]: https://github.com/Microsoft/AKSDeploymentTutorial_AML
[gpus-vs-cpus]: https://azure.microsoft.com/en-us/blog/gpus-vs-cpus-for-deployment-of-deep-learning-models/
[https-ingress]: /azure/aks/ingress-tls
[ingress-controller]: https://kubernetes.io/docs/concepts/services-networking/ingress/
[kubectl]: https://kubernetes.io/docs/tasks/tools/install-kubectl/
[aml]: /azure/machine-learning/service/overview-what-is-azure-ml
[manually-scale-pods]: /azure/aks/tutorial-kubernetes-scale#manually-scale-pods
[monitor-containers]: /azure/monitoring/monitoring-container-insights-overview
[Berechtigungen]: /azure/aks/concepts-identity
[permissions]: /azure/aks/concepts-identity
[rbac]: /azure/active-directory/role-based-access-control-what-is
[scale-cluster]: /azure/aks/scale-cluster
[scikit]: https://pypi.org/project/scikit-learn/
[security-center]: /azure/security-center/security-center-intro
[vm]: /azure/virtual-machines/
