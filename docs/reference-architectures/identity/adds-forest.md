---
title: Erstellen einer AD DS-Ressourcengesamtstruktur in Azure
description: "Informationen zum Erstellen einer vertrauenswürdigen Active Directory-Domäne in Azure.\nAnleitungen, VPN-Gateway, ExpressRoute, Lastenausgleich, virtuelles Netzwerk, Active Directory"
author: telmosampaio
ms.date: 11/28/2016
pnp.series.title: Identity management
pnp.series.prev: adds-extend-domain
pnp.series.next: adfs
cardTitle: Create an AD DS forest in Azure
ms.openlocfilehash: bb7e57af2afacf1faa7679c854bf49217918eba8
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/14/2017
---
# <a name="create-an-active-directory-domain-services-ad-ds-resource-forest-in-azure"></a><span data-ttu-id="07567-104">Erstellen einer Active Directory Domain Services (AD DS)-Ressourcengesamtstruktur in Azure</span><span class="sxs-lookup"><span data-stu-id="07567-104">Create an Active Directory Domain Services (AD DS) resource forest in Azure</span></span>

<span data-ttu-id="07567-105">Diese Referenzarchitektur zeigt, wie eine separate Active Directory-Domäne in Azure erstellt wird, der Domänen in der lokalen Active Directory-Gesamtstruktur vertrauen.</span><span class="sxs-lookup"><span data-stu-id="07567-105">This reference architecture shows how to create a separate Active Directory domain in Azure that is trusted by domains in your on-premises AD forest.</span></span> [<span data-ttu-id="07567-106">**Stellen Sie diese Lösung bereit**.</span><span class="sxs-lookup"><span data-stu-id="07567-106">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="07567-107">[![0]][0]</span><span class="sxs-lookup"><span data-stu-id="07567-107">[![0]][0]</span></span> 

<span data-ttu-id="07567-108">*Laden Sie eine [Visio-Datei][visio-download] mit dieser Architektur herunter.*</span><span class="sxs-lookup"><span data-stu-id="07567-108">*Download a [Visio file][visio-download] of this architecture.*</span></span>

<span data-ttu-id="07567-109">In Active Directory Domain Services (AD DS) werden Identitätsinformationen in einer hierarchischen Struktur gespeichert.</span><span class="sxs-lookup"><span data-stu-id="07567-109">Active Directory Domain Services (AD DS) stores identity information in a hierarchical structure.</span></span> <span data-ttu-id="07567-110">Der oberste Knoten in der hierarchischen Struktur wird als Gesamtstruktur bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="07567-110">The top node in the hierarchical structure is known as a forest.</span></span> <span data-ttu-id="07567-111">Eine Gesamtstruktur enthält Domänen, und Domänen enthalten andere Objekttypen.</span><span class="sxs-lookup"><span data-stu-id="07567-111">A forest contains domains, and domains contain other types of objects.</span></span> <span data-ttu-id="07567-112">In dieser Referenzarchitektur wird eine AD DS-Gesamtstruktur in Azure mit einer unidirektionalen ausgehenden Vertrauensstellung mit einer lokalen Domäne erstellt.</span><span class="sxs-lookup"><span data-stu-id="07567-112">This reference architecture creates an AD DS forest in Azure with a one-way outgoing trust relationship with an on-premises domain.</span></span> <span data-ttu-id="07567-113">Die Gesamtstruktur in Azure enthält eine Domäne, die lokal nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="07567-113">The forest in Azure contains a domain that does not exist on-premises.</span></span> <span data-ttu-id="07567-114">Aufgrund der Vertrauensstellung werden Anmeldungen bei lokalen Domänen als vertrauenswürdig für den Zugriff auf Ressourcen in der separaten Azure-Domäne angesehen.</span><span class="sxs-lookup"><span data-stu-id="07567-114">Because of the trust relationship, logons made against on-premises domains can be trusted for access to resources in the separate Azure domain.</span></span> 

<span data-ttu-id="07567-115">Zu den typischen Verwendungsmöglichkeiten dieser Architektur zählen die Verwaltung einer Sicherheitstrennung für in der Cloud gespeicherte Objekte und Identitäten sowie die Migration einzelner Domänen aus einem lokalen System in die Cloud.</span><span class="sxs-lookup"><span data-stu-id="07567-115">Typical uses for this architecture include maintaining security separation for objects and identities held in the cloud, and migrating individual domains from on-premises to the cloud.</span></span> 

<span data-ttu-id="07567-116">Weitere Überlegungen finden Sie unter [Auswählen einer Lösung für die Integration einer lokalen Active Directory-Instanz in Azure][considerations].</span><span class="sxs-lookup"><span data-stu-id="07567-116">For additional considerations, see [Choose a solution for integrating on-premises Active Directory with Azure][considerations].</span></span> 

## <a name="architecture"></a><span data-ttu-id="07567-117">Architektur</span><span class="sxs-lookup"><span data-stu-id="07567-117">Architecture</span></span>

<span data-ttu-id="07567-118">Diese Architektur besteht aus den folgenden Komponenten.</span><span class="sxs-lookup"><span data-stu-id="07567-118">The architecture has the following components.</span></span>

* <span data-ttu-id="07567-119">**Lokales Netzwerk**.</span><span class="sxs-lookup"><span data-stu-id="07567-119">**On-premises network**.</span></span> <span data-ttu-id="07567-120">Das lokale Netzwerk enthält eine eigene Active Directory-Gesamtstruktur und eigene Domänen.</span><span class="sxs-lookup"><span data-stu-id="07567-120">The on-premises network contains its own Active Directory forest and domains.</span></span>
* <span data-ttu-id="07567-121">**Active Directory-Server**.</span><span class="sxs-lookup"><span data-stu-id="07567-121">**Active Directory servers**.</span></span> <span data-ttu-id="07567-122">Hierbei handelt es sich um Domänencontroller, die Domänendienste implementieren und als virtuelle Computer in der Cloud ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="07567-122">These are domain controllers implementing domain services running as VMs in the cloud.</span></span> <span data-ttu-id="07567-123">Diese Server hosten eine Gesamtstruktur mit einer oder mehrere Domänen, die von den lokal gehosteten getrennt sind.</span><span class="sxs-lookup"><span data-stu-id="07567-123">These servers host a forest containing one or more domains, separate from those located on-premises.</span></span>
* <span data-ttu-id="07567-124">**Unidirektionale Vertrauensstellung**.</span><span class="sxs-lookup"><span data-stu-id="07567-124">**One-way trust relationship**.</span></span> <span data-ttu-id="07567-125">Das Beispiel im Diagramm zeigt eine unidirektionale Vertrauensstellung von der Domäne in Azure zur lokalen Domäne.</span><span class="sxs-lookup"><span data-stu-id="07567-125">The example in the diagram shows a one-way trust from the domain in Azure to the on-premises domain.</span></span> <span data-ttu-id="07567-126">Diese Beziehung ermöglicht lokalen Benutzern den Zugriff auf Ressourcen in der Domäne in Azure, jedoch nicht umgekehrt.</span><span class="sxs-lookup"><span data-stu-id="07567-126">This relationship enables on-premises users to access resources in the domain in Azure, but not the other way around.</span></span> <span data-ttu-id="07567-127">Es kann eine bidirektionale Vertrauensstellung erstellt werden, wenn Cloudbenutzer auch Zugriff auf lokale Ressourcen benötigen.</span><span class="sxs-lookup"><span data-stu-id="07567-127">It is possible to create a two-way trust if cloud users also require access to on-premises resources.</span></span>
* <span data-ttu-id="07567-128">**Active Directory-Subnetz**.</span><span class="sxs-lookup"><span data-stu-id="07567-128">**Active Directory subnet**.</span></span> <span data-ttu-id="07567-129">Die AD DS-Server werden in einem separaten Subnetz gehostet.</span><span class="sxs-lookup"><span data-stu-id="07567-129">The AD DS servers are hosted in a separate subnet.</span></span> <span data-ttu-id="07567-130">NSG-Regeln (Netzwerksicherheitsgruppe) schützen die AD DS-Server und stellen eine Firewall für Datenverkehr von unerwarteten Quellen dar.</span><span class="sxs-lookup"><span data-stu-id="07567-130">Network security group (NSG) rules protect the AD DS servers and provide a firewall against traffic from unexpected sources.</span></span>
* <span data-ttu-id="07567-131">**Azure-Gateway**.</span><span class="sxs-lookup"><span data-stu-id="07567-131">**Azure gateway**.</span></span> <span data-ttu-id="07567-132">Das Azure-Gateway stellt eine Verbindung zwischen dem lokalen Netzwerk und dem Azure-VNet her.</span><span class="sxs-lookup"><span data-stu-id="07567-132">The Azure gateway provides a connection between the on-premises network and the Azure VNet.</span></span> <span data-ttu-id="07567-133">Dabei kann es sich um eine [VPN-Verbindung][azure-vpn-gateway] oder um [Azure ExpressRoute][azure-expressroute] handeln.</span><span class="sxs-lookup"><span data-stu-id="07567-133">This can be a [VPN connection][azure-vpn-gateway] or [Azure ExpressRoute][azure-expressroute].</span></span> <span data-ttu-id="07567-134">Weitere Informationen finden Sie unter [Implementieren einer sicheren Hybrid-Netzwerkarchitektur in Azure][implementing-a-secure-hybrid-network-architecture].</span><span class="sxs-lookup"><span data-stu-id="07567-134">For more information, see [Implementing a secure hybrid network architecture in Azure][implementing-a-secure-hybrid-network-architecture].</span></span>

## <a name="recommendations"></a><span data-ttu-id="07567-135">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="07567-135">Recommendations</span></span>

<span data-ttu-id="07567-136">Spezifische Empfehlungen zur Implementierung von Active Directory in Azure finden Sie in den folgenden Artikeln:</span><span class="sxs-lookup"><span data-stu-id="07567-136">For specific recommendations on implementing Active Directory in Azure, see the following articles:</span></span>

- <span data-ttu-id="07567-137">[Erweitern von Active Directory Domain Services (AD DS) auf Azure][adds-extend-domain]</span><span class="sxs-lookup"><span data-stu-id="07567-137">[Extending Active Directory Domain Services (AD DS) to Azure][adds-extend-domain].</span></span> 
- <span data-ttu-id="07567-138">[Richtlinien für die Bereitstellung von Windows Server Active Directory auf virtuellen Azure-Computern][ad-azure-guidelines]</span><span class="sxs-lookup"><span data-stu-id="07567-138">[Guidelines for Deploying Windows Server Active Directory on Azure Virtual Machines][ad-azure-guidelines].</span></span>

### <a name="trust"></a><span data-ttu-id="07567-139">Vertrauen</span><span class="sxs-lookup"><span data-stu-id="07567-139">Trust</span></span>

<span data-ttu-id="07567-140">Die lokalen Domänen sind in einer anderen Gesamtstruktur als die Domänen in der Cloud enthalten.</span><span class="sxs-lookup"><span data-stu-id="07567-140">The on-premises domains are contained within a different forest from the domains in the cloud.</span></span> <span data-ttu-id="07567-141">Um die Authentifizierung von lokalen Benutzern in der Cloud zu ermöglichen, müssen die Domänen in Azure der Anmeldedomäne in der lokalen Gesamtstruktur vertrauen.</span><span class="sxs-lookup"><span data-stu-id="07567-141">To enable authentication of on-premises users in the cloud, the domains in Azure must trust the logon domain in the on-premises forest.</span></span> <span data-ttu-id="07567-142">Ebenso kann es bei Bereitstellung einer Anmeldedomäne für externe Benutzer in der Cloud erforderlich sein, dass die lokale Gesamtstruktur der Clouddomäne vertraut.</span><span class="sxs-lookup"><span data-stu-id="07567-142">Similarly, if the cloud provides a logon domain for external users, it may be necessary for the on-premises forest to trust the cloud domain.</span></span>

<span data-ttu-id="07567-143">Sie können Vertrauensstellungen auf Gesamtstrukturebene durch [Erstellen von Gesamtstrukturvertrauensstellungen][creating-forest-trusts] oder auf Domänenebene durch [Erstellen externer Vertrauensstellungen][creating-external-trusts] einrichten.</span><span class="sxs-lookup"><span data-stu-id="07567-143">You can establish trusts at the forest level by [creating forest trusts][creating-forest-trusts], or at the domain level by [creating external trusts][creating-external-trusts].</span></span> <span data-ttu-id="07567-144">Eine Vertrauensstellung auf Gesamtstrukturebene erstellt eine Beziehung zwischen allen Domänen in zwei Gesamtstrukturen.</span><span class="sxs-lookup"><span data-stu-id="07567-144">A forest level trust creates a relationship between all domains in two forests.</span></span> <span data-ttu-id="07567-145">Eine Vertrauensstellung auf Ebene externer Domänen erstellt nur eine Beziehung zwischen zwei angegebenen Domänen.</span><span class="sxs-lookup"><span data-stu-id="07567-145">An external domain level trust only creates a relationship between two specified domains.</span></span> <span data-ttu-id="07567-146">Sie sollten Vertrauensstellungen auf Ebene externer Domänen nur zwischen Domänen in verschiedenen Gesamtstrukturen erstellen.</span><span class="sxs-lookup"><span data-stu-id="07567-146">You should only create external domain level trusts between domains in different forests.</span></span>

<span data-ttu-id="07567-147">Vertrauensstellungen können unidirektional oder bidirektional sein:</span><span class="sxs-lookup"><span data-stu-id="07567-147">Trusts can be unidirectional (one-way) or bidirectional (two-way):</span></span>

* <span data-ttu-id="07567-148">Eine unidirektionale Vertrauensstellung ermöglicht Benutzern in einer Domäne oder Gesamtstruktur (als *eingehende* Domäne oder Gesamtstruktur bezeichnet) Zugriff auf die Ressourcen in einer anderen Domäne oder Gesamtstruktur (als *ausgehende* Domäne oder Gesamtstruktur bezeichnet).</span><span class="sxs-lookup"><span data-stu-id="07567-148">A one-way trust enables users in one domain or forest (known as the *incoming* domain or forest) to access the resources held in another (the *outgoing* domain or forest).</span></span>
* <span data-ttu-id="07567-149">Eine bidirektionale Vertrauensstellung ermöglicht Benutzern in beiden Domänen oder Gesamtstrukturen den Zugriff auf Ressourcen in der jeweils anderen Domäne oder Gesamtstruktur.</span><span class="sxs-lookup"><span data-stu-id="07567-149">A two-way trust enables users in either domain or forest to access resources held in the other.</span></span>

<span data-ttu-id="07567-150">Die folgende Tabelle enthält eine Übersicht über Vertrauensstellungskonfigurationen für einige einfache Szenarien:</span><span class="sxs-lookup"><span data-stu-id="07567-150">The following table summarizes trust configurations for some simple scenarios:</span></span>

| <span data-ttu-id="07567-151">Szenario</span><span class="sxs-lookup"><span data-stu-id="07567-151">Scenario</span></span> | <span data-ttu-id="07567-152">Lokale Vertrauensstellung</span><span class="sxs-lookup"><span data-stu-id="07567-152">On-premises trust</span></span> | <span data-ttu-id="07567-153">Cloudvertrauensstellung</span><span class="sxs-lookup"><span data-stu-id="07567-153">Cloud trust</span></span> |
| --- | --- | --- |
| <span data-ttu-id="07567-154">Lokale Benutzer benötigen Zugriff auf Ressourcen in der Cloud, aber nicht umgekehrt</span><span class="sxs-lookup"><span data-stu-id="07567-154">On-premises users require access to resources in the cloud, but not vice versa</span></span> |<span data-ttu-id="07567-155">Unidirektional, eingehend</span><span class="sxs-lookup"><span data-stu-id="07567-155">One-way, incoming</span></span> |<span data-ttu-id="07567-156">Unidirektional, ausgehend</span><span class="sxs-lookup"><span data-stu-id="07567-156">One-way, outgoing</span></span> |
| <span data-ttu-id="07567-157">Benutzer in der Cloud benötigen Zugriff auf lokale Ressourcen, aber nicht umgekehrt</span><span class="sxs-lookup"><span data-stu-id="07567-157">Users in the cloud require access to resources located on-premises, but not vice versa</span></span> |<span data-ttu-id="07567-158">Unidirektional, ausgehend</span><span class="sxs-lookup"><span data-stu-id="07567-158">One-way, outgoing</span></span> |<span data-ttu-id="07567-159">Unidirektional, eingehend</span><span class="sxs-lookup"><span data-stu-id="07567-159">One-way, incoming</span></span> |
| <span data-ttu-id="07567-160">Sowohl Benutzer in der Cloud als auch lokale Benutzer benötigen Zugriff auf Ressourcen in der Cloud und auf lokale Ressourcen</span><span class="sxs-lookup"><span data-stu-id="07567-160">Users in the cloud and on-premises both requires access to resources held in the cloud and on-premises</span></span> |<span data-ttu-id="07567-161">Bidirektional, eingehend und ausgehend</span><span class="sxs-lookup"><span data-stu-id="07567-161">Two-way, incoming and outgoing</span></span> |<span data-ttu-id="07567-162">Bidirektional, eingehend und ausgehend</span><span class="sxs-lookup"><span data-stu-id="07567-162">Two-way, incoming and outgoing</span></span> |

## <a name="scalability-considerations"></a><span data-ttu-id="07567-163">Überlegungen zur Skalierbarkeit</span><span class="sxs-lookup"><span data-stu-id="07567-163">Scalability considerations</span></span>

<span data-ttu-id="07567-164">Active Directory ist für Domänencontroller, die Teil derselben Domäne sind, automatisch skalierbar.</span><span class="sxs-lookup"><span data-stu-id="07567-164">Active Directory is automatically scalable for domain controllers that are part of the same domain.</span></span> <span data-ttu-id="07567-165">Anforderungen werden auf alle Controller innerhalb einer Domäne verteilt.</span><span class="sxs-lookup"><span data-stu-id="07567-165">Requests are distributed across all controllers within a domain.</span></span> <span data-ttu-id="07567-166">Sie können einen weiteren Domänencontroller hinzufügen, und er wird automatisch mit der Domäne synchronisiert.</span><span class="sxs-lookup"><span data-stu-id="07567-166">You can add another domain controller, and it synchronizes automatically with the domain.</span></span> <span data-ttu-id="07567-167">Konfigurieren Sie keinen separaten Lastenausgleich, um Datenverkehr an Controller innerhalb der Domäne weiterzuleiten.</span><span class="sxs-lookup"><span data-stu-id="07567-167">Do not configure a separate load balancer to direct traffic to controllers within the domain.</span></span> <span data-ttu-id="07567-168">Stellen Sie sicher, dass alle Domänencontroller über genügend Arbeitsspeicher und Speicherressourcen für den Umgang mit der Domänendatenbank verfügen.</span><span class="sxs-lookup"><span data-stu-id="07567-168">Ensure that all domain controllers have sufficient memory and storage resources to handle the domain database.</span></span> <span data-ttu-id="07567-169">Erstellen Sie alle Domänencontroller als virtuelle Computer derselben Größe.</span><span class="sxs-lookup"><span data-stu-id="07567-169">Make all domain controller VMs the same size.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="07567-170">Überlegungen zur Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="07567-170">Availability considerations</span></span>

<span data-ttu-id="07567-171">Stellen Sie mindestens zwei Domänencontroller für jede Domäne bereit.</span><span class="sxs-lookup"><span data-stu-id="07567-171">Provision at least two domain controllers for each domain.</span></span> <span data-ttu-id="07567-172">Dies ermöglicht eine automatische Replikation zwischen Servern.</span><span class="sxs-lookup"><span data-stu-id="07567-172">This enables automatic replication between servers.</span></span> <span data-ttu-id="07567-173">Erstellen Sie eine Verfügbarkeitsgruppe für die virtuellen Computer, die als Active Directory-Server für die Handhabung der einzelnen Domänen dienen.</span><span class="sxs-lookup"><span data-stu-id="07567-173">Create an availability set for the VMs acting as Active Directory servers handling each domain.</span></span> <span data-ttu-id="07567-174">Es müssen mindestens zwei Server in dieser Verfügbarkeitsgruppe enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="07567-174">Put at least two servers in this availability set.</span></span>

<span data-ttu-id="07567-175">Überlegen Sie auch, ob Sie einen oder mehrere Server in jeder Domäne als [Standby-Betriebsmaster][standby-operations-masters] für den Fall festlegen, dass die Verbindung mit einem Server mit FSMO-Rolle (Flexible Single Master Operation) fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="07567-175">Also, consider designating one or more servers in each domain as [standby operations masters][standby-operations-masters] in case connectivity to a server acting as a flexible single master operation (FSMO) role fails.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="07567-176">Überlegungen zur Verwaltbarkeit</span><span class="sxs-lookup"><span data-stu-id="07567-176">Manageability considerations</span></span>

<span data-ttu-id="07567-177">Informationen zu Überlegungen in Bezug auf Verwaltung und Überwachung finden Sie unter [Erweitern von Active Directory auf Azure][adds-extend-domain].</span><span class="sxs-lookup"><span data-stu-id="07567-177">For information about management and monitoring considerations, see [Extending Active Directory to Azure][adds-extend-domain].</span></span> 
 
<span data-ttu-id="07567-178">Weitere Informationen finden Sie unter [Überwachen von Active Directory][monitoring_ad].</span><span class="sxs-lookup"><span data-stu-id="07567-178">For additional information, see [Monitoring Active Directory][monitoring_ad].</span></span> <span data-ttu-id="07567-179">Sie können Tools wie z.B. [Microsoft Systems Center][microsoft_systems_center] auf einem Überwachungsserver im Verwaltungssubnetz installieren, um diese Aufgaben auszuführen.</span><span class="sxs-lookup"><span data-stu-id="07567-179">You can install tools such as [Microsoft Systems Center][microsoft_systems_center] on a monitoring server in the management subnet to help perform these tasks.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="07567-180">Sicherheitshinweise</span><span class="sxs-lookup"><span data-stu-id="07567-180">Security considerations</span></span>

<span data-ttu-id="07567-181">Vertrauensstellungen auf Gesamtstrukturebene sind transitiv.</span><span class="sxs-lookup"><span data-stu-id="07567-181">Forest level trusts are transitive.</span></span> <span data-ttu-id="07567-182">Wenn Sie eine Vertrauensstellung auf Gesamtstrukturebene zwischen einer lokalen Gesamtstruktur und einer Gesamtstruktur in der Cloud erstellen, wird diese Vertrauensstellung auf weitere neue Domänen ausgeweitet, die in beiden Gesamtstrukturen erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="07567-182">If you establish a forest level trust between an on-premises forest and a forest in the cloud, this trust is extended to other new domains created in either forest.</span></span> <span data-ttu-id="07567-183">Wenn Sie Domänen verwenden, um eine Trennung aus Sicherheitsgründen bereitzustellen, sollten Sie Vertrauensstellungen nur auf Domänenebene erstellen.</span><span class="sxs-lookup"><span data-stu-id="07567-183">If you use domains to provide separation for security purposes, consider creating trusts at the domain level only.</span></span> <span data-ttu-id="07567-184">Vertrauensstellungen auf Domäneneben sind nicht transitiv.</span><span class="sxs-lookup"><span data-stu-id="07567-184">Domain level trusts are non-transitive.</span></span>

<span data-ttu-id="07567-185">Spezifische Überlegungen zur Sicherheit für Active Directory finden Sie im Abschnitt „Sicherheitshinweise“ unter [Erweitern von Active Directory auf Azure][adds-extend-domain].</span><span class="sxs-lookup"><span data-stu-id="07567-185">For Active Directory-specific security considerations, see the security considerations section in [Extending Active Directory to Azure][adds-extend-domain].</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="07567-186">Bereitstellen der Lösung</span><span class="sxs-lookup"><span data-stu-id="07567-186">Deploy the solution</span></span>

<span data-ttu-id="07567-187">Eine Projektmappe zur Bereitstellung für diese Referenzarchitektur ist auf [GitHub][github] verfügbar.</span><span class="sxs-lookup"><span data-stu-id="07567-187">A solution is available on [Github][github] to deploy this reference architecture.</span></span> <span data-ttu-id="07567-188">Sie benötigen die neueste Version der Azure-Befehlszeilenschnittstelle, um das PowerShell-Skript auszuführen, mit dem die Lösung bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="07567-188">You will need the latest version of the Azure CLI to run the Powershell script that deploys the solution.</span></span> <span data-ttu-id="07567-189">Um die Referenzarchitektur bereitzustellen, gehen Sie folgendermaßen vor:</span><span class="sxs-lookup"><span data-stu-id="07567-189">To deploy the reference architecture, follow these steps:</span></span>

1. <span data-ttu-id="07567-190">Laden Sie den Projektmappenordner von [GitHub][github] auf Ihren lokalen Computer herunter, oder klonen Sie ihn.</span><span class="sxs-lookup"><span data-stu-id="07567-190">Download or clone the solution folder from [Github][github] to your local machine.</span></span>

2. <span data-ttu-id="07567-191">Öffnen Sie die Azure-Befehlszeilenschnittstelle, und navigieren Sie zum lokalen Projektmappenordner.</span><span class="sxs-lookup"><span data-stu-id="07567-191">Open the Azure CLI and navigate to the local solution folder.</span></span>

3. <span data-ttu-id="07567-192">Führen Sie den folgenden Befehl aus:</span><span class="sxs-lookup"><span data-stu-id="07567-192">Run the following command:</span></span>
   
    ```Powershell
    .\Deploy-ReferenceArchitecture.ps1 <subscription id> <location> <mode>
    ```
   
    <span data-ttu-id="07567-193">Ersetzen Sie `<subscription id>` durch Ihre Azure-Abonnement-ID.</span><span class="sxs-lookup"><span data-stu-id="07567-193">Replace `<subscription id>` with your Azure subscription ID.</span></span>
   
    <span data-ttu-id="07567-194">Geben Sie für `<location>` eine Azure-Region an, z. B. `eastus` oder `westus`.</span><span class="sxs-lookup"><span data-stu-id="07567-194">For `<location>`, specify an Azure region, such as `eastus` or `westus`.</span></span>
   
    <span data-ttu-id="07567-195">Der `<mode>`-Parameter steuert die Granularität der Bereitstellung. Er kann einen der folgenden Werte annehmen:</span><span class="sxs-lookup"><span data-stu-id="07567-195">The `<mode>` parameter controls the granularity of the deployment, and can be one of the following values:</span></span>
   
   * <span data-ttu-id="07567-196">`Onpremise`: stellt die simulierte lokale Umgebung bereit.</span><span class="sxs-lookup"><span data-stu-id="07567-196">`Onpremise`: deploys the simulated on-premises environment.</span></span>
   * <span data-ttu-id="07567-197">`Infrastructure`: stellt die VNet-Infrastruktur und die Jumpbox in Azure bereit.</span><span class="sxs-lookup"><span data-stu-id="07567-197">`Infrastructure`: deploys the VNet infrastructure and jump box in Azure.</span></span>
   * <span data-ttu-id="07567-198">`CreateVpn`: stellt das Gateway des virtuellen Azure-Netzwerks bereit und verbindet es mit dem simulierten lokalen Netzwerk.</span><span class="sxs-lookup"><span data-stu-id="07567-198">`CreateVpn`: deploys the Azure virtual network gateway and connects it to the simulated on-premises network.</span></span>
   * <span data-ttu-id="07567-199">`AzureADDS`: stellt die virtuellen Computer, die als Active Directory DS-Server fungieren, auf diesen virtuellen Computern Active Directory und dann die Domäne in Azure bereit.</span><span class="sxs-lookup"><span data-stu-id="07567-199">`AzureADDS`: deploys the VMs acting as Active Directory DS servers, deploys Active Directory to these VMs, and deploys the domain in Azure.</span></span>
   * <span data-ttu-id="07567-200">`WebTier`: stellt die virtuellen Computer der Webebene und den Lastenausgleich bereit.</span><span class="sxs-lookup"><span data-stu-id="07567-200">`WebTier`: deploys the web tier VMs and load balancer.</span></span>
   * <span data-ttu-id="07567-201">`Prepare`: stellt alle vorherigen Bereitstellungen bereit.</span><span class="sxs-lookup"><span data-stu-id="07567-201">`Prepare`: deploys all of the preceding deployments.</span></span> <span data-ttu-id="07567-202">**Dies ist die empfohlene Option, wenn Sie nicht über ein lokales Netzwerk verfügen, aber die vollständige oben beschriebene Referenzarchitektur für Tests oder Prüfverfahren bereitstellen möchten.**</span><span class="sxs-lookup"><span data-stu-id="07567-202">**This is the recommended option if If you do not have an existing on-premises network but you want to deploy the complete reference architecture described above for testing or evaluation.**</span></span> 
   * <span data-ttu-id="07567-203">`Workload`: stellt die virtuellen Computer der Geschäfts- und Datenebene sowie Lastenausgleichsmodule bereit.</span><span class="sxs-lookup"><span data-stu-id="07567-203">`Workload`: deploys the business and data tier VMs and load balancers.</span></span> <span data-ttu-id="07567-204">Beachten Sie, dass diese virtuellen Computer nicht in der Bereitstellung `Prepare` enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="07567-204">Note that these VMs are not included in the `Prepare` deployment.</span></span>

4. <span data-ttu-id="07567-205">Warten Sie, bis die Bereitstellung abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="07567-205">Wait for the deployment to complete.</span></span> <span data-ttu-id="07567-206">Das Bereitstellen der Bereitstellung `Prepare` dauert mehrere Stunden.</span><span class="sxs-lookup"><span data-stu-id="07567-206">If you are deploying the `Prepare` deployment, it will take several hours.</span></span>
     
5. <span data-ttu-id="07567-207">Wenn Sie die simulierte lokale Konfiguration verwenden, konfigurieren Sie die eingehende Vertrauensstellung:</span><span class="sxs-lookup"><span data-stu-id="07567-207">If you are using the simulated on-premises configuration, configure the incoming trust relationship:</span></span>
   
   1. <span data-ttu-id="07567-208">Stellen Sie eine Verbindung mit der Jumpbox her (*ra-adtrust-mgmt-vm1* in der Ressourcengruppe *ra-adtrust-security-rg*).</span><span class="sxs-lookup"><span data-stu-id="07567-208">Connect to the jump box (*ra-adtrust-mgmt-vm1* in the *ra-adtrust-security-rg* resource group).</span></span> <span data-ttu-id="07567-209">Melden Sie sich als *testuser* mit dem Kennwort *AweS0me@PW* an.</span><span class="sxs-lookup"><span data-stu-id="07567-209">Log in as *testuser* with password *AweS0me@PW*.</span></span>
   2. <span data-ttu-id="07567-210">Öffnen Sie in der Jumpbox eine RDP-Sitzung auf dem ersten virtuellen Computer in der Domäne *contoso.com* (die lokale Domäne).</span><span class="sxs-lookup"><span data-stu-id="07567-210">On the jump box open an RDP session on the first VM in the *contoso.com* domain (the on-premises domain).</span></span> <span data-ttu-id="07567-211">Dieser virtuelle Computer hat die IP-Adresse 192.168.0.4.</span><span class="sxs-lookup"><span data-stu-id="07567-211">This VM has the IP address 192.168.0.4.</span></span> <span data-ttu-id="07567-212">Der Benutzername ist *contoso\testuser* mit dem Kennwort *AweS0me@PW*.</span><span class="sxs-lookup"><span data-stu-id="07567-212">The username is *contoso\testuser* with password *AweS0me@PW*.</span></span>
   3. <span data-ttu-id="07567-213">Laden Sie das Skript [incoming-trust.ps1][incoming-trust] herunter, und führen Sie es aus, um die eingehende Vertrauensstellung von der Domäne *treyresearch.com* zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="07567-213">Download the [incoming-trust.ps1][incoming-trust] script and run it to create the incoming trust from the *treyresearch.com* domain.</span></span>

6. <span data-ttu-id="07567-214">Wenn Sie Ihre eigene lokale Infrastruktur verwenden, gehen Sie folgendermaßen vor:</span><span class="sxs-lookup"><span data-stu-id="07567-214">If you are using your own on-premises infrastructure:</span></span>
   
   1. <span data-ttu-id="07567-215">Laden Sie das Skript [incoming-trust.ps1][incoming-trust] herunter.</span><span class="sxs-lookup"><span data-stu-id="07567-215">Download the [incoming-trust.ps1][incoming-trust] script.</span></span>
   2. <span data-ttu-id="07567-216">Bearbeiten Sie das Skript, und ersetzen Sie den Wert der Variablen `$TrustedDomainName` durch den Namen Ihrer eigenen Domäne.</span><span class="sxs-lookup"><span data-stu-id="07567-216">Edit the script and replace the value of the `$TrustedDomainName` variable with the name of your own domain.</span></span>
   3. <span data-ttu-id="07567-217">Führen Sie das Skript aus.</span><span class="sxs-lookup"><span data-stu-id="07567-217">Run the script.</span></span>

7. <span data-ttu-id="07567-218">Stellen Sie von der Jumpbox eine Verbindung mit dem ersten virtuellen Computer in der Domäne *treyresearch.com* (die Domäne in der Cloud) her.</span><span class="sxs-lookup"><span data-stu-id="07567-218">From the jump-box, connect to the first VM in the *treyresearch.com* domain (the domain in the cloud).</span></span> <span data-ttu-id="07567-219">Dieser virtuelle Computer hat die IP-Adresse 10.0.4.4.</span><span class="sxs-lookup"><span data-stu-id="07567-219">This VM has the IP address 10.0.4.4.</span></span> <span data-ttu-id="07567-220">Der Benutzername ist *treyresearch\testuser* mit dem Kennwort *AweS0me@PW*.</span><span class="sxs-lookup"><span data-stu-id="07567-220">The username is *treyresearch\testuser* with password *AweS0me@PW*.</span></span>

8. <span data-ttu-id="07567-221">Laden Sie das Skript [outgoing-trust.ps1][outgoing-trust] herunter, und führen Sie es aus, um die eingehende Vertrauensstellung von der Domäne *treyresearch.com* zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="07567-221">Download the [outgoing-trust.ps1][outgoing-trust] script and run it to create the incoming trust from the *treyresearch.com* domain.</span></span> <span data-ttu-id="07567-222">Wenn Sie Ihre eigenen lokalen Computer verwenden, bearbeiten Sie zuerst das Skript.</span><span class="sxs-lookup"><span data-stu-id="07567-222">If you are using your own on-premises machines, then edit the script first.</span></span> <span data-ttu-id="07567-223">Legen Sie die Variable `$TrustedDomainName` auf den Namen Ihrer lokalen Domäne fest, und geben Sie die IP-Adressen der Active Directory DS-Server für diese Domäne in der Variablen `$TrustedDomainDnsIpAddresses` an.</span><span class="sxs-lookup"><span data-stu-id="07567-223">Set the `$TrustedDomainName` variable to the name of your on-premises domain, and specify the IP addresses of the Active Directory DS servers for this domain in the `$TrustedDomainDnsIpAddresses` variable.</span></span>

9. <span data-ttu-id="07567-224">Warten Sie einige Minuten, bis die vorherigen Schritte abgeschlossen sind, und stellen Sie dann eine Verbindung mit einem lokalen virtuellen Computer her. Führen Sie die im Artikel [Überprüfen einer Vertrauensstellung][verify-a-trust] beschriebenen Schritte aus, um festzustellen, ob die Vertrauensstellung zwischen den Domänen *contoso.com* und *treyresearch.com* richtig konfiguriert ist.</span><span class="sxs-lookup"><span data-stu-id="07567-224">Wait a few minutes for the previous steps to complete, then connect to an on-premises VM and perform the steps outlined in the article [Verify a Trust][verify-a-trust] to determine whether the trust relationship between the *contoso.com* and *treyresearch.com* domains is correctly configured.</span></span>

## <a name="next-steps"></a><span data-ttu-id="07567-225">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="07567-225">Next steps</span></span>

* <span data-ttu-id="07567-226">Informieren Sie sich über bewährte Methoden für das [Erweitern Ihrer lokalen AD DS-Domäne auf Azure][adds-extend-domain].</span><span class="sxs-lookup"><span data-stu-id="07567-226">Learn the best practices for [extending your on-premises AD DS domain to Azure][adds-extend-domain]</span></span>
* <span data-ttu-id="07567-227">Informieren Sie sich über bewährte Methoden für das [Erstellen einer AD FS-Infrastruktur][adfs] in Azure.</span><span class="sxs-lookup"><span data-stu-id="07567-227">Learn the best practices for [creating an AD FS infrastructure][adfs] in Azure.</span></span>

<!-- links -->
[adds-extend-domain]: adds-extend-domain.md
[adfs]: adfs.md

[implementing-a-secure-hybrid-network-architecture]: ../dmz/secure-vnet-hybrid.md
[implementing-a-secure-hybrid-network-architecture-with-internet-access]: ../dmz/secure-vnet-dmz.md

[running-VMs-for-an-N-tier-architecture-on-Azure]: ../virtual-machines-windows/n-tier.md

[ad-azure-guidelines]: https://msdn.microsoft.com/library/azure/jj156090.aspx
[azure-expressroute]: https://azure.microsoft.com/documentation/articles/expressroute-introduction/
[azure-vpn-gateway]: https://azure.microsoft.com/documentation/articles/vpn-gateway-about-vpngateways/
[considerations]: ./considerations.md
[creating-external-trusts]: https://technet.microsoft.com/library/cc816837(v=ws.10).aspx
[creating-forest-trusts]: https://technet.microsoft.com/library/cc816810(v=ws.10).aspx
[github]: https://github.com/mspnp/reference-architectures/tree/master/identity/adds-forest
[incoming-trust]: https://raw.githubusercontent.com/mspnp/reference-architectures/master/identity/adds-forest/extensions/incoming-trust.ps1
[microsoft_systems_center]: https://www.microsoft.com/server-cloud/products/system-center-2016/
[monitoring_ad]: https://msdn.microsoft.com/library/bb727046.aspx
[resource-manager-overview]: /azure/azure-resource-manager/resource-group-overview
[solution-script]: https://raw.githubusercontent.com/mspnp/reference-architectures/master/identity/adds-forest/Deploy-ReferenceArchitecture.ps1
[standby-operations-masters]: https://technet.microsoft.com/library/cc794737(v=ws.10).aspx
[outgoing-trust]: https://raw.githubusercontent.com/mspnp/reference-architectures/master/identity/adds-forest/extensions/outgoing-trust.ps1
[verify-a-trust]: https://technet.microsoft.com/library/cc753821.aspx
[visio-download]: https://archcenter.azureedge.net/cdn/identity-architectures.vsdx
[0]: ./images/adds-forest.png "Schützen einer Hybrid-Netzwerkarchitektur mit separaten Active Directory-Domänen"