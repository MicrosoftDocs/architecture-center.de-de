---
title: Erweitern von Active Directory Domain Services (AD DS) auf Azure
description: >-
  Erfahren Sie, wie Sie eine sichere Hybrid-Netzwerkarchitektur mit Active Directory-Autorisierung in Azure implementieren.

  Anleitungen, VPN-Gateway, ExpressRoute, Lastenausgleich, virtuelles Netzwerk, Active Directory
author: telmosampaio
ms.date: 11/28/2016
pnp.series.title: Identity management
pnp.series.prev: azure-ad
pnp.series.next: adds-forest
ms.openlocfilehash: 007d244f29bf11c6e2bd703c7f4f245d22c02f0f
ms.sourcegitcommit: c441fd165e6bebbbbbc19854ec6f3676be9c3b25
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/30/2018
---
# <a name="extend-active-directory-domain-services-ad-ds-to-azure"></a><span data-ttu-id="7fedf-104">Erweitern von Active Directory Domain Services (AD DS) auf Azure</span><span class="sxs-lookup"><span data-stu-id="7fedf-104">Extend Active Directory Domain Services (AD DS) to Azure</span></span>

<span data-ttu-id="7fedf-105">Diese Referenzarchitektur zeigt, wie Sie Ihre Active Directory-Umgebung nach Azure erweitern, um verteilte Authentifizierungsdienste mit [Active Directory Domain Services (AD DS)][active-directory-domain-services] bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-105">This reference architecture shows how to extend your Active Directory environment to Azure to provide distributed authentication services using [Active Directory Domain Services (AD DS)][active-directory-domain-services].</span></span>  [<span data-ttu-id="7fedf-106">**So stellen Sie diese Lösung bereit**.</span><span class="sxs-lookup"><span data-stu-id="7fedf-106">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="7fedf-107">[![0]][0]</span><span class="sxs-lookup"><span data-stu-id="7fedf-107">[![0]][0]</span></span> 

<span data-ttu-id="7fedf-108">*Laden Sie eine [Visio-Datei][visio-download] mit dieser Architektur herunter.*</span><span class="sxs-lookup"><span data-stu-id="7fedf-108">*Download a [Visio file][visio-download] of this architecture.*</span></span>

<span data-ttu-id="7fedf-109">AD DS dient zum Authentifizieren von Benutzern, Computern, Anwendungen oder anderen Identitäten in einer Sicherheitsdomäne.</span><span class="sxs-lookup"><span data-stu-id="7fedf-109">AD DS is used to authenticate user, computer, application, or other identities that are included in a security domain.</span></span> <span data-ttu-id="7fedf-110">Ein lokales Hosting ist zwar möglich, aber wenn Ihre Anwendung teilweise lokal und teilweise in Azure gehostet wird, ist es möglicherweise effizienter, diese Funktionalität in Azure zu replizieren.</span><span class="sxs-lookup"><span data-stu-id="7fedf-110">It can be hosted on-premises, but if your application is hosted partly on-premises and partly in Azure, it may be more efficient to replicate this functionality in Azure.</span></span> <span data-ttu-id="7fedf-111">Dies kann Verzögerungen verringern, die durch das Senden der Authentifizierung und von lokalen Autorisierungsanforderungen aus der Cloud zurück in die lokale AD DS-Instanz auftreten.</span><span class="sxs-lookup"><span data-stu-id="7fedf-111">This can reduce the latency caused by sending authentication and local authorization requests from the cloud back to AD DS running on-premises.</span></span> 

<span data-ttu-id="7fedf-112">Diese Architektur wird häufig verwendet, wenn das lokale Netzwerk und das virtuelle Azure-Netzwerk über eine VPN- oder ExpressRoute-Verbindung miteinander verbunden sind.</span><span class="sxs-lookup"><span data-stu-id="7fedf-112">This architecture is commonly used when the on-premises network and the Azure virtual network are connected by a VPN or ExpressRoute connection.</span></span> <span data-ttu-id="7fedf-113">Diese Architektur unterstützt auch die bidirektionale Replikation, sodass Änderungen sowohl lokal als auch in der Cloud vorgenommen werden können und dabei beide Quellen konsistent bleiben.</span><span class="sxs-lookup"><span data-stu-id="7fedf-113">This architecture also supports bidirectional replication, meaning changes can be made either on-premises or in the cloud, and both sources will be kept consistent.</span></span> <span data-ttu-id="7fedf-114">Typische Einsatzfälle für diese Architektur sind Hybridanwendungen, bei denen die Funktionalität lokal und in Azure bereitgestellt wird und Anwendungen und Dienste die Authentifizierung mit Active Directory durchführen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-114">Typical uses for this architecture include hybrid applications in which functionality is distributed between on-premises and Azure, and applications and services that perform authentication using Active Directory.</span></span>

<span data-ttu-id="7fedf-115">Weitere Überlegungen finden Sie unter [Auswählen einer Lösung für die Integration einer lokalen Active Directory-Instanz in Azure][considerations].</span><span class="sxs-lookup"><span data-stu-id="7fedf-115">For additional considerations, see [Choose a solution for integrating on-premises Active Directory with Azure][considerations].</span></span> 

## <a name="architecture"></a><span data-ttu-id="7fedf-116">Architecture</span><span class="sxs-lookup"><span data-stu-id="7fedf-116">Architecture</span></span> 

<span data-ttu-id="7fedf-117">Diese Architektur erweitert die in [DMZ zwischen Azure und dem Internet][implementing-a-secure-hybrid-network-architecture-with-internet-access] gezeigte Architektur.</span><span class="sxs-lookup"><span data-stu-id="7fedf-117">This architecture extends the architecture shown in [DMZ between Azure and the Internet][implementing-a-secure-hybrid-network-architecture-with-internet-access].</span></span> <span data-ttu-id="7fedf-118">Sie enthält die folgenden Komponenten.</span><span class="sxs-lookup"><span data-stu-id="7fedf-118">It has the following components.</span></span>

* <span data-ttu-id="7fedf-119">**Lokales Netzwerk**.</span><span class="sxs-lookup"><span data-stu-id="7fedf-119">**On-premises network**.</span></span> <span data-ttu-id="7fedf-120">Das lokale Netzwerk enthält lokale Active Directory-Server, die Authentifizierung und Autorisierung für lokale Komponenten ausführen können.</span><span class="sxs-lookup"><span data-stu-id="7fedf-120">The on-premises network includes local Active Directory servers that can perform authentication and authorization for components located on-premises.</span></span>
* <span data-ttu-id="7fedf-121">**Active Directory-Server**.</span><span class="sxs-lookup"><span data-stu-id="7fedf-121">**Active Directory servers**.</span></span> <span data-ttu-id="7fedf-122">Hierbei handelt es sich um Domänencontroller, die Verzeichnisdienste (AD DS) implementieren und als virtuelle Computer in der Cloud ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="7fedf-122">These are domain controllers implementing directory services (AD DS) running as VMs in the cloud.</span></span> <span data-ttu-id="7fedf-123">Diese Server führen die Authentifizierung von Komponenten durch, die in Ihrem virtuellen Azure-Netzwerk ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="7fedf-123">These servers can provide authentication of components running in your Azure virtual network.</span></span>
* <span data-ttu-id="7fedf-124">**Active Directory-Subnetz**.</span><span class="sxs-lookup"><span data-stu-id="7fedf-124">**Active Directory subnet**.</span></span> <span data-ttu-id="7fedf-125">Die AD DS-Server werden in einem separaten Subnetz gehostet.</span><span class="sxs-lookup"><span data-stu-id="7fedf-125">The AD DS servers are hosted in a separate subnet.</span></span> <span data-ttu-id="7fedf-126">NSG-Regeln (Netzwerksicherheitsgruppe) schützen die AD DS-Server und stellen eine Firewall für Datenverkehr von unerwarteten Quellen dar.</span><span class="sxs-lookup"><span data-stu-id="7fedf-126">Network security group (NSG) rules protect the AD DS servers and provide a firewall against traffic from unexpected sources.</span></span>
* <span data-ttu-id="7fedf-127">**Azure-Gateway und Active Directory-Synchronisierung**.</span><span class="sxs-lookup"><span data-stu-id="7fedf-127">**Azure Gateway and Active Directory synchronization**.</span></span> <span data-ttu-id="7fedf-128">Das Azure-Gateway stellt eine Verbindung zwischen Ihrem lokalen Netzwerk und dem virtuellen Azure-Netzwerk her.</span><span class="sxs-lookup"><span data-stu-id="7fedf-128">The Azure gateway provides a connection between the on-premises network and the Azure VNet.</span></span> <span data-ttu-id="7fedf-129">Dabei kann es sich um eine [VPN-Verbindung][azure-vpn-gateway] oder um [Azure ExpressRoute][azure-expressroute] handeln.</span><span class="sxs-lookup"><span data-stu-id="7fedf-129">This can be a [VPN connection][azure-vpn-gateway] or [Azure ExpressRoute][azure-expressroute].</span></span> <span data-ttu-id="7fedf-130">Alle Synchronisierungsanforderungen zwischen den Active Directory-Servern in der Cloud und den lokalen Servern werden über das Gateway weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="7fedf-130">All synchronization requests between the Active Directory servers in the cloud and on-premises pass through the gateway.</span></span> <span data-ttu-id="7fedf-131">Benutzerdefinierte Routen (UDRs) verarbeiten das Routing für den lokalen Datenverkehr, der zu Azure übertragen wird.</span><span class="sxs-lookup"><span data-stu-id="7fedf-131">User-defined routes (UDRs) handle routing for on-premises traffic that passes to Azure.</span></span> <span data-ttu-id="7fedf-132">Datenverkehr zu und von Active Directory-Servern wird in diesem Szenario nicht über virtuelle Netzwerkgeräte (NVAs) übermittelt.</span><span class="sxs-lookup"><span data-stu-id="7fedf-132">Traffic to and from the Active Directory servers does not pass through the network virtual appliances (NVAs) used in this scenario.</span></span>

<span data-ttu-id="7fedf-133">Weitere Informationen zum Konfigurieren von UDRs und NVAs finden Sie unter [Implementieren einer sicheren Hybrid-Netzwerkarchitektur in Azure][implementing-a-secure-hybrid-network-architecture].</span><span class="sxs-lookup"><span data-stu-id="7fedf-133">For more information about configuring UDRs and the NVAs, see [Implementing a secure hybrid network architecture in Azure][implementing-a-secure-hybrid-network-architecture].</span></span> 

## <a name="recommendations"></a><span data-ttu-id="7fedf-134">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="7fedf-134">Recommendations</span></span>

<span data-ttu-id="7fedf-135">Die folgenden Empfehlungen gelten für die meisten Szenarios.</span><span class="sxs-lookup"><span data-stu-id="7fedf-135">The following recommendations apply for most scenarios.</span></span> <span data-ttu-id="7fedf-136">Sofern Sie keine besonderen Anforderungen haben, die Vorrang haben, sollten Sie diese Empfehlungen befolgen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-136">Follow these recommendations unless you have a specific requirement that overrides them.</span></span> 

### <a name="vm-recommendations"></a><span data-ttu-id="7fedf-137">Empfehlungen für virtuelle Computer</span><span class="sxs-lookup"><span data-stu-id="7fedf-137">VM recommendations</span></span>

<span data-ttu-id="7fedf-138">Sie bestimmen die Anforderungen an die [VM-Größe][vm-windows-sizes] anhand der erwarteten Menge von Authentifizierungsanforderungen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-138">Determine your [VM size][vm-windows-sizes] requirements based on the expected volume of authentication requests.</span></span> <span data-ttu-id="7fedf-139">Nutzen Sie die Spezifikationen des Computers, auf dem AD DS lokal ausgeführt wird, als Ausgangspunkt, und passen Sie die Azure-VM-Größen entsprechend an.</span><span class="sxs-lookup"><span data-stu-id="7fedf-139">Use the specifications of the machines hosting AD DS on premises as a starting point, and match them with the Azure VM sizes.</span></span> <span data-ttu-id="7fedf-140">Nach der Bereitstellung überwachen Sie die Auslastung und führen anhand der tatsächlichen Last auf den virtuellen Computern eine zentrale Hoch- oder Herunterskalierung durch.</span><span class="sxs-lookup"><span data-stu-id="7fedf-140">Once deployed, monitor utilization and scale up or down based on the actual load on the VMs.</span></span> <span data-ttu-id="7fedf-141">Weitere Informationen zum Ändern der Größe von AD DS-Domänencontrollern finden Sie unter [Kapazitätsplanung für Active Directory Domain Services][capacity-planning-for-adds].</span><span class="sxs-lookup"><span data-stu-id="7fedf-141">For more information about sizing AD DS domain controllers, see [Capacity Planning for Active Directory Domain Services][capacity-planning-for-adds].</span></span>

<span data-ttu-id="7fedf-142">Erstellen Sie einen separaten virtuellen Datenträger zum Speichern der Datenbank, der Protokolle und von SYSVOL für Active Directory.</span><span class="sxs-lookup"><span data-stu-id="7fedf-142">Create a separate virtual data disk for storing the database, logs, and SYSVOL for Active Directory.</span></span> <span data-ttu-id="7fedf-143">Speichern Sie diese Elemente nicht auf demselben Datenträger wie das Betriebssystem.</span><span class="sxs-lookup"><span data-stu-id="7fedf-143">Do not store these items on the same disk as the operating system.</span></span> <span data-ttu-id="7fedf-144">Standardmäßig verwenden die Datenträger, die an eine VM angefügt sind, einen Durchschreibcache (Write-Through Caching).</span><span class="sxs-lookup"><span data-stu-id="7fedf-144">Note that by default, data disks that are attached to a VM use write-through caching.</span></span> <span data-ttu-id="7fedf-145">Allerdings kann diese Form des Cachings zu Konflikten mit den Anforderungen von AD DS führen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-145">However, this form of caching can conflict with the requirements of AD DS.</span></span> <span data-ttu-id="7fedf-146">Legen Sie daher unter *Hostcacheeinstellungen* für den Datenträger *Keine* fest.</span><span class="sxs-lookup"><span data-stu-id="7fedf-146">For this reason, set the *Host Cache Preference* setting on the data disk to *None*.</span></span> <span data-ttu-id="7fedf-147">Weitere Informationen finden Sie unter [Platzierung der Windows Server AD DS-Datenbank und von SYSVOL][adds-data-disks].</span><span class="sxs-lookup"><span data-stu-id="7fedf-147">For more information, see [Placement of the Windows Server AD DS database and SYSVOL][adds-data-disks].</span></span>

<span data-ttu-id="7fedf-148">Stellen Sie mindestens zwei virtuelle Computer mit AD DS als Domänencontroller bereit, und fügen Sie sie einer [Verfügbarkeitsgruppe][availability-set] hinzu.</span><span class="sxs-lookup"><span data-stu-id="7fedf-148">Deploy at least two VMs running AD DS as domain controllers and add them to an [availability set][availability-set].</span></span>

### <a name="networking-recommendations"></a><span data-ttu-id="7fedf-149">Netzwerkempfehlungen</span><span class="sxs-lookup"><span data-stu-id="7fedf-149">Networking recommendations</span></span>

<span data-ttu-id="7fedf-150">Konfigurieren Sie die Netzwerkschnittstelle (NIC) der VM für jeden AD DS-Server für vollständige DNS-Unterstützung (Domain Name Service) mit einer statischen privaten IP-Adresse.</span><span class="sxs-lookup"><span data-stu-id="7fedf-150">Configure the VM network interface (NIC) for each AD DS server with a static private IP address for full domain name service (DNS) support.</span></span> <span data-ttu-id="7fedf-151">Weitere Informationen finden Sie unter [Einrichten einer statischen privaten IP-Adresse im Azure-Portal][set-a-static-ip-address].</span><span class="sxs-lookup"><span data-stu-id="7fedf-151">For more information, see [How to set a static private IP address in the Azure portal][set-a-static-ip-address].</span></span>

> [!NOTE]
> <span data-ttu-id="7fedf-152">Konfigurieren Sie nicht die VM-NIC für AD DS-Instanzen mit einer öffentlichen IP-Adresse.</span><span class="sxs-lookup"><span data-stu-id="7fedf-152">Do not configure the VM NIC for any AD DS with a public IP address.</span></span> <span data-ttu-id="7fedf-153">Weitere Informationen finden Sie unter [Überlegungen zur Sicherheit][security-considerations].</span><span class="sxs-lookup"><span data-stu-id="7fedf-153">See [Security considerations][security-considerations] for more details.</span></span>
> 
> 

<span data-ttu-id="7fedf-154">Die NSG für das Active Directory-Subnetz erfordert Regeln zum Zulassen von eingehendem Datenverkehr aus lokalen Quellen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-154">The Active Directory subnet NSG requires rules to permit incoming traffic from on-premises.</span></span> <span data-ttu-id="7fedf-155">Ausführliche Informationen zu den Ports, die AD DS verwendet, finden Sie unter [Portanforderungen für Active Directory und Active Directory Domain Services][ad-ds-ports].</span><span class="sxs-lookup"><span data-stu-id="7fedf-155">For detailed information on the ports used by AD DS, see [Active Directory and Active Directory Domain Services Port Requirements][ad-ds-ports].</span></span> <span data-ttu-id="7fedf-156">Stellen Sie außerdem sicher, dass die UDR-Tabellen AD DS-Datenverkehr nicht über die in dieser Architektur verwendeten NVAs leiten.</span><span class="sxs-lookup"><span data-stu-id="7fedf-156">Also, ensure the UDR tables do not route AD DS traffic through the NVAs used in this architecture.</span></span> 

### <a name="active-directory-site"></a><span data-ttu-id="7fedf-157">Active Directory-Standort</span><span class="sxs-lookup"><span data-stu-id="7fedf-157">Active Directory site</span></span>

<span data-ttu-id="7fedf-158">In AD DS stellt ein Standort einen physischen Standort, ein Netzwerk oder eine Sammlung von Geräten dar.</span><span class="sxs-lookup"><span data-stu-id="7fedf-158">In AD DS, a site represents a physical location, network, or collection of devices.</span></span> <span data-ttu-id="7fedf-159">AD DS-Standorte dienen zum Verwalten der AD DS-Datenbankreplikation durch das Gruppieren von AD DS-Objekten, die sich nah beieinander befinden und über ein Hochgeschwindigkeitsnetzwerk verbunden sind.</span><span class="sxs-lookup"><span data-stu-id="7fedf-159">AD DS sites are used to manage AD DS database replication by grouping together AD DS objects that are located close to one another and are connected by a high speed network.</span></span> <span data-ttu-id="7fedf-160">AD DS enthält Logik zum Auswählen der besten Strategie für das Replizieren der AD DS-Datenbank zwischen Standorten.</span><span class="sxs-lookup"><span data-stu-id="7fedf-160">AD DS includes logic to select the best strategy for replacating the AD DS database between sites.</span></span>

<span data-ttu-id="7fedf-161">Es wird empfohlen, dass Sie einen AD DS-Standort einschließlich der Subnetze, die für Ihre Anwendung in Azure definiert wurden, erstellen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-161">We recommend that you create an AD DS site including the subnets defined for your application in Azure.</span></span> <span data-ttu-id="7fedf-162">Konfigurieren Sie dann eine Standortverknüpfung zwischen Ihren lokalen AD DS-Standorten. AD DS führt daraufhin automatisch die effizienteste Datenbankreplikation durch.</span><span class="sxs-lookup"><span data-stu-id="7fedf-162">Then, configure a site link between your on-premises AD DS sites, and AD DS will automatically perform the most efficient database replication possible.</span></span> <span data-ttu-id="7fedf-163">Beachten Sie, dass diese Datenbankreplikation die Erstkonfiguration etwas erweitert.</span><span class="sxs-lookup"><span data-stu-id="7fedf-163">Note that this database replication requires little beyond the initial configuration.</span></span>

### <a name="active-directory-operations-masters"></a><span data-ttu-id="7fedf-164">Active Directory-Betriebsmaster</span><span class="sxs-lookup"><span data-stu-id="7fedf-164">Active Directory operations masters</span></span>

<span data-ttu-id="7fedf-165">Zur Unterstützung der Konsistenzüberprüfung zwischen Instanzen replizierter AD DS-Datenbanken kann die Betriebsmasterrolle auch AD DS-Domänencontrollern zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="7fedf-165">The operations masters role can be assigned to AD DS domain controllers to support consistency checking between instances of replicated AD DS databases.</span></span> <span data-ttu-id="7fedf-166">Es gibt fünf Betriebsmasterrollen: Schemamaster, Domänennamenmaster RID-Master, Masteremulator für den primären Domänencontroller und Infrastrukturmaster.</span><span class="sxs-lookup"><span data-stu-id="7fedf-166">There are five operations master roles: schema master, domain naming master, relative identifier master, primary domain controller master emulator, and infrastructure master.</span></span> <span data-ttu-id="7fedf-167">Weitere Informationen zu diesen Rollen finden Sie unter [Was sind Betriebsmaster?][ad-ds-operations-masters].</span><span class="sxs-lookup"><span data-stu-id="7fedf-167">For more information about these roles, see [What are Operations Masters?][ad-ds-operations-masters].</span></span>

<span data-ttu-id="7fedf-168">Es wird empfohlen, den in Azure bereitgestellten Domänencontrollern keine Betriebsmasterrollen zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-168">We recommend you do not assign operations masters roles to the domain controllers deployed in Azure.</span></span>

### <a name="monitoring"></a><span data-ttu-id="7fedf-169">Überwachung</span><span class="sxs-lookup"><span data-stu-id="7fedf-169">Monitoring</span></span>

<span data-ttu-id="7fedf-170">Überwachen Sie die Ressourcen der Domänencontroller-VMs sowie die AD DS-Dienste, und erstellen Sie einen Plan zum schnellen Beheben eventuell auftretender Probleme.</span><span class="sxs-lookup"><span data-stu-id="7fedf-170">Monitor the resources of the domain controller VMs as well as the AD DS Services and create a plan to quickly correct any problems.</span></span> <span data-ttu-id="7fedf-171">Weitere Informationen finden Sie unter [Überwachen von Active Directory][monitoring_ad].</span><span class="sxs-lookup"><span data-stu-id="7fedf-171">For more information, see [Monitoring Active Directory][monitoring_ad].</span></span> <span data-ttu-id="7fedf-172">Sie können auch Tools wie [Microsoft Systems Center][microsoft_systems_center] auf dem Überwachungsserver installieren (siehe Architekturdiagramm), um diese Aufgaben auszuführen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-172">You can also install tools such as [Microsoft Systems Center][microsoft_systems_center] on the monitoring server (see the architecture diagram) to help perform these tasks.</span></span>  

## <a name="scalability-considerations"></a><span data-ttu-id="7fedf-173">Überlegungen zur Skalierbarkeit</span><span class="sxs-lookup"><span data-stu-id="7fedf-173">Scalability considerations</span></span>

<span data-ttu-id="7fedf-174">AD DS ist auf Skalierbarkeit ausgelegt.</span><span class="sxs-lookup"><span data-stu-id="7fedf-174">AD DS is designed for scalability.</span></span> <span data-ttu-id="7fedf-175">Sie müssen keinen Lastenausgleich und keine Datenverkehrssteuerung konfigurieren, um Anforderungen an AD DS-Domänencontroller umzuleiten.</span><span class="sxs-lookup"><span data-stu-id="7fedf-175">You don't need to configure a load balancer or traffic controller to direct requests to AD DS domain controllers.</span></span> <span data-ttu-id="7fedf-176">Den einzigen Skalierungsaspekt stellt die Konfiguration der virtuellen Computer, auf denen AD DS ausgeführt wird, mit der richtigen Größe für die Lastanforderungen Ihres Netzwerks dar. Dazu überwachen Sie die Last auf den virtuellen Computern und skalieren nach Bedarf zentral hoch oder herunter.</span><span class="sxs-lookup"><span data-stu-id="7fedf-176">The only scalability consideration is to configure the VMs running AD DS with the correct size for your network load requirements, monitor the load on the VMs, and scale up or down as necessary.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="7fedf-177">Überlegungen zur Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="7fedf-177">Availability considerations</span></span>

<span data-ttu-id="7fedf-178">Stellen Sie die virtuellen Computer mit AD DS in einer [Verfügbarkeitsgruppe][availability-set] bereit.</span><span class="sxs-lookup"><span data-stu-id="7fedf-178">Deploy the VMs running AD DS into an [availability set][availability-set].</span></span> <span data-ttu-id="7fedf-179">Erwägen Sie dabei auch, die Rolle des [Standby-Betriebsmasters][standby-operations-masters] mindestens einem Server (je nach Ihren Anforderungen auch mehr) zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="7fedf-179">Also, consider assigning the role of [standby operations master][standby-operations-masters] to at least one server, and possibly more depending on your requirements.</span></span> <span data-ttu-id="7fedf-180">Ein Standby-Betriebsmaster ist eine aktive Kopie des Betriebsmasters, die anstelle des primären Betriebsmasterservers während des Failovers verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="7fedf-180">A standby operations master is an active copy of the operations master that can be used in place of the primary operations masters server during fail over.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="7fedf-181">Überlegungen zur Verwaltbarkeit</span><span class="sxs-lookup"><span data-stu-id="7fedf-181">Manageability considerations</span></span>

<span data-ttu-id="7fedf-182">Führen Sie regelmäßige Sicherungen von AD DS durch.</span><span class="sxs-lookup"><span data-stu-id="7fedf-182">Perform regular AD DS backups.</span></span> <span data-ttu-id="7fedf-183">Kopieren Sie nicht einfach die VHD-Dateien der Domänencontroller, anstatt regelmäßige Sicherungen auszuführen, da die AD DS-Datenbankdatei auf der VHD möglicherweise beim Kopieren nicht konsistent ist. Dies könnte dazu führen, dass die Datenbank nicht mehr neu gestartet werden kann.</span><span class="sxs-lookup"><span data-stu-id="7fedf-183">Don't simply copy the VHD files of domain controllers instead of performing regular backups, because the AD DS database file on the VHD may not be in a consistent state when it's copied, making it impossible to restart the database.</span></span>

<span data-ttu-id="7fedf-184">Fahren Sie Domänencontroller-VMs nicht über das Azure-Portal herunter.</span><span class="sxs-lookup"><span data-stu-id="7fedf-184">Do not shut down a domain controller VM using Azure portal.</span></span> <span data-ttu-id="7fedf-185">Führen Sie die Vorgänge zum Herunterfahren und Neustarten stattdessen im Gastbetriebssystem durch.</span><span class="sxs-lookup"><span data-stu-id="7fedf-185">Instead, shut down and restart from the guest operating system.</span></span> <span data-ttu-id="7fedf-186">Beim Herunterfahren über das Portal wird die Zuordnung des virtuellen Computers aufgehoben und dadurch sowohl die `VM-GenerationID` als auch die `invocationID` des Active Directory-Repositorys zurückgesetzt.</span><span class="sxs-lookup"><span data-stu-id="7fedf-186">Shutting down through the portal causes the VM to be deallocated, which resets both the `VM-GenerationID` and the `invocationID` of the Active Directory repository.</span></span> <span data-ttu-id="7fedf-187">Damit werden der RID-Pool (relative ID) von AD DS verworfen und SYSVOL als nicht autorisierend markiert. Als Folge müsste der Domänencontroller neu konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="7fedf-187">This discards the AD DS relative identifier (RID) pool and marks SYSVOL as nonauthoritative, and may require reconfiguration of the domain controller.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="7fedf-188">Sicherheitshinweise</span><span class="sxs-lookup"><span data-stu-id="7fedf-188">Security considerations</span></span>

<span data-ttu-id="7fedf-189">AD DS-Server stellen Authentifizierungsdienste bereit und sind damit ein attraktives Ziel für Angriffe.</span><span class="sxs-lookup"><span data-stu-id="7fedf-189">AD DS servers provide authentication services and are an attractive target for attacks.</span></span> <span data-ttu-id="7fedf-190">Wenn Sie sie schützen möchten, müssen Sie direkte Internetverbindungen verhindern, indem Sie die AD DS-Server in einem separaten Subnetz mit einer NSG, die als Firewall fungiert, platzieren.</span><span class="sxs-lookup"><span data-stu-id="7fedf-190">To secure them, prevent direct Internet connectivity by placing the AD DS servers in a separate subnet with an NSG acting as a firewall.</span></span> <span data-ttu-id="7fedf-191">Schließen Sie alle Ports auf den AD DS-Servern mit Ausnahme derjenigen, die für die Authentifizierung, Autorisierung und Serversynchronisierung erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="7fedf-191">Close all ports on the AD DS servers except those necessary for authentication, authorization, and server synchronization.</span></span> <span data-ttu-id="7fedf-192">Weitere Informationen finden Sie unter [Portanforderungen für Active Directory und Active Directory Domain Services][ad-ds-ports].</span><span class="sxs-lookup"><span data-stu-id="7fedf-192">For more information, see [Active Directory and Active Directory Domain Services Port Requirements][ad-ds-ports].</span></span>

<span data-ttu-id="7fedf-193">Erwägen Sie auch die Implementierung zusätzlicher Sicherheitsperimeter um die Server durch ein Paar von Subnetzen und NVAs. Eine Beschreibung finden Sie unter [Implementieren einer sichere Hybrid-Netzwerkarchitektur mit Internetzugriff in Azure][implementing-a-secure-hybrid-network-architecture-with-internet-access].</span><span class="sxs-lookup"><span data-stu-id="7fedf-193">Consider implementing an additional security perimeter around servers with a pair of subnets and NVAs, as described in [Implementing a secure hybrid network architecture with Internet access in Azure][implementing-a-secure-hybrid-network-architecture-with-internet-access].</span></span>

<span data-ttu-id="7fedf-194">Verwenden Sie BitLocker oder Azure Disk Encryption, um den Datenträger, auf dem die AD DS-Datenbank gehostet wird, zu verschlüsseln.</span><span class="sxs-lookup"><span data-stu-id="7fedf-194">Use either BitLocker or Azure disk encryption to encrypt the disk hosting the AD DS database.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="7fedf-195">Bereitstellen der Lösung</span><span class="sxs-lookup"><span data-stu-id="7fedf-195">Deploy the solution</span></span>

<span data-ttu-id="7fedf-196">Eine Lösung zur Bereitstellung für diese Referenzarchitektur ist auf [GitHub][github] verfügbar.</span><span class="sxs-lookup"><span data-stu-id="7fedf-196">A solution is available on [GitHub][github] to deploy this reference architecture.</span></span> <span data-ttu-id="7fedf-197">Sie benötigen die neueste Version der [Azure-Befehlszeilenschnittstelle][azure-powershell], um das PowerShell-Skript auszuführen, mit dem die Lösung bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="7fedf-197">You will need the latest version of the [Azure CLI][azure-powershell] to run the Powershell script that deploys the solution.</span></span> <span data-ttu-id="7fedf-198">Um die Referenzarchitektur bereitzustellen, gehen Sie folgendermaßen vor:</span><span class="sxs-lookup"><span data-stu-id="7fedf-198">To deploy the reference architecture, follow these steps:</span></span>

1. <span data-ttu-id="7fedf-199">Laden Sie den Projektmappenordner von [GitHub][github] auf Ihren lokalen Computer herunter, oder klonen Sie ihn.</span><span class="sxs-lookup"><span data-stu-id="7fedf-199">Download or clone the solution folder from [GitHub][github] to your local machine.</span></span>

2. <span data-ttu-id="7fedf-200">Öffnen Sie die Azure-Befehlszeilenschnittstelle, und navigieren Sie zum lokalen Projektmappenordner.</span><span class="sxs-lookup"><span data-stu-id="7fedf-200">Open the Azure CLI and navigate to the local solution folder.</span></span>

3. <span data-ttu-id="7fedf-201">Führen Sie den folgenden Befehl aus:</span><span class="sxs-lookup"><span data-stu-id="7fedf-201">Run the following command:</span></span>
    ```Powershell
    .\Deploy-ReferenceArchitecture.ps1 <subscription id> <location> <mode>
    ```
    <span data-ttu-id="7fedf-202">Ersetzen Sie `<subscription id>` durch Ihre Azure-Abonnement-ID.</span><span class="sxs-lookup"><span data-stu-id="7fedf-202">Replace `<subscription id>` with your Azure subscription ID.</span></span>
    <span data-ttu-id="7fedf-203">Geben Sie für `<location>` eine Azure-Region an, z.B. `eastus` oder `westus`.</span><span class="sxs-lookup"><span data-stu-id="7fedf-203">For `<location>`, specify an Azure region, such as `eastus` or `westus`.</span></span>
    <span data-ttu-id="7fedf-204">Der `<mode>`-Parameter steuert die Granularität der Bereitstellung. Er kann einen der folgenden Werte annehmen:</span><span class="sxs-lookup"><span data-stu-id="7fedf-204">The `<mode>` parameter controls the granularity of the deployment, and can be one of the following values:</span></span>
    * <span data-ttu-id="7fedf-205">`Onpremise`: stellt die simulierte lokale Umgebung bereit</span><span class="sxs-lookup"><span data-stu-id="7fedf-205">`Onpremise`: deploys the simulated on-premises environment.</span></span>
    * <span data-ttu-id="7fedf-206">`Infrastructure`: stellt die VNET-Infrastruktur und die Jumpbox in Azure bereit</span><span class="sxs-lookup"><span data-stu-id="7fedf-206">`Infrastructure`: deploys the VNet infrastructure and jump box in Azure.</span></span>
    * <span data-ttu-id="7fedf-207">`CreateVpn`: stellt das Gateway des virtuellen Azure-Netzwerks bereit und verbindet es mit dem simulierten lokalen Netzwerk</span><span class="sxs-lookup"><span data-stu-id="7fedf-207">`CreateVpn`: deploys the Azure virtual network gateway and connects it to the simulated on-premises network.</span></span>
    * <span data-ttu-id="7fedf-208">`AzureADDS`: stellt die virtuellen Computer, die als AD DS-Server fungieren bereit, dann auf diesen virtuellen Computern Active Directory und schließlich die Domäne in Azure</span><span class="sxs-lookup"><span data-stu-id="7fedf-208">`AzureADDS`: deploys the VMs acting as AD DS servers, deploys Active Directory to these VMs, and deploys the domain in Azure.</span></span>
    * <span data-ttu-id="7fedf-209">`Workload`: stellt die öffentlichen und privaten DMZs und die Workloadebene bereit</span><span class="sxs-lookup"><span data-stu-id="7fedf-209">`Workload`: deploys the public and private DMZs and the workload tier.</span></span>
    * <span data-ttu-id="7fedf-210">`All`: Stellt alle vorherigen Bereitstellungen bereit.</span><span class="sxs-lookup"><span data-stu-id="7fedf-210">`All`: deploys all of the preceding deployments.</span></span> <span data-ttu-id="7fedf-211">**Dies ist die empfohlene Option, wenn Sie nicht über ein lokales Netzwerk verfügen, aber die vollständige oben beschriebene Referenzarchitektur für Tests oder Prüfverfahren bereitstellen möchten.**</span><span class="sxs-lookup"><span data-stu-id="7fedf-211">**This is the recommended option if If you do not have an existing on-premises network but you want to deploy the complete reference architecture described above for testing or evaluation.**</span></span>

4. <span data-ttu-id="7fedf-212">Warten Sie, bis die Bereitstellung abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="7fedf-212">Wait for the deployment to complete.</span></span> <span data-ttu-id="7fedf-213">Das Bereitstellen der Bereitstellung `All` dauert mehrere Stunden.</span><span class="sxs-lookup"><span data-stu-id="7fedf-213">If you are deploying the `All` deployment, it will take several hours.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7fedf-214">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="7fedf-214">Next steps</span></span>

* <span data-ttu-id="7fedf-215">Informieren Sie sich über bewährte Methoden für das [Erstellen einer AD DS-Ressourcengesamtstruktur][adds-resource-forest] in Azure.</span><span class="sxs-lookup"><span data-stu-id="7fedf-215">Learn the best practices for [creating an AD DS resource forest][adds-resource-forest] in Azure.</span></span>
* <span data-ttu-id="7fedf-216">Informieren Sie sich über bewährte Methoden für das [Erstellen einer Infrastruktur für Active Directory-Verbunddienste (AD FS)][adfs] in Azure.</span><span class="sxs-lookup"><span data-stu-id="7fedf-216">Learn the best practices for [creating an Active Directory Federation Services (AD FS) infrastructure][adfs] in Azure.</span></span>

<!-- links -->
[adds-resource-forest]: adds-forest.md
[adfs]: adfs.md

[implementing-a-secure-hybrid-network-architecture]: ../dmz/secure-vnet-hybrid.md
[implementing-a-secure-hybrid-network-architecture-with-internet-access]: ../dmz/secure-vnet-dmz.md

[active-directory-domain-services]: https://technet.microsoft.com/library/dd448614.aspx
[adds-data-disks]: https://msdn.microsoft.com/library/azure/jj156090.aspx#BKMK_PlaceDB
[ad-ds-operations-masters]: https://technet.microsoft.com/library/cc779716(v=ws.10).aspx
[ad-ds-ports]: https://technet.microsoft.com/library/dd772723(v=ws.11).aspx
[availability-set]: /azure/virtual-machines/virtual-machines-windows-create-availability-set
[azure-expressroute]: https://azure.microsoft.com/documentation/articles/expressroute-introduction/
[azure-powershell]: /powershell/azureps-cmdlets-docs
[azure-vpn-gateway]: https://azure.microsoft.com/documentation/articles/vpn-gateway-about-vpngateways/
[capacity-planning-for-adds]: http://social.technet.microsoft.com/wiki/contents/articles/14355.capacity-planning-for-active-directory-domain-services.aspx
[considerations]: ./considerations.md
[GitHub]: https://github.com/mspnp/reference-architectures/tree/master/identity/adds-extend-domain
[microsoft_systems_center]: https://www.microsoft.com/server-cloud/products/system-center-2016/
[monitoring_ad]: https://msdn.microsoft.com/library/bb727046.aspx
[security-considerations]: #security-considerations
[set-a-static-ip-address]: https://azure.microsoft.com/documentation/articles/virtual-networks-static-private-ip-arm-pportal/
[standby-operations-masters]: https://technet.microsoft.com/library/cc794737(v=ws.10).aspx
[visio-download]: https://archcenter.blob.core.windows.net/cdn/identity-architectures.vsdx
[vm-windows-sizes]: /azure/virtual-machines/virtual-machines-windows-sizes

[0]: ./images/adds-extend-domain.png "Schützen einer Hybrid-Netzwerkarchitektur mit Active Directory"
