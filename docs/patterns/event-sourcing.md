---
title: Muster „Ereignissourcing“
titleSuffix: Cloud Design Patterns
description: Verwenden Sie einen nur zum Anfügen vorgesehenen Speicher, um die vollständige Serie von Ereignissen aufzuzeichnen, die die mit Daten in einer Domäne ausgeführten Aktionen beschreiben.
keywords: Entwurfsmuster
author: dragon119
ms.date: 06/23/2017
ms.topic: design-pattern
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.custom: seodec18
ms.openlocfilehash: 0183342257c676538aedc073f4f31a1c38ffdeef
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 01/23/2019
ms.locfileid: "54488629"
---
# <a name="event-sourcing-pattern"></a><span data-ttu-id="9eda6-104">Muster „Ereignissourcing“</span><span class="sxs-lookup"><span data-stu-id="9eda6-104">Event Sourcing pattern</span></span>

[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="9eda6-105">Anstatt nur den aktuellen Zustand der Daten in einer Domäne zu speichern, verwenden Sie einen nur zum Anfügen vorgesehenen Speicher, um die vollständige Serie von Aktionen aufzuzeichnen, die mit diesen Daten ausgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-105">Instead of storing just the current state of the data in a domain, use an append-only store to record the full series of actions taken on that data.</span></span>
<span data-ttu-id="9eda6-106">Der Speicher fungiert als Aufzeichnungssystem und kann zum Materialisieren der Domänenobjekte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-106">The store acts as the system of record and can be used to materialize the domain objects.</span></span> <span data-ttu-id="9eda6-107">Dadurch lassen sich Tasks in komplexen Domänen vereinfachen, da Datenmodell und Geschäftsdomäne nicht mehr synchronisiert werden müssen. Gleichzeitig steigen Leistung, Skalierbarkeit und Reaktionsfähigkeit.</span><span class="sxs-lookup"><span data-stu-id="9eda6-107">This can simplify tasks in complex domains, by avoiding the need to synchronize the data model and the business domain, while improving performance, scalability, and responsiveness.</span></span> <span data-ttu-id="9eda6-108">Das Muster kann auch Konsistenz für Transaktionsdaten bieten und vollständige Überwachungspfade und -verläufe verwalten, die kompensierende Maßnahmen ermöglichen können.</span><span class="sxs-lookup"><span data-stu-id="9eda6-108">It can also provide consistency for transactional data, and maintain full audit trails and history that can enable compensating actions.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="9eda6-109">Kontext und Problem</span><span class="sxs-lookup"><span data-stu-id="9eda6-109">Context and problem</span></span>

<span data-ttu-id="9eda6-110">Die meisten Anwendungen basieren auf Daten. Der typische Ansatz besteht darin, dass die Anwendung den aktuellen Zustand der Daten verwaltet, indem sie die Daten aktualisiert, wenn Benutzer damit arbeiten.</span><span class="sxs-lookup"><span data-stu-id="9eda6-110">Most applications work with data, and the typical approach is for the application to maintain the current state of the data by updating it as users work with it.</span></span> <span data-ttu-id="9eda6-111">Im herkömmlichen CRUD-Modell (Create, Read, Update, Delete – Erstellen, Lesen, Aktualisieren, Löschen) sieht ein typischer Datenprozess folgendermaßen aus: Der Prozess liest Daten aus dem Speicher, nimmt einige Änderungen daran vor und aktualisiert den Zustand der Daten mit neuen Werten – häufig mithilfe von Transaktionen, die die Daten sperren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-111">For example, in the traditional create, read, update, and delete (CRUD) model a typical data process is to read data from the store, make some modifications to it, and update the current state of the data with the new values&mdash;often by using transactions that lock the data.</span></span>

<span data-ttu-id="9eda6-112">Der CRUD-Ansatz weist einige Einschränkungen auf:</span><span class="sxs-lookup"><span data-stu-id="9eda6-112">The CRUD approach has some limitations:</span></span>

- <span data-ttu-id="9eda6-113">CRUD-Systeme führen Aktualisierungsvorgänge direkt in einem Datenspeicher durch, was aufgrund des erforderlichen Verarbeitungsaufwands die Leistung und Reaktionsfähigkeit verringern und die Skalierbarkeit einschränken kann.</span><span class="sxs-lookup"><span data-stu-id="9eda6-113">CRUD systems perform update operations directly against a data store, which can slow down performance and responsiveness, and limit scalability, due to the processing overhead it requires.</span></span>

- <span data-ttu-id="9eda6-114">In einer kollaborativen Domäne mit vielen gleichzeitigen Benutzern sind Datenaktualisierungskonflikte wahrscheinlicher, da die Aktualisierungsvorgänge in einem einzigen Datenelement stattfinden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-114">In a collaborative domain with many concurrent users, data update conflicts are more likely because the update operations take place on a single item of data.</span></span>

- <span data-ttu-id="9eda6-115">Sofern kein zusätzlicher Überwachungsmechanismus vorhanden ist, der die Details jedes Vorgangs in einem separaten Protokoll aufzeichnet, ist der Verlauf nicht mehr nachvollziehbar.</span><span class="sxs-lookup"><span data-stu-id="9eda6-115">Unless there's an additional auditing mechanism that records the details of each operation in a separate log, history is lost.</span></span>

> <span data-ttu-id="9eda6-116">Einen ausführlicheren Überblick über die Einschränkungen des CRUD-Ansatzes finden Sie unter [CRUD, Only When You Can Afford It](https://blogs.msdn.microsoft.com/maarten_mullender/2004/07/23/crud-only-when-you-can-afford-it-revisited/) (CRUD, aber nur wenn Sie es sich leisten können).</span><span class="sxs-lookup"><span data-stu-id="9eda6-116">For a deeper understanding of the limits of the CRUD approach see [CRUD, Only When You Can Afford It](https://blogs.msdn.microsoft.com/maarten_mullender/2004/07/23/crud-only-when-you-can-afford-it-revisited/).</span></span>

## <a name="solution"></a><span data-ttu-id="9eda6-117">Lösung</span><span class="sxs-lookup"><span data-stu-id="9eda6-117">Solution</span></span>

<span data-ttu-id="9eda6-118">Das Ereignissourcingmuster definiert eine Vorgehensweise zur Verarbeitung von Daten, die auf einer Ereignissequenz basiert. Jedes Ereignis wird in einem nur zum Anfügen vorgesehenen Speicher aufgezeichnet.</span><span class="sxs-lookup"><span data-stu-id="9eda6-118">The Event Sourcing pattern defines an approach to handling operations on data that's driven by a sequence of events, each of which is recorded in an append-only store.</span></span> <span data-ttu-id="9eda6-119">Der Anwendungscode sendet eine Reihe von Ereignissen, die zwingend jede Aktion beschreiben, die für die Daten im Ereignisspeicher ausgeführt wurde, in dem die Daten dauerhaft gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="9eda6-119">Application code sends a series of events that imperatively describe each action that has occurred on the data to the event store, where they're persisted.</span></span> <span data-ttu-id="9eda6-120">Jedes Ereignis stellt eine Reihe von Änderungen der Daten dar (z.B. `AddedItemToOrder`).</span><span class="sxs-lookup"><span data-stu-id="9eda6-120">Each event represents a set of changes to the data (such as `AddedItemToOrder`).</span></span>

<span data-ttu-id="9eda6-121">Die Ereignisse werden in einem Ereignisspeicher dauerhaft gespeichert, der als Aufzeichnungssystem (die maßgebliche Datenquelle) für den aktuellen Zustand der Daten fungiert.</span><span class="sxs-lookup"><span data-stu-id="9eda6-121">The events are persisted in an event store that acts as the system of record (the authoritative data source) about the current state of the data.</span></span> <span data-ttu-id="9eda6-122">Der Ereignisspeicher veröffentlicht diese Ereignisse in der Regel, sodass Consumer benachrichtigt werden und die Ereignisse bei Bedarf verarbeiten können.</span><span class="sxs-lookup"><span data-stu-id="9eda6-122">The event store typically publishes these events so that consumers can be notified and can handle them if needed.</span></span> <span data-ttu-id="9eda6-123">Consumer könnten z.B. Tasks initiieren, die die Vorgänge in den Ereignissen auf andere Systeme anwenden, oder eine andere verknüpfte Aktion ausführen, die zum Abschließen des Vorgangs erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="9eda6-123">Consumers could, for example, initiate tasks that apply the operations in the events to other systems, or perform any other associated action that's required to complete the operation.</span></span> <span data-ttu-id="9eda6-124">Beachten Sie, dass der Anwendungscode, der die Ereignisse generiert, von den Systemen abgekoppelt ist, die die Ereignisse abonnieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-124">Notice that the application code that generates the events is decoupled from the systems that subscribe to the events.</span></span>

<span data-ttu-id="9eda6-125">Typische Anwendungen der vom Ereignisspeicher veröffentlichten Ereignisse sind die Verwaltung materialisierter Sichten von Entitäten, wenn Aktionen in der Anwendung diese ändern, und die Integration in externe Systeme.</span><span class="sxs-lookup"><span data-stu-id="9eda6-125">Typical uses of the events published by the event store are to maintain materialized views of entities as actions in the application change them, and for integration with external systems.</span></span> <span data-ttu-id="9eda6-126">Ein System kann z.B. eine materialisierte Sicht aller Kundenaufträge verwalten, die zum Auffüllen von Teilen der Benutzeroberfläche verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9eda6-126">For example, a system can maintain a materialized view of all customer orders that's used to populate parts of the UI.</span></span> <span data-ttu-id="9eda6-127">Wenn die Anwendung neue Aufträge hinzufügt, einzelne Posten im Auftrag hinzufügt oder daraus entfernt und Versandinformationen hinzufügt, können die Ereignisse, die diese Änderungen beschreiben, verarbeitet und zum Aktualisieren der [materialisierten Sicht](./materialized-view.md) verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-127">As the application adds new orders, adds or removes items on the order, and adds shipping information, the events that describe these changes can be handled and used to update the [materialized view](./materialized-view.md).</span></span>

<span data-ttu-id="9eda6-128">Darüber hinaus können Anwendungen zu jeder Zeit den Verlauf der Ereignisse lesen und zum Materialisieren des aktuellen Zustands einer Entität verwenden. Dazu werden alle Ereignisse, die mit dieser Entität in Zusammenhang stehen, wiedergegeben und genutzt.</span><span class="sxs-lookup"><span data-stu-id="9eda6-128">In addition, at any point it's possible for applications to read the history of events, and use it to materialize the current state of an entity by playing back and consuming all the events related to that entity.</span></span> <span data-ttu-id="9eda6-129">Dies kann bei Bedarf erfolgen, um bei der Verarbeitung einer Anforderung ein Domänenobjekt zu materialisieren, oder durch einen geplanten Task, sodass der Zustand der Entität als materialisierte Sicht gespeichert werden kann, um die Darstellungsschicht zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-129">This can occur on demand to materialize a domain object when handling a request, or through a scheduled task so that the state of the entity can be stored as a materialized view to support the presentation layer.</span></span>

<span data-ttu-id="9eda6-130">Die Abbildung zeigt eine Übersicht über das Muster, einschließlich einiger Optionen für die Verwendung des Ereignisstroms: Erstellen einer materialisierten Sicht, Integrieren von Ereignissen in externe Anwendungen und Systeme und die Wiedergabe von Ereignissen, um Projektionen des aktuellen Zustands bestimmter Entitäten zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-130">The figure shows an overview of the pattern, including some of the options for using the event stream such as creating a materialized view, integrating events with external applications and systems, and replaying events to create projections of the current state of specific entities.</span></span>

![Übersicht und Beispiel des Ereignissourcingmusters](./_images/event-sourcing-overview.png)

<span data-ttu-id="9eda6-132">Das Ereignissourcingmuster bietet folgende Vorteile:</span><span class="sxs-lookup"><span data-stu-id="9eda6-132">The Event Sourcing pattern provides the following advantages:</span></span>

- <span data-ttu-id="9eda6-133">Ereignisse sind unveränderlich und können mit einem Nur-Anfügen-Vorgang gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-133">Events are immutable and can be stored using an append-only operation.</span></span> <span data-ttu-id="9eda6-134">Benutzeroberflächenelemente, Workflows oder Prozesse, die ein Ereignis auslösen, können weiterhin ausgeführt werden, und Tasks, die die Ereignisse verarbeiten, können im Hintergrund ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-134">The user interface, workflow, or process that initiated an event can continue, and tasks that handle the events can run in the background.</span></span> <span data-ttu-id="9eda6-135">In Verbindung mit der Tatsache, dass bei der Verarbeitung von Transaktionen keine Konflikte auftreten, kann dies die Leistung und Skalierbarkeit von Anwendungen erheblich verbessern, insbesondere für die Darstellungsschicht oder die Benutzeroberfläche.</span><span class="sxs-lookup"><span data-stu-id="9eda6-135">This, combined with the fact that there's no contention during the processing of transactions, can vastly improve performance and scalability for applications, especially for the presentation level or user interface.</span></span>

- <span data-ttu-id="9eda6-136">Ereignisse sind einfache Objekte, die eine bestimmte durchgeführte Aktion sowie alle zugehörigen Daten beschreiben, die zum Beschreiben der durch das Ereignis repräsentierten Aktion erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="9eda6-136">Events are simple objects that describe some action that occurred, together with any associated data required to describe the action represented by the event.</span></span> <span data-ttu-id="9eda6-137">Ereignisse aktualisieren einen Datenspeicher nicht direkt.</span><span class="sxs-lookup"><span data-stu-id="9eda6-137">Events don't directly update a data store.</span></span> <span data-ttu-id="9eda6-138">Sie werden nur aufgezeichnet, um zur richtigen Zeit verarbeitet zu werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-138">They're simply recorded for handling at the appropriate time.</span></span> <span data-ttu-id="9eda6-139">Dies kann die Implementierung und Verwaltung vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-139">This can simplify implementation and management.</span></span>

- <span data-ttu-id="9eda6-140">Ereignisse haben in der Regel eine Bedeutung für einen Domänenexperten, während die [objektrelationale Unverträglichkeit](https://en.wikipedia.org/wiki/Object-relational_impedance_mismatch) (Object-Relational Impedance Mismatch) dazu führen kann, dass komplexe Datenbanktabellen schwer zu verstehen sind.</span><span class="sxs-lookup"><span data-stu-id="9eda6-140">Events typically have meaning for a domain expert, whereas [object-relational impedance mismatch](https://en.wikipedia.org/wiki/Object-relational_impedance_mismatch) can make complex database tables hard to understand.</span></span> <span data-ttu-id="9eda6-141">Tabellen sind künstliche Konstrukte, die den aktuellen Zustand des Systems repräsentieren, nicht die aufgetretenen Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="9eda6-141">Tables are artificial constructs that represent the current state of the system, not the events that occurred.</span></span>

- <span data-ttu-id="9eda6-142">Ereignissourcing kann verhindern, dass gleichzeitige Updates Konflikte verursachen, weil Objekte nicht direkt im Datenspeicher aktualisiert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-142">Event sourcing can help prevent concurrent updates from causing conflicts because it avoids the requirement to directly update objects in the data store.</span></span> <span data-ttu-id="9eda6-143">Das Domänenmodell muss jedoch weiterhin so entworfen werden, dass es sich selbst vor Anforderungen schützen kann, die zu einem inkonsistenten Zustand führen könnten.</span><span class="sxs-lookup"><span data-stu-id="9eda6-143">However, the domain model must still be designed to protect itself from requests that might result in an inconsistent state.</span></span>

- <span data-ttu-id="9eda6-144">Die Nur-Anfügen-Speicherung von Ereignissen bietet einen Überwachungspfad, der für folgende Aufgaben verwendet werden kann: Überwachen von Aktionen in einem Datenspeicher, Wiederherstellen des aktuellen Zustands als materialisierte Sichten oder Projektionen durch die Wiedergabe der Ereignisse zu einem beliebigen Zeitpunkt sowie Testen und Debuggen des Systems.</span><span class="sxs-lookup"><span data-stu-id="9eda6-144">The append-only storage of events provides an audit trail that can be used to monitor actions taken against a data store, regenerate the current state as materialized views or projections by replaying the events at any time, and assist in testing and debugging the system.</span></span> <span data-ttu-id="9eda6-145">Darüber hinaus wird durch die Anforderung, zum Abbrechen von Änderungen kompensierende Ereignisse zu verwenden, ein Verlauf der rückgängig gemachten Änderungen erstellt. Dies wäre nicht der Fall, wenn das Modell einfach nur den aktuellen Zustand speichern würde.</span><span class="sxs-lookup"><span data-stu-id="9eda6-145">In addition, the requirement to use compensating events to cancel changes provides a history of changes that were reversed, which wouldn't be the case if the model simply stored the current state.</span></span> <span data-ttu-id="9eda6-146">Die Liste der Ereignisse kann auch verwendet werden, um die Anwendungsleistung zu analysieren und Trends im Benutzerverhalten zu erkennen oder um andere hilfreiche Geschäftsinformationen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-146">The list of events can also be used to analyze application performance and detect user behavior trends, or to obtain other useful business information.</span></span>

- <span data-ttu-id="9eda6-147">Der Ereignisspeicher löst Ereignisse aus, Tasks führen Vorgänge als Reaktion auf diese Ereignisse aus.</span><span class="sxs-lookup"><span data-stu-id="9eda6-147">The event store raises events, and tasks perform operations in response to those events.</span></span> <span data-ttu-id="9eda6-148">Diese Abkopplung der Tasks von den Ereignissen sorgt für Flexibilität und Erweiterbarkeit.</span><span class="sxs-lookup"><span data-stu-id="9eda6-148">This decoupling of the tasks from the events provides flexibility and extensibility.</span></span> <span data-ttu-id="9eda6-149">Tasks kennen den Ereignistyp und die Ereignisdaten, aber nicht den Vorgang, der das Ereignis ausgelöst hat.</span><span class="sxs-lookup"><span data-stu-id="9eda6-149">Tasks know about the type of event and the event data, but not about the operation that triggered the event.</span></span> <span data-ttu-id="9eda6-150">Darüber hinaus kann jedes Ereignis von mehreren Tasks verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-150">In addition, multiple tasks can handle each event.</span></span> <span data-ttu-id="9eda6-151">Dies ermöglicht eine einfache Integration in andere Dienste und Systeme, die nur auf neue vom Ereignisspeicher ausgelöste Ereignisse lauschen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-151">This enables easy integration with other services and systems that only listen for new events raised by the event store.</span></span> <span data-ttu-id="9eda6-152">Die Ereignisse beim Ereignissourcing sind jedoch zuweilen sehr spezifisch, und es ist möglicherweise erforderlich, stattdessen spezielle Integrationsereignisse zu generieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-152">However, the event sourcing events tend to be very low level, and it might be necessary to generate specific integration events instead.</span></span>

> <span data-ttu-id="9eda6-153">Das Ereignissourcing wird häufig mit dem CQRS-Muster kombiniert, indem als Reaktion auf die Ereignisse Datenverwaltungstasks ausgeführt und aus den gespeicherten Ereignissen Sichten materialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-153">Event sourcing is commonly combined with the CQRS pattern by performing the data management tasks in response to the events, and by materializing views from the stored events.</span></span>

## <a name="issues-and-considerations"></a><span data-ttu-id="9eda6-154">Probleme und Überlegungen</span><span class="sxs-lookup"><span data-stu-id="9eda6-154">Issues and considerations</span></span>

<span data-ttu-id="9eda6-155">Beachten Sie die folgenden Punkte bei der Entscheidung, wie dieses Muster implementiert werden soll:</span><span class="sxs-lookup"><span data-stu-id="9eda6-155">Consider the following points when deciding how to implement this pattern:</span></span>

<span data-ttu-id="9eda6-156">Das System ist nur dann letztlich konsistent, wenn durch Wiedergabe von Ereignissen materialisierte Sichten erstellt oder Projektionen generiert werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-156">The system will only be eventually consistent when creating materialized views or generating projections of data by replaying events.</span></span> <span data-ttu-id="9eda6-157">Es gibt eine gewisse Verzögerung zwischen dem Hinzufügen von Ereignissen zum Ereignisspeicher durch eine Anwendung nach der Verarbeitung einer Anforderung, dem Veröffentlichen der Ereignisse und dem Verarbeiten der Ereignisse durch Consumer.</span><span class="sxs-lookup"><span data-stu-id="9eda6-157">There's some delay between an application adding events to the event store as the result of handling a request, the events being published, and consumers of the events handling them.</span></span> <span data-ttu-id="9eda6-158">Während dieses Zeitraums können neue Ereignisse im Ereignisspeicher eingegangen sein, die weitere Änderungen an Entitäten beschreiben.</span><span class="sxs-lookup"><span data-stu-id="9eda6-158">During this period, new events that describe further changes to entities might have arrived at the event store.</span></span>

> [!NOTE]
> <span data-ttu-id="9eda6-159">Weitere Informationen zur letztlichen Konsistenz finden Sie unter [Data Consistency Primer](https://msdn.microsoft.com/library/dn589800.aspx) (Grundlagen der Datenkonsistenz).</span><span class="sxs-lookup"><span data-stu-id="9eda6-159">See the [Data Consistency Primer](https://msdn.microsoft.com/library/dn589800.aspx) for information about eventual consistency.</span></span>

<span data-ttu-id="9eda6-160">Der Ereignisspeicher ist die dauerhafte Informationsquelle, daher sollten Ereignisdaten niemals aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-160">The event store is the permanent source of information, and so the event data should never be updated.</span></span> <span data-ttu-id="9eda6-161">Die einzige Möglichkeit, eine Entität zu aktualisieren, um eine Änderung rückgängig zu machen, besteht darin, dem Ereignisspeicher ein kompensierendes Ereignis hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-161">The only way to update an entity to undo a change is to add a compensating event to the event store.</span></span> <span data-ttu-id="9eda6-162">Wenn das Format (nicht die Daten) der dauerhaft gespeicherten Ereignisse geändert werden muss – möglicherweise während einer Migration –, kann es schwierig sein, vorhandene Ereignisse im Speicher mit der neuen Version zu kombinieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-162">If the format (rather than the data) of the persisted events needs to change, perhaps during a migration, it can be difficult to combine existing events in the store with the new version.</span></span> <span data-ttu-id="9eda6-163">Möglicherweise müssen alle Ereignisse durchlaufen werden, die Änderungen vornehmen, sodass die Ereignisse mit dem neuen Format konform sind. Eventuell müssen auch neue Ereignisse hinzugefügt werden, die das neue Format verwenden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-163">It might be necessary to iterate through all the events making changes so they're compliant with the new format, or add new events that use the new format.</span></span> <span data-ttu-id="9eda6-164">Ziehen Sie in Betracht, einen Versionsstempel für jede Version des Ereignisschemas zu verwenden, um sowohl das alte als auch das neue Ereignisformat beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="9eda6-164">Consider using a version stamp on each version of the event schema to maintain both the old and the new event formats.</span></span>

<span data-ttu-id="9eda6-165">Möglicherweise speichern Anwendungen mit mehreren Threads und mehrere Instanzen von Anwendungen Ereignisse im Ereignisspeicher.</span><span class="sxs-lookup"><span data-stu-id="9eda6-165">Multi-threaded applications and multiple instances of applications might be storing events in the event store.</span></span> <span data-ttu-id="9eda6-166">Die Konsistenz der Ereignisse im Ereignisspeicher ist von entscheidender Bedeutung, ebenso wie die Reihenfolge der Ereignisse, die eine bestimmte Entität betreffen (die Reihenfolge, in der Änderungen auf eine Entität angewendet werden, wirkt sich auf den aktuellen Zustand aus).</span><span class="sxs-lookup"><span data-stu-id="9eda6-166">The consistency of events in the event store is vital, as is the order of events that affect a specific entity (the order that changes occur to an entity affects its current state).</span></span> <span data-ttu-id="9eda6-167">Durch Hinzufügen eines Zeitstempels zu jedem Ereignis lassen sich Probleme verhindern.</span><span class="sxs-lookup"><span data-stu-id="9eda6-167">Adding a timestamp to every event can help to avoid issues.</span></span> <span data-ttu-id="9eda6-168">Eine weitere häufige Vorgehensweise besteht darin, jedes Ereignis, das aus einer Anforderung resultiert, mit einem inkrementellen Bezeichner zu kommentieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-168">Another common practice is to annotate each event resulting from a request with an incremental identifier.</span></span> <span data-ttu-id="9eda6-169">Wenn zwei Aktionen versuchen, gleichzeitig Ereignisse für die gleiche Entität hinzuzufügen, kann der Ereignisspeicher ein Ereignis ablehnen, das mit einem vorhandenen Entitätsbezeichner und einem vorhandenen Ereignisbezeichner übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="9eda6-169">If two actions attempt to add events for the same entity at the same time, the event store can reject an event that matches an existing entity identifier and event identifier.</span></span>

<span data-ttu-id="9eda6-170">Es gibt keine Standardmethode oder vorhandene Mechanismen wie beispielsweise SQL-Abfragen, um Informationen aus Ereignissen auszulesen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-170">There's no standard approach, or existing mechanisms such as SQL queries, for reading the events to obtain information.</span></span> <span data-ttu-id="9eda6-171">Die einzigen Daten, die extrahiert werden können, sind Ereignisströme. Hierbei wird ein Ereignisbezeichner als Kriterium verwendet.</span><span class="sxs-lookup"><span data-stu-id="9eda6-171">The only data that can be extracted is a stream of events using an event identifier as the criteria.</span></span> <span data-ttu-id="9eda6-172">Die Ereignis-ID lässt sich in der Regel einzelnen Entitäten zuordnen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-172">The event ID typically maps to individual entities.</span></span> <span data-ttu-id="9eda6-173">Der aktuelle Zustand einer Entität kann nur bestimmt werden, indem alle Ereignisse, die sich auf sie beziehen, im Vergleich zum ursprünglichen Zustand der Entität wiedergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-173">The current state of an entity can be determined only by replaying all of the events that relate to it against the original state of that entity.</span></span>

<span data-ttu-id="9eda6-174">Die Länge der einzelnen Ereignisströme wirkt sich auf die Verwaltung und Aktualisierung des Systems aus.</span><span class="sxs-lookup"><span data-stu-id="9eda6-174">The length of each event stream affects managing and updating the system.</span></span> <span data-ttu-id="9eda6-175">Wenn die Ströme umfangreich sind, kann es sinnvoll sein, in bestimmten Intervallen – z.B. nach einer bestimmten Anzahl von Ereignissen – Momentaufnahmen zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-175">If the streams are large, consider creating snapshots at specific intervals such as a specified number of events.</span></span> <span data-ttu-id="9eda6-176">Der aktuelle Zustand der Entität kann aus der Momentaufnahme abgerufen werden, indem alle Ereignisse wiedergegeben werden, die nach diesem Zeitpunkt aufgetreten sind.</span><span class="sxs-lookup"><span data-stu-id="9eda6-176">The current state of the entity can be obtained from the snapshot and by replaying any events that occurred after that point in time.</span></span> <span data-ttu-id="9eda6-177">Weitere Informationen zum Erstellen von Momentaufnahmen von Daten finden Sie auf der [Enterprise Application Architecture-Website von Martin Fowler unter „Snapshot“](https://martinfowler.com/eaaDev/Snapshot.html) und im Artikel [Master-Subordinate Snapshot Replication](https://msdn.microsoft.com/library/ff650012.aspx) (Momentaufnahmereplikation mit Masterelementen und untergeordneten Elementen).</span><span class="sxs-lookup"><span data-stu-id="9eda6-177">For more information about creating snapshots of data, see [Snapshot on Martin Fowler’s Enterprise Application Architecture website](https://martinfowler.com/eaaDev/Snapshot.html) and [Master-Subordinate Snapshot Replication](https://msdn.microsoft.com/library/ff650012.aspx).</span></span>

<span data-ttu-id="9eda6-178">Auch wenn das Ereignissourcing das Risiko von Aktualisierungskonflikten bei den Daten minimiert, muss die Anwendung dennoch weiterhin in der Lage sein, Inkonsistenzen zu bewältigen, die aus der letztlichen Konsistenz und dem Fehlen von Transaktionen entstehen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-178">Even though event sourcing minimizes the chance of conflicting updates to the data, the application must still be able to deal with inconsistencies that result from eventual consistency and the lack of transactions.</span></span> <span data-ttu-id="9eda6-179">Ein Beispiel: Ein Ereignis, das eine Reduzierung des Lagerbestands für diesen Artikel angibt, wird in den Datenspeicher übermittelt, während eine Bestellung für einen Artikel platziert wird. Daraus entsteht eine Anforderung, die beiden Vorgänge in Einklang zu bringen – entweder durch eine Nachricht an den Kunden oder durch Nachbestellen des Artikels.</span><span class="sxs-lookup"><span data-stu-id="9eda6-179">For example, an event that indicates a reduction in stock inventory might arrive in the data store while an order for that item is being placed, resulting in a requirement to reconcile the two operations either by advising the customer or creating a back order.</span></span>

<span data-ttu-id="9eda6-180">Jede Veröffentlichung kann als „at least once“ festgelegt sein, daher müssen Consumer der Ereignisse idempotent sein.</span><span class="sxs-lookup"><span data-stu-id="9eda6-180">Event publication might be “at least once,” and so consumers of the events must be idempotent.</span></span> <span data-ttu-id="9eda6-181">Sie dürfen das in einem Ereignis beschriebene Update nicht erneut anwenden, wenn das Ereignis mehr als einmal verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="9eda6-181">They must not reapply the update described in an event if the event is handled more than once.</span></span> <span data-ttu-id="9eda6-182">Wenn beispielsweise mehrere Instanzen eines Consumers das Aggregat einer Entitätseigenschaft verwalten, wie etwa die Gesamtanzahl platzierter Bestellungen, darf nur eine Instanz das Aggregat erhöhen, wenn ein „Bestellung platziert“-Ereignis auftritt.</span><span class="sxs-lookup"><span data-stu-id="9eda6-182">For example, if multiple instances of a consumer maintain an aggregate an entity's property, such as the total number of orders placed, only one must succeed in incrementing the aggregate when an order placed event occurs.</span></span> <span data-ttu-id="9eda6-183">Dies ist zwar kein entscheidendes Merkmal des Ereignissourcing, aber die übliche Implementierungsentscheidung.</span><span class="sxs-lookup"><span data-stu-id="9eda6-183">While this isn't a key characteristic of event sourcing, it's the usual implementation decision.</span></span>

## <a name="when-to-use-this-pattern"></a><span data-ttu-id="9eda6-184">Verwendung dieses Musters</span><span class="sxs-lookup"><span data-stu-id="9eda6-184">When to use this pattern</span></span>

<span data-ttu-id="9eda6-185">Verwenden Sie dieses Muster in folgenden Szenarien:</span><span class="sxs-lookup"><span data-stu-id="9eda6-185">Use this pattern in the following scenarios:</span></span>

- <span data-ttu-id="9eda6-186">Sie möchten eine Absicht, einen Zweck oder einen Grund in den Daten erfassen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-186">When you want to capture intent, purpose, or reason in the data.</span></span> <span data-ttu-id="9eda6-187">Änderungen an einer Kundenentität können z.B. als Reihe von bestimmten Ereignistypen erfasst werden, wie etwa _Umgezogen_, _Konto gekündigt_ oder _Verstorben_.</span><span class="sxs-lookup"><span data-stu-id="9eda6-187">For example, changes to a customer entity can be captured as a series of specific event types such as _Moved home_, _Closed account_, or _Deceased_.</span></span>

- <span data-ttu-id="9eda6-188">Es ist von entscheidender Bedeutung, Aktualisierungskonflikte bei Daten zu minimieren oder vollständig zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-188">When it's vital to minimize or completely avoid the occurrence of conflicting updates to data.</span></span>

- <span data-ttu-id="9eda6-189">Sie möchten auftretende Ereignisse aufzeichnen und wiedergeben, um den Zustand eines Systems wiederherzustellen, Änderungen rückgängig zu machen oder ein Verlaufs- und Überwachungsprotokoll zu pflegen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-189">When you want to record events that occur, and be able to replay them to restore the state of a system, roll back changes, or keep a history and audit log.</span></span> <span data-ttu-id="9eda6-190">Wenn beispielsweise ein Task mehrere Schritte umfasst, müssen Sie möglicherweise Aktionen ausführen, um Updates rückgängig zu machen, und dann einige Schritte wiedergeben, um die Daten wieder in einen konsistenten Zustand zu versetzen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-190">For example, when a task involves multiple steps you might need to execute actions to revert updates and then replay some steps to bring the data back into a consistent state.</span></span>

- <span data-ttu-id="9eda6-191">Das Verwenden von Ereignissen ist eine natürliche Betriebsfunktion der Anwendung und erfordert wenig zusätzlichen Aufwand für die Entwicklung und Implementierung.</span><span class="sxs-lookup"><span data-stu-id="9eda6-191">When using events is a natural feature of the operation of the application, and requires little additional development or implementation effort.</span></span>

- <span data-ttu-id="9eda6-192">Sie müssen den Prozess der Eingabe oder Aktualisierung von Daten von den Tasks abkoppeln, die zum Anwenden dieser Aktionen erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="9eda6-192">When you need to decouple the process of inputting or updating data from the tasks required to apply these actions.</span></span> <span data-ttu-id="9eda6-193">Dies kann dazu dienen, die Leistung der Benutzeroberfläche zu verbessern oder Ereignisse auf andere Listener zu verteilen, die eine Aktion ausführen, wenn die Ereignisse auftreten.</span><span class="sxs-lookup"><span data-stu-id="9eda6-193">This might be to improve UI performance, or to distribute events to other listeners that take action when the events occur.</span></span> <span data-ttu-id="9eda6-194">Ein Beispiel hierfür ist die Integration eines Lohnabrechnungssystems in eine Website für die Übermittlung von Spesenabrechnungen. Hierbei können Ereignisse, die vom Ereignisspeicher als Reaktion auf in der Website erfolgte Datenupdates ausgelöst wurden, sowohl von der Website als auch vom Lohnabrechnungssystem genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-194">For example, integrating a payroll system with an expense submission website so that events raised by the event store in response to data updates made in the website are consumed by both the website and the payroll system.</span></span>

- <span data-ttu-id="9eda6-195">Sie benötigen mehr Flexibilität, um das Format materialisierter Modelle und Entitätsdaten ändern zu können, wenn sich die Anforderungen ändern. Oder Sie verwenden das Muster zusammen mit CQRS und müssen ein Lesemodell oder die Ansichten anpassen, die die Daten verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-195">When you want flexibility to be able to change the format of materialized models and entity data if requirements change, or&mdash;when used in conjunction with CQRS&mdash;you need to adapt a read model or the views that expose the data.</span></span>

- <span data-ttu-id="9eda6-196">Sie verwenden das Muster zusammen mit CQRS, und die letztliche Konsistenz ist akzeptabel, während ein Lesemodell aktualisiert wird, oder die Leistungsbeeinträchtigung durch das Aktivieren von Entitäten und Daten aus einem Ereignisstrom ist akzeptabel.</span><span class="sxs-lookup"><span data-stu-id="9eda6-196">When used in conjunction with CQRS, and eventual consistency is acceptable while a read model is updated, or the performance impact of rehydrating entities and data from an event stream is acceptable.</span></span>

<span data-ttu-id="9eda6-197">Dieses Muster ist in den folgenden Situationen eventuell nicht nützlich:</span><span class="sxs-lookup"><span data-stu-id="9eda6-197">This pattern might not be useful in the following situations:</span></span>

- <span data-ttu-id="9eda6-198">Kleine oder einfache Domänen, Systeme ohne oder mit nur geringfügiger Geschäftslogik oder Systeme ohne Domäne, die naturgemäß gut mit herkömmlichen CRUD-Datenverwaltungsmechanismen funktionieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-198">Small or simple domains, systems that have little or no business logic, or nondomain systems that naturally work well with traditional CRUD data management mechanisms.</span></span>

- <span data-ttu-id="9eda6-199">Systeme, in denen Konsistenz und Echtzeitupdates der Datensichten erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="9eda6-199">Systems where consistency and real-time updates to the views of the data are required.</span></span>

- <span data-ttu-id="9eda6-200">Systeme, in den Überwachungspfade, Verlaufsinformationen und Funktionen zum Ausführen von Rollbacks und Wiedergeben von Aktionen nicht erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="9eda6-200">Systems where audit trails, history, and capabilities to roll back and replay actions are not required.</span></span>

- <span data-ttu-id="9eda6-201">Systeme, bei denen nur in sehr geringem Maß Aktualisierungskonflikte bei den zugrunde liegenden Daten auftreten.</span><span class="sxs-lookup"><span data-stu-id="9eda6-201">Systems where there's only a very low occurrence of conflicting updates to the underlying data.</span></span> <span data-ttu-id="9eda6-202">Dies können z.B. Systeme sein, die Daten eher hinzufügen als aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-202">For example, systems that predominantly add data rather than updating it.</span></span>

## <a name="example"></a><span data-ttu-id="9eda6-203">Beispiel</span><span class="sxs-lookup"><span data-stu-id="9eda6-203">Example</span></span>

<span data-ttu-id="9eda6-204">Ein Konferenzverwaltungssystem muss die Anzahl abgeschlossener Buchungen für eine Konferenz nachverfolgen, um überprüfen zu können, ob noch Plätze verfügbar sind, wenn ein potenzieller Teilnehmer eine Buchung vornehmen möchte.</span><span class="sxs-lookup"><span data-stu-id="9eda6-204">A conference management system needs to track the number of completed bookings for a conference so that it can check whether there are seats still available when a potential attendee tries to make a booking.</span></span> <span data-ttu-id="9eda6-205">Das System kann die Gesamtanzahl von Buchungen für eine Konferenz auf mindestens zwei Arten speichern:</span><span class="sxs-lookup"><span data-stu-id="9eda6-205">The system could store the total number of bookings for a conference in at least two ways:</span></span>

- <span data-ttu-id="9eda6-206">Das System kann die Informationen zur Gesamtanzahl von Buchungen als separate Entität in einer Datenbank speichern, die Buchungsinformationen enthält.</span><span class="sxs-lookup"><span data-stu-id="9eda6-206">The system could store the information about the total number of bookings as a separate entity in a database that holds booking information.</span></span> <span data-ttu-id="9eda6-207">Wenn Buchungen vorgenommen oder storniert werden, kann das System diese Zahl entsprechend erhöhen oder reduzieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-207">As bookings are made or canceled, the system could increment or decrement this number as appropriate.</span></span> <span data-ttu-id="9eda6-208">Dieser Ansatz ist in der Theorie sehr einfach, kann aber zu Skalierbarkeitsproblemen führen, wenn eine große Anzahl von Teilnehmern innerhalb kurzer Zeit versucht, Plätze zu buchen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-208">This approach is simple in theory, but can cause scalability issues if a large number of attendees are attempting to book seats during a short period of time.</span></span> <span data-ttu-id="9eda6-209">Dies kann beispielsweise am letzten Tag des möglichen Buchungszeitraums der Fall sein.</span><span class="sxs-lookup"><span data-stu-id="9eda6-209">For example, in the last day or so prior to the booking period closing.</span></span>

- <span data-ttu-id="9eda6-210">Das System kann Informationen zu Buchungen und Stornierungen in Form von Ereignissen in einem Ereignisspeicher speichern.</span><span class="sxs-lookup"><span data-stu-id="9eda6-210">The system could store information about bookings and cancellations as events held in an event store.</span></span> <span data-ttu-id="9eda6-211">So kann das System die Anzahl der verfügbaren Plätze durch Wiedergabe dieser Ereignisse berechnen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-211">It could then calculate the number of seats available by replaying these events.</span></span> <span data-ttu-id="9eda6-212">Dieser Ansatz ist aufgrund der Unveränderlichkeit von Ereignissen besser skalierbar.</span><span class="sxs-lookup"><span data-stu-id="9eda6-212">This approach can be more scalable due to the immutability of events.</span></span> <span data-ttu-id="9eda6-213">Das System muss nur Daten aus dem Ereignisspeicher lesen oder an den Ereignisspeicher anfügen können.</span><span class="sxs-lookup"><span data-stu-id="9eda6-213">The system only needs to be able to read data from the event store, or append data to the event store.</span></span> <span data-ttu-id="9eda6-214">Ereignisinformationen zu Buchungen und Stornierungen werden niemals geändert.</span><span class="sxs-lookup"><span data-stu-id="9eda6-214">Event information about bookings and cancellations is never modified.</span></span>

<span data-ttu-id="9eda6-215">Das folgende Diagramm veranschaulicht, wie das Platzreservierungs-Subsystem des Konferenzverwaltungssystems mithilfe des Ereignissourcingmusters implementiert werden könnte.</span><span class="sxs-lookup"><span data-stu-id="9eda6-215">The following diagram illustrates how the seat reservation subsystem of the conference management system might be implemented using event sourcing.</span></span>

![Verwenden von Ereignissourcing zum Erfassen von Informationen zu Platzreservierungen in einem Konferenzverwaltungssystem](./_images/event-sourcing-bounded-context.png)

<span data-ttu-id="9eda6-217">Die Aktionssequenz für die Reservierung von zwei Plätzen lautet folgendermaßen:</span><span class="sxs-lookup"><span data-stu-id="9eda6-217">The sequence of actions for reserving two seats is as follows:</span></span>

1. <span data-ttu-id="9eda6-218">Die Benutzeroberfläche gibt einen Befehl aus, um Plätze für zwei Teilnehmer zu reservieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-218">The user interface issues a command to reserve seats for two attendees.</span></span> <span data-ttu-id="9eda6-219">Der Befehl wird von einem separaten Befehlshandler verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="9eda6-219">The command is handled by a separate command handler.</span></span> <span data-ttu-id="9eda6-220">Dies ist ein Stück Logik, das von der Benutzeroberfläche abgekoppelt ist und für die Verarbeitung von Anforderungen zuständig ist, die als Befehle übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="9eda6-220">A piece of logic that is decoupled from the user interface and is responsible for handling requests posted as commands.</span></span>

2. <span data-ttu-id="9eda6-221">Es wird ein Aggregat mit Informationen zu allen Reservierungen für die Konferenz erstellt, indem die Ereignisse abgefragt werden, die Buchungen und Stornierungen beschreiben.</span><span class="sxs-lookup"><span data-stu-id="9eda6-221">An aggregate containing information about all reservations for the conference is constructed by querying the events that describe bookings and cancellations.</span></span> <span data-ttu-id="9eda6-222">Dieses Aggregat wird als `SeatAvailability` bezeichnet und ist in einem Domänenmodell enthalten, das Methoden zum Abfragen und Ändern der Daten im Aggregat verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="9eda6-222">This aggregate is called `SeatAvailability`, and is contained within a domain model that exposes methods for querying and modifying the data in the aggregate.</span></span>

    > <span data-ttu-id="9eda6-223">Ziehen Sie ggf. folgende Optimierungen in Betracht: Verwenden von Momentaufnahmen (damit Sie nicht die gesamte Liste der Ereignisse abfragen und wiedergeben müssen, um den aktuellen Zustand des Aggregats zu erhalten) und Zwischenspeichern einer Kopie des Aggregats im Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="9eda6-223">Some optimizations to consider are using snapshots (so that you don’t need to query and replay the full list of events to obtain the current state of the aggregate), and maintaining a cached copy of the aggregate in memory.</span></span>

3. <span data-ttu-id="9eda6-224">Der Befehlshandler ruft eine Methode auf, die vom Domänenmodell verfügbar gemacht wurde, um die Reservierungen vorzunehmen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-224">The command handler invokes a method exposed by the domain model to make the reservations.</span></span>

4. <span data-ttu-id="9eda6-225">Das `SeatAvailability`-Aggregat zeichnet ein Ereignis auf, das die Anzahl von reservierten Plätzen enthält.</span><span class="sxs-lookup"><span data-stu-id="9eda6-225">The `SeatAvailability` aggregate records an event containing the number of seats that were reserved.</span></span> <span data-ttu-id="9eda6-226">Wenn das Aggregat das nächste Mal Ereignisse anwendet, werden alle Reservierungen verwendet, um zu berechnen, wie viele Plätze verbleiben.</span><span class="sxs-lookup"><span data-stu-id="9eda6-226">The next time the aggregate applies events, all the reservations will be used to compute how many seats remain.</span></span>

5. <span data-ttu-id="9eda6-227">Das System fügt das neue Ereignis an die Liste der Ereignisse im Ereignisspeicher an.</span><span class="sxs-lookup"><span data-stu-id="9eda6-227">The system appends the new event to the list of events in the event store.</span></span>

<span data-ttu-id="9eda6-228">Wenn ein Benutzer einen Platz storniert, ist das Verfahren ähnlich – mit einer Ausnahme: Der Befehlshandler gibt einen Befehl aus, der ein Stornierungsereignis generiert und dieses an den Ereignisspeicher anfügt.</span><span class="sxs-lookup"><span data-stu-id="9eda6-228">If a user cancels a seat, the system follows a similar process except the command handler issues a command that generates a seat cancellation event and appends it to the event store.</span></span>

<span data-ttu-id="9eda6-229">Ein Ereignisspeicher bietet nicht nur mehr Raum für Skalierbarkeit, sondern auch einen vollständigen Verlauf bzw. Überwachungspfad der Buchungen und Stornierungen für eine Konferenz.</span><span class="sxs-lookup"><span data-stu-id="9eda6-229">As well as providing more scope for scalability, using an event store also provides a complete history, or audit trail, of the bookings and cancellations for a conference.</span></span> <span data-ttu-id="9eda6-230">Die Ereignisse im Ereignisspeicher stellen den korrekten Datensatz dar.</span><span class="sxs-lookup"><span data-stu-id="9eda6-230">The events in the event store are the accurate record.</span></span> <span data-ttu-id="9eda6-231">Es ist nicht notwendig, Aggregate auf andere Weise dauerhaft zu speichern, weil das System ganz einfach die Ereignisse wiedergeben und den Zustand auf einen beliebigen Zeitpunkt wiederherstellen kann.</span><span class="sxs-lookup"><span data-stu-id="9eda6-231">There is no need to persist aggregates in any other way because the system can easily replay the events and restore the state to any point in time.</span></span>

> <span data-ttu-id="9eda6-232">Weitere Information zu diesem Beispiel finden Sie unter [Introducing Event Sourcing](https://msdn.microsoft.com/library/jj591559.aspx) (Einführung in das Ereignissourcing).</span><span class="sxs-lookup"><span data-stu-id="9eda6-232">You can find more information about this example in [Introducing Event Sourcing](https://msdn.microsoft.com/library/jj591559.aspx).</span></span>

## <a name="related-patterns-and-guidance"></a><span data-ttu-id="9eda6-233">Zugehörige Muster und Anleitungen</span><span class="sxs-lookup"><span data-stu-id="9eda6-233">Related patterns and guidance</span></span>

<span data-ttu-id="9eda6-234">Die folgenden Muster und Anweisungen können für die Implementierung dieses Musters ebenfalls relevant sein:</span><span class="sxs-lookup"><span data-stu-id="9eda6-234">The following patterns and guidance might also be relevant when implementing this pattern:</span></span>

- <span data-ttu-id="9eda6-235">[CQRS-Muster (Command and Query Responsibility Segregation)](./cqrs.md).</span><span class="sxs-lookup"><span data-stu-id="9eda6-235">[Command and Query Responsibility Segregation (CQRS) pattern](./cqrs.md).</span></span> <span data-ttu-id="9eda6-236">Der Schreibspeicher, der die permanente Informationsquelle für eine CQRS-Implementierung bereitstellt, basiert oft auf einer Implementierung des Ereignissourcingmusters.</span><span class="sxs-lookup"><span data-stu-id="9eda6-236">The write store that provides the permanent source of information for a CQRS implementation is often based on an implementation of the Event Sourcing pattern.</span></span> <span data-ttu-id="9eda6-237">Das Muster beschreibt, wie mithilfe separater Schnittstellen die Vorgänge, die Daten in einer Anwendung lesen, von den Vorgängen getrennt werden, die Daten aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-237">Describes how to segregate the operations that read data in an application from the operations that update data by using separate interfaces.</span></span>

- <span data-ttu-id="9eda6-238">[Muster „Materialisierte Sichten“](./materialized-view.md):</span><span class="sxs-lookup"><span data-stu-id="9eda6-238">[Materialized View pattern](./materialized-view.md).</span></span> <span data-ttu-id="9eda6-239">Der Datenspeicher, der in einem auf Ereignissourcing basierenden System verwendet wird, eignet sich in der Regel nicht gut für effiziente Abfragen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-239">The data store used in a system based on event sourcing is typically not well suited to efficient querying.</span></span> <span data-ttu-id="9eda6-240">Ein häufiger Ansatz besteht darin, in regelmäßigen Abständen oder bei Änderung von Daten vorab aufgefüllte Sichten der Daten zu generieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-240">Instead, a common approach is to generate prepopulated views of the data at regular intervals, or when the data changes.</span></span> <span data-ttu-id="9eda6-241">Das Muster zeigt, wie dies umgesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="9eda6-241">Shows how this can be done.</span></span>

- <span data-ttu-id="9eda6-242">[Muster „Kompensierende Transaktion“](./compensating-transaction.md):</span><span class="sxs-lookup"><span data-stu-id="9eda6-242">[Compensating Transaction pattern](./compensating-transaction.md).</span></span> <span data-ttu-id="9eda6-243">Die vorhandenen Daten in einem Ereignissourcingspeicher werden nicht aktualisiert. Stattdessen werden neue Einträge hinzugefügt, die den Zustand der Entitäten auf die neuen Werte übertragen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-243">The existing data in an event sourcing store is not updated, instead new entries are added that transition the state of entities to the new values.</span></span> <span data-ttu-id="9eda6-244">Um eine Änderung rückgängig zu machen, werden kompensierende Einträge verwendet, da es nicht möglich ist, die vorherige Änderung einfach rückgängig zu machen.</span><span class="sxs-lookup"><span data-stu-id="9eda6-244">To reverse a change, compensating entries are used because it isn't possible to simply reverse the previous change.</span></span> <span data-ttu-id="9eda6-245">Dieses Muster beschreibt, wie die Ergebnisse eines vorherigen Vorgangs rückgängig gemacht werden können.</span><span class="sxs-lookup"><span data-stu-id="9eda6-245">Describes how to undo the work that was performed by a previous operation.</span></span>

- <span data-ttu-id="9eda6-246">[Data Consistency Primer](https://msdn.microsoft.com/library/dn589800.aspx) (Grundlagen der Datenkonsistenz).</span><span class="sxs-lookup"><span data-stu-id="9eda6-246">[Data Consistency Primer](https://msdn.microsoft.com/library/dn589800.aspx).</span></span> <span data-ttu-id="9eda6-247">Wenn das Ereignissourcing mit einem separaten Lesespeicher oder materialisierten Sichten verwendet wird, sind die gelesenen Daten nicht sofort, sondern nur letztlich konsistent.</span><span class="sxs-lookup"><span data-stu-id="9eda6-247">When using event sourcing with a separate read store or materialized views, the read data won't be immediately consistent, instead it'll be only eventually consistent.</span></span> <span data-ttu-id="9eda6-248">Das Muster bietet eine Übersicht über die Probleme bei der Gewährleistung von Konsistenz bei verteilten Daten.</span><span class="sxs-lookup"><span data-stu-id="9eda6-248">Summarizes the issues surrounding maintaining consistency over distributed data.</span></span>

- <span data-ttu-id="9eda6-249">[Data Partitioning Guidance](https://msdn.microsoft.com/library/dn589795.aspx) (Leitfaden zur Datenpartitionierung).</span><span class="sxs-lookup"><span data-stu-id="9eda6-249">[Data Partitioning Guidance](https://msdn.microsoft.com/library/dn589795.aspx).</span></span> <span data-ttu-id="9eda6-250">Beim Ereignissourcing werden Daten häufig partitioniert, um die Skalierbarkeit zu verbessern, Konflikte zu reduzieren und die Leistung zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="9eda6-250">Data is often partitioned when using event sourcing to improve scalability, reduce contention, and optimize performance.</span></span> <span data-ttu-id="9eda6-251">Das Muster beschreibt, wie Daten auf getrennte Partitionen aufgeteilt werden, und erläutert mögliche Probleme.</span><span class="sxs-lookup"><span data-stu-id="9eda6-251">Describes how to divide data into discrete partitions, and the issues that can arise.</span></span>
