---
title: Entwickeln von Resilienz und Verfügbarkeit in Azure-Anwendungen
description: Integrieren von Resilienz und Verfügbarkeit in eine Azure-Anwendung
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.openlocfilehash: ee4bb5b4a85e48fe0ff017297c31823c93a48f04
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/17/2019
ms.locfileid: "59642866"
---
# <a name="architecting-azure-applications-for-resiliency-and-availability"></a>Entwickeln von Resilienz und Verfügbarkeit in Azure-Anwendungen

Nachdem Sie die Anforderungen für Ihre Anwendung entwickelt haben, besteht der nächste Schritt darin, Resilienz und Verfügbarkeit zu integrieren. Diese Qualitäten können nicht am Ende hinzugefügt werden, sondern müssen ins Design der Architektur integriert werden.

## <a name="conduct-a-failure-mode-analysis"></a>Ausführen einer Fehlermodusanalyse

Durch die *Fehlermodusanalyse* (FMA) wird Resilienz in ein System integriert, indem mögliche Fehlerpunkte identifiziert werden und indem festgelegt wird, wie die Anwendung auf diese Fehler reagiert. Die Fehlermodusanalyse sollte in die Planungs- und Designphasen eingebunden werden, damit die Wiederherstellung nach einem Fehler von Anfang an in das System integriert wird. Ziele von FMA:

- Bestimmen, welche Arten von Fehlern in einer Anwendung auftreten können und wie die Anwendung diese Fehler erkennt.
- Erfassen der möglichen Auswirkungen der einzelnen Fehlerarten und Bestimmen, wie die App reagiert.
- Planen der Protokollierung und Überwachung des Fehlers und Identifizieren von Wiederherstellungsstrategien.

Hier finden Sie einige Beispiele für Fehlerzustände und Erkennungsstrategien für einen bestimmten Fehlerpunkt (Aufruf eines externen Webdiensts):

| Fehlermodus           | Erkennungsstrategie           |
|------------------------|------------------------------|
| Dienst nicht verfügbar | HTTP 5xx                     |
| Drosselung             | HTTP 429 (Zu viele Anforderungen) |
| Authentication         | HTTP 401 (Nicht autorisiert)      |
| Langsame Reaktion          | Timeout der Anforderung            |

Weitere Informationen zum FMA-Prozess mit spezifischen Empfehlungen für Azure finden Sie unter [Fehlermodusanalyse](../resiliency/failure-mode-analysis.md).

## <a name="plan-for-redundancy"></a>Planen von Redundanz

Der Umfang und die Auswirkungen von Fehlern variieren. Einige Hardwarefehler, z.B. ein ausgefallener Datenträger, wirken sich nur auf einen einzelnen Hostcomputer aus. Ein fehlerhafter Netzwerkswitch kann sich auf ein gesamtes Serverrack auswirken. Weniger häufige Fehler, z.B. ein Stromausfall, führen zu einer Unterbrechung eines gesamten Rechenzentrums. In selten Fällen kommt es vor, dass eine gesamte Region nicht mehr verfügbar ist.

Redundanz ist eine Möglichkeit, eine Anwendung resilient zu machen. Der Redundanzgrad richtet sich nach Ihren Geschäftsanforderungen – nicht für jede Anwendung ist eine regionsübergreifende Redundanz als Schutz vor einem regionalen Ausfall erforderlich. In der Regel muss ein Kompromiss zwischen höherer Redundanz und Zuverlässigkeit und einer höheren Kostensumme und Komplexität gefunden werden.

### <a name="review-azure-redundancy-features"></a>Azure-Redundanzfeatures

Azure verfügt über eine Reihe von Redundanzfeatures für alle Fehlerebenen – von einem einzelnen virtuellen Computer (VM) bis hin zu einer gesamten Region.

- **Einzelne VMs** verfügen über eine von Azure bereitgestellte [Vereinbarung zum Servicelevel (SLA) bezüglich der Betriebszeit](https://azure.microsoft.com/support/legal/sla/virtual-machines). (Der virtuelle Computer muss Storage Premium für alle Betriebssystem-Datenträger und Datenträger verwenden.) Sie können zwar einen höheren SLA-Grad erzielen, indem Sie zwei oder mehr VMs ausführen, aber für einige Workloads kann eine einzelne VM zuverlässig genug sein. Für Produktionsworkloads empfehlen wir jedoch aus Redundanzgründen die Verwendung von mindestens zwei virtuellen Computern.
- **Verfügbarkeitsgruppen** schützen vor lokalen Hardwarefehlern, z.B. ein Ausfall eines Datenträgers oder Netzwerkswitchs. VMs in einer Verfügbarkeitsgruppe sind auf bis zu drei *Fehlerdomänen* verteilt. Eine Fehlerdomäne definiert eine Gruppe virtueller Computer, die eine Stromquelle und einen Netzwerkswitch gemeinsam nutzen. Wenn ein Hardwareausfall eine Fehlerdomäne betrifft, wird der Netzwerkdatenverkehr an VMs in den anderen Fehlerdomänen weitergeleitet. Weitere Informationen zu Verfügbarkeitsgruppen finden Sie unter [Verwalten der Verfügbarkeit virtueller Windows-Computer in Azure](/azure/virtual-machines/windows/manage-availability).
- **Verfügbarkeitszonen** sind physisch getrennte Zonen in einer Azure-Region. Jede Verfügbarkeitszone verfügt über eine eigene Stromquelle, ein Netzwerk und eine Kühlung. Die Bereitstellung von VMs über Verfügbarkeitszonen hinweg dient dem Schutz einer Anwendung vor Ausfällen, die ein gesamtes Rechenzentrum betreffen. Nicht alle Regionen unterstützen Verfügbarkeitszonen. Eine Liste der unterstützten Regionen und Dienste finden Sie unter [Was sind Verfügbarkeitszonen in Azure?](/azure/availability-zones/az-overview)

    Wenn Sie Verfügbarkeitszonen in Ihrer Bereitstellung verwenden möchten, vergewissern Sie sich zuerst, dass Ihre Anwendungsarchitektur und Codebasis diese Konfiguration unterstützen. Wenn Sie kommerzielle Software bereitstellen, wenden Sie sich an den Softwareanbieter und führen Sie angemessene Tests durch, bevor Sie in der Produktionsumgebung bereitstellen. Eine Anwendung muss während eines Ausfalls innerhalb der konfigurierten Zone einen Zustand beibehalten und Datenverluste verhindern. Die Anwendung muss die Ausführung in einer elastischen und verteilten Infrastruktur ohne hartcodierte Infrastrukturkomponenten unterstützen.
- **Azure Site Recovery** repliziert virtuelle Azure-Computer in einer anderen Azure-Region, um Business Continuity- und Disaster Recovery-Anforderungen (BC und DR) zu erfüllen. Sie können regelmäßige DR-Drills ausführen, um sicherzustellen, dass die Complianceanforderungen erfüllt werden. Der virtuelle Computer wird mit den angegebenen Einstellungen in der ausgewählten Region repliziert, sodass Sie Ihre Anwendungen bei Ausfällen in der Quellregion wiederherstellen können. Weitere Informationen finden Sie unter [Einrichten der Notfallwiederherstellung in einer sekundären Azure-Region für einen virtuellen Azure-Computer](/azure/site-recovery/azure-to-azure-quickstart/).

    Vergewissern Sie sich während der Testphase, dass *Recovery Time Objective* (RTO) und *Recovery Point Objective* (RPO) Ihre Anforderungen erfüllen. RTO ist die maximale Zeit, die eine Anwendung nach einem Vorfall nicht verfügbar ist, und RPO ist die maximale Dauer des Datenverlusts während eines Notfalls.
- **Regionspaare** werden erstellt unter Verwendung von Azure Traffic Manager erstellt, um Internetdatenverkehr auf verschiedene Regionen zu verteilen und eine Anwendung so vor einem regionalen Ausfall zu schützen. Jede Azure-Region ist mit einer anderen Region gekoppelt. Zusammen bilden diese Regionen ein [*Regionspaar*](/azure/best-practices-availability-paired-regions). Um steuerliche und rechtliche Anforderungen an den Speicherort von Daten zu erfüllen, befinden sich die Regionen der Regionspaare immer innerhalb des gleichen geografischen Gebiets (mit Ausnahme von „Brasilien, Süden“).

    Um die Anwendungsresilienz zu verbessern, werden Plattformupdates (geplante Wartung) für Regionspaare von Azure so serialisiert, dass immer nur jeweils eine Region pro Paar aktualisiert wird.
- Berücksichtigen Sie beim Entwerfen einer Anwendung für mehrere Regionen, dass die Netzwerklatenz für mehrere Regionen höher als innerhalb einer Region ist. Wenn Sie beispielsweise eine Datenbank replizieren, um das Failover zu ermöglichen, sollten Sie die synchrone Datenreplikation innerhalb einer Region und die asynchrone Datenreplikation für mehrere Regionen verwenden.

Die folgende Tabelle vergleicht die Redundanzfaktoren verschiedener Resilienzstrategien:

| &nbsp; | Verfügbarkeitsgruppe | Verfügbarkeitszone | Azure Site Recovery/Gekoppelte Region |
|--------|------------------|-------------------|-----------------------------------|
| Fehlerumfang | Rack                  | Datacenter               | Region                               |
| Routinganforderung  | Azure Load Balancer   | Zonenübergreifender Lastenausgleich | Azure Traffic Manager                |
| Netzwerklatenz  | Sehr niedrig              | Niedrig                      | Mittel bis hoch                          |
| Virtuelles Netzwerk  | Virtuelles Azure-Netzwerk | Virtuelles Azure-Netzwerk          | Regionsübergreifendes Peering in virtuellen Azure-Netzwerken |

### <a name="complete-azure-redundancy-tasks"></a>Abschließen von Azure-Redundanzaufgaben

Verwenden Sie die folgenden Aufgaben, um Redundanzanforderungen zu erfüllen:

- **Stellen Sie mehrere Instanzen von Diensten bereit.** Wenn Ihre Anwendung von einer einzelnen Instanz eines Diensts abhängig ist, entsteht dadurch ein Single Point of Failure. Durch die Bereitstellung von mehreren Instanzen werden Resilienz und Skalierbarkeit verbessert. Wählen Sie für [Azure App Service](/azure/app-service/app-service-value-prop-what-is/) einen [App Service-Plan](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/) aus, der mehrere Instanzen bietet. Stellen Sie für [Azure-VMs](/azure/virtual-machines/virtual-machines-windows-about/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) sicher, dass Ihre Architektur mehr als eine VM enthält und dass jede VM zu einer [Verfügbarkeitsgruppe](/azure/virtual-machines/virtual-machines-windows-manage-availability/) gehört.

- **Replizieren Sie virtuelle Computer mithilfe von Azure Site Recovery.** Wenn Sie virtuelle Azure-Computer mit [Site Recovery](/azure/site-recovery/) replizieren, werden kontinuierlich alle VM-Datenträger asynchron in der Zielregion repliziert. Die Wiederherstellungspunkte werden alle paar Minuten erstellt, wodurch eine RPO von wenigen Minuten erreicht wird.

- **Erwägen Sie die Bereitstellung Ihrer Anwendung in mehreren Regionen.** Wenn Ihre Anwendung in einer einzelnen Region bereitgestellt wird, ist Ihre Anwendung nicht mehr verfügbar, falls die gesamte Region ausfällt. Dies kann unter den Bestimmungen der SLA für Ihre Anwendung nicht akzeptabel sein. Wenn dies der Fall ist, erwägen Sie die Bereitstellung Ihrer Anwendung und der zugehörigen Dienste in mehreren Regionen. Eine Bereitstellung in mehreren Regionen kann eine *Aktiv/Aktiv*- oder *Aktiv/Passiv*-Konfiguration verwenden. Bei einer Aktiv/Aktiv-Konfiguration werden Anforderungen auf mehrere aktive Regionen verteilt. Bei einer Aktiv/Passiv-Konfiguration werden betriebsbereite Instanzen in der sekundären Region bereitgehalten, es wird aber kein Datenverkehr dorthin gesendet, es sei denn, in der primären Region tritt ein Fehler auf. Für die Bereitstellungen in mehreren Regionen wird die Bereitstellung in Regionspaaren empfohlen, wie oben beschrieben. Weitere Informationen finden Sie unter [Geschäftskontinuität und Notfallwiederherstellung: Azure-Regionspaare](/azure/best-practices-availability-paired-regions).

- **Verwenden Sie Azure Traffic Manager zum Weiterleiten des Datenverkehrs für Ihre Anwendung an verschiedene Regionen.** [Azure Traffic Manager](/azure/traffic-manager/traffic-manager-overview/) führt den Lastenausgleich auf DNS-Ebene durch und leitet den Datenverkehr an verschiedene Regionen weiter. Die Weiterleitung basiert auf der Methode für das [Datenverkehrrouting](/azure/traffic-manager/traffic-manager-routing-methods/) und der Integrität der Endpunkte Ihrer Anwendung. Ohne Traffic Manager ist Ihre Bereitstellung auf eine Region beschränkt. Dadurch wird die Skalierung eingeschränkt und die Latenz für einige Benutzer erhöht. Zudem entstehen Ausfallzeiten der Anwendung, falls in der gesamten Region der Dienst unterbrochen wird.

- **Konfigurieren Sie Azure Application Gateway für die Verwendung mehrerer Instanzen.** Abhängig von den Anforderungen Ihrer Anwendung kann [Azure Application Gateway](/azure/application-gateway/application-gateway-introduction/) für die Verteilung von Anforderungen an die Dienste der Anwendung besser geeignet sein. Allerdings sind einzelne Instanzen des Application Gateway-Diensts nicht durch einen SLA garantiert. Daher ist es möglich, dass bei einem Ausfall der Application Gateway-Instanz die Anwendung ausfällt. Stellen Sie mehr als eine mittlere oder größere Instanz bereit, um die Verfügbarkeit des Diensts gemäß den Bedingungen der [SLA für Application Gateway](https://azure.microsoft.com/support/legal/sla/application-gateway/) zu gewährleisten.

## <a name="design-for-scalability"></a>Skalierbarkeitsorientiertes Design

*Skalierbarkeit* ist die Fähigkeit eines Systems, zunehmende Lasten zu bewältigen, und gehört zu den [Säulen der Softwarequalität](../guide/pillars.md). Skalierbarkeitsaufgaben während der Phase der Architekturerstellung:

- **Partitionieren Sie die Workloads.** Entwickeln Sie Teile des Prozesses als diskret und zerlegbar. Minimieren Sie die Größe der einzelnen Teile. Dadurch können Komponententeile auf eine Weise verteilt werden, die die Verwendung jeder Compute-Einheit maximiert. Es erleichtert auch die Skalierung der Anwendung, indem Sie Instanzen bestimmter Ressourcen hinzufügen. Erwägen Sie für komplexe Domänen die Einführung einer [Microservices-Architektur](../guide/architecture-styles/microservices.md).
- **Berücksichtigen Sie Skalierung beim Entwurf.** Skalierung ermöglicht es Anwendungen, auf veränderbare Last zu reagieren, indem sie die Anzahl der Instanzen der Rollen, Warteschlangen und andere Dienste erhöhen und verringern. Die Anwendung muss jedoch zu diesem Zweck entworfen werden. Die Anwendung und die verwendeten Dienste müssen z. B. statusfrei sein, damit Anforderungen an eine beliebige Instanz weitergeleitet werden können. Zustandslose Dienste zu verwendet, bedeutet auch, dass das Hinzufügen oder Entfernen einer Instanz keine negativen Auswirkungen auf aktuelle Benutzer hat.
- **Planen Sie Wachstum mit Skalierungseinheiten ein.** Sie sollten für jede Ressource die oberen Skalierungsgrenzen kennen und Sharding oder Zerlegung verwenden, um über diese Grenzen hinausgehen. Entwerfen Sie die Anwendung so, dass sie einfach skaliert wird, indem Sie eine oder mehrere Skalierungseinheiten hinzufügen. Bestimmen der Skalierungseinheiten für das System im Hinblick auf klar definierte Ressourcensätze. Dadurch ist die Anwendung der horizontalen Skalierung einfacher und weniger anfällig für negative Auswirkungen, die durch den Mangel an Ressourcen in einem Teil des gesamten Systems verursacht werden. Zum Beispiel kann das Hinzufügen von *x* Front-End-VMs möglicherweise *y* zusätzliche Warteschlangen und *z* Speicherkonten erforderlich machen, um die zusätzliche Workload zu bewältigen. Eine Skalierungseinheit kann somit aus *x* VM-Instanzen, *y* Warteschlangen und *z* Speicherkonten bestehen.
- **Vermeiden Sie Clientaffinität.** Stellen Sie wenn möglich sicher, dass für die Anwendung keine Affinität erforderlich ist. Anforderungen können dann an eine beliebige Instanz weitergeleitet werden, und die Anzahl der Instanzen ist irrelevant. Dies verhindert auch den Aufwand für das Speichern, Abrufen und Verwalten von Zustandsinformationen für jeden einzelnen Benutzer.
- **Nutzen Sie Features der automatischen Plattformskalierung.** Verwenden Sie nach Möglichkeit integrierte Autoskalierungsfeatures anstelle von benutzerdefinierten Mechanismen oder Mechanismen von Drittanbietern. Verwenden Sie wo möglich geplante Skalierungsregeln, um sicherzustellen, dass die Ressourcen ohne Startverzögerung zur Verfügung stehen. Fügen Sie jedoch automatische reaktive Skalierungsregeln hinzu, um gegebenenfalls unerwartete Änderungen der Nachfrage zu bewältigen. Weitere Informationen finden Sie im [Leitfaden für die automatische Skalierung](../best-practices/auto-scaling.md).  

  Wenn Ihre Anwendung nicht so konfiguriert ist, dass sie beim Anstieg der Last automatisch horizontal hochskaliert wird, ist es möglich, dass Dienste der Anwendung fehlschlagen, wenn zu viele Benutzeranforderungen auftreten. Weitere Informationen finden Sie in den folgenden Artikeln:

  - Allgemeines: [Checkliste für Skalierbarkeit](../checklist/scalability.md)
  - Azure App Service: [Manuelles oder automatisches Skalieren der Instanzenzahl](/azure/monitoring-and-diagnostics/insights-how-to-scale/)
  - Cloud Services: [Automatisches Skalieren eines Clouddiensts](/azure/cloud-services/cloud-services-how-to-scale/)
  - Virtuelle Computer: [Automatische Skalierung und Skalierungsgruppen für virtuelle Computer](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-autoscale-overview/)

- **Offload-intensive CPU/IO-Vorgänge als Hintergrundaufgaben.** Lagern Sie die Verarbeitung für diese Anforderung in einer separaten Aufgabe aus, wenn erwartet wird, dass eine Anforderung an einen Dienst lange Zeit für die Ausführung benötigt oder beträchtliche Ressourcen absorbiert. Verwenden Sie zum Ausführen dieser Aufgaben Hintergrundaufträge. Dadurch kann den Dienst weiterhin Anforderungen erhalten und reaktionsfähig bleiben. Weitere Informationen finden Sie unter [Leitfaden für Hintergrundaufträge](../best-practices/background-jobs.md).
- **Verteilen Sie die Workload für Hintergrundaufgaben.** Wenn es viele Hintergrundaufgaben gibt oder die Aufgaben beträchtliche Zeit oder Ressourcen erfordern, können Sie die Arbeit auf mehrere Compute-Einheiten verteilen. Eine mögliche Lösung ist das [Muster „Konkurrierende Consumer“](../patterns/competing-consumers.md).
- **Erwägen Sie den Übergang zu einer *Shared-Nothing*-Architektur** (Architektur ohne gemeinsam genutzte Inhalte). Diese Architektur verwendet unabhängige, eigenständige Knoten, die keine einzelnen Konfliktpunkt haben (z. B. gemeinsame Dienste oder Speicher). Theoretisch kann ein solches System fast unbegrenzt skaliert werden. Während ein vollständiger Ansatz ohne gemeinsam genutzte Inhalte im Allgemeinen nicht geeignet ist, bietet er Möglichkeiten für Entwürfe mit besserer Skalierbarkeit. Gute Beispiele für den Übergang zu einer Architektur ohne gemeinsam genutzte Inhalte sind Datenpartitionierung und die Vermeidung der Verwendung von serverseitigem Sitzungsstatus und Clientaffinität.
- **Entwerfen Sie die Speicheranforderungen Ihrer Anwendung so, dass sie innerhalb der Skalierbarkeits- und Leistungsziele für Azure Storage liegen.** Azure Storage ist für die Verwendung innerhalb vordefinierter Skalierbarkeits- und Leistungsziele konzipiert. Entwerfen Sie Ihre Anwendung also für die Speichernutzung innerhalb dieser Ziele. Wenn Sie diese Ziele überschreiten, wird für Ihre Anwendung der Speicher eingeschränkt. Um diese zu vermeiden, stellen Sie zusätzliche Speicherkonten bereit. Wenn Sie den Grenzwert für Speicherkonten erreichen, stellen Sie zusätzliche Azure-Abonnements für zusätzliche Speicherkonten bereit. Weitere Informationen finden Sie unter [Skalierbarkeits- und Leistungsziele für Azure Storage](/azure/storage/storage-scalability-targets/).
- **Wählen Sie die richtige VM-Größe für Ihre Anwendung aus.** Messen Sie die tatsächlichen Werte für CPU, Arbeitsspeicher, Datenträger und E/A Ihrer VMs in der Produktion, und stellen Sie sicher, dass die ausgewählte VM-Größe ausreichend ist. Falls nicht, können in Ihrer Anwendung Kapazitätsprobleme auftreten, wenn die VMs ihre Grenzwerte erreichen. VM-Größen werden ausführlich unter [Größen für virtuelle Computer in Azure](/azure/virtual-machines/virtual-machines-windows-sizes/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) beschrieben.

## <a name="determine-subscription-and-service-requirements"></a>Bestimmen der Abonnement- und Dienstanforderungen

Wählen Sie das richtige Abonnement und die geeigneten Dienstfeatures für Ihre App aus, indem Sie diese Aufgaben durcharbeiten:

- **Auswerten der Anforderungen im Hinblick auf [Einschränkungen von Azure-Abonnements und -Diensten](/azure/azure-subscription-service-limits/).** Bei *Azure-Abonnements* gelten Grenzwerte für bestimmte Ressourcentypen. Hierzu zählt beispielsweise die Anzahl von Ressourcengruppen, Kernen und Speicherkonten. Wenn mit den Anforderungen Ihrer Anwendung Grenzwerte des Azure-Abonnements überschritten werden, erstellen Sie ein weiteres Azure-Abonnement für zusätzliche Ressourcen. Für einzelne Azure-Dienste gelten Nutzungsgrenzwerte, beispielsweise Grenzwerte für Speicher, Durchsatz, die Anzahl der Verbindungen, Anforderungen pro Sekunde und weitere Metriken. Ihre Anwendung schlägt fehl, wenn sie versucht, Ressourcen außerhalb dieser Grenzen zu nutzen, was zu Dienstdrosselung und möglichen Ausfallzeiten für betroffene Benutzer führt. Abhängig vom spezifischen Dienst und den Anforderungen Ihrer Anwendung können Sie diese Grenzwerte häufig durch zentrales Hochskalieren (z.B. die Auswahl eines anderen Tarifs) oder horizontales Skalieren (z.B. Hinzufügen neuer Instanzen) vermeiden.
- **Bestimmen Sie, wie viele Speicherkonten, die Sie benötigen.** Azure erlaubt eine bestimmte Anzahl von Speicherkonten pro Abonnement. Weitere Informationen finden Sie unter [Grenzwerte für Azure-Abonnements, -Dienste und -Kontingente sowie allgemeine Beschränkungen](/azure/azure-subscription-service-limits/#storage-limits).
- **Wählen Sie die richtige Dienstebene für Azure SQL-Datenbank aus.** Wenn Ihre Anwendung Azure SQL-Datenbank verwendet, wählen Sie die geeignete Dienstebene aus. Wenn die Ebene die Anforderungen Ihrer Anwendung an die Datenbanktransaktionseinheiten (DTU) nicht verarbeiten kann, wird die Datenverwendung eingeschränkt. Weitere Informationen zur Wahl des korrekten Dienstplans finden Sie unter [SQL-Datenbankoptionen und -leistung: Grundlegendes zum Angebot in den einzelnen Tarifen](/azure/sql-database/sql-database-service-tiers/).
- **Stellen Sie ausreichend Anforderungseinheiten (RUs) in Azure Cosmos DB bereit**. Bei Azure Cosmos DB zahlen Sie für den bereitgestellten Durchsatz und den verwendeten Speicher auf Stundenbasis. Die Kosten für alle Datenbankvorgänge werden als RUs normalisiert, was Systemressourcen wie CPU, IOPS-Wert und Arbeitsspeicher abstrahiert. Weitere Informationen finden Sie unter [Anforderungseinheiten in Azure Cosmos DB](/azure/cosmos-db/request-units).

## <a name="load-balance-as-needed"></a>Lastenausgleich nach Bedarf

Ein ordnungsgemäßer Lastenausgleich ermöglicht Ihnen, die Verfügbarkeitsanforderungen zu erfüllen und die mit der Verfügbarkeit verbundenen Kosten zu minimieren.

- **Verwenden Sie den Lastenausgleich, um Anforderungen zu verteilen.** Mit dem Lastenausgleich werden die Anforderungen Ihrer Anwendung auf fehlerfreie Dienstinstanzen verteilt, indem fehlerhafte Instanzen aus der Rotation entfernt werden. Wenn der Dienst Azure App Service oder Azure Cloud Services verwendet, erfolgt bereits ein Lastenausgleich. Wenn Ihre Anwendung allerdings Azure-VMs verwendet, müssen Sie einen Lastenausgleich bereitstellen. Weitere Informationen finden Sie unter [Was ist Azure Load Balancer?](/azure/load-balancer/load-balancer-overview/)

  Sie können Azure Load Balancer für Folgendes verwenden:

  - Führen Sie einen Lastenausgleich für den eingehenden Internetdatenverkehr für virtuelle Computer aus. Diese Konfiguration wird als [*öffentlicher Load Balancer*](/azure/load-balancer/load-balancer-overview#publicloadbalancer) bezeichnet.
  - Ausführen eines Lastenausgleichs des Datenverkehrs für mehrere VMs in einem virtuellen Netzwerk. Sie können ein Load Balancer-Front-End in einem Hybridszenario auch aus einem lokalen Netzwerk erreichen. In beiden Szenarien wird eine Konfiguration verwendet, die als [*interner Load Balancer*](/azure/load-balancer/load-balancer-overview#internalloadbalancer) bezeichnet wird.
  - Der Port leitet den Datenverkehr an einen aufgeschlüsselten Port auf bestimmten virtuellen Computern mit Regeln für die Netzwerkadressenübersetzung für eingehenden Datenverkehr weiter.
  - Stellen Sie [ausgehende Verbindungen](/azure/load-balancer/load-balancer-outbound-connections) für virtuelle Computer in Ihrem virtuellen Netzwerk durch Verwenden eines öffentlichen Load Balancers bereit.

- **Führen Sie einen Lastenausgleich über Regionen mit einem Traffic Manager aus, z.B. Azure Traffic Manager.** Für den Lastenausgleich des Datenverkehrs über mehrere Regionen hinweg ist eine Lösung für die Datenverkehrsverwaltung erforderlich. Azure stellt dazu [Traffic Manager](https://azure.microsoft.com/services/traffic-manager/) bereit. Sie können auch Drittanbieterdienste nutzen, die ähnliche Funktionen für die Verwaltung des Datenverkehrs bieten.

## <a name="implement-resiliency-strategies"></a>Implementieren von Resilienzstrategien

In diesem Abschnitt werden einige häufig verwendete Resilienzstrategien beschrieben. Die meisten dieser Strategien sind nicht auf eine bestimmte Technologie beschränkt. In den Beschreibungen sind jeweils die grundlegenden Ideen jedes Verfahrens mit Links zu weiteren Informationen zusammengefasst.

- **Implementieren Sie ggf. Resilienzmuster** für Remotevorgänge. Wenn Ihre Anwendung von der Kommunikation zwischen Remotediensten abhängig ist, folgen Sie den [Entwurfsmustern](../patterns/category/resiliency.md) für den Umgang mit vorübergehenden Fehlern.

- **Wiederholen des Vorgangs bei vorübergehenden Fehlern.** Diese können durch eine kurze Trennung der Netzwerkverbindung, einen Verlust der Verbindung zur Datenbank oder eine Zeitüberschreitung bei zu hoher Auslastung eines Diensts verursacht werden. Häufig kann ein vorübergehender Fehler gelöst werden, indem versucht wird, die Anforderung erneut zu senden.

  - Für viele Azure-Dienste werden vom Client-SDK (Software Development Kit) automatische Wiederholungen so implementiert, dass dies für den Aufrufer transparent ist. Informationen hierzu finden Sie unter [Wiederholungsanleitung für bestimmte Dienste](../best-practices/retry-service-specific.md).
  - Oder implementieren Sie das [Wiederholungsmuster](../patterns/retry.md), um der Anwendung zu ermöglichen, erwartete, vorübergehende Fehler beim Versuch, sich mit einem Dienst oder einer Netzwerkressource zu verbinden, transparent zu handhaben.

- **Verwenden Sie einen Schutzschalter**, um Fehler zu behandeln, für deren Behebung eine variable Zeitspanne benötigt wird. Mit einem [Schutzschaltermuster](../patterns/circuit-breaker.md) kann verhindert werden, dass von einer Anwendung wiederholt versucht wird, einen Vorgang auszuführen, der mit hoher Wahrscheinlichkeit fehlschlägt. Der Schutzschalter umschließt Aufrufe an einen Dienst und verfolgt die Anzahl kürzlich aufgetretener Fehler nach. Überschreitet die Fehleranzahl einen Schwellenwert, gibt der Schutzschalter einen Fehlercode zurück, ohne den Dienst aufzurufen. Dies gibt dem Dienst Zeit zur Wiederherstellung und hilft, kaskadierende Ausfälle zu vermeiden.
- **Isolieren Sie kritische Ressourcen.** Fehler in einem Subsystem können ggf. zu kaskadierenden Fehlern werden und Fehler in anderen Teilen der Anwendung verursachen. Dies kann passieren, wenn ein Fehler dazu führt, dass einige Ressourcen, z.B. Threads oder Sockets, nicht freigegeben werden und die Ressourcen erschöpft sind. Um dies zu vermeiden, können Sie ein System in isolierte Gruppen partitionieren, damit ein Ausfall in einer Partition nicht zum Ausfall des gesamten Systems führt.

    Hier sind einige Beispiele für diese Technik, die manchmal als [Bulkhead-Muster](../patterns/bulkhead.md) bezeichnet wird:

  - Partitionieren Sie eine Datenbank (z.B. nach Mandant), und weisen Sie einen separaten Pool mit Webserverinstanzen für jede Partition zu.
  - Verwenden Sie separate Threadpools, um Aufrufe von unterschiedlichen Diensten zu isolieren. Auf diese Weise werden kaskadierende Fehler verhindert, wenn einer der Dienste ausfällt. Ein Beispiel finden Sie in der [Hystrix-Bibliothek](https://medium.com/netflix-techblog/introducing-hystrix-for-resiliency-engineering-13531c1ab362) von Netflix.
  - Verwenden Sie [Container](https://en.wikipedia.org/wiki/Operating-system-level_virtualization), um die Ressourcen zu begrenzen, die für ein bestimmtes Subsystem verfügbar sind.

      ![Diagramm des Bulkhead-Musters](_images/bulkhead.png)

- **Wenden Sie [*ausgleichende Transaktionen*](../patterns/compensating-transaction.md)** an. Mit einer ausgleichenden Transaktion werden die Auswirkungen einer anderen abgeschlossenen Transaktion rückgängig gemacht. In einem verteilten System kann es schwierig sein, eine hohe Transaktionskonsistenz zu erzielen. Ausgleichende Transaktionen helfen, Konsistenz zu erreichen, indem eine Reihe von kleineren einzelnen Transaktionen verwendet wird, die in jedem Schritt rückgängig gemacht werden können. Beim Buchen einer Reise kann ein Kunde beispielsweise einen Mietwagen, ein Hotelzimmer und einen Flug reservieren. Wenn einer dieser Schritte nicht erfolgreich ist, schlägt der gesamte Vorgang fehl. Anstatt eine einzelne verteilte Transaktion für den gesamten Vorgang zu verwenden, können Sie für jeden Schritt eine ausgleichende Transaktion definieren.
- **Implementieren Sie nach Möglichkeit asynchrone Vorgänge.** Synchrone Vorgänge können zu einer Monopolisierung von Ressourcen führen und andere Vorgänge blockieren, während der Aufrufer auf den Abschluss des Vorgangs wartet. Entwerfen Sie die einzelnen Teile der Anwendung so, dass nach Möglichkeit asynchrone Vorgänge genutzt werden. Weitere Informationen zum Implementieren der asynchronen Programmierung in C\# finden Sie unter [Asynchrone Programmierung](/dotnet/articles/csharp/async).

## <a name="ensure-that-availability-meets-slas"></a>Sicherstellen, dass Verfügbarkeit die SLAs erfüllt

*Verfügbarkeit* ist der Zeitanteil, in dem ein System funktioniert und erreichbar ist. Sie gehört zu den [Säulen der Softwarequalität](../guide/pillars.md). Verwenden Sie die Aufgaben in diesem Abschnitt, um Ihre Anwendungsarchitektur vom Standpunkt der Verfügbarkeit zu überprüfen und sicherzustellen, dass die Verfügbarkeit Ihre SLAs erfüllt.

- **Vermeiden Sie alle einzelnen Fehlerquellen.**  Alle Komponenten, Dienste, Ressourcen und Serverinstanzen sollten in mehreren Instanzen bereitgestellt werden, um zu verhindern, dass sich eine einzelne Fehlerquelle auf die Verfügbarkeit auswirkt. Authentifizierungsmechanismen können auch ein Single Point of Failure sein. Entwerfen Sie die Anwendung so, dass sie für die Verwendung mehrerer Instanzen konfiguriert werden kann, automatisch Fehler ermittelt und die Anforderungen bei einem Ausfall an einwandfreie Instanzen weiterleitet, wenn die Plattform dies nicht automatisch tut.
- **Teilen Sie Workloads nach Servicelevelziel auf.**  Wenn ein Dienst wichtige und weniger wichtige Workloads umfasst, verwalten Sie sie unterschiedlich, und legen Sie die Dienstfunktionen und die Anzahl von Instanzen entsprechend den jeweiligen Anforderungen an die Verfügbarkeit fest.
- **Minimieren und erkennen Sie Abhängigkeiten des Dienstes.** Minimieren Sie die Anzahl der verwendeten unterschiedlichen Dienste, wenn möglich. Stellen Sie sicher, dass Sie alle im System vorhandenen Feature- und Dienstabhängigkeiten verstehen. Insbesondere sollten Sie die Gesamtauswirkungen von Fehlern oder Leistungseinbußen in jeder Abhängigkeit verstehen.
- **Entwerfen Sie Aufgaben und Nachrichten möglichst so, dass sie *idempotent* sind.** Ein Vorgang ist idempotent, wenn er mehrere Male wiederholt werden kann und das gleiche Ergebnis erzielt. Dies kann sicherstellen, dass doppelte Anforderungen keine Probleme verursachen. Nachrichtenconsumer und die Vorgänge, die sie ausführen, müssen idempotent sein, damit die Wiederholung eines zuvor ausgeführten Vorgangs nicht zu ungültigen Ergebnissen führt. Dies kann bedeuten, dass doppelte Nachrichten erkannt werden müssen oder dass die Konsistenz durch einen optimistischen Konfliktlösungsansatz gewährleistet sein muss.
- **Konfigurieren Sie Anforderungstimeouts.** Dienste und Ressourcen können möglicherweise nicht mehr verfügbar sein, sodass bei Anforderungen Fehler auftreten. Stellen Sie sicher, dass Sie Timeouts festlegen, die für den jeweiligen Dienst oder die Ressource und für den Client geeignet sind, der auf diese zugreift. In einigen Fällen können Sie je nach Kontext und weiteren Aktionen, die der Client ausführt, ein längeres Zeitlimit für eine bestimmte Clientinstanz festlegen. Kurze Timeouts können zu übermäßig vielen Wiederholungsvorgängen bei Diensten und Ressourcen mit höherer Latenz führen. Lange Timeouts können zu einer Blockade führen, wenn sich eine große Anzahl von Anforderungen in der Warteschlange befindet und darauf wartet, dass ein Dienst oder eine Ressource reagiert.
- **Verwenden Sie einen Nachrichtenmakler, der für wichtige Transaktionen Hochverfügbarkeit implementiert.** Viele Cloudanwendungen verwenden Messaging, um asynchrone Aufgaben auszulösen. Um die Nachrichtenübermittlung zu gewährleisten, sollte das Messaging-System Hochverfügbarkeit bieten. [Azure Service Bus-Messaging](/azure/service-bus-messaging) implementiert *mindestens einmal* Semantik, was bedeutet, dass eine Nachricht garantiert mindestens einmal zugestellt wird. Unter bestimmten Umständen können doppelte Nachrichten zugestellt werden. Wenn die Nachrichtenverarbeitung idempotent ist (siehe vorheriger Punkt), sollte die wiederholte Übermittlung kein Problem darstellen.
- **Drosseln von Benutzern mit hohem Volumen.** Es kann vorkommen, dass eine geringe Zahl von Benutzern für die Erzeugung sehr hoher Lasten verantwortlich ist. Dies kann negative Auswirkungen auf andere Benutzer haben und die Gesamtverfügbarkeit Ihrer Anwendung reduzieren. Wenn von einem einzelnen Client übermäßig viele Anforderungen ausgehen, kann die Anwendung den Client ggf. für einen bestimmten Zeitraum drosseln. Während des Drosselungszeitraums verweigert die Anwendung einige oder alle Anforderungen dieses Clients. Der Schwellenwert für die Drosselung richtet sich oft nach der Dienstebene des Kunden. Weitere Informationen finden Sie unter [Drosselungsmuster](../patterns/throttling.md).

    Die Drosselung muss nicht bedeuten, dass der Client in böser Absicht gehandelt hat, sondern nur, dass das Dienstkontingent überschritten wurde. In einigen Fällen kann es vorkommen, dass ein Consumer das Kontingent ständig überschreitet oder sich auf andere Weise unangemessen verhält. Sie können dann weitere Maßnahmen treffen und den Benutzer blockieren. Normalerweise wird hierzu ein API-Schlüssel oder ein IP-Adressbereich blockiert.
- **Entwerfen Sie Anwendungen, die ihre Anforderungen ordnungsgemäß herabstufen.** Die Auslastung einer Anwendung kann die Kapazität von einem oder mehreren Teilen überschreiten und zu verringerter Verfügbarkeit und fehlgeschlagenen Verbindungen führen. Dieses Problem lässt sich durch Skalierung entschärfen, wobei jedoch eine durch andere Faktoren wie z.B. die Ressourcenverfügbarkeit oder Kosten bedingte Grenze erreicht werden kann. Wenn eine Anwendung ein Ressourcenlimit erreicht, müssen entsprechende Maßnahmen ergriffen werden, damit der Benutzer möglichst wenig beeinträchtigt wird. Wenn beispielsweise in einem E-Commerce-System das Subsystem zur Auftragsverarbeitung stark ausgelastet oder ausgefallen ist, kann es vorübergehend deaktiviert werden, während andere Funktionen wie das Durchsuchen des Produktkatalogs ausgeführt werden können. Es kann zweckmäßig sein, die Anforderungen, die an ein ausgefallenes Subsystem gesendet werden, aufzuschieben, z. B. indem zugelassen wird, dass die Kunden Bestellungen absenden, diese jedoch für die spätere Verarbeitung gespeichert werden, wenn das Subsystem für Bestellungen wieder verfügbar ist.
- **Verarbeiten Sie schnelle Änderungen der Auslastung ordnungsgemäß.** Die meisten Anwendungen müssen im Laufe der Zeit unterschiedlich starke Auslastungen handhaben können. Die automatische Skalierung kann bei der Bewältigung der Last hilfreich sein, es kann jedoch einige Zeit dauern, bis weitere Instanzen online geschaltet sind und Anforderungen verarbeiten. Um zu verhindern, dass die Anwendung durch einen Anstieg der Aktivität überfordert wird, entwerfen Sie sie so, dass Anforderungen an die verwendeten Dienste in Warteschlangen eingefügt werden und dass die Anwendung ordnungsgemäß herabgestuft wird, wenn die Warteschlangen ihre Kapazitätsgrenze fast erreicht haben. Stellen Sie sicher, dass unter normalen Bedingungen ausreichend Leistung und Kapazität zur Verfügung steht, um die Warteschlangen zu leeren und die ausstehenden Anforderungen zu verarbeiten. Weitere Informationen finden Sie unter [Warteschlangenbasiertes Lastenausgleichsmuster](../patterns/queue-based-load-leveling.md).
- **Erstellen oder nutzen Sie mehrere Komponenten.** Entwerfen Sie die Anwendungen möglichst so, dass sie mehrere Instanzen nutzen, ohne den Betrieb und die vorhandenen Verbindungen zu beeinträchtigen. Um die Verfügbarkeit zu maximieren, verwenden Sie mehrere Instanzen, teilen Sie die Anforderungen zwischen diesen Instanzen auf, erkennen Sie ausgefallene Instanzen, und vermeiden Sie das Senden von Anforderungen an ausgefallene Instanzen.
- **Weichen Sie auf einen anderen Dienst oder Workflow aus.** Wenn z.B. beim Schreiben in die SQL-Datenbank ein Fehler auftritt, speichern Sie die Daten temporär im Blobspeicher oder in Redis Cache. Stellen Sie eine Möglichkeit bereit, die Schreibvorgänge in die SQL-Datenbank zu wiederholen, wenn der Dienst wieder verfügbar ist. In einigen Fällen kann für einen fehlgeschlagenen Vorgang eine alternative Aktion vorhanden sein, die das weitere Funktionieren der Anwendung ermöglicht, selbst wenn eine Komponente oder ein Dienst ausfällt. Wenn möglich, erkennen Sie Fehler, und leiten Sie Anforderungen an andere Dienste weiter, wenn der primäre Dienst offline ist.
- **Verwenden eines Belastungsausgleichs zum Ausgleichen von Datenverkehrsspitzen.** Für Anwendungen kann es zu plötzlichen Datenverkehrsspitzen kommen, die von Diensten auf dem Back-End nicht mehr bewältigt werden können. Kann ein Back-End-Dienst nicht schnell genug auf Anforderungen reagieren, kann es zu einem Rückstau der ausstehenden Anforderungen kommen, oder die Anwendung kann vom Dienst gedrosselt werden. Sie können eine Warteschlange als Puffer verwenden, um dies zu verhindern. Wenn ein neues Arbeitselement vorhanden ist, reiht die Anwendung ein Arbeitselement für die asynchrone Ausführung in die Warteschlange ein, anstatt sofort den Back-End-Dienst aufzurufen. Die Warteschlange fungiert als Puffer, um Lastspitzen zu glätten. Weitere Informationen finden Sie unter [Warteschlangenbasiertes Belastungsausgleichsmuster](../patterns/queue-based-load-leveling.md).

## <a name="manage-your-data"></a>Verwalten Ihrer Daten

Wie Sie Ihre Daten verwalten, steht in direktem Zusammenhang mit der Verfügbarkeit Ihrer Anwendung. Die Aufgaben in diesem Abschnitt können Ihnen helfen, einen Plan für die Verwaltung zur Gewährleistung der Verfügbarkeit zu erstellen.

- **Replizieren Sie Daten, und entwickeln Sie ein Verständnis der Replikationsmethoden für die Datenspeicher Ihrer Anwendung.** Das Replizieren von Daten ist eine allgemeine Strategie zum Verarbeiten von nicht vorübergehenden Fehlern in einem Datenspeicher. Berücksichtigen Sie sowohl Lese- als auch Schreibpfade. Je nach Speichertechnologie sind ggf. mehrere beschreibbare Replikate oder ein einzelnes beschreibbares Replikat und mehrere schreibgeschützte Replikate vorhanden. Zur Maximierung der Verfügbarkeit können Replikate in mehreren Regionen angeordnet werden. Mit diesem Ansatz wird jedoch die Wartezeit beim Replizieren der Daten erhöht. Normalerweise wird das regionsübergreifende Replizieren asynchron durchgeführt. Dies ist mit einem Modell der letztlichen Konsistenz und potenziellem Datenverlust bei einem Ausfall eines Replikats verbunden.  

  Sie können mithilfe von [Azure Site Recovery](/azure/site-recovery/azure-to-azure-quickstart/) virtuelle Azure-Computer aus einer Region in einer andere replizieren. Site Recovery repliziert Daten fortlaufend in der Zielregion. Bei einem Ausfall am primären Standort können Sie ein Failover auf einen sekundären Standort ausführen.

- **Stellen Sie sicher, dass kein einzelnes Benutzerkonto Zugriff auf Produktions- und Sicherungsdaten hat.** Die Datensicherungen sind gefährdet, wenn ein einzelnes Benutzerkonto über die Berechtigung zum Schreiben in Produktions- und Sicherungsquellen verfügt. Ein böswilliger Benutzer könnte absichtlich alle Daten löschen, einem normalen Benutzer könnte dies versehentlich passieren. Entwerfen Sie Ihre Anwendung so, dass die Berechtigungen für jedes Benutzerkonto eingeschränkt sind. Gewähren Sie nur den Benutzern Schreibzugriff, die diesen benötigen, und gewähren Sie den Zugriff entweder auf die Produktionsversion oder auf die Sicherung, aber nicht auf beides.
- **Dokumentieren und testen Sie die Failover- und Failbackprozesse für Ihre Datenspeicher.** Bei einem schwerwiegenden Ausfall des Datenspeichers muss ein menschlicher Operator einer Reihe von dokumentierten Anweisungen folgen, um ein Failover auf einen neuen Datenspeicher auszuführen. Wenn die dokumentierten Schritte Fehler aufweisen, kann ein Operator sie nicht erfolgreich befolgen und kein Failover für die Ressource ausführen. Testen Sie die Schritte der Anweisung regelmäßig, um sicherzustellen, dass ein Operator, der der Dokumentation folgt, erfolgreich ein Failover und ein Failback der Datenquelle ausführen kann.
- **Sichern Sie Ihre Daten, und überprüfen Sie die Datensicherungen.** Führen Sie regelmäßig ein Skript aus, um Datenintegrität, Schema und Abfragen zu überprüfen und sicherzustellen, dass die Sicherungsdaten Ihren Erwartungen entsprechen. Protokollieren und melden Sie Inkonsistenzen, damit der Sicherungsdienst repariert werden kann.
- **Verwenden Sie regelmäßige Sicherungen und die Zeitpunktwiederherstellung**. Sichern Sie Daten, die nicht an anderer Stelle gespeichert werden, regelmäßig und automatisch. Überprüfen Sie, ob Sie sowohl die Daten als auch die Anwendung selbst zuverlässig wiederherstellen können, wenn ein Fehler auftritt. Stellen Sie sicher, dass Sicherungen Ihrer RPO entsprechen. Datenreplikation ist kein Sicherungsfeature, da menschliche Fehler oder böswillige Eingriffe Daten über alle Replikate hinweg beschädigen können. Der Sicherungsvorgang muss sicher sein, sodass die Daten während der Übertragung und Speicherung geschützt sind. Datenbanken können in der Regel mithilfe von Transaktionsprotokollen in einem Zustand wiederhergestellt werden, den sie zu einem früheren Zeitpunkt hatten. Weitere Informationen finden Sie unter [Wiederherstellung nach Datenbeschädigung oder unbeabsichtigtem Löschen](../resiliency/recovery-data-corruption.md).
- **Erwägen Sie die Verwendung eines geografisch redundanten Speicherkontos.** Daten, die in einem Azure-Speicherkonto gespeichert sind, werden immer lokal repliziert. Bei der Bereitstellung eines Speicherkontos können Sie jedoch aus mehreren Replikationsstrategien auswählen. Um Ihre Anwendungsdaten für den seltenen Fall zu schützen, dass eine vollständige Region nicht mehr verfügbar ist, wählen Sie einen [georedundanten Speicher mit Lesezugriff (RA-GRS) in Azure ](/azure/storage/storage-redundancy/#read-access-geo-redundant-storage)aus.  

    > [!NOTE]
    > Verlassen Sie sich für VMs nicht auf die RA-GRS-Replikation, um die VM-Datenträger (VHD-Dateien) wiederherzustellen. Verwenden Sie stattdessen [Azure Backup](/azure/backup).

- **Erwägen Sie die Bereitstellung von Verweisdaten in mehreren Regionen.** Verweisdaten sind schreibgeschützte Daten, die die Anwendungsfunktionalität unterstützen. Sie ändern sich normalerweise nur selten. Die Wiederherstellung aus einer Sicherung stellt zwar eine Möglichkeit zum Behandeln von regionsweiten Dienstunterbrechungen dar, die RTO ist jedoch relativ lang. Wenn Sie die Anwendung in einer sekundären Region bereitstellen, gibt es einige Strategien, die RTO für Verweisdaten zu verbessern.

    Da Verweisdaten nur selten geändert werden, können Sie die RTO verbessern, indem Sie eine dauerhafte Kopie in der sekundären Region verwalten. Dadurch wird der Zeitaufwand für die Wiederherstellung von Sicherungen nach einem Notfall beseitigt. Um die Anforderungen der Notfallwiederherstellung in mehreren Regionen zu erfüllen, müssen Sie die Anwendung und die Verweisdaten zusammen in mehreren Regionen bereitstellen.

- **Verwenden Sie optimistische Parallelität und letztendliche Konsistenz.** Transaktionen, die den Zugriff auf Ressourcen durch Sperren (*pessimistische Parallelität*) blockieren, können die Leistung beeinträchtigen und die Verfügbarkeit reduzieren. Diese Probleme können insbesondere in verteilten Systemen akut werden. In vielen Fällen lässt sich die Wahrscheinlichkeit, dass miteinander in Konflikt stehende Aktualisierungen auftreten, durch sorgfältige Planung und Techniken, wie z. B. die Partitionierung, minimieren. Wenn Daten repliziert oder aus einem separat aktualisierten Speicher gelesen werden, sind die Daten erst zum Schluss konsistent. Die Vorteile überwiegen aber in der Regel gegenüber den Auswirkungen, die die Verwendung von Transaktionen zur Gewährleistung der sofortigen Konsistenz auf die Verfügbarkeit haben.
- **Nutzen Sie die aktive Georeplikation für die SQL-Datenbank, um Änderungen an einer sekundären Datenbank zu replizieren.** Mit der aktiven Georeplikation für die SQL-Datenbank werden Datenbankänderungen automatisch in sekundären Datenbanken in derselben Region oder einer anderen Region repliziert. Weitere Informationen finden Sie unter [Erstellen und Verwenden der aktiven Georeplikation](/azure/sql-database/sql-database-active-geo-replication).

  Alternativ können Sie einen manuelleren Ansatz wählen, indem Sie den Befehl **DATABASE COPY** verwenden, um eine Sicherungskopie der Datenbank mit Transaktionskonsistenz zu erstellen. Sie können auch den Import-/Export-Dienst von Azure SQL-Datenbank nutzen, der den Export von Datenbanken in BACPAC-Dateien (komprimierte Dateien, die Ihr Datenbankschema und die dazugehörigen Daten enthalten) unterstützt, die in Azure Blob Storage gespeichert sind. Azure Storage erstellt zwei Replikate der Sicherungsdatei in einer Region. Jedoch bestimmt die Häufigkeit des Sicherungsvorgangs Ihre RPO, also den Umfang an Daten, die Sie bei einem Notfall verlieren können. Wenn Sie Daten beispielsweise einmal pro Stunde sichern und ein Notfall zwei Minuten vor der Sicherung auftritt, verlieren Sie die Daten der letzten 58 Minuten. Darüber hinaus sollten Sie zum Schutz vor einer regionsweiten Dienstunterbrechung die BACPAC-Dateien in eine alternative Region kopieren. Weitere Informationen finden Sie unter [Übersicht über die Geschäftskontinuität mit Azure SQL-Datenbank](/azure/sql-database/sql-database-business-continuity).

- **Verwenden Sie Geosicherungen für SQL Data Warehouse.** Verwenden Sie für SQL Data Warehouse [Geosicherungen](/azure/sql-data-warehouse/backup-and-restore), um zur Notfallwiederherstellung die Wiederherstellung in einer gekoppelten Region durchzuführen. Diese Sicherungen werden alle 24 Stunden erstellt und können innerhalb von 20 Minuten in der gekoppelten Region wiederhergestellt werden. Dieses Feature ist standardmäßig für alle SQL Data Warehouse-Instanzen aktiviert. Weitere Informationen zum Wiederherstellen Ihres Data Warehouse finden Sie unter [Wiederherstellen von einer geografischen Azure-Region aus mithilfe von PowerShell](/azure/sql-data-warehouse/sql-data-warehouse-restore).

- **Replizieren Sie VM-Datenträger mithilfe von Azure Site Recovery.** Wenn Sie virtuelle Azure-Computer mit [Site Recovery](/azure/site-recovery/) replizieren, werden kontinuierlich alle VM-Datenträger asynchron in der Zielregion repliziert. Die Wiederherstellungspunkte werden im Abstand von wenigen Minuten erstellt. Dadurch erzielen Sie einen RPO-Wert von wenigen Minuten.
- **Sichern Sie SQL Server auf virtuellen Computern, oder konfigurieren Sie eine Sitzung für den Protokollversand.** Für SQL Server auf virtuellen Computern gibt es zwei Optionen: herkömmliche Sicherungen und Protokollversand. Herkömmliche Sicherungen ermöglichen die Wiederherstellung auf einen bestimmten Zeitpunkt – allerdings ist der Wiederherstellungsprozess langsam. Um herkömmliche Sicherungen wiederherzustellen, müssen Sie mit einer vollständigen Erstsicherung beginnen und dann alle nachfolgend durchgeführten Sicherungen anwenden. Bei der zweiten Option wird eine Protokollversandsitzung konfiguriert, um die Wiederherstellung von Protokollsicherungen zu verzögern (beispielsweise um zwei Stunden). In dem entstandenen Zeitfenster können Fehler in der primären Datenbank behoben werden.
- **Verwenden Sie einen benutzerdefinierten Prozess oder ein Drittanbietertool für die Azure Storage-Sicherung.** Für Azure Storage können Sie einen eigenen benutzerdefinierten Sicherungsprozess entwickeln. Sie können aber auch ein Sicherungstool von Drittanbietern verwenden. In den meisten Anwendungsentwürfen liegt zusätzliche Komplexität vor, in denen Speicherressourcen aufeinander verweisen. Stellen Sie sich beispielsweise eine SQL-Datenbank vor, die über eine Spalte mit einem Link zu einem Blob in Azure Storage verfügt. Wenn die Sicherungen nicht gleichzeitig erfolgen, enthält die Datenbank möglicherweise einen Zeiger auf ein Blob, das vor dem Ausfall nicht gesichert wurde. Die Anwendung oder der Notfallwiederherstellungsplan muss Prozesse implementieren, damit diese Inkonsistenz nach einer Wiederherstellung behandelt wird.
- **Verwenden Sie für andere Datenplattformen, die auf VMs gehostet werden, die nativen Funktionen für Momentaufnahmen oder Replikation.** Andere Datenplattformen, wie Elasticsearch oder MongoDB, verfügen über eigene Funktionen, und es gelten eigene Überlegungen für die Erstellung eines integrierten Sicherungs- und Wiederherstellungsprozesses. Für diese Datenplattformen wird allgemein empfohlen, alle nativen oder verfügbaren integrationsbasierten Funktionen für Replikation oder Momentaufnahmen zu nutzen. Wenn diese Funktionen nicht vorhanden oder nicht geeignet sind, sollten Sie in Erwägung ziehen, Azure Backup oder Datenträger-Momentaufnahmen zu verwenden, um eine zeitpunktbezogene Kopie von Anwendungsdaten zu erstellen. Auf alle Fälle ist es wichtig zu bestimmen, wie konsistente Sicherungen erreicht werden können. Dies gilt insbesondere, wenn Anwendungsdaten sich in mehreren Dateisystemen befinden oder wenn mehrere Laufwerke zu einem einzigen Dateisystem zusammengefasst sind.
- **Untersuchen Sie die Replikationsmethoden für die Datenquellen Ihrer Anwendung.** Ihre Anwendungsdaten werden in unterschiedlichen Datenquellen gespeichert und weisen unterschiedliche Anforderungen an die Verfügbarkeit auf. Bewerten Sie die Replikationsmethoden für jeden Typ von Datenspeicher in Azure, beispielsweise die [Azure Storage-Redundanz](/azure/storage/storage-redundancy/) und die [aktive Georeplikation in Azure SQL-Datenbank](/azure/sql-database/sql-database-geo-replication-overview/), um sicherzustellen, dass die Datenanforderungen Ihrer Anwendung erfüllt werden. Falls Sie virtuelle Azure-Computer mit [Site Recovery](/azure/site-recovery/) replizieren, werden kontinuierlich alle VM-Datenträger asynchron in der Zielregion repliziert. Die Wiederherstellungspunkte werden im Abstand von wenigen Minuten erstellt.
- **Richten Sie Datenstrategien für die Notfallwiederherstellung ein.** Der richtige Umgang mit Daten ist ein anspruchsvoller Aspekt jedes Plans für die Notfallwiederherstellung. Während des Wiederherstellungsprozesses benötigt die Wiederherstellung von Daten in der Regel die meiste Zeit. Verschiedene Optionen für die Einschränkung von Funktionalität führen zu schwierigen Herausforderungen für die Datenwiederherstellung und die Konsistenz.

## <a name="next-steps"></a>Nächste Schritte

> [!div class="nextstepaction"]
> [Test auf Resilienz und Verfügbarkeit](./testing.md)
