---
title: API-Gateways
description: API-Gateways in Microservices
author: MikeWasson
ms.date: 12/08/2017
ms.openlocfilehash: 6483d416363e24f4084d6b856847a740bf4054d9
ms.sourcegitcommit: a8453c4bc7c870fa1a12bb3c02e3b310db87530c
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 12/29/2017
---
# <a name="designing-microservices-api-gateways"></a><span data-ttu-id="47fad-103">Entwerfen von Microservices: API-Gateways</span><span class="sxs-lookup"><span data-stu-id="47fad-103">Designing microservices: API gateways</span></span>

<span data-ttu-id="47fad-104">In einer Microservices-Architektur interagiert ein Client ggf. mit mehreren Front-End-Diensten.</span><span class="sxs-lookup"><span data-stu-id="47fad-104">In a microservices architecture, a client might interact with more than one front-end service.</span></span> <span data-ttu-id="47fad-105">Woher weiß ein Client aber, welche Endpunkte er aufrufen soll?</span><span class="sxs-lookup"><span data-stu-id="47fad-105">Given this fact, how does a client know what endpoints to call?</span></span> <span data-ttu-id="47fad-106">Was passiert, wenn neue Dienste eingeführt oder vorhandene Dienste umgestaltet werden?</span><span class="sxs-lookup"><span data-stu-id="47fad-106">What happens when new services are introduced, or existing services are refactored?</span></span> <span data-ttu-id="47fad-107">Wie behandeln Dienste SSL-Beendigung, Authentifizierung und andere Anliegen?</span><span class="sxs-lookup"><span data-stu-id="47fad-107">How do services handle SSL termination, authentication, and other concerns?</span></span> <span data-ttu-id="47fad-108">Hier kann ein *API-Gateway* hilfreich sein.</span><span class="sxs-lookup"><span data-stu-id="47fad-108">An *API gateway* can help to address these challenges.</span></span> 

![](./images/gateway.png)

## <a name="what-is-an-api-gateway"></a><span data-ttu-id="47fad-109">Was ist ein API-Gateway?</span><span class="sxs-lookup"><span data-stu-id="47fad-109">What is an API gateway?</span></span>

<span data-ttu-id="47fad-110">Ein API-Gateway befindet sich zwischen Clients und Diensten.</span><span class="sxs-lookup"><span data-stu-id="47fad-110">An API gateway sits between clients and services.</span></span> <span data-ttu-id="47fad-111">Es fungiert als Reverseproxy und leitet Anforderungen von Clients an Dienste weiter.</span><span class="sxs-lookup"><span data-stu-id="47fad-111">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="47fad-112">Darüber hinaus kann es verschiedene übergreifende Aufgaben wie Authentifizierung, SSL-Beendigung und Ratenbegrenzung übernehmen.</span><span class="sxs-lookup"><span data-stu-id="47fad-112">It may also perform various cross-cutting tasks such as authentication, SSL termination, and rate limiting.</span></span> <span data-ttu-id="47fad-113">Wenn Sie kein Gateway bereitstellen, müssen Clients Anforderungen direkt an Front-End-Dienste senden.</span><span class="sxs-lookup"><span data-stu-id="47fad-113">If you don't deploy a gateway, clients must send requests directly to front-end services.</span></span> <span data-ttu-id="47fad-114">Der direkte Kontakt zwischen Diensten und Clients kann jedoch problematisch sein:</span><span class="sxs-lookup"><span data-stu-id="47fad-114">However, there are some potential problems with exposing services directly to clients:</span></span>

- <span data-ttu-id="47fad-115">Er kann zu komplexem Clientcode führen.</span><span class="sxs-lookup"><span data-stu-id="47fad-115">It can result in complex client code.</span></span> <span data-ttu-id="47fad-116">Der Client muss den Überblick über mehrere Endpunkte behalten und über eine robuste Fehlerbehandlung verfügen.</span><span class="sxs-lookup"><span data-stu-id="47fad-116">The client must keep track of multiple endpoints, and handle failures in a resilient way.</span></span> 
- <span data-ttu-id="47fad-117">Er führt zu einer Kopplung zwischen Client und Back-End.</span><span class="sxs-lookup"><span data-stu-id="47fad-117">It creates coupling between the client and the backend.</span></span> <span data-ttu-id="47fad-118">Der Client benötigt Informationen zur Aufspaltung der einzelnen Dienste.</span><span class="sxs-lookup"><span data-stu-id="47fad-118">The client needs to know how the individual services are decomposed.</span></span> <span data-ttu-id="47fad-119">Dies erschwert die Verwaltung des Clients sowie die Umgestaltung von Diensten.</span><span class="sxs-lookup"><span data-stu-id="47fad-119">That makes it harder to maintain the client and also harder to refactor services.</span></span>
- <span data-ttu-id="47fad-120">Für einen einzelnen Vorgang müssen möglicherweise mehrere Dienste aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="47fad-120">A single operation might require calls to multiple services.</span></span> <span data-ttu-id="47fad-121">Dies kann mehrere Netzwerkroundtrips zwischen Client und Server erforderlich machen und die Wartezeit erheblich erhöhen.</span><span class="sxs-lookup"><span data-stu-id="47fad-121">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> 
- <span data-ttu-id="47fad-122">Jeder öffentliche Dienst muss Aspekte wie Authentifizierung, SSL und Clientratenbegrenzung behandeln.</span><span class="sxs-lookup"><span data-stu-id="47fad-122">Each public-facing service must handle concerns such as authentication, SSL, and client rate limiting.</span></span> 
- <span data-ttu-id="47fad-123">Dienste müssen ein clientfreundliches Protokoll wie HTTP oder WebSocket verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="47fad-123">Services must expose a client-friendly protocol such as HTTP or WebSocket.</span></span> <span data-ttu-id="47fad-124">Dies schränkt die in Frage kommenden [Kommunikationsprotokolle](./interservice-communication.md) ein.</span><span class="sxs-lookup"><span data-stu-id="47fad-124">This limits the choice of [communication protocols](./interservice-communication.md).</span></span> 
- <span data-ttu-id="47fad-125">Dienste mit öffentlichen Endpunkten stellen ein potenzielles Angriffsziel dar und müssen gehärtet werden.</span><span class="sxs-lookup"><span data-stu-id="47fad-125">Services with public endpoints are a potential attack surface, and must be hardened.</span></span>

<span data-ttu-id="47fad-126">Ein Gateway trägt zur Bewältigung dieser Herausforderungen bei, indem es Clients von Diensten entkoppelt.</span><span class="sxs-lookup"><span data-stu-id="47fad-126">A gateway helps to address these issues by decoupling clients from services.</span></span> <span data-ttu-id="47fad-127">Gateways können eine ganze Reihe unterschiedlicher Funktionen übernehmen, die Sie möglicherweise gar nicht alle benötigen.</span><span class="sxs-lookup"><span data-stu-id="47fad-127">Gateways can perform a number of different functions, and you may not need all of them.</span></span> <span data-ttu-id="47fad-128">Die Funktionen lassen sich in folgende Entwurfsmuster unterteilen:</span><span class="sxs-lookup"><span data-stu-id="47fad-128">The functions can be grouped into the following design patterns:</span></span>

<span data-ttu-id="47fad-129">[Gatewayrouting:](../patterns/gateway-routing.md)</span><span class="sxs-lookup"><span data-stu-id="47fad-129">[Gateway Routing](../patterns/gateway-routing.md).</span></span> <span data-ttu-id="47fad-130">Verwenden Sie das Gateway als Reverseproxy, um Anforderungen mittels Layer-7-Routing an Back-End-Dienste weiterzuleiten.</span><span class="sxs-lookup"><span data-stu-id="47fad-130">Use the gateway as a reverse proxy to route requests to one or more backend services, using layer 7 routing.</span></span> <span data-ttu-id="47fad-131">Das Gateway stellt einen einzelnen Endpunkt für Clients bereit und trägt zur Entkopplung von Clients und Diensten bei.</span><span class="sxs-lookup"><span data-stu-id="47fad-131">The gateway provides a single endpoint for clients, and helps to decouple clients from services.</span></span> 

<span data-ttu-id="47fad-132">[Gatewayaggregation:](../patterns/gateway-aggregation.md)</span><span class="sxs-lookup"><span data-stu-id="47fad-132">[Gateway Aggregation](../patterns/gateway-aggregation.md).</span></span> <span data-ttu-id="47fad-133">Aggregieren Sie mehrere Anforderungen mithilfe des Gateways in einer einzelnen Anforderung.</span><span class="sxs-lookup"><span data-stu-id="47fad-133">Use the gateway to aggregate multiple individual requests into a single request.</span></span> <span data-ttu-id="47fad-134">Dieses Muster kommt zur Anwendung, wenn für einen einzelnen Vorgang mehrere Back-End-Dienste aufgerufen werden müssen.</span><span class="sxs-lookup"><span data-stu-id="47fad-134">This pattern applies when a single operation requires calls to multiple backend services.</span></span> <span data-ttu-id="47fad-135">Der Client sendet eine einzelne Anforderung an das Gateway.</span><span class="sxs-lookup"><span data-stu-id="47fad-135">The client sends one request to the gateway.</span></span> <span data-ttu-id="47fad-136">Das Gateway sendet Anforderungen an die verschiedenen Back-End-Systeme, aggregiert die Ergebnisse und gibt sie an den Client zurück.</span><span class="sxs-lookup"><span data-stu-id="47fad-136">The gateway dispatches requests to the various backend services, and then aggregates the results and sends them back to the client.</span></span> <span data-ttu-id="47fad-137">Dadurch verringert sich die Kommunikation zwischen Client Back-End.</span><span class="sxs-lookup"><span data-stu-id="47fad-137">This helps to reduce chattiness between the client and the backend.</span></span> 

<span data-ttu-id="47fad-138">[Gatewayabladung:](../patterns/gateway-offloading.md)</span><span class="sxs-lookup"><span data-stu-id="47fad-138">[Gateway Offloading](../patterns/gateway-offloading.md).</span></span> <span data-ttu-id="47fad-139">Nutzen Sie das Gateway, um Funktionen einzelner Dienste (insbesondere übergreifende Aspekte) an das Gateway auszulagern.</span><span class="sxs-lookup"><span data-stu-id="47fad-139">Use the gateway to offload functionality from individual services to the gateway, particularly cross-cutting concerns.</span></span> <span data-ttu-id="47fad-140">Es kann hilfreich sein, diese Funktionen an einem zentralen Ort zusammenzufassen, anstatt ihre Implementierung den einzelnen Diensten zu überlassen.</span><span class="sxs-lookup"><span data-stu-id="47fad-140">It can be useful to consolidate these functions into one place, rather than making every service responsible for implementing them.</span></span> <span data-ttu-id="47fad-141">Das gilt insbesondere für Features wie Authentifizierung und Autorisierung, deren korrekte Implementierung spezielles Fachwissen voraussetzt.</span><span class="sxs-lookup"><span data-stu-id="47fad-141">This is particularly true for features that requires specialized skills to implement correctly, such as authentication and authorization.</span></span> 

<span data-ttu-id="47fad-142">Folgende Funktionen können beispielsweise an ein Gateway ausgelagert werden:</span><span class="sxs-lookup"><span data-stu-id="47fad-142">Here are some examples of functionality that could be offloaded to a gateway:</span></span>

- <span data-ttu-id="47fad-143">SSL-Beendigung</span><span class="sxs-lookup"><span data-stu-id="47fad-143">SSL termination</span></span>
- <span data-ttu-id="47fad-144">Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="47fad-144">Authentication</span></span>
- <span data-ttu-id="47fad-145">IP-Whitelisting</span><span class="sxs-lookup"><span data-stu-id="47fad-145">IP whitelisting</span></span>
- <span data-ttu-id="47fad-146">Clientratenbegrenzung (Drosselung)</span><span class="sxs-lookup"><span data-stu-id="47fad-146">Client rate limiting (throttling)</span></span>
- <span data-ttu-id="47fad-147">Protokollierung und Überwachung</span><span class="sxs-lookup"><span data-stu-id="47fad-147">Logging and monitoring</span></span>
- <span data-ttu-id="47fad-148">Zwischenspeicherung von Antworten</span><span class="sxs-lookup"><span data-stu-id="47fad-148">Response caching</span></span>
- <span data-ttu-id="47fad-149">Web Application Firewall</span><span class="sxs-lookup"><span data-stu-id="47fad-149">Web application firewall</span></span>
- <span data-ttu-id="47fad-150">GZIP-Komprimierung</span><span class="sxs-lookup"><span data-stu-id="47fad-150">GZIP compression</span></span>
- <span data-ttu-id="47fad-151">Wartung statischer Inhalte</span><span class="sxs-lookup"><span data-stu-id="47fad-151">Servicing static content</span></span>

## <a name="choosing-a-gateway-technology"></a><span data-ttu-id="47fad-152">Wählen einer Gatewaytechnologie</span><span class="sxs-lookup"><span data-stu-id="47fad-152">Choosing a gateway technology</span></span>

<span data-ttu-id="47fad-153">In diesem Abschnitt finden Sie einige Optionen für die Implementierung eines API-Gateways in Ihrer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="47fad-153">Here are some options for implementing an API gateway in your application.</span></span>

- <span data-ttu-id="47fad-154">**Reverseproxyserver:**</span><span class="sxs-lookup"><span data-stu-id="47fad-154">**Reverse proxy server**.</span></span> <span data-ttu-id="47fad-155">Nginx und HAProxy sind gängige Reverseproxyserver, die Features wie Lastenausgleich, SSL und Layer-7-Routing unterstützen.</span><span class="sxs-lookup"><span data-stu-id="47fad-155">Nginx and HAProxy are popular reverse proxy servers that support features such as load balancing, SSL, and layer 7 routing.</span></span> <span data-ttu-id="47fad-156">Beides sind kostenlose Open-Source-Produkte, die auch als kostenpflichtige Editionen mit zusätzlichen Features und Unterstützungsoptionen erhältlich sind.</span><span class="sxs-lookup"><span data-stu-id="47fad-156">They are both free, open-source products, with paid editions that provide additional features and support options.</span></span> <span data-ttu-id="47fad-157">Nginx und HAProxy sind ausgereifte, leistungsfähige Produkte mit großem Funktionsumfang.</span><span class="sxs-lookup"><span data-stu-id="47fad-157">Nginx and HAProxy are both mature products with rich feature sets and high performance.</span></span> <span data-ttu-id="47fad-158">Sie können mit Drittanbietermodulen oder benutzerdefinierten Lua-Skripts erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="47fad-158">You can extend them with third-party modules or by writing custom scripts in Lua.</span></span> <span data-ttu-id="47fad-159">Nginx unterstützt auch ein JavaScript-basiertes Skripterstellungsmodul namens NginScript.</span><span class="sxs-lookup"><span data-stu-id="47fad-159">Nginx also supports a JavaScript-based scripting module called NginScript.</span></span>

- <span data-ttu-id="47fad-160">**Dienstnetz-Eingangscontroller:**</span><span class="sxs-lookup"><span data-stu-id="47fad-160">**Service mesh ingress controller**.</span></span> <span data-ttu-id="47fad-161">Ziehen Sie bei Verwendung eines Dienstnetzes wie linkerd oder Istio die Features in Erwägung, die vom Eingangscontroller für das Dienstnetz bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="47fad-161">If you are using a service mesh such as linkerd or Istio, consider the features that are provided by the ingress controller for that service mesh.</span></span> <span data-ttu-id="47fad-162">Der Istio-Eingangscontroller unterstützt beispielsweise Layer-7-Routing, HTTP-Umleitungen, Wiederholungen und andere Features.</span><span class="sxs-lookup"><span data-stu-id="47fad-162">For example, the Istio ingress controller supports layer 7 routing, HTTP redirects, retries, and other features.</span></span> 

- <span data-ttu-id="47fad-163">[Azure Application Gateway:](/azure/application-gateway/)</span><span class="sxs-lookup"><span data-stu-id="47fad-163">[Azure Application Gateway](/azure/application-gateway/).</span></span> <span data-ttu-id="47fad-164">Application Gateway ist ein verwalteter Lastenausgleichsdienst, der für Layer-7-Routing und SSL-Beendigung geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="47fad-164">Application Gateway is a managed load balancing service that can perform layer-7 routing and SSL termination.</span></span> <span data-ttu-id="47fad-165">Darüber hinaus verfügt er über eine Web Application Firewall (WAF).</span><span class="sxs-lookup"><span data-stu-id="47fad-165">It also provides a web application firewall (WAF).</span></span>

- <span data-ttu-id="47fad-166">[Azure API Management:](/azure/api-management/)</span><span class="sxs-lookup"><span data-stu-id="47fad-166">[Azure API Management](/azure/api-management/).</span></span> <span data-ttu-id="47fad-167">API Management ist eine sofort einsatzbereite Lösung zum Veröffentlichen von APIs für externe und interne Kunden.</span><span class="sxs-lookup"><span data-stu-id="47fad-167">API Management is a turnkey solution for publishing APIs to external and internal customers.</span></span> <span data-ttu-id="47fad-168">Sie bietet hilfreiche Features für die Verwaltung einer öffentlichen API wie Ratenbeschränkung, IP-Whitelisting und Authentifizierung mit Azure Active Directory oder anderen Identitätsanbietern.</span><span class="sxs-lookup"><span data-stu-id="47fad-168">It provides features that are useful for managing a public-facing API, including rate limiting, IP white listing, and authentication using Azure Active Directory or other identity providers.</span></span> <span data-ttu-id="47fad-169">Da API Management über keinen Lastenausgleich verfügt, sollte die Lösung mit einem Lastenausgleich wie Application Gateway oder einem Reverseproxy kombiniert werden.</span><span class="sxs-lookup"><span data-stu-id="47fad-169">API Management doesn't perform any load balancing, so it should be used in conjunction with a load balancer such as Application Gateway or a reverse proxy.</span></span>

<span data-ttu-id="47fad-170">Berücksichtigen Sie bei der Wahl einer Gatewaytechnologie Folgendes:</span><span class="sxs-lookup"><span data-stu-id="47fad-170">When choosing a gateway technology, consider the following:</span></span>

<span data-ttu-id="47fad-171">**Features:**</span><span class="sxs-lookup"><span data-stu-id="47fad-171">**Features**.</span></span> <span data-ttu-id="47fad-172">Die oben aufgeführten Optionen unterstützen alle Layer-7-Routing. Die Unterstützung anderer Features variiert.</span><span class="sxs-lookup"><span data-stu-id="47fad-172">The options listed above all support layer 7 routing, but support for other features will vary.</span></span> <span data-ttu-id="47fad-173">Je nach benötigten Features können Sie mehrere Gateways bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="47fad-173">Depending on the features that you need, you might deploy more than one gateway.</span></span> 

<span data-ttu-id="47fad-174">**Bereitstellung:**</span><span class="sxs-lookup"><span data-stu-id="47fad-174">**Deployment**.</span></span> <span data-ttu-id="47fad-175">Azure Application Gateway und API Management sind verwaltete Dienste.</span><span class="sxs-lookup"><span data-stu-id="47fad-175">Azure Application Gateway and API Management are managed services.</span></span> <span data-ttu-id="47fad-176">Nginx und HAProxy werden in der Regel in Containern innerhalb des Clusters ausgeführt, können aber auch auf dedizierten virtuellen Computern außerhalb des Clusters bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="47fad-176">Nginx and HAProxy will typically run in containers inside the cluster, but can also be deployed to dedicated VMs outside of the cluster.</span></span> <span data-ttu-id="47fad-177">Dadurch wird das Gateway vom Rest der Workload isoliert, verursacht aber auch einen höheren Verwaltungsaufwand.</span><span class="sxs-lookup"><span data-stu-id="47fad-177">This isolates the gateway from the rest of the workload, but incurs higher management overhead.</span></span>

<span data-ttu-id="47fad-178">**Verwaltung:**</span><span class="sxs-lookup"><span data-stu-id="47fad-178">**Management**.</span></span> <span data-ttu-id="47fad-179">Wenn Dienste aktualisiert oder neue Dienste hinzugefügt werden, müssen ggf. die Gatewayroutingregeln aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="47fad-179">When services are updated or new services are added, the gateway routing rules may need to be updated.</span></span> <span data-ttu-id="47fad-180">Überlegen Sie sich, wie dieser Prozess gehandhabt werden soll.</span><span class="sxs-lookup"><span data-stu-id="47fad-180">Consider how this process will be managed.</span></span> <span data-ttu-id="47fad-181">Ähnliche Überlegungen müssen für den Umgang mit SSL-Zertifikaten, IP-Whitelists und anderen Konfigurationsaspekten angestellt werden.</span><span class="sxs-lookup"><span data-stu-id="47fad-181">Similar considerations apply to managing SSL certificates, IP whitelists, and other aspects of configuration.</span></span>

## <a name="deployment-considerations"></a><span data-ttu-id="47fad-182">Überlegungen zur Bereitstellung</span><span class="sxs-lookup"><span data-stu-id="47fad-182">Deployment considerations</span></span>

### <a name="deploying-nginx-or-haproxy-to-kubernetes"></a><span data-ttu-id="47fad-183">Bereitstellen von Nginx oder HAProxy für Kubernetes</span><span class="sxs-lookup"><span data-stu-id="47fad-183">Deploying Nginx or HAProxy to Kubernetes</span></span>

<span data-ttu-id="47fad-184">Sie können Nginx oder HAProxy für Kubernetes als [ReplicaSet](https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/) oder [DaemonSet](https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/) bereitstellen, das das Nginx- oder HAProxy-Containerimage angibt.</span><span class="sxs-lookup"><span data-stu-id="47fad-184">You can deploy Nginx or HAProxy to Kubernetes as a [ReplicaSet](https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/) or [DaemonSet](https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/) that specifies the Nginx or HAProxy container image.</span></span> <span data-ttu-id="47fad-185">Speichern Sie die Konfigurationsdatei für den Proxy mithilfe eines ConfigMap-Elements, und binden Sie dieses als Volume ein.</span><span class="sxs-lookup"><span data-stu-id="47fad-185">Use a ConfigMap to store the configuration file for the proxy, and mount the ConfigMap as a volume.</span></span> <span data-ttu-id="47fad-186">Erstellen Sie einen LoadBalancer-Dienst, um das Gateway über einen Azure Load Balancer verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="47fad-186">Create a service of type LoadBalancer to expose the gateway through an Azure Load Balancer.</span></span> 

<!-- - Configure a readiness probe that serves a static file from the gateway (rather than routing to another service). -->

<span data-ttu-id="47fad-187">Alternativ können Sie auch einen Eingangscontroller erstellen.</span><span class="sxs-lookup"><span data-stu-id="47fad-187">An alternative is to create an Ingress Controller.</span></span> <span data-ttu-id="47fad-188">Ein Eingangscontroller ist eine Kubernetes-Ressource, die einen Lastenausgleich oder Reverseproxyserver bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="47fad-188">An Ingress Controller is a Kubernetes resource that deploys a load balancer or reverse proxy server.</span></span> <span data-ttu-id="47fad-189">Hierfür stehen mehrere Implementierungen (unter anderem Nginx und HAProxy) zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="47fad-189">Several implementations exist, including Nginx and HAProxy.</span></span> <span data-ttu-id="47fad-190">Eine separate Ressource namens „Ingress“ (Eingang) definiert die Einstellungen für den Eingangscontroller (beispielsweise Routingregeln und TLS-Zertifikate).</span><span class="sxs-lookup"><span data-stu-id="47fad-190">A separate resource called an Ingress defines settings for the Ingress Controller, such as routing rules and TLS certificates.</span></span> <span data-ttu-id="47fad-191">Dadurch müssen Sie keine komplexen spezifischen Konfigurationsdateien für eine bestimmte Proxyservertechnologie verwalten.</span><span class="sxs-lookup"><span data-stu-id="47fad-191">That way, you don't need to manage complex configuration files that are specific to a particular proxy server technology.</span></span> <span data-ttu-id="47fad-192">Eingangscontroller von Kubernetes befinden sich zum Zeitpunkt der Artikelerstellung noch in der Betaphase. Ihre Entwicklung ist also noch nicht abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="47fad-192">Ingress Controllers are still a beta feature of Kubernetes at the time of this writing, and the feature will continue to evolve.</span></span>

<span data-ttu-id="47fad-193">Das Gateway ist ein potenzieller Engpass oder Single Point of Failure des Systems. Stellen Sie daher immer mindestens zwei Replikate bereit, um eine hohe Verfügbarkeit zu gewährleisten.</span><span class="sxs-lookup"><span data-stu-id="47fad-193">The gateway is a potential bottleneck or single point of failure in the system, so always deploy at least two replicas for high availability.</span></span> <span data-ttu-id="47fad-194">Abhängig von der Last müssen die Replikate ggf. weiter horizontal hochskaliert werden.</span><span class="sxs-lookup"><span data-stu-id="47fad-194">You may need to scale out the replicas further, depending on the load.</span></span> 

<span data-ttu-id="47fad-195">Unter Umständen empfiehlt es sich auch, das Gateway auf einer dedizierten Gruppe von Knoten im Cluster auszuführen.</span><span class="sxs-lookup"><span data-stu-id="47fad-195">Also consider running the gateway on a dedicated set of nodes in the cluster.</span></span> <span data-ttu-id="47fad-196">Dieser Ansatz bietet folgende Vorteile:</span><span class="sxs-lookup"><span data-stu-id="47fad-196">Benefits to this approach include:</span></span>

- <span data-ttu-id="47fad-197">Isolation:</span><span class="sxs-lookup"><span data-stu-id="47fad-197">Isolation.</span></span> <span data-ttu-id="47fad-198">Sämtlicher eingehender Datenverkehr geht an eine feste Gruppe von Knoten, die von Back-End-Diensten isoliert werden können.</span><span class="sxs-lookup"><span data-stu-id="47fad-198">All inbound traffic goes to a fixed set of nodes, which can be isolated from backend services.</span></span>

- <span data-ttu-id="47fad-199">Stabile Konfiguration:</span><span class="sxs-lookup"><span data-stu-id="47fad-199">Stable configuration.</span></span> <span data-ttu-id="47fad-200">Im Falle einer falschen Gatewaykonfiguration ist möglicherweise die gesamte Anwendung nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="47fad-200">If the gateway is misconfigured, the entire application may become unavailable.</span></span> 

- <span data-ttu-id="47fad-201">Leistung:</span><span class="sxs-lookup"><span data-stu-id="47fad-201">Performance.</span></span> <span data-ttu-id="47fad-202">Aus Leistungsgründen empfiehlt sich unter Umständen die Verwendung einer bestimmten VM-Konfiguration für das Gateway.</span><span class="sxs-lookup"><span data-stu-id="47fad-202">You may want to use a specific VM configuration for the gateway for performance reasons.</span></span>

<!-- - Load balancing. You can configure the external load balancer so that requests always go to a gateway node. That can save a network hop, which would otherwise happen whenever a request lands on a node that isn't running a gateway pod. This consideration applies mainly to large clusters, where the gateway runs on a relatively small fraction of the total nodes. In Azure Container Service (ACS), this approach currently requires [ACS Engine](https://github.com/Azure/acs-engine)) which allows you to create multiple agent pools. Then you can deploy the gateway as a DaemonSet to the front-end pool. -->

### <a name="azure-application-gateway"></a><span data-ttu-id="47fad-203">Azure Application Gateway</span><span class="sxs-lookup"><span data-stu-id="47fad-203">Azure Application Gateway</span></span>

<span data-ttu-id="47fad-204">So verbinden Sie Application Gateway mit einem Kubernetes-Cluster in Azure:</span><span class="sxs-lookup"><span data-stu-id="47fad-204">To connect Application Gateway to a Kubernetes cluster in Azure:</span></span>

1. <span data-ttu-id="47fad-205">Erstellen Sie im Cluster-VNet ein leeres Subnetz.</span><span class="sxs-lookup"><span data-stu-id="47fad-205">Create an empty subnet in the cluster VNet.</span></span>
2. <span data-ttu-id="47fad-206">Stellen Sie Application Gateway bereit.</span><span class="sxs-lookup"><span data-stu-id="47fad-206">Deploy Application Gateway.</span></span>
3. <span data-ttu-id="47fad-207">Erstellen Sie einen Kubernetes-Dienst vom Typ [NodePort](https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport).</span><span class="sxs-lookup"><span data-stu-id="47fad-207">Create a Kubernetes service with type=[NodePort](https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport).</span></span> <span data-ttu-id="47fad-208">Dadurch wird der Dienst auf jedem Knoten verfügbar gemacht, sodass er von außerhalb des Clusters erreichbar ist.</span><span class="sxs-lookup"><span data-stu-id="47fad-208">This exposes the service on each node so that it can be reached from outside the cluster.</span></span> <span data-ttu-id="47fad-209">Ein Lastenausgleich wird nicht erstellt.</span><span class="sxs-lookup"><span data-stu-id="47fad-209">It does not create a load balancer.</span></span>
5. <span data-ttu-id="47fad-210">Rufen Sie die zugewiesene Portnummer für den Dienst ab.</span><span class="sxs-lookup"><span data-stu-id="47fad-210">Get the assigned port number for the service.</span></span>
6. <span data-ttu-id="47fad-211">Fügen Sie eine Application Gateway-Regel hinzu, die folgende Kriterien erfüllt:</span><span class="sxs-lookup"><span data-stu-id="47fad-211">Add an Application Gateway rule where:</span></span>
    - <span data-ttu-id="47fad-212">Der Back-End-Adresspool enthält die virtuellen Agent-Computer.</span><span class="sxs-lookup"><span data-stu-id="47fad-212">The backend pool contains the agent VMs.</span></span>
    - <span data-ttu-id="47fad-213">Die HTTP-Einstellung gibt die Dienstportnummer an.</span><span class="sxs-lookup"><span data-stu-id="47fad-213">The HTTP setting specifies the service port number.</span></span>
    - <span data-ttu-id="47fad-214">Der Gatewaylistener lauscht an den Ports 80/443.</span><span class="sxs-lookup"><span data-stu-id="47fad-214">The gateway listener listens on ports 80/443</span></span>
    
<span data-ttu-id="47fad-215">Legen Sie die Instanzanzahl mindestens auf „2“ fest, um für hohe Verfügbarkeit zu sorgen.</span><span class="sxs-lookup"><span data-stu-id="47fad-215">Set the instance count to 2 or more for high availability.</span></span>

### <a name="azure-api-management"></a><span data-ttu-id="47fad-216">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="47fad-216">Azure API Management</span></span> 

<span data-ttu-id="47fad-217">So verbinden Sie API Management mit einem Kubernetes-Cluster in Azure:</span><span class="sxs-lookup"><span data-stu-id="47fad-217">To connect API Management to a Kubernetes cluster in Azure:</span></span>

1. <span data-ttu-id="47fad-218">Erstellen Sie im Cluster-VNet ein leeres Subnetz.</span><span class="sxs-lookup"><span data-stu-id="47fad-218">Create an empty subnet in the cluster VNet.</span></span>
2. <span data-ttu-id="47fad-219">Stellen Sie in diesem Subnetz API Management bereit.</span><span class="sxs-lookup"><span data-stu-id="47fad-219">Deploy API Management to that subnet.</span></span>
3. <span data-ttu-id="47fad-220">Erstellen Sie einen Kubernetes-Dienst vom Typ „LoadBalancer“.</span><span class="sxs-lookup"><span data-stu-id="47fad-220">Create a Kubernetes service of type LoadBalancer.</span></span> <span data-ttu-id="47fad-221">Verwenden Sie die [Anmerkung für einen internen Lastenausgleich](https://kubernetes.io/docs/concepts/services-networking/service/#internal-load-balancer), um anstelle des standardmäßigen Lastenausgleichs mit Internetzugriff einen internen Lastenausgleich zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="47fad-221">Use the [internal load balancer](https://kubernetes.io/docs/concepts/services-networking/service/#internal-load-balancer) annotation to create an internal load balancer, instead of an Internet-facing load balancer, which is the default.</span></span>
4. <span data-ttu-id="47fad-222">Ermitteln Sie mithilfe von kubectl oder der Azure-Befehlszeilenschnittstelle die private IP-Adresse des internen Lastenausgleichs.</span><span class="sxs-lookup"><span data-stu-id="47fad-222">Find the private IP of the internal load balancer, using kubectl or the Azure CLI.</span></span>
5. <span data-ttu-id="47fad-223">Erstellen Sie mithilfe von API Management eine API für die Weiterleitung an die private IP-Adresse des Lastenausgleichs.</span><span class="sxs-lookup"><span data-stu-id="47fad-223">Use API Management to create an API that directs to the private IP address of the load balancer.</span></span>

<span data-ttu-id="47fad-224">Kombinieren Sie API Management ggf. mit einem Reverseproxy (Nginx, HAProxy oder Azure Application Gateway).</span><span class="sxs-lookup"><span data-stu-id="47fad-224">Consider combining API Management with a reverse proxy, whether Nginx, HAProxy, or Azure Application Gateway.</span></span> <span data-ttu-id="47fad-225">Informationen zur Verwendung von API Management mit Application Gateway finden Sie unter [Integrieren von API Management in ein internes VNET mit Application Gateway](/azure/api-management/api-management-howto-integrate-internal-vnet-appgateway).</span><span class="sxs-lookup"><span data-stu-id="47fad-225">For information about using API Management with Application Gateway, see [Integrate API Management in an internal VNET with Application Gateway](/azure/api-management/api-management-howto-integrate-internal-vnet-appgateway).</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="47fad-226">Protokollierung und Überwachung</span><span class="sxs-lookup"><span data-stu-id="47fad-226">Logging and monitoring</span></span>](./logging-monitoring.md)
