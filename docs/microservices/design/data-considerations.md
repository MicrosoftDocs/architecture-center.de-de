---
title: Überlegungen zu Daten für Microservices
description: Überlegungen zu Daten für Microservices.
author: MikeWasson
ms.date: 02/25/2019
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: microservices
ms.openlocfilehash: dd620cdcb6cb3a06d4fae4fb34eeb086ec17b4c5
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/20/2019
ms.locfileid: "58241521"
---
# <a name="data-considerations-for-microservices"></a><span data-ttu-id="3c4a0-103">Überlegungen zu Daten für Microservices</span><span class="sxs-lookup"><span data-stu-id="3c4a0-103">Data considerations for microservices</span></span>

<span data-ttu-id="3c4a0-104">Dieser Artikel enthält Überlegungen zur Verwaltung von Daten in einer Microservices-Architektur.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-104">This article describes considerations for managing data in a microservices architecture.</span></span> <span data-ttu-id="3c4a0-105">Da jeder Microservice seine eigenen Daten verwaltet, sind Datenintegrität und -konsistenz von entscheidender Bedeutung.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-105">Because every microservice manages its own data, data integrity and data consistency are critical challenges.</span></span>

<span data-ttu-id="3c4a0-106">Die Verwaltung der jeweils eigenen Daten ist ein Grundprinzip von Microservices.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-106">A basic principle of microservices is that each service manages its own data.</span></span> <span data-ttu-id="3c4a0-107">Zwei Dienste sollten sich nicht den gleichen Datenspeicher teilen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-107">Two services should not share a data store.</span></span> <span data-ttu-id="3c4a0-108">Stattdessen ist jeder Dienst für seinen eigenen privaten Datenspeicher zuständig, und andere Dienste können nicht direkt auf diesen Datenspeicher zugreifen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-108">Instead, each service is responsible for its own private data store, which other services cannot access directly.</span></span>

<span data-ttu-id="3c4a0-109">Mit dieser Regel wird eine unbeabsichtigte Kopplung von Diensten vermieden, die entstehen kann, wenn Dienste die gleichen zugrunde liegenden Datenschemas nutzen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-109">The reason for this rule is to avoid unintentional coupling between services, which can result if services share the same underlying data schemas.</span></span> <span data-ttu-id="3c4a0-110">Eine Änderung des Datenschemas muss für jeden Dienst koordiniert werden, der auf der betroffenen Datenbank basiert.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-110">If there is a change to the data schema, the change must be coordinated across every service that relies on that database.</span></span> <span data-ttu-id="3c4a0-111">Die Isolierung des Datenspeichers der einzelnen Dienste ermöglicht eine Eingrenzung des Änderungsumfangs, und die Agilität vollständig unabhängiger Bereitstellungen bleibt erhalten.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-111">By isolating each service's data store, we can limit the scope of change, and preserve the agility of truly independent deployments.</span></span> <span data-ttu-id="3c4a0-112">Darüber hinaus kann jeder Microservice über eigene Datenmodelle, Abfragen oder Lese-/Schreibmuster verfügen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-112">Another reason is that each microservice may have its own data models, queries, or read/write patterns.</span></span> <span data-ttu-id="3c4a0-113">Bei Verwendung eines gemeinsamen Datenspeichers können die einzelnen Teams den Datenspeicher nicht mehr uneingeschränkt für ihren jeweiligen Dienst optimieren.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-113">Using a shared data store limits each team's ability to optimize data storage for their particular service.</span></span>

![Diagramm eines falschen Ansatzes für CQRS](../../guide/architecture-styles/images/cqrs-microservices-wrong.png)

<span data-ttu-id="3c4a0-115">Dieses Konzept führt ganz natürlich zu [Polyglot Persistence](https://martinfowler.com/bliki/PolyglotPersistence.html) (also zur Verwendung mehrerer Datenspeichertechnologien in einer einzelnen Anwendung).</span><span class="sxs-lookup"><span data-stu-id="3c4a0-115">This approach naturally leads to [polyglot persistence](https://martinfowler.com/bliki/PolyglotPersistence.html) &mdash; the use of multiple data storage technologies within a single application.</span></span> <span data-ttu-id="3c4a0-116">Ein Dienst benötigt möglicherweise die Schema-on-Read-Funktionen einer Dokumentdatenbank.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-116">One service might require the schema-on-read capabilities of a document database.</span></span> <span data-ttu-id="3c4a0-117">Ein anderer benötigt unter Umständen die referenzielle Integrität eines Managementsystems für relationale Datenbanken (Relational Database Management System, RDBMS).</span><span class="sxs-lookup"><span data-stu-id="3c4a0-117">Another might need the referential integrity provided by an RDBMS.</span></span> <span data-ttu-id="3c4a0-118">Jedes Team kann seinen Dienst optimal konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-118">Each team is free to make the best choice for their service.</span></span> <span data-ttu-id="3c4a0-119">Weitere Informationen zum allgemeinen Polyglot Persistence-Prinzip finden Sie unter [Verwenden des besten Datenspeichers für den Auftrag](../../guide/design-principles/use-the-best-data-store.md).</span><span class="sxs-lookup"><span data-stu-id="3c4a0-119">For more about the general principle of polyglot persistence, see [Use the best data store for the job](../../guide/design-principles/use-the-best-data-store.md).</span></span>

> [!NOTE]
> <span data-ttu-id="3c4a0-120">Dienste können ohne Weiteres den gleichen physischen Datenbankserver verwenden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-120">It's fine for services to share the same physical database server.</span></span> <span data-ttu-id="3c4a0-121">Problematisch wird es, wenn Dienste das gleiche Schema verwenden oder Lese-/Schreibvorgänge für die gleiche Gruppe von Datenbanktabellen ausführen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-121">The problem occurs when services share the same schema, or read and write to the same set of database tables.</span></span>

## <a name="challenges"></a><span data-ttu-id="3c4a0-122">Herausforderungen</span><span class="sxs-lookup"><span data-stu-id="3c4a0-122">Challenges</span></span>

<span data-ttu-id="3c4a0-123">Dieses Konzept der verteilten Datenverwaltung ist mit gewissen Herausforderungen verbunden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-123">Some challenges arise from this distributed approach to managing data.</span></span> <span data-ttu-id="3c4a0-124">Da wäre zum einen eine mögliche Redundanz in den Datenspeichern, die dazu führt, dass die gleichen Datenelemente an mehreren Orten vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-124">First, there may be redundancy across the data stores, with the same item of data appearing in multiple places.</span></span> <span data-ttu-id="3c4a0-125">So kann es beispielsweise vorkommen, dass Daten als Teil einer Transaktion und anschließend anderswo zur Analyse, Berichterstellung oder Archivierung gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-125">For example, data might be stored as part of a transaction, then stored elsewhere for analytics, reporting, or archiving.</span></span> <span data-ttu-id="3c4a0-126">Duplizierte oder partitionierte Daten können zu Problemen mit der Integrität und Konsistenz der Daten führen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-126">Duplicated or partitioned data can lead to issues of data integrity and consistency.</span></span> <span data-ttu-id="3c4a0-127">Wenn sich Datenbeziehungen über mehrere Dienste erstrecken, lassen sich die Beziehungen nicht mithilfe herkömmlicher Datenverwaltungstechniken erzwingen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-127">When data relationships span multiple services, you can't use traditional data management techniques to enforce the relationships.</span></span>

<span data-ttu-id="3c4a0-128">Herkömmliche Datenmodelle basieren auf der Regel „eine einzelne Information an einem einzelnen Ort“.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-128">Traditional data modeling uses the rule of "one fact in one place."</span></span> <span data-ttu-id="3c4a0-129">Jede Entität kommt im Schema genau einmal vor.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-129">Every entity appears exactly once in the schema.</span></span> <span data-ttu-id="3c4a0-130">Andere Entitäten können zwar Verweise auf die Entität enthalten, sie darf jedoch nicht dupliziert werden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-130">Other entities may hold references to it but not duplicate it.</span></span> <span data-ttu-id="3c4a0-131">Das herkömmliche Konzept hat natürlich den Vorteil, dass Aktualisierungen an einem einzelnen Ort durchgeführt und somit Probleme mit der Datenkonsistenz vermieden werden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-131">The obvious advantage to the traditional approach is that updates are made in a single place, which avoids problems with data consistency.</span></span> <span data-ttu-id="3c4a0-132">In einer Microservices-Architektur müssen Sie sich Gedanken zur dienstübergreifenden Verteilung von Aktualisierungen machen und sich überlegen, wie Sie letztlich für Konsistenz sorgen können, wenn sich Daten an mehreren Orten ohne starke Konsistenz befinden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-132">In a microservices architecture, you have to consider how updates are propagated across services, and how to manage eventual consistency when data appears in multiple places without strong consistency.</span></span>

## <a name="approaches-to-managing-data"></a><span data-ttu-id="3c4a0-133">Datenverwaltungskonzepte</span><span class="sxs-lookup"><span data-stu-id="3c4a0-133">Approaches to managing data</span></span>

<span data-ttu-id="3c4a0-134">In Ermangelung eines Allzweckkonzepts finden Sie im Anschluss einige allgemeine Richtlinien für die Datenverwaltung in einer Microservices-Architektur.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-134">There is no single approach that's correct in all cases, but here are some general guidelines for managing data in a microservices architecture.</span></span>

- <span data-ttu-id="3c4a0-135">Implementieren Sie die letztliche Konsistenz, wo immer möglich.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-135">Embrace eventual consistency where possible.</span></span> <span data-ttu-id="3c4a0-136">Überlegen Sie sich, wo Sie im System starke Konsistenz oder ACID-Transaktionen benötigen und wo die letztliche Konsistenz ausreicht.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-136">Understand the places in the system where you need strong consistency or ACID transactions, and the places where eventual consistency is acceptable.</span></span>

- <span data-ttu-id="3c4a0-137">Wenn Sie starke Konsistenz gewährleisten müssen, kann ein einzelner Dienst als gültige Quelle für eine bestimmte Entität fungieren, die über eine API verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-137">When you need strong consistency guarantees, one service may represent the source of truth for a given entity, which is exposed through an API.</span></span> <span data-ttu-id="3c4a0-138">Andere Dienste können über ihre eigene Kopie der Daten oder über eine Teilmenge der Daten verfügen, die zwar letztlich mit den Masterdaten konsistent ist, aber nicht als gültige Quelle betrachtet wird.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-138">Other services might hold their own copy of the data, or a subset of the data, that is eventually consistent with the master data but not considered the source of truth.</span></span> <span data-ttu-id="3c4a0-139">Stellen Sie sich zum Beispiel ein E-Commerce-System mit einem Kundenbestelldienst und einem Empfehlungsdienst vor.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-139">For example, imagine an e-commerce system with a customer order service and a recommendation service.</span></span> <span data-ttu-id="3c4a0-140">Der Empfehlungsdienst lauscht zwar unter Umständen auf Ereignisse aus dem Bestelldienst, sollte ein Kunde jedoch eine Rückerstattung beantragen, ist es der Bestelldienst (und nicht der Empfehlungsdienst), der über den vollständigen Transaktionsverlauf verfügt.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-140">The recommendation service might listen to events from the order service, but if a customer requests a refund, it is the order service, not the recommendation service, that has the complete transaction history.</span></span>

- <span data-ttu-id="3c4a0-141">Verwenden Sie für Transaktionen Muster wie [Scheduler-Agent-Supervisor](../../patterns/scheduler-agent-supervisor.md) und [Kompensierende Transaktion](../../patterns/compensating-transaction.md), um Daten über mehrere Dienste hinweg konsistent zu halten.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-141">For transactions, use patterns such as [Scheduler Agent Supervisor](../../patterns/scheduler-agent-supervisor.md) and [Compensating Transaction](../../patterns/compensating-transaction.md) to keep data consistent across several services.</span></span>  <span data-ttu-id="3c4a0-142">Gegebenenfalls muss zur Erfassung des Zustands einer Arbeitseinheit, die mehrere Dienste umfasst, ein zusätzliches Datenelement gespeichert werden, um Teilfehler zwischen mehreren Diensten zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-142">You may need to store an additional piece of data that captures the state of a unit of work that spans multiple services, to avoid partial failure among multiple services.</span></span> <span data-ttu-id="3c4a0-143">Speichern Sie hierzu beispielsweise ein Arbeitselement während der Ausführung einer mehrstufigen Transaktion in einer permanenten Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-143">For example, keep a work item on a durable queue while a multi-step transaction is in progress.</span></span>

- <span data-ttu-id="3c4a0-144">Speichern Sie nur die Daten, die ein Dienst benötigt.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-144">Store only the data that a service needs.</span></span> <span data-ttu-id="3c4a0-145">Ein Dienst benötigt möglicherweise nur einen Teil der Informationen zu einer Domänenentität.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-145">A service might only need a subset of information about a domain entity.</span></span> <span data-ttu-id="3c4a0-146">Im Rahmen des Versandkontexts müssen wir beispielsweise wissen, welcher Kunde zu einer bestimmten Lieferung gehört.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-146">For example, in the Shipping bounded context, we need to know which customer is associated to a particular delivery.</span></span> <span data-ttu-id="3c4a0-147">Die Rechnungsadresse des Kunden wird in diesem Kontext allerdings nicht benötigt und stattdessen im Rahmen des Kontokontexts verwaltet.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-147">But we don't need the customer's billing address &mdash; that's managed by the Accounts bounded context.</span></span> <span data-ttu-id="3c4a0-148">Hier kann es hilfreich sein, sich Gedanken zur Domäne zu machen und einen DDD-Ansatz zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-148">Thinking carefully about the domain, and using a DDD approach, can help here.</span></span>

- <span data-ttu-id="3c4a0-149">Überlegen Sie, ob Ihre Dienste kohärent und lose gekoppelt sind.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-149">Consider whether your services are coherent and loosely coupled.</span></span> <span data-ttu-id="3c4a0-150">Wenn zwei Dienste kontinuierlich Informationen austauschen, führt dies zu einer intensiven API-Kommunikation. In diesem Fall empfiehlt es sich unter Umständen, die Dienstgrenzen neu zu definieren, indem Sie zwei Dienste zusammenführen oder ihre Funktionen umgestalten.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-150">If two services are continually exchanging information with each other, resulting in chatty APIs, you may need to redraw your service boundaries, by merging two services or refactoring their functionality.</span></span>

- <span data-ttu-id="3c4a0-151">Verwenden Sie einen [ereignisgesteuerten Architekturstil](../../guide/architecture-styles/event-driven.md).</span><span class="sxs-lookup"><span data-stu-id="3c4a0-151">Use an [event driven architecture style](../../guide/architecture-styles/event-driven.md).</span></span> <span data-ttu-id="3c4a0-152">Bei diesem Architekturstil veröffentlicht ein Dienst ein Ereignis, wenn Änderungen an seinen öffentlichen Modellen oder Entitäten vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-152">In this architecture style, a service publishes an event when there are changes to its public models or entities.</span></span> <span data-ttu-id="3c4a0-153">Diese Ereignisse können von Diensten abonniert werden, für die sie interessant sind.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-153">Interested services can subscribe to these events.</span></span> <span data-ttu-id="3c4a0-154">So kann beispielsweise ein anderer Dienst auf der Grundlage der Ereignisse eine materialisierte Sicht der Daten erstellen, die besser für Abfragen geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-154">For example, another service could use the events to construct a materialized view of the data that is more suitable for querying.</span></span>

- <span data-ttu-id="3c4a0-155">Ein Dienst, der Ereignisse besitzt, sollte ein Schema veröffentlichen, das die Automatisierung der Serialisierung und Deserialisierung der Ereignisse ermöglicht, um eine enge Kopplung zwischen Herausgebern und Abonnenten zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-155">A service that owns events should publish a schema that can be used to automate serializing and deserializing the events, to avoid tight coupling between publishers and subscribers.</span></span> <span data-ttu-id="3c4a0-156">Erwägen Sie die Verwendung eines JSON-Schemas oder eines Frameworks wie [Microsoft Bond](https://github.com/Microsoft/bond), Protobuf oder Avro.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-156">Consider JSON schema or a framework like [Microsoft Bond](https://github.com/Microsoft/bond), Protobuf, or Avro.</span></span>

- <span data-ttu-id="3c4a0-157">Da sich Ereignisse bei intensiver Nutzung als Engpass für das System erweisen können, empfiehlt es sich ggf., die Gesamtlast mittels Aggregation oder Batchverarbeitung zu verringern.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-157">At high scale, events can become a bottleneck on the system, so consider using aggregation or batching to reduce the total load.</span></span>

## <a name="example-choosing-data-stores-for-the-drone-delivery-application"></a><span data-ttu-id="3c4a0-158">Beispiel: Auswählen von Datenspeichern für die Drohnenlieferungsanwendung</span><span class="sxs-lookup"><span data-stu-id="3c4a0-158">Example: Choosing data stores for the Drone Delivery application</span></span>

<span data-ttu-id="3c4a0-159">In den vorherigen Artikeln dieser Reihe wird ein Drohnenlieferdienst als Beispiel herangezogen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-159">The previous articles in this series discuss a drone delivery service as a running example.</span></span> <span data-ttu-id="3c4a0-160">Weitere Informationen zum Szenario sowie die entsprechende Referenzimplementierung finden Sie [hier](./index.md).</span><span class="sxs-lookup"><span data-stu-id="3c4a0-160">You can read more about the scenario and the corresponding reference implementation [here](./index.md).</span></span>

<span data-ttu-id="3c4a0-161">Diese Anwendung definiert mehrere Microservices für die Planung von Lieferungen per Drohne.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-161">To recap, this application defines several microservices for scheduling deliveries by drone.</span></span> <span data-ttu-id="3c4a0-162">Wenn ein Benutzer einen Termin für eine neue Lieferung festlegt, enthält die Clientanforderung sowohl Informationen zur Lieferung (etwa den Abhol- und den Zielort) als auch Informationen zum Paket (etwa Größe und Gewicht).</span><span class="sxs-lookup"><span data-stu-id="3c4a0-162">When a user schedules a new delivery, the client request includes information about the delivery, such as pickup and dropoff locations, and about the package, such as size and weight.</span></span> <span data-ttu-id="3c4a0-163">Diese Informationen definieren eine Arbeitseinheit.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-163">This information defines a unit of work.</span></span>

<span data-ttu-id="3c4a0-164">Für die verschiedenen Back-End-Dienste sind unterschiedliche Teilinformationen aus der Anforderung interessant, und sie verfügen über unterschiedliche Lese- und Schreibprofile.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-164">The various backend services care about different portions of the information in the request, and also have different read and write profiles.</span></span>

![Diagramm zu Datenüberlegungen](../images/data-considerations.png)

### <a name="delivery-service"></a><span data-ttu-id="3c4a0-166">Dienst „Delivery“ (Lieferung)</span><span class="sxs-lookup"><span data-stu-id="3c4a0-166">Delivery service</span></span>

<span data-ttu-id="3c4a0-167">Der Dienst „Delivery“ speichert Informationen zu jeder Lieferung, die derzeit geplant ist oder durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-167">The Delivery service stores information about every delivery that is currently scheduled or in progress.</span></span> <span data-ttu-id="3c4a0-168">Er lauscht auf Ereignisse von den Drohnen und verfolgt den Status aktiver Lieferungen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-168">It listens for events from the drones, and tracks the status of deliveries that are in progress.</span></span> <span data-ttu-id="3c4a0-169">Darüber hinaus sendet er Domänenereignisse mit Lieferstatusupdates.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-169">It also sends domain events with delivery status updates.</span></span>

<span data-ttu-id="3c4a0-170">Es ist davon auszugehen, dass Benutzer mehrmals den Status einer Lieferung prüfen, während sie auf ihr Paket warten.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-170">It's expected that users will frequently check the status of a delivery while they are waiting for their package.</span></span> <span data-ttu-id="3c4a0-171">Der Dienst „Delivery“ benötigt daher einen Datenspeicher, bei dem Durchsatz (Lesen und Schreiben) einen höheren Stellenwert hat als langfristige Speicherung.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-171">Therefore, the Delivery service requires a data store that emphasizes throughput (read and write) over long-term storage.</span></span> <span data-ttu-id="3c4a0-172">Darüber hinaus führt der Dienst „Delivery“ keine komplexen Abfragen oder Analysen durch, sondern ruft einfach nur den aktuellen Status für eine bestimmte Lieferung ab.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-172">Also, the Delivery service does not perform any complex queries or analysis, it simply fetches the latest status for a given delivery.</span></span> <span data-ttu-id="3c4a0-173">Das Team für den Dienst „Delivery“ entscheidet sich aufgrund der hohen Leistung bei Lese- und Schreibvorgängen für Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-173">The Delivery service team chose Azure Redis Cache for its high read-write performance.</span></span> <span data-ttu-id="3c4a0-174">Die in Redis gespeicherten Informationen sind relativ kurzlebig.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-174">The information stored in Redis is relatively short-lived.</span></span> <span data-ttu-id="3c4a0-175">Nach Abschluss der Lieferung wird der Dienst „Delivery History“ (Lieferverlauf) zum System of Record.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-175">Once a delivery is complete, the Delivery History service is the system of record.</span></span>

### <a name="delivery-history-service"></a><span data-ttu-id="3c4a0-176">Dienst „Delivery History“</span><span class="sxs-lookup"><span data-stu-id="3c4a0-176">Delivery History service</span></span>

<span data-ttu-id="3c4a0-177">Der Dienst „Delivery History“ lauscht auf Lieferstatusereignisse des Diensts „Delivery“.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-177">The Delivery History service listens for delivery status events from the Delivery service.</span></span> <span data-ttu-id="3c4a0-178">Diese Daten werden langfristig speichert.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-178">It stores this data in long-term storage.</span></span> <span data-ttu-id="3c4a0-179">Für diese Verlaufsdaten sind zwei Anwendungsfälle mit jeweils unterschiedlichen Datenspeicheranforderungen denkbar.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-179">There are two different use-cases for this historical data, which have different data storage requirements.</span></span>

<span data-ttu-id="3c4a0-180">Im ersten Szenario sollen die Daten für die Datenanalyse aggregiert werden, um geschäftliche Abläufe zu optimieren oder die Servicequalität zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-180">The first scenario is aggregating the data for the purpose of data analytics, in order to optimize the business or improve the quality of the service.</span></span> <span data-ttu-id="3c4a0-181">Beachten Sie, dass die eigentliche Datenanalyse nicht vom Dienst „Delivery History“ durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-181">Note that the Delivery History service doesn't perform the actual analysis of the data.</span></span> <span data-ttu-id="3c4a0-182">Dieser ist nur für die Erfassung und Speicherung der Daten zuständig.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-182">It's only responsible for the ingestion and storage.</span></span> <span data-ttu-id="3c4a0-183">In diesem Szenario muss der Speicher für die Analyse eines umfangreichen Datensatzes optimiert sein und ein Schema-on-Read-Konzept verwenden, um verschiedene Datenquellen verarbeiten zu können.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-183">For this scenario, the storage must be optimized for data analysis over a large set of data, using a schema-on-read approach to accommodate a variety of data sources.</span></span> <span data-ttu-id="3c4a0-184">[Azure Data Lake Store](/azure/data-lake-store/) ist eine gute Wahl für dieses Szenario.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-184">[Azure Data Lake Store](/azure/data-lake-store/) is a good fit for this scenario.</span></span> <span data-ttu-id="3c4a0-185">Bei Data Lake Store handelt es sich um ein mit HDFS (Hadoop Distributed File System) kompatibles, leistungsoptimiertes Apache Hadoop-Dateisystem für Szenarien mit anspruchsvollen Datenanalysen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-185">Data Lake Store is an Apache Hadoop file system compatible with Hadoop Distributed File System (HDFS), and is tuned for performance for data analytics scenarios.</span></span>

<span data-ttu-id="3c4a0-186">Im anderen Szenario soll Benutzern die Möglichkeit gegeben werden, den Verlauf einer Lieferung nach Abschluss der Lieferung nachzuvollziehen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-186">The other scenario is enabling users to look up the history of a delivery after the delivery is completed.</span></span> <span data-ttu-id="3c4a0-187">Für dieses Szenario ist Azure Data Lake nicht speziell optimiert.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-187">Azure Data Lake is not particularly optimized for this scenario.</span></span> <span data-ttu-id="3c4a0-188">Zur Erzielung einer optimalen Leistung empfiehlt Microsoft, Zeitreihendaten in Data Lake in nach Datum partitionierten Ordnern zu speichern.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-188">For optimal performance, Microsoft recommends storing time-series data in Data Lake in folders partitioned by date.</span></span> <span data-ttu-id="3c4a0-189">(Siehe [Optimieren der Leistung von Azure Data Lake Store](/azure/data-lake-store/data-lake-store-performance-tuning-guidance).)</span><span class="sxs-lookup"><span data-stu-id="3c4a0-189">(See [Tuning Azure Data Lake Store for performance](/azure/data-lake-store/data-lake-store-performance-tuning-guidance)).</span></span> <span data-ttu-id="3c4a0-190">Für die ID-basierte Suche nach einzelnen Datensätzen ist diese Struktur jedoch nicht optimal.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-190">However, that structure is not optimal for looking up individual records by ID.</span></span> <span data-ttu-id="3c4a0-191">Sollte Ihnen der Zeitstempel nicht bekannt sein, muss bei einer ID-basierten Suche die gesamte Sammlung durchsucht werden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-191">Unless you also know the timestamp, a lookup by ID requires scanning the entire collection.</span></span> <span data-ttu-id="3c4a0-192">Aus diesem Grund speichert der Dienst „Delivery History“ auch einen Teil der Verlaufsdaten in Cosmos DB, um eine schnellere Recherche zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-192">Therefore, the Delivery History service also stores a subset of the historical data in Cosmos DB for quicker lookup.</span></span> <span data-ttu-id="3c4a0-193">Die Datensätze müssen nicht unbegrenzt lange in Cosmos DB gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-193">The records don't need to stay in Cosmos DB indefinitely.</span></span> <span data-ttu-id="3c4a0-194">Ältere Lieferungen können archiviert werden – beispielsweise nach einem Monat.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-194">Older deliveries can be archived &mdash; say, after a month.</span></span> <span data-ttu-id="3c4a0-195">Hierzu kann gelegentlich ein Batchvorgang ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-195">This could be done by running an occasional batch process.</span></span>

### <a name="package-service"></a><span data-ttu-id="3c4a0-196">Dienst „Package“ (Paket)</span><span class="sxs-lookup"><span data-stu-id="3c4a0-196">Package service</span></span>

<span data-ttu-id="3c4a0-197">Der Dienst „Package“ speichert Informationen zu allen Paketen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-197">The Package service stores information about all of the packages.</span></span> <span data-ttu-id="3c4a0-198">Für Pakete gelten folgende Speicheranforderungen:</span><span class="sxs-lookup"><span data-stu-id="3c4a0-198">The storage requirements for the Package are:</span></span>

- <span data-ttu-id="3c4a0-199">Langfristige Speicherung</span><span class="sxs-lookup"><span data-stu-id="3c4a0-199">Long-term storage.</span></span>
- <span data-ttu-id="3c4a0-200">Hoher Schreibdurchsatz zur Bewältigung einer hohen Anzahl von Paketen</span><span class="sxs-lookup"><span data-stu-id="3c4a0-200">Able to handle a high volume of packages, requiring high write throughput.</span></span>
- <span data-ttu-id="3c4a0-201">Unterstützung einfacher Abfragen mit Paket-ID.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-201">Support simple queries by package ID.</span></span> <span data-ttu-id="3c4a0-202">Keine komplexen Joins oder Anforderungen für die referenzielle Integrität.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-202">No complex joins or requirements for referential integrity.</span></span>

<span data-ttu-id="3c4a0-203">Da es sich bei den Paketdaten nicht um relationale Daten handelt, eignet sich eine objektorientierte Dokumentdatenbank, und Cosmos DB kann mithilfe von Shard-Sammlungen einen sehr hohen Durchsatz erreichen.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-203">Because the package data is not relational, a document oriented database is appropriate, and Cosmos DB can achieve very high throughput by using sharded collections.</span></span> <span data-ttu-id="3c4a0-204">Das für den Dienst „Package“ zuständige Team ist mit dem MEAN-Stack (MongoDB, Express.js, AngularJS und Node.js) vertraut und wählt daher die [MongoDB-API](/azure/cosmos-db/mongodb-introduction) für Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-204">The team that works on the Package service is familiar with the MEAN stack (MongoDB, Express.js, AngularJS, and Node.js), so they select the [MongoDB API](/azure/cosmos-db/mongodb-introduction) for Cosmos DB.</span></span> <span data-ttu-id="3c4a0-205">Dadurch kann das Team auf die bereits gesammelten Erfahrungen mit MongoDB zurückgreifen und gleichzeitig von Cosmos DB (einem verwalteten Azure-Dienst) profitieren.</span><span class="sxs-lookup"><span data-stu-id="3c4a0-205">That lets them leverage their existing experience with MongoDB, while getting the benefits of Cosmos DB, which is a managed Azure service.</span></span>
