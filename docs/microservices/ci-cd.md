---
title: CD/CI für Microservices
description: Continuous Integration und Continuous Delivery für Microservices.
author: MikeWasson
ms.date: 03/27/2019
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: microservices
ms.openlocfilehash: c52ff3d0a330f564e5f7e9b0b07f0ba84c328c8b
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/17/2019
ms.locfileid: "59639783"
---
# <a name="cicd-for-microservices-architectures"></a><span data-ttu-id="68981-103">CI/CD für Microservicearchitekturen</span><span class="sxs-lookup"><span data-stu-id="68981-103">CI/CD for microservices architectures</span></span>

<span data-ttu-id="68981-104">Einer der wichtigsten Vorteile von Microservicearchitekturen sind kürzere Versionszyklen.</span><span class="sxs-lookup"><span data-stu-id="68981-104">Faster release cycles are one of the major advantages of microservices architectures.</span></span> <span data-ttu-id="68981-105">Die Agilität, die von Microservices erwartet wird, lässt sich aber nur mit einem zuverlässigen CI/CD-Prozess erreichen.</span><span class="sxs-lookup"><span data-stu-id="68981-105">But without a good CI/CD process, you won't achieve the agility that microservices promise.</span></span> <span data-ttu-id="68981-106">In diesem Artikel werden die Herausforderungen und einige Lösungsansätze für das Problem beschrieben.</span><span class="sxs-lookup"><span data-stu-id="68981-106">This article describes the challenges and recommends some approaches to the problem.</span></span>

## <a name="what-is-cicd"></a><span data-ttu-id="68981-107">Was ist CI/CD?</span><span class="sxs-lookup"><span data-stu-id="68981-107">What is CI/CD?</span></span>

<span data-ttu-id="68981-108">CI/CD umfasst eigentlich mehrere verwandte Prozesse: Continuous Integration, Continuous Delivery und Continuous Deployment.</span><span class="sxs-lookup"><span data-stu-id="68981-108">When we talk about CI/CD, we're really talking about several related processes: Continuous integration, continuous delivery, and continuous deployment.</span></span>

- <span data-ttu-id="68981-109">**Continuous Integration**.</span><span class="sxs-lookup"><span data-stu-id="68981-109">**Continuous integration**.</span></span> <span data-ttu-id="68981-110">Codeänderungen werden häufig in den Hauptbranch zusammengeführt.</span><span class="sxs-lookup"><span data-stu-id="68981-110">Code changes are frequently merged into the main branch.</span></span> <span data-ttu-id="68981-111">Mithilfe von automatisierten Build- und Testprozessen wird sichergestellt, dass der Code im Hauptbranch immer Produktionsqualität aufweist.</span><span class="sxs-lookup"><span data-stu-id="68981-111">Automated build and test processes ensure that code in the main branch is always production-quality.</span></span>

- <span data-ttu-id="68981-112">**Continuous Delivery**.</span><span class="sxs-lookup"><span data-stu-id="68981-112">**Continuous delivery**.</span></span> <span data-ttu-id="68981-113">Alle Codeänderungen, die den CI-Prozess durchlaufen, werden automatisch in einer produktionsähnlichen Umgebung veröffentlicht.</span><span class="sxs-lookup"><span data-stu-id="68981-113">Any code changes that pass the CI process are automatically published to a production-like environment.</span></span> <span data-ttu-id="68981-114">Für die Bereitstellung in der aktiven Produktionsumgebung ist unter Umständen eine manuelle Freigabe erforderlich, ansonsten ist der Prozess jedoch automatisiert.</span><span class="sxs-lookup"><span data-stu-id="68981-114">Deployment into the live production environment may require manual approval, but is otherwise automated.</span></span> <span data-ttu-id="68981-115">Dadurch soll erreicht werden, dass Ihr Code stets für die Bereitstellung in der Produktionsumgebung *bereit* ist.</span><span class="sxs-lookup"><span data-stu-id="68981-115">The goal is that your code should always be *ready* to deploy into production.</span></span>

- <span data-ttu-id="68981-116">**Continuous Deployment**</span><span class="sxs-lookup"><span data-stu-id="68981-116">**Continuous deployment**.</span></span> <span data-ttu-id="68981-117">Codeänderungen, die die zwei vorhergehenden Schritte durchlaufen haben, werden automatisch *in der Produktionsumgebung* bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="68981-117">Code changes that pass the previous two steps are automatically deployed *into production*.</span></span>

<span data-ttu-id="68981-118">Hier sind einige Ziele eines stabilen CI/CD-Prozesses für eine Microservicearchitektur aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="68981-118">Here are some goals of a robust CI/CD process for a microservices architecture:</span></span>

- <span data-ttu-id="68981-119">Jedes Team kann die eigenen Dienste unabhängig erstellen und bereitstellen, ohne dass andere Teams hierdurch beeinträchtigt oder gestört werden.</span><span class="sxs-lookup"><span data-stu-id="68981-119">Each team can build and deploy the services that it owns independently, without affecting or disrupting other teams.</span></span>

- <span data-ttu-id="68981-120">Bevor eine neue Version eines Diensts für die Produktion bereitgestellt wird, wird sie zunächst zur Überprüfung in Umgebungen für die Entwicklung, Tests und Qualitätssicherung bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="68981-120">Before a new version of a service is deployed to production, it gets deployed to dev/test/QA environments for validation.</span></span> <span data-ttu-id="68981-121">Jede Phase verfügt über so genannte „Quality Gates“.</span><span class="sxs-lookup"><span data-stu-id="68981-121">Quality gates are enforced at each stage.</span></span>

- <span data-ttu-id="68981-122">Eine neue Version eines Diensts kann parallel zur vorherigen Version bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="68981-122">A new version of a service can be deployed side by side with the previous version.</span></span>

- <span data-ttu-id="68981-123">Es sind ausreichende Richtlinien für die Zugriffssteuerung vorhanden.</span><span class="sxs-lookup"><span data-stu-id="68981-123">Sufficient access control policies are in place.</span></span>

- <span data-ttu-id="68981-124">Bei Workloads in Containern können Sie den Containerimages vertrauen, die für die Produktion bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="68981-124">For containerized workloads, you can trust the container images that are deployed to production.</span></span>

## <a name="why-a-robust-cicd-pipeline-matters"></a><span data-ttu-id="68981-125">Wichtigkeit einer robusten CI/CD-Pipeline</span><span class="sxs-lookup"><span data-stu-id="68981-125">Why a robust CI/CD pipeline matters</span></span>

<span data-ttu-id="68981-126">In einer herkömmlichen monolithischen Anwendung gibt es eine einzelne Buildpipeline, die die ausführbare Datei der Anwendung ausgibt.</span><span class="sxs-lookup"><span data-stu-id="68981-126">In a traditional monolithic application, there is a single build pipeline whose output is the application executable.</span></span> <span data-ttu-id="68981-127">Sämtliche Entwicklungsarbeiten werden dieser Pipeline zugeführt.</span><span class="sxs-lookup"><span data-stu-id="68981-127">All development work feeds into this pipeline.</span></span> <span data-ttu-id="68981-128">Bei einem Fehler mit hoher Priorität muss eine Korrektur integriert, getestet und veröffentlicht werden, was die Veröffentlichung neuer Features verzögern kann.</span><span class="sxs-lookup"><span data-stu-id="68981-128">If a high-priority bug is found, a fix must be integrated, tested, and published, which can delay the release of new features.</span></span> <span data-ttu-id="68981-129">Diese Probleme lassen sich durch eine sorgfältige Modulgestaltung sowie durch die Verwendung von Featurebranches behandeln, die die Auswirkungen von Codeänderungen minimieren.</span><span class="sxs-lookup"><span data-stu-id="68981-129">You can mitigate these problems by having well-factored modules and using feature branches to minimize the impact of code changes.</span></span> <span data-ttu-id="68981-130">Mit zunehmender Komplexität und wachsendem Funktionsumfang einer monolithischen Anwendung nimmt jedoch häufig auch die Fehleranfälligkeit des Releaseprozesses zu.</span><span class="sxs-lookup"><span data-stu-id="68981-130">But as the application grows more complex, and more features are added, the release process for a monolith tends to become more brittle and likely to break.</span></span>

<span data-ttu-id="68981-131">Die Microservices-Philosophie sieht kein langwieriges Releaseverfahren vor, in das sich die einzelnen Teams einreihen müssen.</span><span class="sxs-lookup"><span data-stu-id="68981-131">Following the microservices philosophy, there should never be a long release train where every team has to get in line.</span></span> <span data-ttu-id="68981-132">Das Team, das den Dienst „A“ erstellt, kann jederzeit ein Update veröffentlichen und muss nicht warten, bis Änderungen für den Dienst „B“ zusammengeführt, getestet und bereitgestellt wurden.</span><span class="sxs-lookup"><span data-stu-id="68981-132">The team that builds service "A" can release an update at any time, without waiting for changes in service "B" to be merged, tested, and deployed.</span></span>

![Diagramm einer monolithischen CI/CD-Anwendung](./images/cicd-monolith.png)

<span data-ttu-id="68981-134">Um eine hohe Releasegeschwindigkeit zu erreichen, muss Ihre Releasepipeline automatisiert und sehr zuverlässig sein, um Risiken zu minimieren.</span><span class="sxs-lookup"><span data-stu-id="68981-134">To achieve a high release velocity, your release pipeline must be automated and highly reliable, to minimize risk.</span></span> <span data-ttu-id="68981-135">Bei täglich oder mehrmals täglich durchgeführten Veröffentlichungen in der Produktionsumgebung darf es nur ganz selten zu Regressionen oder Dienstausfällen kommen.</span><span class="sxs-lookup"><span data-stu-id="68981-135">If you release to production daily or multiple times a day, regressions or service disruptions must be very rare.</span></span> <span data-ttu-id="68981-136">Sollte doch einmal ein fehlerhaftes Update bereitgestellt werden, müssen Sie schnell und zuverlässig einen Rollback oder Rollforward auf eine frühere Dienstversion ausführen können.</span><span class="sxs-lookup"><span data-stu-id="68981-136">At the same time, if a bad update does get deployed, you must have a reliable way to quickly roll back or roll forward to a previous version of a service.</span></span>

## <a name="challenges"></a><span data-ttu-id="68981-137">Herausforderungen</span><span class="sxs-lookup"><span data-stu-id="68981-137">Challenges</span></span>

- <span data-ttu-id="68981-138">**Zahlreiche kompakte und unabhängige Codebasen:**</span><span class="sxs-lookup"><span data-stu-id="68981-138">**Many small independent code bases**.</span></span> <span data-ttu-id="68981-139">Jedes Team ist für die Erstellung seines eigenen Diensts verantwortlich und verfügt über eine eigene Buildpipeline.</span><span class="sxs-lookup"><span data-stu-id="68981-139">Each team is responsible for building its own service, with its own build pipeline.</span></span> <span data-ttu-id="68981-140">In einigen Organisationen verwenden die Teams unter Umständen separate Coderepositorys.</span><span class="sxs-lookup"><span data-stu-id="68981-140">In some organizations, teams may use separate code repositories.</span></span> <span data-ttu-id="68981-141">Getrennte Repositorys können dazu führen, dass das Know-how für die Erstellung des Systems auf mehrere Teams verteilt ist und niemand in der Organisation weiß, wie die gesamte Anwendung bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="68981-141">Separate repositories can lead to a situation where the knowledge of how to build the system is spread across teams, and nobody in the organization knows how to deploy the entire application.</span></span> <span data-ttu-id="68981-142">Was passiert beispielsweise in einem Notfallwiederherstellungsszenario, wenn Sie schnell eine Bereitstellung in einem neuen Cluster durchführen müssen?</span><span class="sxs-lookup"><span data-stu-id="68981-142">For example, what happens in a disaster recovery scenario, if you need to quickly deploy to a new cluster?</span></span>

    <span data-ttu-id="68981-143">**Lösung**: Verwenden Sie für Build und Bereitstellung von Diensten eine einheitliche und automatisierte Pipeline, so dass dieses Wissen nicht in den einzelnen Teams „verborgen“ ist.</span><span class="sxs-lookup"><span data-stu-id="68981-143">**Mitigation**: Have a unified and automated pipeline to build and deploy services, so that this knowledge is not "hidden" within each team.</span></span>

- <span data-ttu-id="68981-144">**Mehrere Sprachen und Frameworks:**</span><span class="sxs-lookup"><span data-stu-id="68981-144">**Multiple languages and frameworks**.</span></span> <span data-ttu-id="68981-145">Wenn jedes Team seinen eigenen Technologie-Mix verwendet, kann es schwierig sein, einen einzelnen Buildprozess zu erstellen, der für die gesamte Organisation geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="68981-145">With each team using its own mix of technologies, it can be difficult to create a single build process that works across the organization.</span></span> <span data-ttu-id="68981-146">Der Buildprozess muss so flexibel sein, dass jedes Team ihn für die gewählte Sprache oder das gewählte Framework anpassen kann.</span><span class="sxs-lookup"><span data-stu-id="68981-146">The build process must be flexible enough that every team can adapt it for their choice of language or framework.</span></span>

    <span data-ttu-id="68981-147">**Lösung**: Kapseln Sie den Buildprozess für jeden Dienst in einem Container.</span><span class="sxs-lookup"><span data-stu-id="68981-147">**Mitigation**: Containerize the build process for each service.</span></span> <span data-ttu-id="68981-148">Auf diese Weise muss das Buildsystem nur dazu fähig sein, die Container auszuführen.</span><span class="sxs-lookup"><span data-stu-id="68981-148">That way, the build system just needs to be able to run the containers.</span></span>

- <span data-ttu-id="68981-149">**Integration und Auslastungstests:**</span><span class="sxs-lookup"><span data-stu-id="68981-149">**Integration and load testing**.</span></span> <span data-ttu-id="68981-150">Wenn Teams Updates nach ihrem eigenen Zeitplan veröffentlichen, kann die Entwicklung zuverlässiger End-to-End-Tests zur Herausforderung werden – insbesondere, wenn Dienste von anderen Diensten abhängen.</span><span class="sxs-lookup"><span data-stu-id="68981-150">With teams releasing updates at their own pace, it can be challenging to design robust end-to-end testing, especially when services have dependencies on other services.</span></span> <span data-ttu-id="68981-151">Darüber hinaus kann der Betrieb eines vollwertigen Produktionsclusters teuer sein, weshalb es unwahrscheinlich ist, dass jedes Team allein zu Testzwecken einen eigenen vollwertigen Cluster auf Produktionsniveau betreibt.</span><span class="sxs-lookup"><span data-stu-id="68981-151">Moreover, running a full production cluster can be expensive, so it's unlikely that every team will run its own full cluster at production scales, just for testing.</span></span>

- <span data-ttu-id="68981-152">**Releaseverwaltung:**</span><span class="sxs-lookup"><span data-stu-id="68981-152">**Release management**.</span></span> <span data-ttu-id="68981-153">Jedes Team sollte in der Lage sein, ein Update in der Produktionsumgebung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="68981-153">Every team should be able to deploy an update to production.</span></span> <span data-ttu-id="68981-154">Das bedeutet nicht, dass jedes einzelne Teammitglied über entsprechende Berechtigungen verfügt.</span><span class="sxs-lookup"><span data-stu-id="68981-154">That doesn't mean that every team member has permissions to do so.</span></span> <span data-ttu-id="68981-155">Durch eine zentrale Release-Manager-Rolle werden Bereitstellungen jedoch unter Umständen ausgebremst.</span><span class="sxs-lookup"><span data-stu-id="68981-155">But having a centralized Release Manager role can reduce the velocity of deployments.</span></span>

    <span data-ttu-id="68981-156">**Lösung**: Je zuverlässiger und stärker automatisiert Ihr CI/CD-Prozess ist, desto weniger Bedarf besteht für eine zentrale Instanz.</span><span class="sxs-lookup"><span data-stu-id="68981-156">**Mitigation**: The more that your CI/CD process is automated and reliable, the less there should be a need for a central authority.</span></span> <span data-ttu-id="68981-157">Für die Veröffentlichung wichtiger Featureupdates und kleinerer Fehlerbehebung können jeweils unterschiedliche Richtlinien gelten.</span><span class="sxs-lookup"><span data-stu-id="68981-157">That said, you might have different policies for releasing major feature updates versus minor bug fixes.</span></span> <span data-ttu-id="68981-158">Dezentralisierung bedeutet keinen Verzicht auf Governance.</span><span class="sxs-lookup"><span data-stu-id="68981-158">Being decentralized doesn't mean zero governance.</span></span>

- <span data-ttu-id="68981-159">**Dienstupdates:**</span><span class="sxs-lookup"><span data-stu-id="68981-159">**Service updates**.</span></span> <span data-ttu-id="68981-160">Wenn Sie einen Dienst auf eine neue Version aktualisieren, dürfen dadurch keine anderen Dienste beeinträchtigt werden, die von diesem Dienst abhängen.</span><span class="sxs-lookup"><span data-stu-id="68981-160">When you update a service to a new version, it shouldn't break other services that depend on it.</span></span>

    <span data-ttu-id="68981-161">**Lösung**: Verwenden Sie für geringfügige Änderungen Bereitstellungstechniken wie Blaugrün- oder Canary-Releases.</span><span class="sxs-lookup"><span data-stu-id="68981-161">**Mitigation**: Use deployment techniques such as blue-green or canary release for non-breaking changes.</span></span> <span data-ttu-id="68981-162">Stellen Sie für Breaking Changes an APIs die neue Version parallel zur vorherigen Version bereit.</span><span class="sxs-lookup"><span data-stu-id="68981-162">For breaking API changes, deploy the new version side by side with the previous version.</span></span> <span data-ttu-id="68981-163">Auf diese Weise können Dienste, die die vorherige API nutzen, aktualisiert und für die neue API getestet werden.</span><span class="sxs-lookup"><span data-stu-id="68981-163">That way, services that consume the previous API can be updated and tested for the new API.</span></span> <span data-ttu-id="68981-164">Mehr dazu finden Sie unten unter [Aktualisieren von Diensten](#updating-services).</span><span class="sxs-lookup"><span data-stu-id="68981-164">See [Updating services](#updating-services), below.</span></span>

## <a name="monorepo-vs-multi-repo"></a><span data-ttu-id="68981-165">Monorepo im Vergleich mit mehreren Repositorys</span><span class="sxs-lookup"><span data-stu-id="68981-165">Monorepo vs multi-repo</span></span>

<span data-ttu-id="68981-166">Vor dem Erstellen eines CI/CD-Workflows müssen Sie sich darüber im Klaren sein, wie die Codebasis strukturiert sein und verwaltet werden soll.</span><span class="sxs-lookup"><span data-stu-id="68981-166">Before creating a CI/CD workflow, you must know how the code base will be structured and managed.</span></span>

- <span data-ttu-id="68981-167">Arbeiten die Teams in separaten Repositorys oder in einem „Monorepo“ (einzelnen Repository)?</span><span class="sxs-lookup"><span data-stu-id="68981-167">Do teams work in separate repositories or in a monorepo (single repository)?</span></span>
- <span data-ttu-id="68981-168">Wie sieht Ihre Strategie für das „Branchen“ aus?</span><span class="sxs-lookup"><span data-stu-id="68981-168">What is your branching strategy?</span></span>
- <span data-ttu-id="68981-169">Wer kann Code per Pushvorgang in die Produktion übertragen?</span><span class="sxs-lookup"><span data-stu-id="68981-169">Who can push code to production?</span></span> <span data-ttu-id="68981-170">Ist eine Release Manager-Rolle vorhanden?</span><span class="sxs-lookup"><span data-stu-id="68981-170">Is there a release manager role?</span></span>

<span data-ttu-id="68981-171">Die Beliebtheit des Monorepo-Ansatzes ist gestiegen, aber beide Ansätze haben sowohl Vor- als auch Nachteile.</span><span class="sxs-lookup"><span data-stu-id="68981-171">The monorepo approach has been gaining favor but there are advantages and disadvantages to both.</span></span>

| &nbsp; | <span data-ttu-id="68981-172">Monorepo</span><span class="sxs-lookup"><span data-stu-id="68981-172">Monorepo</span></span> | <span data-ttu-id="68981-173">Mehrere Repositorys</span><span class="sxs-lookup"><span data-stu-id="68981-173">Multiple repos</span></span> |
|--------|----------|----------------|
| <span data-ttu-id="68981-174">**Vorteile**</span><span class="sxs-lookup"><span data-stu-id="68981-174">**Advantages**</span></span> | <span data-ttu-id="68981-175">Codefreigabe</span><span class="sxs-lookup"><span data-stu-id="68981-175">Code sharing</span></span><br/><span data-ttu-id="68981-176">Einfacheres Standardisieren von Code und Tools</span><span class="sxs-lookup"><span data-stu-id="68981-176">Easier to standardize code and tooling</span></span><br/><span data-ttu-id="68981-177">Einfacheres Umgestalten von Code</span><span class="sxs-lookup"><span data-stu-id="68981-177">Easier to refactor code</span></span><br/><span data-ttu-id="68981-178">Auffindbarkeit: Zentrale Codeansicht</span><span class="sxs-lookup"><span data-stu-id="68981-178">Discoverability - single view of the code</span></span><br/> | <span data-ttu-id="68981-179">Eindeutige Eigentümerschaft pro Team</span><span class="sxs-lookup"><span data-stu-id="68981-179">Clear ownership per team</span></span><br/><span data-ttu-id="68981-180">Potenziell weniger Zusammenführungskonflikte</span><span class="sxs-lookup"><span data-stu-id="68981-180">Potentially fewer merge conflicts</span></span><br/><span data-ttu-id="68981-181">Unterstützung bei der Durchsetzung der Entkopplung von Microservices</span><span class="sxs-lookup"><span data-stu-id="68981-181">Helps to enforce decoupling of microservices</span></span> |
| <span data-ttu-id="68981-182">**Herausforderungen**</span><span class="sxs-lookup"><span data-stu-id="68981-182">**Challenges**</span></span> | <span data-ttu-id="68981-183">Änderungen an freigegebenem Code können sich auf mehrere Microservices auswirken</span><span class="sxs-lookup"><span data-stu-id="68981-183">Changes to shared code can affect multiple microservices</span></span><br/><span data-ttu-id="68981-184">Höheres Potenzial für Zusammenführungskonflikte</span><span class="sxs-lookup"><span data-stu-id="68981-184">Greater potential for merge conflicts</span></span><br/><span data-ttu-id="68981-185">Tools müssen auf große Codebasis skaliert werden</span><span class="sxs-lookup"><span data-stu-id="68981-185">Tooling must scale to a large code base</span></span><br/><span data-ttu-id="68981-186">Zugriffssteuerung</span><span class="sxs-lookup"><span data-stu-id="68981-186">Access control</span></span><br/><span data-ttu-id="68981-187">Komplexerer Bereitstellungsprozess</span><span class="sxs-lookup"><span data-stu-id="68981-187">More complex deployment process</span></span> | <span data-ttu-id="68981-188">Schwierigere Codefreigabe</span><span class="sxs-lookup"><span data-stu-id="68981-188">Harder to share code</span></span><br/><span data-ttu-id="68981-189">Schwierigeres Durchsetzen von Codierungsstandards</span><span class="sxs-lookup"><span data-stu-id="68981-189">Harder to enforce coding standards</span></span><br/><span data-ttu-id="68981-190">Verwaltung von Abhängigkeiten</span><span class="sxs-lookup"><span data-stu-id="68981-190">Dependency management</span></span><br/><span data-ttu-id="68981-191">Diffuse Codebasis, schlechte Auffindbarkeit</span><span class="sxs-lookup"><span data-stu-id="68981-191">Diffuse code base, poor discoverability</span></span><br/><span data-ttu-id="68981-192">Mangel an freigegebener Infrastruktur</span><span class="sxs-lookup"><span data-stu-id="68981-192">Lack of shared infrastructure</span></span>

## <a name="updating-services"></a><span data-ttu-id="68981-193">Aktualisieren von Diensten</span><span class="sxs-lookup"><span data-stu-id="68981-193">Updating services</span></span>

<span data-ttu-id="68981-194">Für die Aktualisierung eines Diensts, der sich bereits in Produktion befindet, gibt es verschiedene Strategien.</span><span class="sxs-lookup"><span data-stu-id="68981-194">There are various strategies for updating a service that's already in production.</span></span> <span data-ttu-id="68981-195">Hier werden drei gängige Optionen erläutert: paralleles Update, Blaugrün-Bereitstellung und Canary-Release.</span><span class="sxs-lookup"><span data-stu-id="68981-195">Here we discuss three common options: Rolling update, blue-green deployment, and canary release.</span></span>

### <a name="rolling-updates"></a><span data-ttu-id="68981-196">Parallele Updates</span><span class="sxs-lookup"><span data-stu-id="68981-196">Rolling updates</span></span>

<span data-ttu-id="68981-197">Bei einem parallelen Update stellen Sie neue Instanzen eines Diensts bereit, und diese neuen Instanzen nehmen sofort Anforderungen entgegen.</span><span class="sxs-lookup"><span data-stu-id="68981-197">In a rolling update, you deploy new instances of a service, and the new instances start receiving requests right away.</span></span> <span data-ttu-id="68981-198">Wenn die neuen Instanzen online geschaltet werden, werden die vorherigen Instanzen entfernt.</span><span class="sxs-lookup"><span data-stu-id="68981-198">As the new instances come up, the previous instances are removed.</span></span>

<span data-ttu-id="68981-199">**Beispiel:**</span><span class="sxs-lookup"><span data-stu-id="68981-199">**Example.**</span></span> <span data-ttu-id="68981-200">In Kubernetes stellen parallele Updates das Standardverhalten dar, wenn Sie die Pod-Spezifikation für eine Bereitstellung aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="68981-200">In Kubernetes, rolling updates are the default behavior when you update the pod spec for a Deployment.</span></span> <span data-ttu-id="68981-201">Der Bereitstellungscontroller erstellt eine neue Replikatgruppe (ReplicaSet) für die aktualisierten Pods.</span><span class="sxs-lookup"><span data-stu-id="68981-201">The Deployment controller creates a new ReplicaSet for the updated pods.</span></span> <span data-ttu-id="68981-202">Anschließend wird die neue Replikatgruppe zentral hoch- und die alte Gruppe zentral herunterskaliert, sodass die gewünschte Replikatanzahl erhalten bleibt.</span><span class="sxs-lookup"><span data-stu-id="68981-202">Then it scales up the new ReplicaSet while scaling down the old one, to maintain the desired replica count.</span></span> <span data-ttu-id="68981-203">Alte Pods werden erst gelöscht, wenn die neuen Pods bereit sind.</span><span class="sxs-lookup"><span data-stu-id="68981-203">It doesn't delete old pods until the new ones are ready.</span></span> <span data-ttu-id="68981-204">Kubernetes protokolliert den Verlauf des Updates, damit Sie bei Bedarf ein Rollback für das Update ausführen können.</span><span class="sxs-lookup"><span data-stu-id="68981-204">Kubernetes keeps a history of the update, so you can roll back an update if needed.</span></span>

<span data-ttu-id="68981-205">Eine der Herausforderungen bei parallelen Updates besteht darin, dass während der Aktualisierung eine Mischung aus alten und neuen Versionen ausgeführt wird und Datenverkehr empfängt.</span><span class="sxs-lookup"><span data-stu-id="68981-205">One challenge of rolling updates is that during the update process, a mix of old and new versions are running and receiving traffic.</span></span> <span data-ttu-id="68981-206">Während dieser Zeit können Anforderungen jeweils an eine der beiden Versionen weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="68981-206">During this period, any request could get routed to either of the two versions.</span></span>

<span data-ttu-id="68981-207">Für Breaking Changes an APIs ist es eine bewährte Methode, beide Versionen parallel zu unterstützen, bis alle Clients der Vorversion aktualisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="68981-207">For breaking API changes, a good practice is to support both versions side by side, until all clients of the previous version are updated.</span></span> <span data-ttu-id="68981-208">Mehr dazu finden Sie unter [API-Versionsverwaltung](./design/api-design.md#api-versioning).</span><span class="sxs-lookup"><span data-stu-id="68981-208">See [API versioning](./design/api-design.md#api-versioning).</span></span>

### <a name="blue-green-deployment"></a><span data-ttu-id="68981-209">Blaugrün-Bereitstellung</span><span class="sxs-lookup"><span data-stu-id="68981-209">Blue-green deployment</span></span>

<span data-ttu-id="68981-210">Bei einer Blaugrün-Bereitstellung stellen Sie die neue Version zusammen mit der vorherigen Version bereit.</span><span class="sxs-lookup"><span data-stu-id="68981-210">In a blue-green deployment, you deploy the new version alongside the previous version.</span></span> <span data-ttu-id="68981-211">Nach der Überprüfung der neuen Version leiten Sie sämtlichen Datenverkehr von der vorherigen Version zur neuen Version um.</span><span class="sxs-lookup"><span data-stu-id="68981-211">After you validate the new version, you switch all traffic at once from the previous version to the new version.</span></span> <span data-ttu-id="68981-212">Anschließend überwachen Sie die Anwendung auf mögliche Probleme.</span><span class="sxs-lookup"><span data-stu-id="68981-212">After the switch, you monitor the application for any problems.</span></span> <span data-ttu-id="68981-213">Im Problemfall können Sie zur alten Version zurückkehren.</span><span class="sxs-lookup"><span data-stu-id="68981-213">If something goes wrong, you can swap back to the old version.</span></span> <span data-ttu-id="68981-214">Liegen keine Probleme, können Sie die alte Version löschen.</span><span class="sxs-lookup"><span data-stu-id="68981-214">Assuming there are no problems, you can delete the old version.</span></span>

<span data-ttu-id="68981-215">Bei einer eher traditionellen monolithischen oder n-schichtigen Anwendung war eine Blaugrün-Bereitstellung in der Regel mit der Bereitstellung zweier identischer Umgebungen verbunden.</span><span class="sxs-lookup"><span data-stu-id="68981-215">With a more traditional monolithic or N-tier application, blue-green deployment generally meant provisioning two identical environments.</span></span> <span data-ttu-id="68981-216">Dabei musste die neue Version in einer Stagingumgebung bereitgestellt und der Clientdatenverkehr anschließend an die Stagingumgebung umgeleitet werden (beispielsweise durch Austauschen der VIP-Adressen).</span><span class="sxs-lookup"><span data-stu-id="68981-216">You would deploy the new version to a staging environment, then redirect client traffic to the staging environment &mdash; for example, by swapping VIP addresses.</span></span> <span data-ttu-id="68981-217">In einer Microservicearchtektur erfolgen Updates in der Microserviceschicht, also stellen Sie normalerweise das Update in der gleichen Umgebung bereit und verwenden einen Mechanismus für die Diensterkennung für den Umstieg.</span><span class="sxs-lookup"><span data-stu-id="68981-217">In a microservices architecture, updates happen at the microservice level, so you would typically deploy the update into the same environment and use a service discovery mechanism to swap.</span></span>

<span data-ttu-id="68981-218">**Beispiel**.</span><span class="sxs-lookup"><span data-stu-id="68981-218">**Example**.</span></span> <span data-ttu-id="68981-219">In Kubernetes müssen Sie für eine Blaugrün-Bereitstellung keinen separaten Cluster bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="68981-219">In Kubernetes, you don't need to provision a separate cluster to do blue-green deployments.</span></span> <span data-ttu-id="68981-220">Stattdessen können Sie Selektoren nutzen.</span><span class="sxs-lookup"><span data-stu-id="68981-220">Instead, you can take advantage of selectors.</span></span> <span data-ttu-id="68981-221">Erstellen Sie eine neue Bereitstellungsressource mit einer neuen Pod-Spezifikation und einem anderen Satz von Bezeichnungen.</span><span class="sxs-lookup"><span data-stu-id="68981-221">Create a new Deployment resource with a new pod spec and a different set of labels.</span></span> <span data-ttu-id="68981-222">Erstellen Sie diese Bereitstellung, ohne die vorherige Bereitstellung zu löschen oder den Dienst zu ändern, der darauf verweist.</span><span class="sxs-lookup"><span data-stu-id="68981-222">Create this deployment, without deleting the previous deployment or modifying the service that points to it.</span></span> <span data-ttu-id="68981-223">Wenn die neuen Pods aktiv sind, können Sie den Selektor des Diensts auf die neue Bereitstellung aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="68981-223">Once the new pods are running, you can update the service's selector to match the new deployment.</span></span>

<span data-ttu-id="68981-224">Ein Nachteil von Blaugrün-Bereitstellungen ist, dass während der Aktualisierung doppelt so viele Pods für den Dienst (aktuelle und neue Version) aktiv sind.</span><span class="sxs-lookup"><span data-stu-id="68981-224">One drawback of blue-green deployment is that during the update, you are running twice as many pods for the service (current and next).</span></span> <span data-ttu-id="68981-225">Wenn die Pods einen hohen Bedarf an CPU- oder Arbeitsspeicherressourcen haben, müssen Sie den Cluster zur Bewältigung des Ressourcenbedarfs möglicherweise vorübergehend horizontal hochskalieren.</span><span class="sxs-lookup"><span data-stu-id="68981-225">If the pods require a lot of CPU or memory resources, you may need to scale out the cluster temporarily to handle the resource consumption.</span></span>

### <a name="canary-release"></a><span data-ttu-id="68981-226">Canary-Release</span><span class="sxs-lookup"><span data-stu-id="68981-226">Canary release</span></span>

<span data-ttu-id="68981-227">Bei einem Canary-Release führen Sie eine aktualisierte Version für eine geringe Anzahl von Clients ein.</span><span class="sxs-lookup"><span data-stu-id="68981-227">In a canary release, you roll out an updated version to a small number of clients.</span></span> <span data-ttu-id="68981-228">Anschließend überwachen Sie das Verhalten des neuen Diensts, bevor Sie ihn für alle Clients einführen.</span><span class="sxs-lookup"><span data-stu-id="68981-228">Then you monitor the behavior of the new service before rolling it out to all clients.</span></span> <span data-ttu-id="68981-229">Dies ermöglicht eine langsame, kontrollierte Einführung, die Beobachtung echter Daten und die Erkennung von Problemen, bevor alle Kunden betroffen sind.</span><span class="sxs-lookup"><span data-stu-id="68981-229">This lets you do a slow rollout in a controlled fashion, observe real data, and spot problems before all customers are affected.</span></span>

<span data-ttu-id="68981-230">Die Verwaltung eines Canary-Release ist im Vergleich zu einer Blaugrün-Bereitstellung oder einem parallelen Update komplexer, da Anforderungen dynamisch an verschiedene Versionen des Diensts weitergeleitet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="68981-230">A canary release is more complex to manage than either blue-green or rolling update, because you must dynamically route requests to different versions of the service.</span></span>

<span data-ttu-id="68981-231">**Beispiel**.</span><span class="sxs-lookup"><span data-stu-id="68981-231">**Example**.</span></span> <span data-ttu-id="68981-232">In Kubernetes können Sie einen Dienst so konfigurieren, dass er sich über zwei Replikatgruppen (einen für jede Version) erstreckt, und die Replikatanzahl manuell anpassen.</span><span class="sxs-lookup"><span data-stu-id="68981-232">In Kubernetes, you can configure a Service to span two replica sets (one for each version) and adjust the replica counts manually.</span></span> <span data-ttu-id="68981-233">Aufgrund des von Kubernetes verwendeten Lastenausgleichs zwischen Pods ist dieser Ansatz jedoch nicht sehr präzise.</span><span class="sxs-lookup"><span data-stu-id="68981-233">However, this approach is rather coarse-grained, because of the way Kubernetes load balances across pods.</span></span> <span data-ttu-id="68981-234">Ein Beispiel: Wenn Sie insgesamt über 10 Replikate verfügen, können Sie Datenverkehr nur in Zehn-Prozent-Schritten verlagern.</span><span class="sxs-lookup"><span data-stu-id="68981-234">For example, if you have a total of 10 replicas, you can only shift traffic in 10% increments.</span></span> <span data-ttu-id="68981-235">Bei Verwendung eines Dienstnetzes können Sie mithilfe der entsprechenden Routingregeln eine komplexere Canary-Release-Strategie implementieren.</span><span class="sxs-lookup"><span data-stu-id="68981-235">If you are using a service mesh, you can use the service mesh routing rules to implement a more sophisticated canary release strategy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="68981-236">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="68981-236">Next steps</span></span>

<span data-ttu-id="68981-237">Erlernen spezifischer CI/CD-Praktiken für Microservices, die in Kubernetes ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="68981-237">Learn specific CI/CD practices for microservices running on Kubernetes.</span></span>

- [<span data-ttu-id="68981-238">CI/CD für Microservices in Kubernetes</span><span class="sxs-lookup"><span data-stu-id="68981-238">CI/CD for microservices on Kubernetes</span></span>](./ci-cd-kubernetes.md)