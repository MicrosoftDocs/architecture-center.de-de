---
title: Entwurf mit Blick auf Selbstreparatur
titleSuffix: Azure Application Architecture Guide
description: Resiliente Anwendungen können nach einem Ausfall ohne manuellen Eingriff wiederhergestellt werden.
author: MikeWasson
ms.date: 08/30/2018
ms.custom: seojan19
ms.openlocfilehash: a7aaf50b4cb1d844637c89da8e977b694481f18d
ms.sourcegitcommit: 1f4cdb08fe73b1956e164ad692f792f9f635b409
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2019
ms.locfileid: "54113515"
---
# <a name="design-for-self-healing"></a><span data-ttu-id="52684-103">Entwurf mit Blick auf Selbstreparatur</span><span class="sxs-lookup"><span data-stu-id="52684-103">Design for self healing</span></span>

## <a name="design-your-application-to-be-self-healing-when-failures-occur"></a><span data-ttu-id="52684-104">Entwerfen Sie Ihre Anwendung so, dass sie bei Ausfällen eine Selbstreparatur durchführt.</span><span class="sxs-lookup"><span data-stu-id="52684-104">Design your application to be self healing when failures occur</span></span>

<span data-ttu-id="52684-105">In einem verteilten System kann es zu Ausfällen kommen.</span><span class="sxs-lookup"><span data-stu-id="52684-105">In a distributed system, failures happen.</span></span> <span data-ttu-id="52684-106">Hardware kann ausfallen.</span><span class="sxs-lookup"><span data-stu-id="52684-106">Hardware can fail.</span></span> <span data-ttu-id="52684-107">Im Netzwerk können vorübergehende Fehler auftreten.</span><span class="sxs-lookup"><span data-stu-id="52684-107">The network can have transient failures.</span></span> <span data-ttu-id="52684-108">In seltenen Fällen kann ein gesamter Dienst oder eine Region ausfallen, aber auch hierfür muss ein Plan vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="52684-108">Rarely, an entire service or region may experience a disruption, but even those must be planned for.</span></span>

<span data-ttu-id="52684-109">Entwerfen Sie deshalb Ihre Anwendung so, dass sie bei Ausfällen eine Selbstreparatur durchführt.</span><span class="sxs-lookup"><span data-stu-id="52684-109">Therefore, design an application to be self healing when failures occur.</span></span> <span data-ttu-id="52684-110">Dies erfordert einen dreifachen Ansatz:</span><span class="sxs-lookup"><span data-stu-id="52684-110">This requires a three-pronged approach:</span></span>

- <span data-ttu-id="52684-111">Erkennen von Ausfällen.</span><span class="sxs-lookup"><span data-stu-id="52684-111">Detect failures.</span></span>
- <span data-ttu-id="52684-112">Ordnungsgemäßes Reagieren auf Ausfälle.</span><span class="sxs-lookup"><span data-stu-id="52684-112">Respond to failures gracefully.</span></span>
- <span data-ttu-id="52684-113">Protokollieren und Überwachen von Ausfällen, um Einblick in die Abläufe zu gewinnen.</span><span class="sxs-lookup"><span data-stu-id="52684-113">Log and monitor failures, to give operational insight.</span></span>

<span data-ttu-id="52684-114">Ihre Reaktion auf einen bestimmten Typ von Ausfällen kann von den Anforderungen an die Verfügbarkeit der Anwendung abhängen.</span><span class="sxs-lookup"><span data-stu-id="52684-114">How you respond to a particular type of failure may depend on your application's availability requirements.</span></span> <span data-ttu-id="52684-115">Wenn z.B. eine hohe Verfügbarkeit erforderlich ist, kann während eines regionalen Ausfalls ein automatisches Failover zu einer sekundären Region erfolgen.</span><span class="sxs-lookup"><span data-stu-id="52684-115">For example, if you require very high availability, you might automatically fail over to a secondary region during a regional outage.</span></span> <span data-ttu-id="52684-116">Allerdings entstehen dadurch höhere Kosten als für die Bereitstellung in einer einzelnen Region.</span><span class="sxs-lookup"><span data-stu-id="52684-116">However, that will incur a higher cost than a single-region deployment.</span></span>

<span data-ttu-id="52684-117">Berücksichtigen Sie zudem nicht nur umfangreiche Ereignisse, z.B. regionale Ausfälle, die in der Regel selten auftreten.</span><span class="sxs-lookup"><span data-stu-id="52684-117">Also, don't just consider big events like regional outages, which are generally rare.</span></span> <span data-ttu-id="52684-118">Sie sollten sich mindestens in gleichem Ausmaß mit der Behandlung lokaler, kurzfristiger Ausfälle, z.B. dem Ausfall von Netzwerk- oder Datenbankverbindungen, befassen.</span><span class="sxs-lookup"><span data-stu-id="52684-118">You should focus as much, if not more, on handling local, short-lived failures, such as network connectivity failures or failed database connections.</span></span>

## <a name="recommendations"></a><span data-ttu-id="52684-119">Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="52684-119">Recommendations</span></span>

<span data-ttu-id="52684-120">**Wiederholen Sie fehlgeschlagene Vorgänge**.</span><span class="sxs-lookup"><span data-stu-id="52684-120">**Retry failed operations**.</span></span> <span data-ttu-id="52684-121">Vorübergehende Fehler können durch eine kurze Trennung der Netzwerkverbindung, einen Verlust der Verbindung mit der Datenbank oder eine Zeitüberschreitung bei zu hoher Auslastung eines Diensts verursacht werden.</span><span class="sxs-lookup"><span data-stu-id="52684-121">Transient failures may occur due to momentary loss of network connectivity, a dropped database connection, or a timeout when a service is busy.</span></span> <span data-ttu-id="52684-122">Integrieren Sie zur Behandlung vorübergehender Fehler Wiederholungslogik in die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="52684-122">Build retry logic into your application to handle transient failures.</span></span> <span data-ttu-id="52684-123">Für viele Azure-Dienste werden automatische Wiederholungen durch das Client-SDK implementiert.</span><span class="sxs-lookup"><span data-stu-id="52684-123">For many Azure services, the client SDK implements automatic retries.</span></span> <span data-ttu-id="52684-124">Weitere Informationen finden Sie unter [Behandeln vorübergehender Fehler][transient-fault-handling] und unter [Wiederholungsmuster][retry].</span><span class="sxs-lookup"><span data-stu-id="52684-124">For more information, see [Transient fault handling][transient-fault-handling] and the [Retry pattern][retry].</span></span>

<span data-ttu-id="52684-125">**Schützen Sie ausgefallene Remotedienste (Trennschalter)**.</span><span class="sxs-lookup"><span data-stu-id="52684-125">**Protect failing remote services (Circuit Breaker)**.</span></span> <span data-ttu-id="52684-126">Es empfiehlt sich, nach einem vorübergehenden Fehler den Vorgang zu wiederholen. Wenn jedoch der Fehler weiterhin auftritt, treffen möglicherweise zu viele Aufrufe auf den ausgefallenen Dienst.</span><span class="sxs-lookup"><span data-stu-id="52684-126">It's good to retry after a transient failure, but if the failure persists, you can end up with too many callers hammering a failing service.</span></span> <span data-ttu-id="52684-127">Dies kann zu kaskadierenden Fehlern führen, wenn sich Anforderungen aufstauen.</span><span class="sxs-lookup"><span data-stu-id="52684-127">This can lead to cascading failures, as requests back up.</span></span> <span data-ttu-id="52684-128">Verwenden Sie das [Trennschalter-Muster][circuit-breaker], um Fail-Fast-fähig zu sein (ohne den Remoteaufruf auszuführen), wenn eine hohe Wahrscheinlichkeit besteht, dass ein Vorgang nicht erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="52684-128">Use the [Circuit Breaker pattern][circuit-breaker] to fail fast (without making the remote call) when an operation is likely to fail.</span></span>

<span data-ttu-id="52684-129">**Isolieren Sie kritische Ressourcen (Bulkhead)**.</span><span class="sxs-lookup"><span data-stu-id="52684-129">**Isolate critical resources (Bulkhead)**.</span></span> <span data-ttu-id="52684-130">Fehler in einem Subsystem können manchmal kaskadiert werden.</span><span class="sxs-lookup"><span data-stu-id="52684-130">Failures in one subsystem can sometimes cascade.</span></span> <span data-ttu-id="52684-131">Dies kann passieren, wenn ein Fehler dazu führt, dass einige Ressourcen, z.B. Threads oder Sockets, nicht rechtzeitig freigegeben werden und die Ressourcen erschöpft sind.</span><span class="sxs-lookup"><span data-stu-id="52684-131">This can happen if a failure causes some resources, such as threads or sockets, not to get freed in a timely manner, leading to resource exhaustion.</span></span> <span data-ttu-id="52684-132">Um dies zu vermeiden, sollten Sie ein System in isolierte Gruppen partitionieren, damit ein Ausfall in einer Partition nicht zum Ausfall des gesamten Systems führt.</span><span class="sxs-lookup"><span data-stu-id="52684-132">To avoid this, partition a system into isolated groups, so that a failure in one partition does not bring down the entire system.</span></span>

<span data-ttu-id="52684-133">**Führen Sie einen Lastenausgleich aus**.</span><span class="sxs-lookup"><span data-stu-id="52684-133">**Perform load leveling**.</span></span> <span data-ttu-id="52684-134">Für Anwendungen kann es zu plötzlichen Datenverkehrsspitzen kommen, die von Diensten auf dem Back-End nicht mehr bewältigt werden können.</span><span class="sxs-lookup"><span data-stu-id="52684-134">Applications may experience sudden spikes in traffic that can overwhelm services on the backend.</span></span> <span data-ttu-id="52684-135">Verwenden Sie zur Vermeidung das [warteschlangenbasierte Lastenausgleichsmuster][load-level], um Arbeitselemente für die asynchrone Ausführung in die Warteschlange einzureihen.</span><span class="sxs-lookup"><span data-stu-id="52684-135">To avoid this, use the [Queue-Based Load Leveling pattern][load-level] to queue work items to run asynchronously.</span></span> <span data-ttu-id="52684-136">Die Warteschlange fungiert als Puffer, um Lastspitzen zu glätten.</span><span class="sxs-lookup"><span data-stu-id="52684-136">The queue acts as a buffer that smooths out peaks in the load.</span></span>

<span data-ttu-id="52684-137">**Führen Sie ein Failover aus**.</span><span class="sxs-lookup"><span data-stu-id="52684-137">**Fail over**.</span></span> <span data-ttu-id="52684-138">Wenn eine Instanz nicht erreicht werden kann, führen Sie ein Failover zu einer anderen Instanz aus.</span><span class="sxs-lookup"><span data-stu-id="52684-138">If an instance can't be reached, fail over to another instance.</span></span> <span data-ttu-id="52684-139">Platzieren Sie für zustandslose Elemente, z.B. einen Webserver, mehrere Instanzen hinter einem Lastenausgleich oder Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="52684-139">For things that are stateless, like a web server, put several instances behind a load balancer or traffic manager.</span></span> <span data-ttu-id="52684-140">Verwenden Sie für Elemente, die Zustände speichern, z.B. eine Datenbank, Replikate und Failover.</span><span class="sxs-lookup"><span data-stu-id="52684-140">For things that store state, like a database, use replicas and fail over.</span></span> <span data-ttu-id="52684-141">Je nach Datenspeicher und der Art seiner Replikation muss in der Anwendung möglicherweise letztliche Konsistenz verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="52684-141">Depending on the data store and how it replicates, this may require the application to deal with eventual consistency.</span></span>

<span data-ttu-id="52684-142">**Gleichen Sie fehlgeschlagene Transaktionen aus**.</span><span class="sxs-lookup"><span data-stu-id="52684-142">**Compensate failed transactions**.</span></span> <span data-ttu-id="52684-143">Vermeiden Sie generell verteilte Transaktionen, da sie die Koordination zwischen Diensten und Ressourcen erfordern.</span><span class="sxs-lookup"><span data-stu-id="52684-143">In general, avoid distributed transactions, as they require coordination across services and resources.</span></span> <span data-ttu-id="52684-144">Stellen Sie stattdessen einen Vorgang aus kleineren einzelnen Transaktionen zusammen.</span><span class="sxs-lookup"><span data-stu-id="52684-144">Instead, compose an operation from smaller individual transactions.</span></span> <span data-ttu-id="52684-145">Wenn der Vorgang während der Ausführung fehlschlägt, machen Sie die bereits abgeschlossenen Schritte mithilfe [ausgleichender Transaktionen][compensating-transactions] rückgängig.</span><span class="sxs-lookup"><span data-stu-id="52684-145">If the operation fails midway through, use [Compensating Transactions][compensating-transactions] to undo any step that already completed.</span></span>

<span data-ttu-id="52684-146">**Verwenden Sie für lang andauernde Transaktionen Prüfpunkte**.</span><span class="sxs-lookup"><span data-stu-id="52684-146">**Checkpoint long-running transactions**.</span></span> <span data-ttu-id="52684-147">Prüfpunkte können Resilienz ermöglichen, wenn ein lang andauernder Vorgang fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="52684-147">Checkpoints can provide resiliency if a long-running operation fails.</span></span> <span data-ttu-id="52684-148">Wenn der Vorgang neu gestartet wird (wenn er z.B. von einer anderen VM ausgewählt wird), kann er ab dem letzten Prüfpunkt fortgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="52684-148">When the operation restarts (for example, it is picked up by another VM), it can be resumed from the last checkpoint.</span></span>

<span data-ttu-id="52684-149">**Stufen Sie Funktionalität korrekt herab**.</span><span class="sxs-lookup"><span data-stu-id="52684-149">**Degrade gracefully**.</span></span> <span data-ttu-id="52684-150">Wenn eine Problemumgehung nicht möglich ist, können Sie manchmal reduzierte Funktionalität bereitstellen, die immer noch hilfreich ist.</span><span class="sxs-lookup"><span data-stu-id="52684-150">Sometimes you can't work around a problem, but you can provide reduced functionality that is still useful.</span></span> <span data-ttu-id="52684-151">Stellen Sie sich eine Anwendung vor, in der ein Katalog mit Büchern angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="52684-151">Consider an application that shows a catalog of books.</span></span> <span data-ttu-id="52684-152">Wenn die Anwendung das Miniaturbild für den Buchdeckel nicht abrufen kann, wird ggf. ein Platzhalterbild angezeigt.</span><span class="sxs-lookup"><span data-stu-id="52684-152">If the application can't retrieve the thumbnail image for the cover, it might show a placeholder image.</span></span> <span data-ttu-id="52684-153">Möglicherweise sind gesamte Subsysteme für die Anwendung nicht kritisch.</span><span class="sxs-lookup"><span data-stu-id="52684-153">Entire subsystems might be noncritical for the application.</span></span> <span data-ttu-id="52684-154">Beispielsweise ist auf einer E-Commerce-Website das Anzeigen von Produktempfehlungen wahrscheinlich weniger kritisch als das Verarbeiten von Bestellungen.</span><span class="sxs-lookup"><span data-stu-id="52684-154">For example, in an e-commerce site, showing product recommendations is probably less critical than processing orders.</span></span>

<span data-ttu-id="52684-155">**Drosseln Sie Clients**.</span><span class="sxs-lookup"><span data-stu-id="52684-155">**Throttle clients**.</span></span> <span data-ttu-id="52684-156">Manchmal erzeugt eine kleine Anzahl von Benutzern eine übermäßige Last, wodurch die Verfügbarkeit der Anwendung für andere Benutzer reduziert wird.</span><span class="sxs-lookup"><span data-stu-id="52684-156">Sometimes a small number of users create excessive load, which can reduce your application's availability for other users.</span></span> <span data-ttu-id="52684-157">Drosseln Sie in einem solchen Fall den Client für einen bestimmten Zeitraum.</span><span class="sxs-lookup"><span data-stu-id="52684-157">In this situation, throttle the client for a certain period of time.</span></span> <span data-ttu-id="52684-158">Weitere Informationen finden Sie unter [Drosselungsmuster][throttle].</span><span class="sxs-lookup"><span data-stu-id="52684-158">See the [Throttling pattern][throttle].</span></span>

<span data-ttu-id="52684-159">**Blockieren Sie schädliche Akteure**.</span><span class="sxs-lookup"><span data-stu-id="52684-159">**Block bad actors**.</span></span> <span data-ttu-id="52684-160">Wenn Sie einen Client drosseln, bedeutet dies nicht zwangsläufig, dass der Client böswillig agiert hat.</span><span class="sxs-lookup"><span data-stu-id="52684-160">Just because you throttle a client, it doesn't mean client was acting maliciously.</span></span> <span data-ttu-id="52684-161">Es bedeutet lediglich, dass der Client das Dienstkontingent überschritten hat.</span><span class="sxs-lookup"><span data-stu-id="52684-161">It just means the client exceeded their service quota.</span></span> <span data-ttu-id="52684-162">Wenn ein Client jedoch das Kontingent beständig überschreitet oder sich auf sonstige Weise schädlich verhält, können Sie ihn blockieren.</span><span class="sxs-lookup"><span data-stu-id="52684-162">But if a client consistently exceeds their quota or otherwise behaves badly, you might block them.</span></span> <span data-ttu-id="52684-163">Definieren Sie einen Out-of-band-Prozess, damit Benutzer das Aufheben der Blockierung anfordern können.</span><span class="sxs-lookup"><span data-stu-id="52684-163">Define an out-of-band process for user to request getting unblocked.</span></span>

<span data-ttu-id="52684-164">**Wählen Sie eine übergeordnete Instanz aus**.</span><span class="sxs-lookup"><span data-stu-id="52684-164">**Use leader election**.</span></span> <span data-ttu-id="52684-165">Wenn Sie eine Aufgabe koordinieren müssen, wählen Sie einen Koordinator aus, indem Sie eine [übergeordnete Instanz auswählen][leader-election].</span><span class="sxs-lookup"><span data-stu-id="52684-165">When you need to coordinate a task, use [Leader Election][leader-election] to select a coordinator.</span></span> <span data-ttu-id="52684-166">Auf diese Weise ist der Koordinator kein Single Point of Failure.</span><span class="sxs-lookup"><span data-stu-id="52684-166">That way, the coordinator is not a single point of failure.</span></span> <span data-ttu-id="52684-167">Wenn der Koordinator ausfällt, wird ein neuer ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="52684-167">If the coordinator fails, a new one is selected.</span></span> <span data-ttu-id="52684-168">Statt einen vollkommen neu entwickelten Algorithmus für die Auswahl einer übergeordneten Instanz zu implementieren, sollten Sie eine bereits fertige Lösung verwenden, z.B. Zoekeeper.</span><span class="sxs-lookup"><span data-stu-id="52684-168">Rather than implement a leader election algorithm from scratch, consider an off-the-shelf solution such as Zookeeper.</span></span>

<span data-ttu-id="52684-169">**Testen Sie mit Fault Injection**.</span><span class="sxs-lookup"><span data-stu-id="52684-169">**Test with fault injection**.</span></span> <span data-ttu-id="52684-170">Allzu häufig wird der Erfolgspfad gründlich getestet, jedoch nicht der Fehlerpfad.</span><span class="sxs-lookup"><span data-stu-id="52684-170">All too often, the success path is well tested but not the failure path.</span></span> <span data-ttu-id="52684-171">Ein System kann bereits lange Zeit in der Produktion ausgeführt werden, bevor ein Fehlerpfad getestet wird.</span><span class="sxs-lookup"><span data-stu-id="52684-171">A system could run in production for a long time before a failure path is exercised.</span></span> <span data-ttu-id="52684-172">Testen Sie die Resilienz des Systems bei Fehlern mithilfe von Fault Injection, indem Sie entweder echte Fehler auslösen oder diese simulieren.</span><span class="sxs-lookup"><span data-stu-id="52684-172">Use fault injection to test the resiliency of the system to failures, either by triggering actual failures or by simulating them.</span></span>

<span data-ttu-id="52684-173">**Nutzen Sie Chaos Engineering**.</span><span class="sxs-lookup"><span data-stu-id="52684-173">**Embrace chaos engineering**.</span></span> <span data-ttu-id="52684-174">Chaos Engineering ist eine Erweiterung des Konzepts von Fault Injection. Dabei werden Fehler oder anormale Bedingungen in Produktionsinstanzen eingefügt.</span><span class="sxs-lookup"><span data-stu-id="52684-174">Chaos engineering extends the notion of fault injection, by randomly injecting failures or abnormal conditions into production instances.</span></span>

<span data-ttu-id="52684-175">Informationen zu einer strukturieren Vorgehensweise für die Selbstreparatur von Anwendungen finden Sie unter [Entwerfen robuster Anwendungen für Azure][resiliency-overview].</span><span class="sxs-lookup"><span data-stu-id="52684-175">For a structured approach to making your applications self healing, see [Design resilient applications for Azure][resiliency-overview].</span></span>

<!-- links -->

[circuit-breaker]: ../../patterns/circuit-breaker.md
[compensating-transactions]: ../../patterns/compensating-transaction.md
[leader-election]: ../../patterns/leader-election.md
[load-level]: ../../patterns/queue-based-load-leveling.md
[resiliency-overview]: ../../resiliency/index.md
[retry]: ../../patterns/retry.md
[throttle]: ../../patterns/throttling.md
[transient-fault-handling]: ../../best-practices/transient-faults.md
