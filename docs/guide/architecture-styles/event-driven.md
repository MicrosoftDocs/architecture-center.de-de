---
title: Ereignisgesteuerter Architekturstil
description: "Dieser Artikel beschreibt die Vorteile, Herausforderungen und bewährten Methoden für ereignisgesteuerte und IoT-Architekturen in Azure."
author: MikeWasson
ms.openlocfilehash: ff7f936ceabefe7079a1ebbfa717ff4095bf133b
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/14/2017
---
# <a name="event-driven-architecture-style"></a><span data-ttu-id="c8dd0-103">Ereignisgesteuerter Architekturstil</span><span class="sxs-lookup"><span data-stu-id="c8dd0-103">Event-driven architecture style</span></span>

<span data-ttu-id="c8dd0-104">Eine ereignisgesteuerte Architektur besteht aus **Ereignisproducern**, die einen Ereignisstrom generieren, und **Ereignisconsumern**, die auf die Ereignisse lauschen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-104">An event-driven architecture consists of **event producers** that generate a stream of events, and **event consumers** that listen for the events.</span></span> 

![](./images/event-driven.svg)

<span data-ttu-id="c8dd0-105">Ereignisse werden nahezu in Echtzeit übermittelt, sodass Consumer unmittelbar nach dem Auftreten des Ereignisses reagieren können.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-105">Events are delivered in near real time, so consumers can respond immediately to events as they occur.</span></span> <span data-ttu-id="c8dd0-106">Producer sind von Consumern entkoppelt – ein Producer weiß nicht, welche Consumer lauschen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-106">Producers are decoupled from consumers &mdash; a producer doesn't know which consumers are listening.</span></span> <span data-ttu-id="c8dd0-107">Consumer sind auch voneinander entkoppelt, und jeder Consumer sieht alle Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-107">Consumers are also decoupled from each other, and every consumer sees all of the events.</span></span> <span data-ttu-id="c8dd0-108">Dies ist ein Unterschied zum Muster der [konkurrierenden Consumer][competing-consumers], in dem Consumer Nachrichten aus einer Warteschlange abrufen und eine Nachricht nur einmal verarbeitet wird (vorausgesetzt, dass sie fehlerfrei ist).</span><span class="sxs-lookup"><span data-stu-id="c8dd0-108">This differs from a [Competing Consumers][competing-consumers] pattern, where consumers pull messages from a queue and a message is processed just once (assuming no errors).</span></span> <span data-ttu-id="c8dd0-109">In einigen Systemen, z.B. dem Internet der Dinge (Internet of Things, IoT), müssen Ereignisse in sehr großen Mengen erfasst werden.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-109">In some systems, such as IoT, events must be ingested at very high volumes.</span></span>

<span data-ttu-id="c8dd0-110">Eine ereignisgesteuerte Architektur kann ein Veröffentlichungs-/Abonnementmodell oder eine Ereignisstrommodell verwenden.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-110">An event driven architecture can use a pub/sub model or an event stream model.</span></span> 

- <span data-ttu-id="c8dd0-111">**Veröffentlichung/Abonnement**: Die Messaginginfrastruktur verfolgt die Abonnements nach.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-111">**Pub/sub**: The messaging infrastructure keeps track of subscriptions.</span></span> <span data-ttu-id="c8dd0-112">Wenn ein Ereignis veröffentlicht wird, sendet die Infrastruktur das Ereignis an jeden Abonnenten.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-112">When an event is published, it sends the event to each subscriber.</span></span> <span data-ttu-id="c8dd0-113">Nachdem ein Ereignis empfangen wurde, kann es nicht wiedergegeben werden, und für neue Abonnenten wird es nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-113">After an event is received, it cannot be replayed, and new subscribers do not see the event.</span></span> 

- <span data-ttu-id="c8dd0-114">**Ereignisströme**: Ereignisse werden in ein Protokoll geschrieben.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-114">**Event streaming**: Events are written to a log.</span></span> <span data-ttu-id="c8dd0-115">Ereignisse unterliegen einer strikten Reihenfolge (innerhalb einer Partition) und sind dauerhaft.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-115">Events are strictly ordered (within a partition) and durable.</span></span> <span data-ttu-id="c8dd0-116">Clients abonnieren den Ereignisstrom nicht, stattdessen kann ein Client in jedem Teil des Ereignisstroms Lesevorgänge ausführen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-116">Clients don't subscribe to the stream, instead a client can read from any part of the stream.</span></span> <span data-ttu-id="c8dd0-117">Der Client ist dafür zuständig, im Ereignisstrom vorzurücken.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-117">The client is responsible for advancing its position in the stream.</span></span> <span data-ttu-id="c8dd0-118">Das bedeutet, dass ein Client jederzeit beitreten und Ereignisse wiedergeben kann.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-118">That means a client can join at any time, and can replay events.</span></span>

<span data-ttu-id="c8dd0-119">Auf Consumerseite gibt es einige gängige Variationen:</span><span class="sxs-lookup"><span data-stu-id="c8dd0-119">On the consumer side, there are some common variations:</span></span>

- <span data-ttu-id="c8dd0-120">**Einfache Ereignisverarbeitung**.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-120">**Simple event processing**.</span></span> <span data-ttu-id="c8dd0-121">Ein Ereignis löst unmittelbar eine Aktion im Consumer aus.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-121">An event immediately triggers an action in the consumer.</span></span> <span data-ttu-id="c8dd0-122">Sie können z.B. Azure Functions mit einem Service Bus-Trigger verwenden, sodass eine Funktion ausgeführt wird, sobald eine Nachricht in einem Service Bus-Thema veröffentlicht wurde.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-122">For example, you could use Azure Functions with a Service Bus trigger, so that a function executes whenever a message is published to a Service Bus topic.</span></span>

- <span data-ttu-id="c8dd0-123">**Komplexe Ereignisverarbeitung**.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-123">**Complex event processing**.</span></span> <span data-ttu-id="c8dd0-124">Ein Consumer verarbeitet eine Reihe von Ereignissen und sucht dabei mithilfe von Technologien wie Azure Stream Analytics oder Apache Storm nach Mustern in den Ereignisdaten.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-124">A consumer processes a series of events, looking for patterns in the event data, using a technology such as Azure Stream Analytics or Apache Storm.</span></span> <span data-ttu-id="c8dd0-125">Sie können z.B. Messergebnisse eines eingebetteten Geräts für ein bestimmtes Zeitfenster aggregieren und eine Nachricht generieren, wenn der gleitende Durchschnitt einen bestimmten Schwellenwert überschreitet.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-125">For example, you could aggregate readings from an embedded device over a time window, and generate a notification if the moving average crosses a certain threshold.</span></span> 

- <span data-ttu-id="c8dd0-126">**Ereignisstromverarbeitung**.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-126">**Event stream processing**.</span></span> <span data-ttu-id="c8dd0-127">Verwenden Sie eine Plattform zur Verarbeitung von Datenströmen wie z.B. Azure IoT Hub oder Apache Kafka als Pipeline zum Erfassen von Ereignissen und Weiterleiten der Ereignisse an Datenstromprozessoren.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-127">Use a data streaming platform, such as Azure IoT Hub or Apache Kafka, as a pipeline to ingest events and feed them to stream processors.</span></span> <span data-ttu-id="c8dd0-128">Die Datenstromprozessoren verarbeiten oder transformieren den Datenstrom.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-128">The stream processors act to process or transform the stream.</span></span> <span data-ttu-id="c8dd0-129">Es können mehrere Datenstromprozessoren für verschiedene Subsysteme der Anwendung vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-129">There may be multiple stream processors for different subsystems of the application.</span></span> <span data-ttu-id="c8dd0-130">Dieser Ansatz eignet sich gut für IoT-Workloads.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-130">This approach is a good fit for IoT workloads.</span></span>

<span data-ttu-id="c8dd0-131">Die Quelle der Ereignisse befindet sich möglicherweise außerhalb des Systems – z.B. physische Geräte in einer IoT-Lösung.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-131">The source of the events may be external to the system, such as physical devices in an IoT solution.</span></span> <span data-ttu-id="c8dd0-132">In diesem Fall muss das System in der Lage sein, die Daten mit der Kapazität hinsichtlich Umfang und Durchsatz zu erfassen, die für die Datenquelle erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-132">In that case, the system must be able to ingest the data at the volume and throughput that is required by the data source.</span></span>

<span data-ttu-id="c8dd0-133">In dem logischen Diagramm oben wird jeder Consumertyp als einzelnes Feld angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-133">In the logical diagram above, each type of consumer is shown as a single box.</span></span> <span data-ttu-id="c8dd0-134">In der Praxis werden meist mehrere Instanzen eines Consumers bereitgestellt, damit der Consumer nicht zum Single Point of Failure im System wird.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-134">In practice, it's common to have multiple instances of a consumer, to avoid having the consumer become a single point of failure in system.</span></span> <span data-ttu-id="c8dd0-135">Mehrere Instanzen sind möglicherweise auch erforderlich, um die Menge und Häufigkeit von Ereignissen zu bewältigen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-135">Multiple instances might also be necessary to handle the volume and frequency of events.</span></span> <span data-ttu-id="c8dd0-136">Auch verarbeitet ein einzelner Consumer Ereignisse möglicherweise in mehreren Threads.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-136">Also, a single consumer might process events on multiple threads.</span></span> <span data-ttu-id="c8dd0-137">Das kann eine Herausforderung darstellen, wenn Ereignisse in einer bestimmten Reihenfolge verarbeitet werden müssen oder eine „Exactly-Once“-Semantik erfordern.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-137">This can create challenges if events must be processed in order, or require exactly-once semantics.</span></span> <span data-ttu-id="c8dd0-138">Weitere Informationen finden Sie unter [Minimieren der Koordination][minimize-coordination].</span><span class="sxs-lookup"><span data-stu-id="c8dd0-138">See [Minimize Coordination][minimize-coordination].</span></span> 

## <a name="when-to-use-this-architecture"></a><span data-ttu-id="c8dd0-139">Einsatzmöglichkeiten für diese Architektur</span><span class="sxs-lookup"><span data-stu-id="c8dd0-139">When to use this architecture</span></span>

- <span data-ttu-id="c8dd0-140">Mehrere Subsysteme, die die gleichen Ereignisse verarbeiten müssen</span><span class="sxs-lookup"><span data-stu-id="c8dd0-140">Multiple subsystems must process the same events.</span></span> 
- <span data-ttu-id="c8dd0-141">Echtzeitverarbeitung mit minimaler zeitlicher Verzögerung</span><span class="sxs-lookup"><span data-stu-id="c8dd0-141">Real-time processing with minimum time lag.</span></span>
- <span data-ttu-id="c8dd0-142">Komplexe Ereignisverarbeitung, z.B. Musterabgleich oder Aggregation über bestimmte Zeitfenster hinweg</span><span class="sxs-lookup"><span data-stu-id="c8dd0-142">Complex event processing, such as pattern matching or aggregation over time windows.</span></span>
- <span data-ttu-id="c8dd0-143">Große Mengen und hohe Datengeschwindigkeit, z.B. in IoT-Systemen</span><span class="sxs-lookup"><span data-stu-id="c8dd0-143">High volume and high velocity of data, such as IoT.</span></span>

## <a name="benefits"></a><span data-ttu-id="c8dd0-144">Vorteile</span><span class="sxs-lookup"><span data-stu-id="c8dd0-144">Benefits</span></span>

- <span data-ttu-id="c8dd0-145">Producer und Consumer sind entkoppelt.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-145">Producers and consumers are decoupled.</span></span>
- <span data-ttu-id="c8dd0-146">Keine Punkt-zu-Punkt-Integrationen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-146">No point-to point-integrations.</span></span> <span data-ttu-id="c8dd0-147">Neue Consumer lassen sich problemlos zum System hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-147">It's easy to add new consumers to the system.</span></span>
- <span data-ttu-id="c8dd0-148">Consumer können sofort auf Ereignisse reagieren, sobald diese eingehen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-148">Consumers can respond to events immediately as they arrive.</span></span> 
- <span data-ttu-id="c8dd0-149">In hohem Maß skalierbar und verteilt.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-149">Highly scalable and distributed.</span></span> 
- <span data-ttu-id="c8dd0-150">Subsysteme weisen unabhängige Perspektiven des Ereignisstroms auf.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-150">Subsystems have independent views of the event stream.</span></span>

## <a name="challenges"></a><span data-ttu-id="c8dd0-151">Herausforderungen</span><span class="sxs-lookup"><span data-stu-id="c8dd0-151">Challenges</span></span>

- <span data-ttu-id="c8dd0-152">Garantierte Übermittlung.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-152">Guaranteed delivery.</span></span> <span data-ttu-id="c8dd0-153">In manchen Systemen – insbesondere in IoT-Szenarien – ist es von entscheidender Bedeutung, sicherstellen zu können, dass Ereignisse übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-153">In some systems, especially in IoT scenarios, it's crucial to guarantee that events are delivered.</span></span>
- <span data-ttu-id="c8dd0-154">Verarbeitung der Ereignisse in einer bestimmten Reihenfolge oder genau einmal.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-154">Processing events in order or exactly once.</span></span> <span data-ttu-id="c8dd0-155">Jeder Consumertyp wird aus Gründen der Resilienz und Skalierbarkeit in der Regel in mehreren Instanzen ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-155">Each consumer type typically runs in multiple instances, for resiliency and scalability.</span></span> <span data-ttu-id="c8dd0-156">Dies kann zu einer Herausforderung werden, wenn die Ereignisse (innerhalb eines Consumertyps) in einer bestimmten Reihenfolge verarbeitet werden müssen oder die Verarbeitungslogik nicht idempotent ist.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-156">This can create a challenge if the events must be processed in order (within a consumer type), or if the processing logic is not idempotent.</span></span>

## <a name="iot-architecture"></a><span data-ttu-id="c8dd0-157">IoT-Architektur</span><span class="sxs-lookup"><span data-stu-id="c8dd0-157">IoT architecture</span></span>

<span data-ttu-id="c8dd0-158">Ereignisgesteuerte Architekturen sind von zentraler Bedeutung für IoT-Lösungen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-158">Event-driven architectures are central to IoT solutions.</span></span> <span data-ttu-id="c8dd0-159">Das folgende Diagramm zeigt eine mögliche logische Architektur für IoT.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-159">The following diagram shows a possible logical architecture for IoT.</span></span> <span data-ttu-id="c8dd0-160">Das Diagramm veranschaulicht die Komponenten der Architektur, die Ereignisströme verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-160">The diagram emphasizes the event-streaming components of the architecture.</span></span>

![](./images/iot.png)

<span data-ttu-id="c8dd0-161">Das **Cloudgateway** erfasst Geräteereignisse an der Cloudgrenze mithilfe eines zuverlässigen Messagingsystems mit niedriger Latenz.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-161">The **cloud gateway** ingests device events at the cloud boundary, using a reliable, low latency messaging system.</span></span>

<span data-ttu-id="c8dd0-162">Geräte können Ereignisse direkt an das Cloudgateway oder über ein **Bereichsgateway**.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-162">Devices might send events directly to the cloud gateway, or through a **field gateway**.</span></span> <span data-ttu-id="c8dd0-163">Ein Bereichsgateway ist ein spezialisiertes Gerät oder Softwareprogramm, das sich üblicherweise am gleichen Ort befindet wie die Geräte. Es empfängt Ereignisse und leitet sie an das Cloudgateway weiter.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-163">A field gateway is a specialized device or software, usually colocated with the devices, that receives events and forwards them to the cloud gateway.</span></span> <span data-ttu-id="c8dd0-164">Das Bereichsgateway kann auch Vorverarbeitungsfunktionen für die Geräteereignisse ausführen, z.B. Filtern, Aggregation oder Protokolltransformation.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-164">The field gateway might also preprocess the raw device events, performing functions such as filtering, aggregation, or protocol transformation.</span></span>

<span data-ttu-id="c8dd0-165">Nach dem Erfassen durchlaufen Ereignisse einen oder mehrere **Datenstromprozessoren**, die die Daten weiterleiten (z.B. zum Speicher) oder Analyse- oder andere Verarbeitungsfunktionen ausführen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-165">After ingestion, events go through one or more **stream processors** that can route the data (for example, to storage) or perform analytics and other processing.</span></span>

<span data-ttu-id="c8dd0-166">Nachfolgend finden Sie einige häufige Verarbeitungsarten.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-166">The following are some common types of processing.</span></span> <span data-ttu-id="c8dd0-167">(Diese Liste ist sicherlich nicht vollständig.)</span><span class="sxs-lookup"><span data-stu-id="c8dd0-167">(This list is certainly not exhaustive.)</span></span>

- <span data-ttu-id="c8dd0-168">Schreiben von Ereignisdaten in einen Cold Storage zur Archivierung oder Batchanalyse.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-168">Writing event data to cold storage, for archiving or batch analytics.</span></span>

- <span data-ttu-id="c8dd0-169">Analyse des langsamsten Pfads – der Ereignisstrom wird (nahezu) in Echtzeit analysiert, um Anomalien zu erkennen, Muster in rollierenden Zeitfenstern zu ermitteln oder Warnungen auszulösen, wenn eine bestimmte Bedingung im Ereignisstrom auftritt.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-169">Hot path analytics, analyzing the event stream in (near) real time, to detect anomalies, recognize patterns over rolling time windows, or trigger alerts when a specific condition occurs in the stream.</span></span> 

- <span data-ttu-id="c8dd0-170">Verarbeitung bestimmter Arten von nicht telemetriebezogenen Nachrichten von Geräten, z.B. Benachrichtigungen und Warnungen.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-170">Handling special types of non-telemetry messages from devices, such as notifications and alarms.</span></span> 

- <span data-ttu-id="c8dd0-171">Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-171">Machine learning.</span></span>

<span data-ttu-id="c8dd0-172">Die grauen Felder stehen für Komponenten eines IoT-Systems, die nicht in direktem Zusammenhang mit der Ereignisstromverarbeitung stehen, sondern der Vollständigkeit halber hier mit aufgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-172">The boxes that are shaded gray show components of an IoT system that are not directly related to event streaming, but are included here for completeness.</span></span>

- <span data-ttu-id="c8dd0-173">Die **Geräteregistrierung** ist eine Datenbank der bereitgestellten Geräte und enthält die Geräte-IDs sowie üblicherweise einige Metadaten zu den Geräten, beispielsweise den Standort.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-173">The **device registry** is a database of the provisioned devices, including the device IDs and usually device metadata, such as location.</span></span>

- <span data-ttu-id="c8dd0-174">Die **Bereitstellungs-API** ist eine allgemeine externe Schnittstelle für die Bereitstellung und Registrierung neuer Geräte.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-174">The **provisioning API** is a common external interface for provisioning and registering new devices.</span></span>

- <span data-ttu-id="c8dd0-175">In einigen IoT-Lösungen können **Nachrichten mit Befehlen und Steuerungsinformationen** an die Geräte gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-175">Some IoT solutions allow **command and control messages** to be sent to devices.</span></span>

> <span data-ttu-id="c8dd0-176">Dieser Abschnitt stellt eine sehr allgemeine Übersicht über IoT dar, und es gibt eine Vielzahl von Feinheiten und Herausforderungen, die es in diesem Bereich zu berücksichtigen gilt.</span><span class="sxs-lookup"><span data-stu-id="c8dd0-176">This section has presented a very high-level view of IoT, and there are many subtleties and challenges to consider.</span></span> <span data-ttu-id="c8dd0-177">Weitere Informationen und Details finden Sie in der als PDF-Download verfügbaren [Microsoft Azure IoT Reference Architecture][iot-ref-arch] (Referenzarchitektur zu Microsoft Azure IoT).</span><span class="sxs-lookup"><span data-stu-id="c8dd0-177">For a more detailed reference architecture and discussion, see the [Microsoft Azure IoT Reference Architecture][iot-ref-arch] (PDF download).</span></span>

 <!-- links -->

[competing-consumers]: ../../patterns/competing-consumers.md
[iot-ref-arch]: https://azure.microsoft.com/en-us/updates/microsoft-azure-iot-reference-architecture-available/
[minimize-coordination]: ../design-principles/minimize-coordination.md


