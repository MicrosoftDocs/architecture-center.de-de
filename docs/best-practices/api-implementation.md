---
title: API-Implementierungsleitfaden
titleSuffix: Best practices for cloud applications
description: Anleitung zur Implementierung einer API
author: dragon119
ms.date: 07/13/2016
ms.custom: seodec18
ms.openlocfilehash: edbb214c8b582e334a851da79370844da4762a76
ms.sourcegitcommit: 4ba3304eebaa8c493c3e5307bdd9d723cd90b655
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 12/12/2018
ms.locfileid: "53307400"
---
# <a name="api-implementation"></a><span data-ttu-id="406f4-103">API-Implementierung</span><span class="sxs-lookup"><span data-stu-id="406f4-103">API implementation</span></span>

<span data-ttu-id="406f4-104">Mit einer sorgfältig entworfenen RESTful-Web-API werden die Ressourcen, Beziehungen und Navigationsschemas definiert, auf die mit Clientanwendungen zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="406f4-104">A carefully-designed RESTful web API defines the resources, relationships, and navigation schemes that are accessible to client applications.</span></span> <span data-ttu-id="406f4-105">Beim Implementieren und Bereitstellen einer Web-API sollten Sie die physischen Anforderungen der Umgebung  berücksichtigen, in der die Web-API gehostet wird. Außerdem sollten Sie eher darauf achten, wie die Web-API erstellt wurde, als auf die logische Struktur der Daten.</span><span class="sxs-lookup"><span data-stu-id="406f4-105">When you implement and deploy a web API, you should consider the physical requirements of the environment hosting the web API and the way in which the web API is constructed rather than the logical structure of the data.</span></span> <span data-ttu-id="406f4-106">In diesem Leitfaden geht es hauptsächlich um die bewährten Methoden zur Implementierung einer Web-API und deren Veröffentlichung, um sie für Clientanwendungen verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="406f4-106">This guidance focusses on best practices for implementing a web API and publishing it to make it available to client applications.</span></span> <span data-ttu-id="406f4-107">Ausführliche Informationen zum Web-API-Design finden Sie unter [API-Design](/azure/architecture/best-practices/api-design).</span><span class="sxs-lookup"><span data-stu-id="406f4-107">For detailed information about web API design, see [API Design Guidance](/azure/architecture/best-practices/api-design).</span></span>

## <a name="processing-requests"></a><span data-ttu-id="406f4-108">Verarbeiten von Anforderungen</span><span class="sxs-lookup"><span data-stu-id="406f4-108">Processing requests</span></span>

<span data-ttu-id="406f4-109">Beachten Sie die folgenden Punkte, wenn Sie den Code zum Behandeln von Anforderungen implementieren.</span><span class="sxs-lookup"><span data-stu-id="406f4-109">Consider the following points when you implement the code to handle requests.</span></span>

### <a name="get-put-delete-head-and-patch-actions-should-be-idempotent"></a><span data-ttu-id="406f4-110">GET-, PUT-, DELETE-, HEAD- und PATCH-Aktionen sollten idempotent sein</span><span class="sxs-lookup"><span data-stu-id="406f4-110">GET, PUT, DELETE, HEAD, and PATCH actions should be idempotent</span></span>

<span data-ttu-id="406f4-111">Der Code, mit dem diese Anforderungen implementiert werden, sollte nicht mit Nebeneffekten verbunden sein.</span><span class="sxs-lookup"><span data-stu-id="406f4-111">The code that implements these requests should not impose any side-effects.</span></span> <span data-ttu-id="406f4-112">Eine Anforderung, die für eine Ressource wiederholt ausgeführt wird, sollte zum gleichen Ergebnis führen.</span><span class="sxs-lookup"><span data-stu-id="406f4-112">The same request repeated over the same resource should result in the same state.</span></span> <span data-ttu-id="406f4-113">Das Senden von mehreren DELETE-Anforderungen an denselben URI sollte die gleiche Auswirkung haben, aber der HTTP-Statuscode in den Antwortnachrichten kann sich unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="406f4-113">For example, sending multiple DELETE requests to the same URI should have the same effect, although the HTTP status code in the response messages may be different.</span></span> <span data-ttu-id="406f4-114">Für die erste DELETE-Anforderung wird ggf. der Statuscode 204 (Kein Inhalt) zurückgegeben, während für eine nachfolgende DELETE-Anforderung unter Umständen der Statuscode 404 (Nicht gefunden) zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-114">The first DELETE request might return status code 204 (No Content), while a subsequent DELETE request might return status code 404 (Not Found).</span></span>

> [!NOTE]
> <span data-ttu-id="406f4-115">Der Artikel [Idempotency Patterns](https://blog.jonathanoliver.com/idempotency-patterns/) (Muster der Idempotenz) im Blog von Jonathan Oliver enthält eine Übersicht über die Idempotenz und ihre Verbindung mit Datenverwaltungsvorgängen.</span><span class="sxs-lookup"><span data-stu-id="406f4-115">The article [Idempotency Patterns](https://blog.jonathanoliver.com/idempotency-patterns/) on Jonathan Oliver’s blog provides an overview of idempotency and how it relates to data management operations.</span></span>

### <a name="post-actions-that-create-new-resources-should-not-have-unrelated-side-effects"></a><span data-ttu-id="406f4-116">Bei POST-Aktionen, mit denen neue Ressourcen erstellt werden, sollten keine nicht relevanten Nebeneffekte auftreten</span><span class="sxs-lookup"><span data-stu-id="406f4-116">POST actions that create new resources should not have unrelated side-effects</span></span>

<span data-ttu-id="406f4-117">Wenn mit einer POST-Anforderung eine neue Ressource erstellt werden soll, sollten die Auswirkungen der Anforderung auf die neue Ressource beschränkt sein (sowie unter Umständen auf alle direkt verwandten Ressourcen, falls eine Verknüpfung besteht). In einem E-Commerce-System werden mit einer POST-Anforderung, mit der eine neue Bestellung für einen Kunden erstellt wird, ggf. auch Lagerbestände verändert und Rechnungsinformationen erzeugt. Es sollten aber keine Informationen geändert werden, die sich nicht direkt auf die Bestellung beziehen, und es sollten sich auch keine anderen Nebeneffekte für den Gesamtzustand des Systems ergeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-117">If a POST request is intended to create a new resource, the effects of the request should be limited to the new resource (and possibly any directly related resources if there is some sort of linkage involved) For example, in an ecommerce system, a POST request that creates a new order for a customer might also amend inventory levels and generate billing information, but it should not modify information not directly related to the order or have any other side-effects on the overall state of the system.</span></span>

### <a name="avoid-implementing-chatty-post-put-and-delete-operations"></a><span data-ttu-id="406f4-118">Vermeiden der Implementierung von umfangreichen POST-, PUT- und DELETE-Vorgängen</span><span class="sxs-lookup"><span data-stu-id="406f4-118">Avoid implementing chatty POST, PUT, and DELETE operations</span></span>

<span data-ttu-id="406f4-119">Bauen Sie die Unterstützung von POST-, PUT- und DELETE-Anforderungen über Ressourcenauflistungen ein.</span><span class="sxs-lookup"><span data-stu-id="406f4-119">Support POST, PUT and DELETE requests over resource collections.</span></span> <span data-ttu-id="406f4-120">Eine POST-Anforderung kann die Details für mehrere neue Ressourcen enthalten und diese derselben Auflistung hinzufügen. Mit einer PUT-Anforderung kann der gesamte Ressourcensatz in einer Auflistung ersetzt werden, und mit einer DELETE-Anforderung kann eine gesamte Auflistung entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-120">A POST request can contain the details for multiple new resources and add them all to the same collection, a PUT request can replace the entire set of resources in a collection, and a DELETE request can remove an entire collection.</span></span>

<span data-ttu-id="406f4-121">Die in der ASP.NET-Web-API 2 enthaltene OData-Unterstützung ermöglicht das Zusammenfassen von Anforderungen in Batches.</span><span class="sxs-lookup"><span data-stu-id="406f4-121">The OData support included in ASP.NET Web API 2 provides the ability to batch requests.</span></span> <span data-ttu-id="406f4-122">Eine Clientanwendung kann mehrere Web-API-Anforderungen verpacken und in einer einzelnen HTTP-Anforderung an den Server senden. Sie erhält dann eine einzelne HTTP-Antwort mit den Antworten für die einzelnen Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="406f4-122">A client application can package up several web API requests and send them to the server in a single HTTP request, and receive a single HTTP response that contains the replies to each request.</span></span> <span data-ttu-id="406f4-123">Weitere Informationen finden Sie unter [Introducing Batch Support in Web API and Web API OData](https://blogs.msdn.microsoft.com/webdev/2013/11/01/introducing-batch-support-in-web-api-and-web-api-odata/) (Einführung der Batchunterstützung für die Web-API und Web-API-OData).</span><span class="sxs-lookup"><span data-stu-id="406f4-123">For more information, [Introducing Batch Support in Web API and Web API OData](https://blogs.msdn.microsoft.com/webdev/2013/11/01/introducing-batch-support-in-web-api-and-web-api-odata/).</span></span>

### <a name="follow-the-http-specification-when-sending-a-response"></a><span data-ttu-id="406f4-124">Befolgen der HTTP-Spezifikation beim Senden einer Antwort</span><span class="sxs-lookup"><span data-stu-id="406f4-124">Follow the HTTP specification when sending a response</span></span>

<span data-ttu-id="406f4-125">Eine Web-API muss Nachrichten mit dem richtigen HTTP-Statuscode zurückgeben, damit der Client bestimmen kann, wie er das Ergebnis behandeln soll. Außerdem die richtigen HTTP-Header, damit der Client die Art des Ergebnisses versteht, sowie einen richtig formatierten Text, damit der Client das Ergebnis analysieren kann.</span><span class="sxs-lookup"><span data-stu-id="406f4-125">A web API must return messages that contain the correct HTTP status code to enable the client to determine how to handle the result, the appropriate HTTP headers so that the client understands the nature of the result, and a suitably formatted body to enable the client to parse the result.</span></span>

<span data-ttu-id="406f4-126">Ein POST-Vorgang sollte in diesem Fall den Statuscode 201 (Erstellt) zurückgeben, und die Antwortnachricht sollte den URI der neu erstellten Ressource im Location-Header enthalten.</span><span class="sxs-lookup"><span data-stu-id="406f4-126">For example, a POST operation should return status code 201 (Created) and the response message should include the URI of the newly created resource in the Location header of the response message.</span></span>

### <a name="support-content-negotiation"></a><span data-ttu-id="406f4-127">Unterstützung der Inhaltsaushandlung</span><span class="sxs-lookup"><span data-stu-id="406f4-127">Support content negotiation</span></span>

<span data-ttu-id="406f4-128">Der Text einer Antwortnachricht kann Daten in unterschiedlichen Formaten enthalten.</span><span class="sxs-lookup"><span data-stu-id="406f4-128">The body of a response message may contain data in a variety of formats.</span></span> <span data-ttu-id="406f4-129">Bei einer HTTP GET-Anforderung können Daten beispielsweise im JSON- oder XML-Format zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-129">For example, an HTTP GET request could return data in JSON, or XML format.</span></span> <span data-ttu-id="406f4-130">Wenn der Client eine Anforderung sendet, kann diese einen Accept-Header zum Angeben der Datenformate enthalten, die behandelt werden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-130">When the client submits a request, it can include an Accept header that specifies the data formats that it can handle.</span></span> <span data-ttu-id="406f4-131">Diese Formate werden als Medientypen angegeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-131">These formats are specified as media types.</span></span> <span data-ttu-id="406f4-132">Ein Client, der eine GET-Anforderung zum Abrufen eines Bilds ausgibt, kann beispielsweise einen Accept-Header angeben, der die für den Client geeigneten Medientypen auflistet (Beispiel: `image/jpeg, image/gif, image/png`).</span><span class="sxs-lookup"><span data-stu-id="406f4-132">For example, a client that issues a GET request that retrieves an image can specify an Accept header that lists the media types that the client can handle, such as `image/jpeg, image/gif, image/png`.</span></span> <span data-ttu-id="406f4-133">Wenn die Web-API das Ergebnis zurückgibt, sollte sie die Daten mit einem dieser Medientypen formatieren und das Format im Content-Type-Header der Antwort angeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-133">When the web API returns the result, it should format the data by using one of these media types and specify the format in the Content-Type header of the response.</span></span>

<span data-ttu-id="406f4-134">Falls der Client keinen Accept-Header angibt, sollten Sie für den Text der Antwort ein geeignetes Standardformat verwenden.</span><span class="sxs-lookup"><span data-stu-id="406f4-134">If the client does not specify an Accept header, then use a sensible default format for the response body.</span></span> <span data-ttu-id="406f4-135">Beispiel: Das ASP.NET-Web-API-Framework nutzt für textbasierte Daten standardmäßig JSON.</span><span class="sxs-lookup"><span data-stu-id="406f4-135">As an example, the ASP.NET Web API framework defaults to JSON for text-based data.</span></span>

### <a name="provide-links-to-support-hateoas-style-navigation-and-discovery-of-resources"></a><span data-ttu-id="406f4-136">Bereitstellen von Links zum Unterstützen der Navigation im HATEOAS-Stil und der Ermittlung von Ressourcen</span><span class="sxs-lookup"><span data-stu-id="406f4-136">Provide links to support HATEOAS-style navigation and discovery of resources</span></span>

<span data-ttu-id="406f4-137">Mit dem HATEOAS-Ansatz kann ein Client von einem Startpunkt aus zu Ressourcen navigieren und diese ermitteln.</span><span class="sxs-lookup"><span data-stu-id="406f4-137">The HATEOAS approach enables a client to navigate and discover resources from an initial starting point.</span></span> <span data-ttu-id="406f4-138">Dies wird erreicht, indem Links mit URIs verwendet werden. Wenn ein Client eine HTTP GET-Anforderung zum Abrufen einer Ressource ausgibt, sollte die Antwort URIs enthalten, mit denen eine Clientanwendung alle direkt verwandten Ressourcen schnell finden kann.</span><span class="sxs-lookup"><span data-stu-id="406f4-138">This is achieved by using links containing URIs; when a client issues an HTTP GET request to obtain a resource, the response should contain URIs that enable a client application to quickly locate any directly related resources.</span></span> <span data-ttu-id="406f4-139">Es kann beispielsweise sein, dass ein Kunde in einer Web-API, die eine E-Commerce-Lösung unterstützt, viele Bestellungen aufgegeben hat.</span><span class="sxs-lookup"><span data-stu-id="406f4-139">For example, in a web API that supports an e-commerce solution, a customer may have placed many orders.</span></span> <span data-ttu-id="406f4-140">Wenn eine Clientanwendung die Details für einen Kunden abruft, sollte die Antwort Links enthalten, mit denen die Clientanwendung HTTP GET-Anforderungen zum Abrufen dieser Bestellungen senden kann.</span><span class="sxs-lookup"><span data-stu-id="406f4-140">When a client application retrieves the details for a customer, the response should include links that enable the client application to send HTTP GET requests that can retrieve these orders.</span></span> <span data-ttu-id="406f4-141">Darüber hinaus sollten mit Links im HATEOAS-Stil die anderen Vorgänge (POST, PUT, DELETE usw.) beschrieben werden, die von jeder verknüpften Ressource zusammen mit dem entsprechenden URI zum Durchführen der einzelnen Anforderungen unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-141">Additionally, HATEOAS-style links should describe the other operations (POST, PUT, DELETE, and so on) that each linked resource supports together with the corresponding URI to perform each request.</span></span> <span data-ttu-id="406f4-142">Dieser Ansatz wird unter [API-Design][api-design] ausführlicher beschrieben.</span><span class="sxs-lookup"><span data-stu-id="406f4-142">This approach is described in more detail in [API Design][api-design].</span></span>

<span data-ttu-id="406f4-143">Derzeit gibt es keine Standards, mit denen die Implementierung von HATEOAS geregelt wird, aber im folgenden Beispiel wird ein möglicher Ansatz veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="406f4-143">Currently there are no standards that govern the implementation of HATEOAS, but the following example illustrates one possible approach.</span></span> <span data-ttu-id="406f4-144">In diesem Beispiel wird mit einer HTTP GET-Anforderung zum Suchen nach den Details für einen Kunden eine Antwort zurückgegeben, die HATEOAS-Links enthält, mit denen auf die Bestellungen des Kunden verwiesen wird:</span><span class="sxs-lookup"><span data-stu-id="406f4-144">In this example, an HTTP GET request that finds the details for a customer returns a response that include HATEOAS links that reference the orders for that customer:</span></span>

```HTTP
GET https://adventure-works.com/customers/2 HTTP/1.1
Accept: text/json
...
```

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"CustomerID":2,"CustomerName":"Bert","Links":[
    {"rel":"self",
    "href":"https://adventure-works.com/customers/2",
    "action":"GET",
    "types":["text/xml","application/json"]},
    {"rel":"self",
    "href":"https://adventure-works.com/customers/2",
    "action":"PUT",
    "types":["application/x-www-form-urlencoded"]},
    {"rel":"self",
    "href":"https://adventure-works.com/customers/2",
    "action":"DELETE",
    "types":[]},
    {"rel":"orders",
    "href":"https://adventure-works.com/customers/2/orders",
    "action":"GET",
    "types":["text/xml","application/json"]},
    {"rel":"orders",
    "href":"https://adventure-works.com/customers/2/orders",
    "action":"POST",
    "types":["application/x-www-form-urlencoded"]}
]}
```

<span data-ttu-id="406f4-145">Die Kundendaten werden hierbei mit der `Customer` -Klasse dargestellt, wie im folgenden Codeausschnitt zu sehen ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-145">In this example, the customer data is represented by the `Customer` class shown in the following code snippet.</span></span> <span data-ttu-id="406f4-146">Die HATEOAS-Links sind in der `Links` -Auflistungseigenschaft enthalten:</span><span class="sxs-lookup"><span data-stu-id="406f4-146">The HATEOAS links are held in the `Links` collection property:</span></span>

```csharp
public class Customer
{
    public int CustomerID { get; set; }
    public string CustomerName { get; set; }
    public List<Link> Links { get; set; }
    ...
}

public class Link
{
    public string Rel { get; set; }
    public string Href { get; set; }
    public string Action { get; set; }
    public string [] Types { get; set; }
}
```

<span data-ttu-id="406f4-147">Der HTTP GET-Vorgang ruft die Kundendaten aus dem Speicher ab und erstellt ein `Customer`-Objekt und füllt anschließend die `Links`-Auflistung auf.</span><span class="sxs-lookup"><span data-stu-id="406f4-147">The HTTP GET operation retrieves the customer data from storage and constructs a `Customer` object, and then populates the `Links` collection.</span></span> <span data-ttu-id="406f4-148">Das Ergebnis ist als JSON-Antwortnachricht formatiert.</span><span class="sxs-lookup"><span data-stu-id="406f4-148">The result is formatted as a JSON response message.</span></span> <span data-ttu-id="406f4-149">Jeder Link umfasst die folgenden Felder:</span><span class="sxs-lookup"><span data-stu-id="406f4-149">Each link comprises the following fields:</span></span>

- <span data-ttu-id="406f4-150">Die Beziehung zwischen dem zurückgegebenen Objekt und dem Objekt, das vom Link beschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-150">The relationship between the object being returned and the object described by the link.</span></span> <span data-ttu-id="406f4-151">Hierbei wird durch `self` angegeben, dass der Link ein Rückverweis auf das Objekt selbst ist (ähnlich wie bei einem `this`-Zeiger in vielen objektorientierten Sprachen). `orders` ist der Name einer Auflistung, in der die dazugehörigen Bestellinformationen enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="406f4-151">In this case `self` indicates that the link is a reference back to the object itself (similar to a `this` pointer in many object-oriented languages), and `orders` is the name of a collection containing the related order information.</span></span>
- <span data-ttu-id="406f4-152">Der Hyperlink (`Href`) für das Objekt, das mit dem Link beschrieben wird, in Form eines URI.</span><span class="sxs-lookup"><span data-stu-id="406f4-152">The hyperlink (`Href`) for the object being described by the link in the form of a URI.</span></span>
- <span data-ttu-id="406f4-153">Der Typ der HTTP-Anforderung (`Action`), die an diesen URI gesendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="406f4-153">The type of HTTP request (`Action`) that can be sent to this URI.</span></span>
- <span data-ttu-id="406f4-154">Das Format der Daten (`Types`), die in der HTTP-Anforderung bereitgestellt werden sollen oder die je nach Art der Anforderung in der Antwort zurückgegeben werden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-154">The format of any data (`Types`) that should be provided in the HTTP request or that can be returned in the response, depending on the type of the request.</span></span>

<span data-ttu-id="406f4-155">Mit den HATEOAS-Links in der HTTP-Beispielantwort wird angegeben, dass eine Clientanwendung die folgenden Vorgänge durchführen kann:</span><span class="sxs-lookup"><span data-stu-id="406f4-155">The HATEOAS links shown in the example HTTP response indicate that a client application can perform the following operations:</span></span>

- <span data-ttu-id="406f4-156">Eine HTTP GET-Anforderung an den URI `https://adventure-works.com/customers/2`, um die Details des Kunden abzurufen (erneut).</span><span class="sxs-lookup"><span data-stu-id="406f4-156">An HTTP GET request to the URI `https://adventure-works.com/customers/2` to fetch the details of the customer (again).</span></span> <span data-ttu-id="406f4-157">Die Daten können im XML- oder JSON-Format zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-157">The data can be returned as XML or JSON.</span></span>
- <span data-ttu-id="406f4-158">Eine HTTP PUT-Anforderung an den URI `https://adventure-works.com/customers/2`, um die Details des Kunden zu ändern.</span><span class="sxs-lookup"><span data-stu-id="406f4-158">An HTTP PUT request to the URI `https://adventure-works.com/customers/2` to modify the details of the customer.</span></span> <span data-ttu-id="406f4-159">Die neuen Daten müssen in der Anforderungsnachricht im Format „x-www-form-urlencoded“ bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-159">The new data must be provided in the request message in x-www-form-urlencoded format.</span></span>
- <span data-ttu-id="406f4-160">Eine HTTP DELETE-Anforderung an den URI `https://adventure-works.com/customers/2`, um den Kunden zu löschen.</span><span class="sxs-lookup"><span data-stu-id="406f4-160">An HTTP DELETE request to the URI `https://adventure-works.com/customers/2` to delete the customer.</span></span> <span data-ttu-id="406f4-161">Die Anforderung erwartet keine zusätzlichen Informationen oder Rückgabedaten im Text der Antwortnachricht.</span><span class="sxs-lookup"><span data-stu-id="406f4-161">The request does not expect any additional information or return data in the response message body.</span></span>
- <span data-ttu-id="406f4-162">Eine HTTP GET-Anforderung an den URI `https://adventure-works.com/customers/2/orders`, um alle Bestellungen des Kunden per Suche zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="406f4-162">An HTTP GET request to the URI `https://adventure-works.com/customers/2/orders` to find all the orders for the customer.</span></span> <span data-ttu-id="406f4-163">Die Daten können im XML- oder JSON-Format zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-163">The data can be returned as XML or JSON.</span></span>
- <span data-ttu-id="406f4-164">Eine HTTP PUT-Anforderung an den URI `https://adventure-works.com/customers/2/orders`, um eine neue Bestellung für den Kunden zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="406f4-164">An HTTP PUT request to the URI `https://adventure-works.com/customers/2/orders` to create a new order for this customer.</span></span> <span data-ttu-id="406f4-165">Die Daten müssen in der Anforderungsnachricht im Format „x-www-form-urlencoded“ bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-165">The data must be provided in the request message in x-www-form-urlencoded format.</span></span>

## <a name="handling-exceptions"></a><span data-ttu-id="406f4-166">Behandeln von Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="406f4-166">Handling exceptions</span></span>

<span data-ttu-id="406f4-167">Berücksichtigen Sie die folgenden Punkte, wenn ein Vorgang eine nicht abgefangene Ausnahme auslöst.</span><span class="sxs-lookup"><span data-stu-id="406f4-167">Consider the following points if an operation throws an uncaught exception.</span></span>

### <a name="capture-exceptions-and-return-a-meaningful-response-to-clients"></a><span data-ttu-id="406f4-168">Erfassen von Ausnahmen und Zurückgeben einer aussagekräftigen Antwort an Clients</span><span class="sxs-lookup"><span data-stu-id="406f4-168">Capture exceptions and return a meaningful response to clients</span></span>

<span data-ttu-id="406f4-169">Mit dem Code zum Implementieren eines HTTP-Vorgangs sollte eine umfassende Ausnahmebehandlung bereitgestellt werden, anstatt zuzulassen, dass unerwartete Ausnahmen ins Framework gelangen.</span><span class="sxs-lookup"><span data-stu-id="406f4-169">The code that implements an HTTP operation should provide comprehensive exception handling rather than letting uncaught exceptions propagate to the framework.</span></span> <span data-ttu-id="406f4-170">Wenn eine Ausnahme den erfolgreichen Abschluss des Vorgangs verhindert, kann die Ausnahme in der Antwortnachricht zurück übergeben werden. Sie sollte aber eine aussagekräftige Beschreibung des Fehlers enthalten, der die Ausnahme verursacht hat.</span><span class="sxs-lookup"><span data-stu-id="406f4-170">If an exception makes it impossible to complete the operation successfully, the exception can be passed back in the response message, but it should include a meaningful description of the error that caused the exception.</span></span> <span data-ttu-id="406f4-171">Außerdem sollte die Ausnahme den passenden HTTP-Statuscode enthalten, anstatt einfach für jede Situation den Statuscode 500 zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-171">The exception should also include the appropriate HTTP status code rather than simply returning status code 500 for every situation.</span></span> <span data-ttu-id="406f4-172">Wenn eine Benutzeranforderung beispielsweise eine Datenbankaktualisierung bewirkt, die eine Verletzung einer Einschränkung darstellt (z. B. das versuchte Löschen eines Kunden, für den noch Bestellungen ausstehen), sollten Sie den Statuscode 409 (Conflict) und einen Nachrichtentext zurückgeben, um die Ursache des Konflikts anzugeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-172">For example, if a user request causes a database update that violates a constraint (such as attempting to delete a customer that has outstanding orders), you should return status code 409 (Conflict) and a message body indicating the reason for the conflict.</span></span> <span data-ttu-id="406f4-173">Falls die Anforderung aufgrund einer anderen Bedingung nicht durchführbar ist, können Sie den Statuscode 400 (Bad Request) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-173">If some other condition renders the request unachievable, you can return status code 400 (Bad Request).</span></span> <span data-ttu-id="406f4-174">Eine vollständige Liste mit HTTP-Statuscodes finden Sie auf der W3C-Website im Thema zu den [Statuscodedefinitionen](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html).</span><span class="sxs-lookup"><span data-stu-id="406f4-174">You can find a full list of HTTP status codes on the [Status Code Definitions](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) page on the W3C website.</span></span>

<span data-ttu-id="406f4-175">Im Codebeispiel werden unterschiedliche Bedingungen abgefangen, und es wird eine entsprechende Antwort zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-175">The code example traps different conditions and returns an appropriate response.</span></span>

```csharp
[HttpDelete]
[Route("customers/{id:int}")]
public IHttpActionResult DeleteCustomer(int id)
{
    try
    {
        // Find the customer to be deleted in the repository
        var customerToDelete = repository.GetCustomer(id);

        // If there is no such customer, return an error response
        // with status code 404 (Not Found)
        if (customerToDelete == null)
        {
                return NotFound();
        }

        // Remove the customer from the repository
        // The DeleteCustomer method returns true if the customer
        // was successfully deleted
        if (repository.DeleteCustomer(id))
        {
            // Return a response message with status code 204 (No Content)
            // To indicate that the operation was successful
            return StatusCode(HttpStatusCode.NoContent);
        }
        else
        {
            // Otherwise return a 400 (Bad Request) error response
            return BadRequest(Strings.CustomerNotDeleted);
        }
    }
    catch
    {
        // If an uncaught exception occurs, return an error response
        // with status code 500 (Internal Server Error)
        return InternalServerError();
    }
}
```

> [!TIP]
> <span data-ttu-id="406f4-176">Binden Sie keine Informationen ein, die für einen Angreifer nützlich wären, der einen Eindringversuch in Ihre API startet.</span><span class="sxs-lookup"><span data-stu-id="406f4-176">Do not include information that could be useful to an attacker attempting to penetrate your API.</span></span>
  
<span data-ttu-id="406f4-177">Viele Webserver fangen Fehlerbedingungen selbst ab, bevor sie die Web-API erreichen.</span><span class="sxs-lookup"><span data-stu-id="406f4-177">Many web servers trap error conditions themselves before they reach the web API.</span></span> <span data-ttu-id="406f4-178">Wenn Sie beispielsweise die Authentifizierung für eine Website konfigurieren und der Benutzer keine richtigen Authentifizierungsinformationen angibt, sollte der Webserver mit dem Statuscode 401 (Unauthorized) antworten.</span><span class="sxs-lookup"><span data-stu-id="406f4-178">For example, if you configure authentication for a web site and the user fails to provide the correct authentication information, the web server should respond with status code 401 (Unauthorized).</span></span> <span data-ttu-id="406f4-179">Nachdem ein Client authentifiziert wurde, kann Ihr Code eigene Überprüfungen durchführen, um zu bestätigen, dass der Client auf die angeforderte Ressource zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="406f4-179">Once a client has been authenticated, your code can perform its own checks to verify that the client should be able access the requested resource.</span></span> <span data-ttu-id="406f4-180">Wenn diese Autorisierung nicht erfolgreich ist, sollten Sie den Statuscode 403 (Forbidden) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-180">If this authorization fails, you should return status code 403 (Forbidden).</span></span>

### <a name="handle-exceptions-consistently-and-log-information-about-errors"></a><span data-ttu-id="406f4-181">Einheitliches Behandeln von Ausnahmen und Protokollieren von Informationen zu Fehlern</span><span class="sxs-lookup"><span data-stu-id="406f4-181">Handle exceptions consistently and log information about errors</span></span>

<span data-ttu-id="406f4-182">Erwägen Sie zum einheitlichen Behandeln von Ausnahmen die Implementierung einer globalen Strategie zur Fehlerbehandlung in der gesamten Web-API.</span><span class="sxs-lookup"><span data-stu-id="406f4-182">To handle exceptions in a consistent manner, consider implementing a global error handling strategy across the entire web API.</span></span> <span data-ttu-id="406f4-183">Außerdem sollten Sie für eine Fehlerprotokollierung sorgen, bei der für jede Ausnahme alle Details erfasst werden. Dieses Fehlerprotokoll kann ausführliche Informationen enthalten, sofern es nicht für Clients über das Web zugänglich ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-183">You should also incorporate error logging which captures the full details of each exception; this error log can contain detailed information as long as it is not made accessible over the web to clients.</span></span>

### <a name="distinguish-between-client-side-errors-and-server-side-errors"></a><span data-ttu-id="406f4-184">Unterscheiden zwischen clientseitigen und serverseitigen Fehlern</span><span class="sxs-lookup"><span data-stu-id="406f4-184">Distinguish between client-side errors and server-side errors</span></span>

<span data-ttu-id="406f4-185">Im HTTP-Protokoll wird zwischen Fehlern unterschieden, die aufgrund der Clientanwendung auftreten (HTTP 4xx-Statuscodes), und Fehlern, die aufgrund eines Problems auf dem Server auftreten (HTTP 5xx-Statuscodes).</span><span class="sxs-lookup"><span data-stu-id="406f4-185">The HTTP protocol distinguishes between errors that occur due to the client application (the HTTP 4xx status codes), and errors that are caused by a mishap on the server (the HTTP 5xx status codes).</span></span> <span data-ttu-id="406f4-186">Achten Sie darauf, dass Sie diese Konvention in allen Fehlerantwortnachrichten befolgen.</span><span class="sxs-lookup"><span data-stu-id="406f4-186">Make sure that you respect this convention in any error response messages.</span></span>

## <a name="optimizing-client-side-data-access"></a><span data-ttu-id="406f4-187">Optimierung des clientseitigen Datenzugriffs</span><span class="sxs-lookup"><span data-stu-id="406f4-187">Optimizing client-side data access</span></span>

<span data-ttu-id="406f4-188">In einer verteilten Umgebung, z. B. mit einem Webserver und Clientanwendungen, ist das Netzwerk eines der Elemente, die am stärksten beachtet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="406f4-188">In a distributed environment such as that involving a web server and client applications, one of the primary sources of concern is the network.</span></span> <span data-ttu-id="406f4-189">Es können sich erhebliche Engpässe ergeben, und zwar vor allem, wenn eine Clientanwendung häufig Anforderungen sendet oder Daten empfängt.</span><span class="sxs-lookup"><span data-stu-id="406f4-189">This can act as a considerable bottleneck, especially if a client application is frequently sending requests or receiving data.</span></span> <span data-ttu-id="406f4-190">Daher sollten Sie versuchen, die Menge des im Netzwerk übertragenen Datenverkehrs möglichst zu verringern.</span><span class="sxs-lookup"><span data-stu-id="406f4-190">Therefore you should aim to minimize the amount of traffic that flows across the network.</span></span> <span data-ttu-id="406f4-191">Beachten Sie beim Implementieren des Codes zum Abrufen und Verwalten von Daten die folgenden Punkte:</span><span class="sxs-lookup"><span data-stu-id="406f4-191">Consider the following points when you implement the code to retrieve and maintain data:</span></span>

### <a name="support-client-side-caching"></a><span data-ttu-id="406f4-192">Unterstützen der clientseitigen Zwischenspeicherung</span><span class="sxs-lookup"><span data-stu-id="406f4-192">Support client-side caching</span></span>

<span data-ttu-id="406f4-193">Das HTTP 1.1-Protokoll unterstützt die Zwischenspeicherung auf Clients und Zwischenservern, über die eine Anforderung mit Cache-Control-Header weitergeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-193">The HTTP 1.1 protocol supports caching in clients and intermediate servers through which a request is routed by the use of the Cache-Control header.</span></span> <span data-ttu-id="406f4-194">Wenn eine Clientanwendung eine HTTP GET-Anforderung an die Web-API sendet, kann die Antwort einen Cache-Control-Header enthalten. Hiermit wird angegeben, ob die Daten im Text der Antwort vom Client oder einem Zwischenserver, über den die Anforderung weitergeleitet wurde, sicher zwischengespeichert werden können. Außerdem wird angegeben, nach welchem Zeitraum die Daten ablaufen und als veraltet angesehen werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-194">When a client application sends an HTTP GET request to the web API, the response can include a Cache-Control header that indicates whether the data in the body of the response can be safely cached by the client or an intermediate server through which the request has been routed, and for how long before it should expire and be considered out-of-date.</span></span> <span data-ttu-id="406f4-195">Das folgende Beispiel enthält eine HTTP GET-Anforderung und die dazugehörige Antwort mit einem Cache-Control-Header:</span><span class="sxs-lookup"><span data-stu-id="406f4-195">The following example shows an HTTP GET request and the corresponding response that includes a Cache-Control header:</span></span>

```HTTP
GET https://adventure-works.com/orders/2 HTTP/1.1
```

```HTTP
HTTP/1.1 200 OK
...
Cache-Control: max-age=600, private
Content-Type: text/json; charset=utf-8
Content-Length: ...
{"orderID":2,"productID":4,"quantity":2,"orderValue":10.00}
```

<span data-ttu-id="406f4-196">In diesem Beispiel wird mit dem Cache-Control-Header angegeben, dass die zurückgegebenen Daten nach 600 Sekunden ablaufen sollen. Außerdem sind sie nur für einen einzelnen Client geeignet und dürfen nicht in einem freigegebenen Cache gespeichert werden, der von anderen Clients verwendet wird (sie sind als *private* festgelegt).</span><span class="sxs-lookup"><span data-stu-id="406f4-196">In this example, the Cache-Control header specifies that the data returned should be expired after 600 seconds, and is only suitable for a single client and must not be stored in a shared cache used by other clients (it is *private*).</span></span> <span data-ttu-id="406f4-197">Im Cache-Control-Header kann anstelle von *private* auch *public* angegeben werden, damit die Daten in einem freigegebenen Cache gespeichert werden können. Oder es kann *no-store* angegeben werden, wenn die Daten vom Client **nicht** zwischengespeichert werden dürfen.</span><span class="sxs-lookup"><span data-stu-id="406f4-197">The Cache-Control header could specify *public* rather than *private* in which case the data can be stored in a shared cache, or it could specify *no-store* in which case the data must **not** be cached by the client.</span></span> <span data-ttu-id="406f4-198">Im folgenden Codebeispiel wird veranschaulicht, wie Sie einen Cache-Control-Header in einer Antwortnachricht erstellen:</span><span class="sxs-lookup"><span data-stu-id="406f4-198">The following code example shows how to construct a Cache-Control header in a response message:</span></span>

```csharp
public class OrdersController : ApiController
{
    ...
    [Route("api/orders/{id:int:min(0)}")]
    [HttpGet]
    public IHttpActionResult FindOrderByID(int id)
    {
        // Find the matching order
        Order order = ...;
        ...
        // Create a Cache-Control header for the response
        var cacheControlHeader = new CacheControlHeaderValue();
        cacheControlHeader.Private = true;
        cacheControlHeader.MaxAge = new TimeSpan(0, 10, 0);
        ...

        // Return a response message containing the order and the cache control header
        OkResultWithCaching<Order> response = new OkResultWithCaching<Order>(order, this)
        {
            CacheControlHeader = cacheControlHeader
        };
        return response;
    }
    ...
}
```

<span data-ttu-id="406f4-199">In diesem Code wird eine benutzerdefinierte `IHttpActionResult`-Klasse mit dem Namen `OkResultWithCaching` verwendet.</span><span class="sxs-lookup"><span data-stu-id="406f4-199">This code makes use of a custom `IHttpActionResult` class named `OkResultWithCaching`.</span></span> <span data-ttu-id="406f4-200">Diese Klasse ermöglicht dem Controller das Festlegen des Cacheheaderinhalts:</span><span class="sxs-lookup"><span data-stu-id="406f4-200">This class enables the controller to set the cache header contents:</span></span>

```csharp
public class OkResultWithCaching<T> : OkNegotiatedContentResult<T>
{
    public OkResultWithCaching(T content, ApiController controller)
        : base(content, controller) { }

    public OkResultWithCaching(T content, IContentNegotiator contentNegotiator, HttpRequestMessage request, IEnumerable<MediaTypeFormatter> formatters)
        : base(content, contentNegotiator, request, formatters) { }

    public CacheControlHeaderValue CacheControlHeader { get; set; }
    public EntityTagHeaderValue ETag { get; set; }

    public override async Task<HttpResponseMessage> ExecuteAsync(CancellationToken cancellationToken)
    {
        HttpResponseMessage response;
        try
        {
            response = await base.ExecuteAsync(cancellationToken);
            response.Headers.CacheControl = this.CacheControlHeader;
            response.Headers.ETag = ETag;
        }
        catch (OperationCanceledException)
        {
            response = new HttpResponseMessage(HttpStatusCode.Conflict) {ReasonPhrase = "Operation was cancelled"};
        }
        return response;
    }
}
```

> [!NOTE]
> <span data-ttu-id="406f4-201">Außerdem wird im HTTP-Protokoll auch die *no-cache*-Direktive für den Cache-Control-Header definiert.</span><span class="sxs-lookup"><span data-stu-id="406f4-201">The HTTP protocol also defines the *no-cache* directive for the Cache-Control header.</span></span> <span data-ttu-id="406f4-202">Es ist etwas verwirrend, dass diese Direktive nicht etwa „nicht zwischenspeichern“, sondern „zwischengespeicherte Informationen vor dem Zurückgeben per Server neu bewerten“ bedeutet. Die Daten können zwar zwischengespeichert werden, aber sie werden bei jeder Verwendung überprüft, um sicherzustellen, dass sie noch aktuell sind.</span><span class="sxs-lookup"><span data-stu-id="406f4-202">Rather confusingly, this directive does not mean "do not cache" but rather "revalidate the cached information with the server before returning it"; the data can still be cached, but it is checked each time it is used to ensure that it is still current.</span></span>

<span data-ttu-id="406f4-203">Für die Cacheverwaltung ist die Clientanwendung oder der Zwischenserver verantwortlich, aber bei einer richtigen Implementierung kann Bandbreite gespart und die Leistung verbessert werden. Zu diesem Zweck wird verhindert, dass keine Daten mehr abgerufen werden müssen, die bereits vorher abgerufen wurden.</span><span class="sxs-lookup"><span data-stu-id="406f4-203">Cache management is the responsibility of the client application or intermediate server, but if properly implemented it can save bandwidth and improve performance by removing the need to fetch data that has already been recently retrieved.</span></span>

<span data-ttu-id="406f4-204">Der *max-age*-Wert im Cache-Control-Header ist nur ein Anhaltspunkt und keine Garantie, dass sich die entsprechenden Daten während des angegebenen Zeitraums nicht ändern.</span><span class="sxs-lookup"><span data-stu-id="406f4-204">The *max-age* value in the Cache-Control header is only a guide and not a guarantee that the corresponding data won't change during the specified time.</span></span> <span data-ttu-id="406f4-205">Die Web-API sollte den max-age-Wert je nach der erwarteten Volatilität der Daten auf einen geeigneten Wert festlegen.</span><span class="sxs-lookup"><span data-stu-id="406f4-205">The web API should set the max-age to a suitable value depending on the expected volatility of the data.</span></span> <span data-ttu-id="406f4-206">Wenn dieser Zeitraum abgelaufen ist, sollte der Client das Objekt aus dem Cache entfernen.</span><span class="sxs-lookup"><span data-stu-id="406f4-206">When this period expires, the client should discard the object from the cache.</span></span>

> [!NOTE]
> <span data-ttu-id="406f4-207">Die meisten modernen Webbrowser unterstützen die clientseitige Zwischenspeicherung, indem Anforderungen die passenden Cache-Control-Header hinzugefügt werden und die Header der Ergebnisse (wie beschrieben) untersucht werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-207">Most modern web browsers support client-side caching by adding the appropriate cache-control headers to requests and examining the headers of the results, as described.</span></span> <span data-ttu-id="406f4-208">Einige ältere Browser speichern aber keine Werte zwischen, die über eine URL mit einer Abfragezeichenfolge zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-208">However, some older browsers will not cache the values returned from a URL that includes a query string.</span></span> <span data-ttu-id="406f4-209">Normalerweise ist dies kein Problem für benutzerdefinierte Clientanwendungen, bei denen basierend auf dem hier beschriebenen Protokoll eine eigene Strategie zur Cacheverwaltung implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-209">This is not usually an issue for custom client applications which implement their own cache management strategy based on the protocol discussed here.</span></span>
>
> <span data-ttu-id="406f4-210">Einige ältere Proxys weisen das gleiche Verhalten auf und speichern unter Umständen keine Anforderungen zwischen, die auf URLs mit Abfragezeichenfolgen basieren.</span><span class="sxs-lookup"><span data-stu-id="406f4-210">Some older proxies exhibit the same behavior and might not cache requests based on URLs with query strings.</span></span> <span data-ttu-id="406f4-211">Dies kann für benutzerdefinierte Clientanwendungen ein Problem darstellen, die über einen Proxy dieser Art eine Verbindung mit einem Webserver herstellen.</span><span class="sxs-lookup"><span data-stu-id="406f4-211">This could be an issue for custom client applications that connect to a web server through such a proxy.</span></span>

### <a name="provide-etags-to-optimize-query-processing"></a><span data-ttu-id="406f4-212">Bereitstellen von ETags zum Optimieren der Abfrageverarbeitung</span><span class="sxs-lookup"><span data-stu-id="406f4-212">Provide ETags to optimize query processing</span></span>

<span data-ttu-id="406f4-213">Wenn eine Clientanwendung ein Objekt abruft, kann die Antwortnachricht auch ein *ETag* (Entitätstag) enthalten.</span><span class="sxs-lookup"><span data-stu-id="406f4-213">When a client application retrieves an object, the response message can also include an *ETag* (Entity Tag).</span></span> <span data-ttu-id="406f4-214">Ein ETag ist eine opake Zeichenfolge, mit der die Version einer Ressource angegeben wird. Wenn eine Ressource geändert wird, wird auch das ETag geändert.</span><span class="sxs-lookup"><span data-stu-id="406f4-214">An ETag is an opaque string that indicates the version of a resource; each time a resource changes the Etag is also modified.</span></span> <span data-ttu-id="406f4-215">Dieses ETag sollte von der Clientanwendung als Teil der Daten zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-215">This ETag should be cached as part of the data by the client application.</span></span> <span data-ttu-id="406f4-216">Im folgenden Codebeispiel wird veranschaulicht, wie Sie einer HTTP GET-Anforderung ein ETag als Teil der Antwort hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="406f4-216">The following code example shows how to add an ETag as part of the response to an HTTP GET request.</span></span> <span data-ttu-id="406f4-217">In diesem Code wird die `GetHashCode`-Methode eines Objekts zum Generieren eines numerischen Werts verwendet, mit dem das Objekt identifiziert wird (Sie können diese Methode bei Bedarf außer Kraft setzen und einen eigenen Hashwert generieren, indem Sie einen Algorithmus verwenden, z. B. MD5):</span><span class="sxs-lookup"><span data-stu-id="406f4-217">This code uses the `GetHashCode` method of an object to generate a numeric value that identifies the object (you can override this method if necessary and generate your own hash using an algorithm such as MD5) :</span></span>

```csharp
public class OrdersController : ApiController
{
    ...
    public IHttpActionResult FindOrderByID(int id)
    {
        // Find the matching order
        Order order = ...;
        ...

        var hashedOrder = order.GetHashCode();
        string hashedOrderEtag = $"\"{hashedOrder}\"";
        var eTag = new EntityTagHeaderValue(hashedOrderEtag);

        // Return a response message containing the order and the cache control header
        OkResultWithCaching<Order> response = new OkResultWithCaching<Order>(order, this)
        {
            ...,
            ETag = eTag
        };
        return response;
    }
    ...
}
```

<span data-ttu-id="406f4-218">Die von der Web-API bereitgestellte Antwortnachricht sieht wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="406f4-218">The response message posted by the web API looks like this:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Cache-Control: max-age=600, private
Content-Type: text/json; charset=utf-8
ETag: "2147483648"
Content-Length: ...
{"orderID":2,"productID":4,"quantity":2,"orderValue":10.00}
```

> [!TIP]
> <span data-ttu-id="406f4-219">Aus Sicherheitsgründen sollten Sie nicht zulassen, dass sensible Daten oder Daten, die über eine authentifizierte Verbindung (HTTPS) zurückgegeben werden, zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-219">For security reasons, do not allow sensitive data or data returned over an authenticated (HTTPS) connection to be cached.</span></span>

<span data-ttu-id="406f4-220">Eine Clientanwendung kann eine nachfolgende GET-Anforderung ausgeben, um jederzeit dieselbe Ressource abzurufen. Wenn sich die Ressource geändert hat (also ein anderes ETag aufweist), sollte die zwischengespeicherte Version verworfen und die neue Version dem Cache hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-220">A client application can issue a subsequent GET request to retrieve the same resource at any time, and if the resource has changed (it has a different ETag) the cached version should be discarded and the new version added to the cache.</span></span> <span data-ttu-id="406f4-221">Falls eine Ressource umfangreich ist und für die Übertragung zurück auf den Client eine erhebliche Menge an Bandbreite erfordert, kann die Verwendung wiederholter Anforderungen zum Abrufen derselben Daten ineffizient werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-221">If a resource is large and requires a significant amount of bandwidth to transmit back to the client, repeated requests to fetch the same data can become inefficient.</span></span> <span data-ttu-id="406f4-222">Als Lösung definiert das HTTP-Protokoll den folgenden Prozess zum Optimieren von GET-Anforderungen, die Sie in einer Web-API unterstützen sollten:</span><span class="sxs-lookup"><span data-stu-id="406f4-222">To combat this, the HTTP protocol defines the following process for optimizing GET requests that you should support in a web API:</span></span>

- <span data-ttu-id="406f4-223">Der Client erstellt eine GET-Anforderung mit dem ETag für die derzeit zwischengespeicherte Version der Ressource, auf die in einem If-None-Match-HTTP-Header verwiesen wird:</span><span class="sxs-lookup"><span data-stu-id="406f4-223">The client constructs a GET request containing the ETag for the currently cached version of the resource referenced in an If-None-Match HTTP header:</span></span>

    ```HTTP
    GET https://adventure-works.com/orders/2 HTTP/1.1
    If-None-Match: "2147483648"
    ```

- <span data-ttu-id="406f4-224">Der GET-Vorgang in der Web-API ruft das aktuelle ETag für die angeforderten Daten ab („Order 2“ im obigen Beispiel) und vergleicht es mit dem Wert im If-None-Match-Header.</span><span class="sxs-lookup"><span data-stu-id="406f4-224">The GET operation in the web API obtains the current ETag for the requested data (order 2 in the above example), and compares it to the value in the If-None-Match header.</span></span>

- <span data-ttu-id="406f4-225">Wenn das aktuelle ETag für die angeforderten Daten mit dem von der Anforderung bereitgestellten ETag übereinstimmt, hat sich die Ressource nicht geändert. Die Web-API sollte also eine HTTP-Antwort mit leerem Nachrichtentext und dem Statuscode 304 (Not Modified) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-225">If the current ETag for the requested data matches the ETag provided by the request, the resource has not changed and the web API should return an HTTP response with an empty message body and a status code of 304 (Not Modified).</span></span>

- <span data-ttu-id="406f4-226">Wenn das aktuelle ETag für die angeforderten Daten nicht mit dem von der Anforderung bereitgestellten ETag übereinstimmt, haben sich die Daten geändert. Die Web-API sollte also eine HTTP-Antwort mit den neuen Daten im Nachrichtentext und dem Statuscode 200 (OK) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-226">If the current ETag for the requested data does not match the ETag provided by the request, then the data has changed and the web API should return an HTTP response with the new data in the message body and a status code of 200 (OK).</span></span>

- <span data-ttu-id="406f4-227">Falls die angeforderten Daten nicht mehr vorhanden sind, sollte die Web-API eine HTTP-Antwort mit dem Statuscode 404 (Nicht gefunden) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-227">If the requested data no longer exists then the web API should return an HTTP response with the status code of 404 (Not Found).</span></span>

- <span data-ttu-id="406f4-228">Der Client verwendet den Statuscode zum Verwalten des Cache.</span><span class="sxs-lookup"><span data-stu-id="406f4-228">The client uses the status code to maintain the cache.</span></span> <span data-ttu-id="406f4-229">Wenn sich die Daten nicht geändert haben (Statuscode 304), kann das Objekt zwischengespeichert bleiben, und die Clientanwendung sollte weiterhin diese Version des Objekts nutzen.</span><span class="sxs-lookup"><span data-stu-id="406f4-229">If the data has not changed (status code 304) then the object can remain cached and the client application should continue to use this version of the object.</span></span> <span data-ttu-id="406f4-230">Wenn sich die Daten geändert haben (Statuscode 200), sollte das zwischengespeicherte Objekt verworfen und das neue Objekt eingefügt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-230">If the data has changed (status code 200) then the cached object should be discarded and the new one inserted.</span></span> <span data-ttu-id="406f4-231">Falls die Daten nicht mehr verfügbar sind (Statuscode 404), sollte das Objekt aus dem Cache entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-231">If the data is no longer available (status code 404) then the object should be removed from the cache.</span></span>

> [!NOTE]
> <span data-ttu-id="406f4-232">Wenn der Antwortheader den Cache-Control-Header „no-store“ enthält, sollte das Objekt unabhängig vom HTTP-Statuscode aus dem Cache entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-232">If the response header contains the Cache-Control header no-store then the object should always be removed from the cache regardless of the HTTP status code.</span></span>

<span data-ttu-id="406f4-233">Im Code unten wird die erweiterte `FindOrderByID` -Methode zum Unterstützen des If-None-Match-Headers veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="406f4-233">The code below shows the `FindOrderByID` method extended to support the If-None-Match header.</span></span> <span data-ttu-id="406f4-234">Beachten Sie Folgendes: Wenn der If-None-Match-Header weggelassen wird, wird immer die angegebene Bestellung abgerufen:</span><span class="sxs-lookup"><span data-stu-id="406f4-234">Notice that if the If-None-Match header is omitted, the specified order is always retrieved:</span></span>

```csharp
public class OrdersController : ApiController
{
    [Route("api/orders/{id:int:min(0)}")]
    [HttpGet]
    public IHttpActionResult FindOrderByID(int id)
    {
        try
        {
            // Find the matching order
            Order order = ...;

            // If there is no such order then return NotFound
            if (order == null)
            {
                return NotFound();
            }

            // Generate the ETag for the order
            var hashedOrder = order.GetHashCode();
            string hashedOrderEtag = $"\"{hashedOrder}\"";

            // Create the Cache-Control and ETag headers for the response
            IHttpActionResult response;
            var cacheControlHeader = new CacheControlHeaderValue();
            cacheControlHeader.Public = true;
            cacheControlHeader.MaxAge = new TimeSpan(0, 10, 0);
            var eTag = new EntityTagHeaderValue(hashedOrderEtag);

            // Retrieve the If-None-Match header from the request (if it exists)
            var nonMatchEtags = Request.Headers.IfNoneMatch;

            // If there is an ETag in the If-None-Match header and
            // this ETag matches that of the order just retrieved,
            // then create a Not Modified response message
            if (nonMatchEtags.Count > 0 &&
                String.CompareOrdinal(nonMatchEtags.First().Tag, hashedOrderEtag) == 0)
            {
                response = new EmptyResultWithCaching()
                {
                    StatusCode = HttpStatusCode.NotModified,
                    CacheControlHeader = cacheControlHeader,
                    ETag = eTag
                };
            }
            // Otherwise create a response message that contains the order details
            else
            {
                response = new OkResultWithCaching<Order>(order, this)
                {
                    CacheControlHeader = cacheControlHeader,
                    ETag = eTag
                };
            }

            return response;
        }
        catch
        {
            return InternalServerError();
        }
    }
...
}
```

<span data-ttu-id="406f4-235">Dieses Beispiel enthält eine zusätzliche benutzerdefinierte `IHttpActionResult`-Klasse mit dem Namen `EmptyResultWithCaching`.</span><span class="sxs-lookup"><span data-stu-id="406f4-235">This example incorporates an additional custom `IHttpActionResult` class named `EmptyResultWithCaching`.</span></span> <span data-ttu-id="406f4-236">Diese Klasse dient lediglich als Wrapper für ein `HttpResponseMessage` -Objekt ohne Antworttext:</span><span class="sxs-lookup"><span data-stu-id="406f4-236">This class simply acts as a wrapper around an `HttpResponseMessage` object that does not contain a response body:</span></span>

```csharp
public class EmptyResultWithCaching : IHttpActionResult
{
    public CacheControlHeaderValue CacheControlHeader { get; set; }
    public EntityTagHeaderValue ETag { get; set; }
    public HttpStatusCode StatusCode { get; set; }
    public Uri Location { get; set; }

    public async Task<HttpResponseMessage> ExecuteAsync(CancellationToken cancellationToken)
    {
        HttpResponseMessage response = new HttpResponseMessage(StatusCode);
        response.Headers.CacheControl = this.CacheControlHeader;
        response.Headers.ETag = this.ETag;
        response.Headers.Location = this.Location;
        return response;
    }
}
```

> [!TIP]
> <span data-ttu-id="406f4-237">In diesem Beispiel wird das ETag für die Daten generiert, indem die Daten, die aus der zugrunde liegenden Datenquelle abgerufen werden, mit einem Hashwert versehen werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-237">In this example, the ETag for the data is generated by hashing the data retrieved from the underlying data source.</span></span> <span data-ttu-id="406f4-238">Wenn das ETag auf andere Art berechnet werden kann, kann der Prozess weiter optimiert werden, und die Daten müssen nur dann aus der Datenquelle abgerufen werden, wenn sie sich geändert haben.</span><span class="sxs-lookup"><span data-stu-id="406f4-238">If the ETag can be computed in some other way, then the process can be optimized further and the data only needs to be fetched from the data source if it has changed.</span></span> <span data-ttu-id="406f4-239">Dieser Ansatz ist besonders nützlich, wenn die Daten sehr umfangreich sind oder das Zugreifen auf die Datenquelle zu einer längeren Wartezeit führen kann (beispielsweise bei einer Remotedatenbank als Datenquelle).</span><span class="sxs-lookup"><span data-stu-id="406f4-239">This approach is especially useful if the data is large or accessing the data source can result in significant latency (for example, if the data source is a remote database).</span></span>

### <a name="use-etags-to-support-optimistic-concurrency"></a><span data-ttu-id="406f4-240">Verwenden von ETags zum Unterstützen der optimistischen Parallelität</span><span class="sxs-lookup"><span data-stu-id="406f4-240">Use ETags to Support Optimistic Concurrency</span></span>

<span data-ttu-id="406f4-241">Zum Ermöglichen von Updates für zuvor zwischengespeicherte Daten unterstützt das HTTP-Protokoll die Strategie der optimistischen Parallelität.</span><span class="sxs-lookup"><span data-stu-id="406f4-241">To enable updates over previously cached data, the HTTP protocol supports an optimistic concurrency strategy.</span></span> <span data-ttu-id="406f4-242">Wenn die Clientanwendung nach dem Abrufen und Zwischenspeichern einer Ressource nachfolgend eine PUT- oder DELETE-Anforderung sendet, um die Ressource zu ändern oder zu entfernen, sollte diese einen If-Match-Header mit Verweis auf das ETag enthalten.</span><span class="sxs-lookup"><span data-stu-id="406f4-242">If, after fetching and caching a resource, the client application subsequently sends a PUT or DELETE request to change or remove the resource, it should include in If-Match header that references the ETag.</span></span> <span data-ttu-id="406f4-243">Mit diesen Informationen kann die Web-API dann bestimmen, ob die Ressource bereits von einem anderen Benutzer geändert wurde, seitdem sie abgerufen wurde, und wie folgt eine geeignete Antwort zurück an die Clientanwendung senden:</span><span class="sxs-lookup"><span data-stu-id="406f4-243">The web API can then use this information to determine whether the resource has already been changed by another user since it was retrieved and send an appropriate response back to the client application as follows:</span></span>

- <span data-ttu-id="406f4-244">Der Client erstellt eine PUT-Anforderung mit den neuen Details für die Ressource und dem ETag für die derzeit zwischengespeicherte Version der Ressource, auf die in einem If-Match-HTTP-Header verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-244">The client constructs a PUT request containing the new details for the resource and the ETag for the currently cached version of the resource referenced in an If-Match HTTP header.</span></span> <span data-ttu-id="406f4-245">Das folgende Beispiel enthält eine PUT-Anforderung, mit der eine Bestellung aktualisiert wird:</span><span class="sxs-lookup"><span data-stu-id="406f4-245">The following example shows a PUT request that updates an order:</span></span>

    ```HTTP
    PUT https://adventure-works.com/orders/1 HTTP/1.1
    If-Match: "2282343857"
    Content-Type: application/x-www-form-urlencoded
    Content-Length: ...
    productID=3&quantity=5&orderValue=250
    ```

- <span data-ttu-id="406f4-246">Der PUT-Vorgang in der Web-API ruft das aktuelle ETag für die angeforderten Daten ab („Order 1“ im obigen Beispiel) und vergleicht es mit dem Wert im If-Match-Header.</span><span class="sxs-lookup"><span data-stu-id="406f4-246">The PUT operation in the web API obtains the current ETag for the requested data (order 1 in the above example), and compares it to the value in the If-Match header.</span></span>

- <span data-ttu-id="406f4-247">Wenn das aktuelle ETag für die angeforderten Daten mit dem von der Anforderung bereitgestellten ETag übereinstimmt, hat sich die Ressource nicht geändert. Die Web-API sollte also das Update durchführen und eine Nachricht mit dem HTTP-Statuscode 204 (No Content) zurückgeben, wenn der Vorgang erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-247">If the current ETag for the requested data matches the ETag provided by the request, the resource has not changed and the web API should perform the update, returning a message with HTTP status code 204 (No Content) if it is successful.</span></span> <span data-ttu-id="406f4-248">Die Antwort kann Cache-Control- und ETag-Header für die aktualisierte Version der Ressource enthalten.</span><span class="sxs-lookup"><span data-stu-id="406f4-248">The response can include Cache-Control and ETag headers for the updated version of the resource.</span></span> <span data-ttu-id="406f4-249">Die Antwort sollte immer den Location-Header enthalten, mit dem auf den URI der gerade aktualisierten Ressource verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-249">The response should always include the Location header that references the URI of the newly updated resource.</span></span>

- <span data-ttu-id="406f4-250">Wenn das aktuelle ETag für die angeforderten Daten nicht mit dem von der Anforderung bereitgestellten ETag übereinstimmt, wurden die Daten von einem anderen Benutzer geändert, seitdem sie abgerufen wurden. Die Web-API sollte eine HTTP-Antwort mit einem leeren Nachrichtentext und dem Statuscode 412 (Precondition Failed) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-250">If the current ETag for the requested data does not match the ETag provided by the request, then the data has been changed by another user since it was fetched and the web API should return an HTTP response with an empty message body and a status code of 412 (Precondition Failed).</span></span>

- <span data-ttu-id="406f4-251">Falls die zu aktualisierende Ressource nicht mehr vorhanden ist, sollte die Web-API eine HTTP-Antwort mit dem Statuscode 404 (Nicht gefunden) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-251">If the resource to be updated no longer exists then the web API should return an HTTP response with the status code of 404 (Not Found).</span></span>

- <span data-ttu-id="406f4-252">Der Client nutzt den Statuscode und die Antwortheader zum Verwalten des Cache.</span><span class="sxs-lookup"><span data-stu-id="406f4-252">The client uses the status code and response headers to maintain the cache.</span></span> <span data-ttu-id="406f4-253">Wenn die Daten aktualisiert wurden (Statuscode 204), kann das Objekt zwischengespeichert bleiben (sofern im Cache-Control-Header nicht „no-store“ angegeben ist), aber das ETag muss aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-253">If the data has been updated (status code 204) then the object can remain cached (as long as the Cache-Control header does not specify no-store) but the ETag should be updated.</span></span> <span data-ttu-id="406f4-254">Falls die Daten von einem anderen Benutzer geändert (Statuscode 412) oder Nicht gefunden wurden (Statuscode 404), sollte das zwischengespeicherte Objekt verworfen werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-254">If the data was changed by another user changed (status code 412) or not found (status code 404) then the cached object should be discarded.</span></span>

<span data-ttu-id="406f4-255">Im nächsten Codebeispiel wird eine Implementierung des PUT-Vorgangs für den Orders-Controller veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="406f4-255">The next code example shows an implementation of the PUT operation for the Orders controller:</span></span>

```csharp
public class OrdersController : ApiController
{
    [HttpPut]
    [Route("api/orders/{id:int}")]
    public IHttpActionResult UpdateExistingOrder(int id, DTOOrder order)
    {
        try
        {
            var baseUri = Constants.GetUriFromConfig();
            var orderToUpdate = this.ordersRepository.GetOrder(id);
            if (orderToUpdate == null)
            {
                return NotFound();
            }

            var hashedOrder = orderToUpdate.GetHashCode();
            string hashedOrderEtag = $"\"{hashedOrder}\"";

            // Retrieve the If-Match header from the request (if it exists)
            var matchEtags = Request.Headers.IfMatch;

            // If there is an Etag in the If-Match header and
            // this etag matches that of the order just retrieved,
            // or if there is no etag, then update the Order
            if (((matchEtags.Count > 0 &&
                String.CompareOrdinal(matchEtags.First().Tag, hashedOrderEtag) == 0)) ||
                matchEtags.Count == 0)
            {
                // Modify the order
                orderToUpdate.OrderValue = order.OrderValue;
                orderToUpdate.ProductID = order.ProductID;
                orderToUpdate.Quantity = order.Quantity;

                // Save the order back to the data store
                // ...

                // Create the No Content response with Cache-Control, ETag, and Location headers
                var cacheControlHeader = new CacheControlHeaderValue();
                cacheControlHeader.Private = true;
                cacheControlHeader.MaxAge = new TimeSpan(0, 10, 0);

                hashedOrder = order.GetHashCode();
                hashedOrderEtag = $"\"{hashedOrder}\"";
                var eTag = new EntityTagHeaderValue(hashedOrderEtag);

                var location = new Uri($"{baseUri}/{Constants.ORDERS}/{id}");
                var response = new EmptyResultWithCaching()
                {
                    StatusCode = HttpStatusCode.NoContent,
                    CacheControlHeader = cacheControlHeader,
                    ETag = eTag,
                    Location = location
                };

                return response;
            }

            // Otherwise return a Precondition Failed response
            return StatusCode(HttpStatusCode.PreconditionFailed);
        }
        catch
        {
            return InternalServerError();
        }
    }
    ...
}
```

> [!TIP]
> <span data-ttu-id="406f4-256">Die Verwendung des If-Match-Headers ist absolut optional. Wenn er weggelassen wird, versucht die Web-API stets, die angegebene Bestellung zu aktualisieren. Hierbei kann es unter Umständen vorkommen, dass ein Update eines anderen Benutzers versehentlich überschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-256">Use of the If-Match header is entirely optional, and if it is omitted the web API will always attempt to update the specified order, possibly blindly overwriting an update made by another user.</span></span> <span data-ttu-id="406f4-257">Geben Sie zur Vermeidung von Problemen aufgrund von verloren gegangenen Updates immer einen If-Match-Header an.</span><span class="sxs-lookup"><span data-stu-id="406f4-257">To avoid problems due to lost updates, always provide an If-Match header.</span></span>

## <a name="handling-large-requests-and-responses"></a><span data-ttu-id="406f4-258">Behandlung umfangreicher Anforderungen und Antworten</span><span class="sxs-lookup"><span data-stu-id="406f4-258">Handling large requests and responses</span></span>

<span data-ttu-id="406f4-259">Wenn eine Clientanwendung Anforderungen ausgibt, bei denen Daten gesendet oder empfangen werden, kann es vorkommen, dass diese mehrere Megabyte groß (oder noch größer) sind.</span><span class="sxs-lookup"><span data-stu-id="406f4-259">There may be occasions when a client application needs to issue requests that send or receive data that may be several megabytes (or bigger) in size.</span></span> <span data-ttu-id="406f4-260">Das Warten auf den Abschluss der Übertragung dieser Datenmenge kann dazu führen, dass die Clientanwendung nicht mehr reagiert.</span><span class="sxs-lookup"><span data-stu-id="406f4-260">Waiting while this amount of data is transmitted could cause the client application to become unresponsive.</span></span> <span data-ttu-id="406f4-261">Beachten Sie die folgenden Punkte, wenn Sie Anforderungen behandeln müssen, die größere Datenmengen enthalten:</span><span class="sxs-lookup"><span data-stu-id="406f4-261">Consider the following points when you need to handle requests that include significant amounts of data:</span></span>

### <a name="optimize-requests-and-responses-that-involve-large-objects"></a><span data-ttu-id="406f4-262">Optimieren von Anforderungen und Antworten, die große Objekte enthalten</span><span class="sxs-lookup"><span data-stu-id="406f4-262">Optimize requests and responses that involve large objects</span></span>

<span data-ttu-id="406f4-263">Einige Ressourcen können große Objekte sein oder große Felder enthalten, z. B. Grafiken oder andere Arten von Binärdaten.</span><span class="sxs-lookup"><span data-stu-id="406f4-263">Some resources may be large objects or include large fields, such as graphics images or other types of binary data.</span></span> <span data-ttu-id="406f4-264">Eine Web-API sollte das Streamen unterstützen, um das Hoch- und Herunterladen dieser Ressourcen zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="406f4-264">A web API should support streaming to enable optimized uploading and downloading of these resources.</span></span>

<span data-ttu-id="406f4-265">Das HTTP-Protokoll stellt das Verfahren für die segmentierte Transfercodierung bereit, mit dem große Datenobjekte zurück auf einen Client gestreamt werden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-265">The HTTP protocol provides the chunked transfer encoding mechanism to stream large data objects back to a client.</span></span> <span data-ttu-id="406f4-266">Wenn der Client eine HTTP GET-Anforderung für ein großes Objekt sendet, kann die Web-API die Antwort in einzelnen *Segmenten* („Chunks“) über eine HTTP-Verbindung zurücksenden.</span><span class="sxs-lookup"><span data-stu-id="406f4-266">When the client sends an HTTP GET request for a large object, the web API can send the reply back in piecemeal *chunks* over an HTTP connection.</span></span> <span data-ttu-id="406f4-267">Die Länge der Daten in der Antwort ist am Anfang unter Umständen noch nicht bekannt (ggf. werden sie erst generiert). Der Server, auf dem die Web-API gehostet wird, sollte also mit jedem Segment eine Antwortnachricht senden, für die der Header „Transfer-Encoding: Chunked“ (und kein Content-Length-Header) angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-267">The length of the data in the reply may not be known initially (it might be generated), so the server hosting the web API should send a response message with each chunk that specifies the Transfer-Encoding: Chunked header rather than a Content-Length header.</span></span> <span data-ttu-id="406f4-268">Die Clientanwendung kann die einzelnen Segmente empfangen, um die vollständige Antwort zusammenzusetzen.</span><span class="sxs-lookup"><span data-stu-id="406f4-268">The client application can receive each chunk in turn to build up the complete response.</span></span> <span data-ttu-id="406f4-269">Die Datenübertragung ist abgeschlossen, wenn der Server das letzte Segment mit einer Größe von null zurücksendet.</span><span class="sxs-lookup"><span data-stu-id="406f4-269">The data transfer completes when the server sends back a final chunk with zero size.</span></span>

<span data-ttu-id="406f4-270">Es ist vorstellbar, dass eine einzelne Anforderung zu einem riesigen Objekt führt, für das Ressourcen in erheblichem Umfang verbraucht werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-270">A single request could conceivably result in a massive object that consumes considerable resources.</span></span> <span data-ttu-id="406f4-271">Wenn die Web-API während des Streamingvorgangs ermittelt, dass die Menge der Daten in einer Anforderung nicht mehr akzeptabel ist, kann sie den Vorgang abbrechen und eine Antwortnachricht mit dem Statuscode 413 (Request Entity Too Large) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-271">If, during the streaming process, the web API determines that the amount of data in a request has exceeded some acceptable bounds, it can abort the operation and return a response message with status code 413 (Request Entity Too Large).</span></span>

<span data-ttu-id="406f4-272">Sie können die Größe von großen Objekten, die über das Netzwerk übertragen werden, per HTTP-Komprimierung verringern.</span><span class="sxs-lookup"><span data-stu-id="406f4-272">You can minimize the size of large objects transmitted over the network by using HTTP compression.</span></span> <span data-ttu-id="406f4-273">Dieser Ansatz ist hilfreich, um die Menge des Datenverkehrs im Netzwerk und die damit verbundene Netzwerklatenz zu reduzieren. Der Nachteil ist, dass auf dem Client und dem Server, auf dem die Web-API gehostet wird, zusätzlicher Verarbeitungsaufwand anfällt.</span><span class="sxs-lookup"><span data-stu-id="406f4-273">This approach helps to reduce the amount of network traffic and the associated network latency, but at the cost of requiring additional processing at the client and the server hosting the web API.</span></span> <span data-ttu-id="406f4-274">Eine Clientanwendung, die den Eingang von komprimierten Daten erwartet, kann beispielsweise den Anforderungsheader „Accept-Encoding: gzip“ einfügen (auch andere Algorithmen zur Datenkomprimierung können angegeben werden).</span><span class="sxs-lookup"><span data-stu-id="406f4-274">For example, a client application that expects to receive compressed data can include an Accept-Encoding: gzip request header (other data compression algorithms can also be specified).</span></span> <span data-ttu-id="406f4-275">Wenn der Server die Komprimierung unterstützt, sollte die Antwort den Inhalt im gzip-Format im Nachrichtentext sowie den Antwortheader „Content-Encoding: gzip“ enthalten.</span><span class="sxs-lookup"><span data-stu-id="406f4-275">If the server supports compression it should respond with the content held in gzip format in the message body and the Content-Encoding: gzip response header.</span></span>

<span data-ttu-id="406f4-276">Sie können die codierte Komprimierung mit dem Streaming kombinieren. Komprimieren Sie die Daten vor dem Streamen, und geben Sie die gzip-Inhaltscodierung und die segmentierte Transfercodierung in den Nachrichtenheadern an.</span><span class="sxs-lookup"><span data-stu-id="406f4-276">You can combine encoded compression with streaming; compress the data first before streaming it, and specify the gzip content encoding and chunked transfer encoding in the message headers.</span></span> <span data-ttu-id="406f4-277">Beachten Sie außerdem, dass einige Webserver (z. B. Internet Information Server) so konfiguriert werden können, dass HTTP-Antworten automatisch komprimiert werden. Dies gilt unabhängig davon, ob die Web-API die Daten komprimiert oder nicht.</span><span class="sxs-lookup"><span data-stu-id="406f4-277">Also note that some web servers (such as Internet Information Server) can be configured to automatically compress HTTP responses regardless of whether the web API compresses the data or not.</span></span>

### <a name="implement-partial-responses-for-clients-that-do-not-support-asynchronous-operations"></a><span data-ttu-id="406f4-278">Implementieren von Teilantworten für Clients, die keine asynchronen Vorgänge unterstützen</span><span class="sxs-lookup"><span data-stu-id="406f4-278">Implement partial responses for clients that do not support asynchronous operations</span></span>

<span data-ttu-id="406f4-279">Als Alternative zum asynchronen Streaming kann eine Clientanwendung Daten für große Objekte explizit in Segmenten anfordern. Diese werden als Teilantworten bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="406f4-279">As an alternative to asynchronous streaming, a client application can explicitly request data for large objects in chunks, known as partial responses.</span></span> <span data-ttu-id="406f4-280">Die Clientanwendung sendet eine HTTP HEAD-Anforderung, um Informationen zum Objekt abzurufen.</span><span class="sxs-lookup"><span data-stu-id="406f4-280">The client application sends an HTTP HEAD request to obtain information about the object.</span></span> <span data-ttu-id="406f4-281">Wenn die Web-API Teilantworten unterstützt, sollte sie auf die HEAD-Anforderung mit einer Antwortnachricht reagieren, die einen Accept-Ranges-Header und einen Content-Length-Header zum Angeben der Gesamtgröße des Objekts enthält. Der Text der Nachricht sollte aber leer sein.</span><span class="sxs-lookup"><span data-stu-id="406f4-281">If the web API supports partial responses if should respond to the HEAD request with a response message that contains an Accept-Ranges header and a Content-Length header that indicates the total size of the object, but the body of the message should be empty.</span></span> <span data-ttu-id="406f4-282">Die Clientanwendung kann diese Informationen verwenden, um eine Reihe von GET-Anforderungen zu erstellen, mit denen ein Bereich für den zu empfangenden Bytebereich angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-282">The client application can use this information to construct a series of GET requests that specify a range of bytes to receive.</span></span> <span data-ttu-id="406f4-283">Die Web-API sollte eine Antwortnachricht mit dem HTTP-Status 206 (Partial Content), einen Content-Length-Header zum Angeben des tatsächlichen Betrags an Daten im Text der Antwortnachricht und einen Content-Range-Header zurückgeben, mit dem angegeben wird, welchen Teil des Objekts (z. B. Bytes 4.000 bis 8.000) diese Daten darstellen.</span><span class="sxs-lookup"><span data-stu-id="406f4-283">The web API should return a response message with HTTP status 206 (Partial Content), a Content-Length header that specifies the actual amount of data included in the body of the response message, and a Content-Range header that indicates which part (such as bytes 4000 to 8000) of the object this data represents.</span></span>

<span data-ttu-id="406f4-284">HTTP HEAD-Anforderungen und Teilantworten werden unter [API-Design][api-design] ausführlicher beschrieben.</span><span class="sxs-lookup"><span data-stu-id="406f4-284">HTTP HEAD requests and partial responses are described in more detail in [API Design][api-design].</span></span>

### <a name="avoid-sending-unnecessary-100-continue-status-messages-in-client-applications"></a><span data-ttu-id="406f4-285">Vermeiden des Sendens von unnötigen 100-Continue-Statusnachrichten in Clientanwendungen</span><span class="sxs-lookup"><span data-stu-id="406f4-285">Avoid sending unnecessary 100-Continue status messages in client applications</span></span>

<span data-ttu-id="406f4-286">Eine Clientanwendung, die eine große Datenmenge an einen Server senden möchte, kann auch zuerst ermitteln, ob auf dem Server die Bereitschaft zum Annehmen der Anforderung besteht.</span><span class="sxs-lookup"><span data-stu-id="406f4-286">A client application that is about to send a large amount of data to a server may determine first whether the server is actually willing to accept the request.</span></span> <span data-ttu-id="406f4-287">Vor dem Senden der Daten kann die Clientanwendung eine HTTP-Anforderung mit dem Header „Expect: 100-Continue“, einem Content-Length-Header zum Angeben der Größe für die Daten und einem leeren Nachrichtentext übermitteln.</span><span class="sxs-lookup"><span data-stu-id="406f4-287">Prior to sending the data, the client application can submit an HTTP request with an Expect: 100-Continue header, a Content-Length header that indicates the size of the data, but an empty message body.</span></span> <span data-ttu-id="406f4-288">Wenn der Server zum Behandeln der Anforderung bereit ist, sollte er mit einer Nachricht antworten, in der der HTTP-Status 100 (Continue) angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-288">If the server is willing to handle the request, it should respond with a message that specifies the HTTP status 100 (Continue).</span></span> <span data-ttu-id="406f4-289">Die Clientanwendung kann den Vorgang dann fortsetzen und die gesamte Anforderung senden, einschließlich der Daten im Nachrichtentext.</span><span class="sxs-lookup"><span data-stu-id="406f4-289">The client application can then proceed and send the complete request including the data in the message body.</span></span>

<span data-ttu-id="406f4-290">Wenn Sie einen Dienst per IIS hosten, erkennt der Treiber „HTTP.sys“ automatisch Header vom Typ „Expect: 100-Continue“ und behandelt sie, bevor Anforderungen an Ihre Webanwendung übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-290">If you are hosting a service by using IIS, the HTTP.sys driver automatically detects and handles Expect: 100-Continue headers before passing requests to your web application.</span></span> <span data-ttu-id="406f4-291">Dies bedeutet, dass Sie diese Header wahrscheinlich nicht in Ihrem Anwendungscode sehen, und Sie können davon ausgehen, dass per IIS bereits alle Nachrichten herausgefiltert wurden, die als ungeeignet oder zu groß angesehen werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-291">This means that you are unlikely to see these headers in your application code, and you can assume that IIS has already filtered any messages that it deems to be unfit or too large.</span></span>

<span data-ttu-id="406f4-292">Wenn Sie Clientanwendungen mit dem .NET Framework erstellen, werden für alle POST- und PUT-Nachrichten standardmäßig zuerst Nachrichten mit Headern vom Typ „Expect: 100-Continue“ gesendet.</span><span class="sxs-lookup"><span data-stu-id="406f4-292">If you are building client applications by using the .NET Framework, then all POST and PUT messages will first send messages with Expect: 100-Continue headers by default.</span></span> <span data-ttu-id="406f4-293">Wie auf der Serverseite auch, wird der Prozess vom .NET Framework transparent behandelt.</span><span class="sxs-lookup"><span data-stu-id="406f4-293">As with the server-side, the process is handled transparently by the .NET Framework.</span></span> <span data-ttu-id="406f4-294">Dieser Prozess führt aber dazu, dass jede POST- und PUT-Anforderung zwei Roundtrips zum Server verursacht. Dies gilt auch für kleine Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="406f4-294">However, this process results in each POST and PUT request causing two round-trips to the server, even for small requests.</span></span> <span data-ttu-id="406f4-295">Wenn von Ihrer Anwendung keine Anforderungen mit großen Datenmengen gesendet werden, können Sie dieses Feature deaktivieren. Verwenden Sie hierzu die `ServicePointManager`-Klasse, um `ServicePoint`-Objekte in der Clientanwendung zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="406f4-295">If your application is not sending requests with large amounts of data, you can disable this feature by using the `ServicePointManager` class to create `ServicePoint` objects in the client application.</span></span> <span data-ttu-id="406f4-296">Ein `ServicePoint`-Objekt behandelt die Verbindungen, die der Client basierend auf dem Schema und den Hostfragmenten von URIs, mit denen Ressourcen auf dem Server identifiziert werden, mit einem Server herstellt.</span><span class="sxs-lookup"><span data-stu-id="406f4-296">A `ServicePoint` object handles the connections that the client makes to a server based on the scheme and host fragments of URIs that identify resources on the server.</span></span> <span data-ttu-id="406f4-297">Sie können die `Expect100Continue`-Eigenschaft des `ServicePoint`-Objekts dann auf „false“ festlegen.</span><span class="sxs-lookup"><span data-stu-id="406f4-297">You can then set the `Expect100Continue` property of the `ServicePoint` object to false.</span></span> <span data-ttu-id="406f4-298">Alle nachfolgenden POST- und PUT-Anforderungen, die vom Client über einen URI gesendet werden, der mit dem Schema und den Hostfragmenten des `ServicePoint`-Objekts übereinstimmt, werden ohne Header vom Typ „Expect: 100-Continue“ gesendet.</span><span class="sxs-lookup"><span data-stu-id="406f4-298">All subsequent POST and PUT requests made by the client through a URI that matches the scheme and host fragments of the `ServicePoint` object will be sent without Expect: 100-Continue headers.</span></span> <span data-ttu-id="406f4-299">Im folgenden Code wird veranschaulicht, wie Sie ein `ServicePoint`-Objekt konfigurieren, mit dem alle an URIs gesendeten Anforderungen mit dem Schema `http` und dem Host `www.contoso.com` konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-299">The following code shows how to configure a `ServicePoint` object that configures all requests sent to URIs with a scheme of `http` and a host of `www.contoso.com`.</span></span>

```csharp
Uri uri = new Uri("https://www.contoso.com/");
ServicePoint sp = ServicePointManager.FindServicePoint(uri);
sp.Expect100Continue = false;
```

<span data-ttu-id="406f4-300">Sie können auch die statische `Expect100Continue`-Eigenschaft der `ServicePointManager`-Klasse festlegen, um den Standardwert dieser Eigenschaft für alle nachfolgend erstellten [ServicePoint]](/dotnet/api/system.net.servicepoint)-Objekte anzugeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-300">You can also set the static `Expect100Continue` property of the `ServicePointManager` class to specify the default value of this property for all subsequently created [ServicePoint]](/dotnet/api/system.net.servicepoint) objects.</span></span>

### <a name="support-pagination-for-requests-that-may-return-large-numbers-of-objects"></a><span data-ttu-id="406f4-301">Unterstützen der Paginierung für Anforderungen, bei denen ggf. eine große Zahl von Objekten zurückgegeben wird</span><span class="sxs-lookup"><span data-stu-id="406f4-301">Support pagination for requests that may return large numbers of objects</span></span>

<span data-ttu-id="406f4-302">Wenn eine Auflistung eine große Zahl von Ressourcen enthält, kann das Ausgeben einer GET-Anforderung an den entsprechenden URI zu erheblichem Verarbeitungsaufwand auf dem Hostserver der Web-API führen. Dies kann die Leistung beeinträchtigen und einen signifikanten Anstieg des Netzwerkdatenverkehrs und somit längere Wartezeiten nach sich ziehen.</span><span class="sxs-lookup"><span data-stu-id="406f4-302">If a collection contains a large number of resources, issuing a GET request to the corresponding URI could result in significant processing on the server hosting the web API affecting performance, and generate a significant amount of network traffic resulting in increased latency.</span></span>

<span data-ttu-id="406f4-303">Zum Behandeln dieser Fälle sollte die Web-API Abfragezeichenfolgen unterstützen, mit denen die Clientanwendung Anforderungen verfeinern oder Daten in besser verwaltbaren, diskreten Blöcken (bzw. Seiten) abrufen kann.</span><span class="sxs-lookup"><span data-stu-id="406f4-303">To handle these cases, the web API should support query strings that enable the client application to refine requests or fetch data in more manageable, discrete blocks (or pages).</span></span> <span data-ttu-id="406f4-304">Im folgenden Code wird die `GetAllOrders`-Methode im `Orders`-Controller veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="406f4-304">The code below shows the `GetAllOrders` method in the `Orders` controller.</span></span> <span data-ttu-id="406f4-305">Mit dieser Methode werden die Details der Bestellungen abgerufen.</span><span class="sxs-lookup"><span data-stu-id="406f4-305">This method retrieves the details of orders.</span></span> <span data-ttu-id="406f4-306">Wenn für diese Methode keine Einschränkungen vorliegen, kann darüber ggf. eine große Datenmenge zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-306">If this method was unconstrained, it could conceivably return a large amount of data.</span></span> <span data-ttu-id="406f4-307">Mit den Parametern `limit` und `offset` soll der Umfang der Daten auf eine kleinere Teilmenge reduziert werden. In diesem Fall sind dies standardmäßig nur die ersten zehn Bestellungen:</span><span class="sxs-lookup"><span data-stu-id="406f4-307">The `limit` and `offset` parameters are intended to reduce the volume of data to a smaller subset, in this case only the first 10 orders by default:</span></span>

```csharp
public class OrdersController : ApiController
{
    ...
    [Route("api/orders")]
    [HttpGet]
    public IEnumerable<Order> GetAllOrders(int limit=10, int offset=0)
    {
        // Find the number of orders specified by the limit parameter
        // starting with the order specified by the offset parameter
        var orders = ...
        return orders;
    }
    ...
}
```

<span data-ttu-id="406f4-308">Eine Clientanwendung kann eine Anforderung senden, um 30 Bestellungen ab Offset 50 abzurufen, indem der URI `https://www.adventure-works.com/api/orders?limit=30&offset=50` verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-308">A client application can issue a request to retrieve 30 orders starting at offset 50 by using the URI `https://www.adventure-works.com/api/orders?limit=30&offset=50`.</span></span>

> [!TIP]
> <span data-ttu-id="406f4-309">Sie sollten verhindern, dass Clientanwendungen Abfragezeichenfolgen angeben können, die zu einem URI mit einer Länge von mehr als 2.000 Zeichen führen.</span><span class="sxs-lookup"><span data-stu-id="406f4-309">Avoid enabling client applications to specify query strings that result in a URI that is more than 2000 characters long.</span></span> <span data-ttu-id="406f4-310">Viele Webclients und -server können keine URIs dieser Länge verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="406f4-310">Many web clients and servers cannot handle URIs that are this long.</span></span>

## <a name="maintaining-responsiveness-scalability-and-availability"></a><span data-ttu-id="406f4-311">Aufrechterhaltung der Reaktionsfähigkeit, Skalierbarkeit und Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="406f4-311">Maintaining responsiveness, scalability, and availability</span></span>

<span data-ttu-id="406f4-312">Eine Web-API kann von vielen Clientanwendungen, die weltweit an den unterschiedlichsten Orten ausgeführt werden, gemeinsam verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-312">The same web API might be utilized by many client applications running anywhere in the world.</span></span> <span data-ttu-id="406f4-313">Es ist wichtig sicherzustellen, dass für die Implementierung der Web-API Folgendes gilt: Auch bei einer hohen Auslastung bleibt die Reaktionsfähigkeit erhalten, sie kann zur Unterstützung stark variierender Workloads skaliert werden, und für Clients, auf denen unternehmenskritische Vorgänge ausgeführt werden, wird die Verfügbarkeit garantiert.</span><span class="sxs-lookup"><span data-stu-id="406f4-313">It is important to ensure that the web API is implemented to maintain responsiveness under a heavy load, to be scalable to support a highly varying workload, and to guarantee availability for clients that perform business-critical operations.</span></span> <span data-ttu-id="406f4-314">Beachten Sie die folgenden Punkte, wenn Sie ermitteln möchten, wie diese Anforderungen erfüllt werden können:</span><span class="sxs-lookup"><span data-stu-id="406f4-314">Consider the following points when determining how to meet these requirements:</span></span>

### <a name="provide-asynchronous-support-for-long-running-requests"></a><span data-ttu-id="406f4-315">Bereitstellen von asynchroner Unterstützung für Anforderungen mit langer Ausführungsdauer</span><span class="sxs-lookup"><span data-stu-id="406f4-315">Provide asynchronous support for long-running requests</span></span>

<span data-ttu-id="406f4-316">Eine Anforderung, deren Verarbeitung unter Umständen sehr lange dauern kann, sollte durchgeführt werden, ohne den übermittelnden Client zu blockieren.</span><span class="sxs-lookup"><span data-stu-id="406f4-316">A request that might take a long time to process should be performed without blocking the client that submitted the request.</span></span> <span data-ttu-id="406f4-317">Die Web-API kann einige erste Überprüfungen durchführen, um die Anforderung zu validieren, eine separate Aufgabe zum Ausführen der Arbeit initiieren und dann eine Antwortnachricht mit dem HTTP-Code 202 (Accepted) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-317">The web API can perform some initial checking to validate the request, initiate a separate task to perform the work, and then return a response message with HTTP code 202 (Accepted).</span></span> <span data-ttu-id="406f4-318">Die Aufgabe kann asynchron im Rahmen der Web-API-Verarbeitung ausgeführt oder auf eine Hintergrundaufgabe verlagert werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-318">The task could run asynchronously as part of the web API processing, or it could be offloaded to a background task.</span></span>

<span data-ttu-id="406f4-319">Außerdem sollte die Web-API über ein Verfahren zum Zurückgeben der Ergebnisse einer Verarbeitung an die Clientanwendung verfügen.</span><span class="sxs-lookup"><span data-stu-id="406f4-319">The web API should also provide a mechanism to return the results of the processing to the client application.</span></span> <span data-ttu-id="406f4-320">Hierzu können Sie einen Abrufmechanismus für Clientanwendungen bereitstellen, um regelmäßig abzufragen, ob die Verarbeitung abgeschlossen ist, und das Ergebnis abzurufen. Sie können die Web-API auch so einrichten, dass nach Abschluss des Vorgangs eine Benachrichtigung gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-320">You can achieve this by providing a polling mechanism for client applications to periodically query whether the processing has finished and obtain the result, or enabling the web API to send a notification when the operation has completed.</span></span>

<span data-ttu-id="406f4-321">Sie können einen einfachen Abrufmechanismus implementieren, indem Sie einen *polling*-URI angeben, der als virtuelle Ressource fungiert. Gehen Sie hierbei wie folgt vor:</span><span class="sxs-lookup"><span data-stu-id="406f4-321">You can implement a simple polling mechanism by providing a *polling* URI that acts as a virtual resource using the following approach:</span></span>

1. <span data-ttu-id="406f4-322">Die Clientanwendung sendet die erste Anfrage an die Web-API.</span><span class="sxs-lookup"><span data-stu-id="406f4-322">The client application sends the initial request to the web API.</span></span>
2. <span data-ttu-id="406f4-323">Die Web-API speichert Informationen zur Anforderung in einer Tabelle, die im Tabellenspeicher oder im Microsoft Azure Cache vorgehalten wird, und generiert einen eindeutigen Schlüssel für diesen Eintrag, z. B. in Form einer GUID.</span><span class="sxs-lookup"><span data-stu-id="406f4-323">The web API stores information about the request in a table held in table storage or Microsoft Azure Cache, and generates a unique key for this entry, possibly in the form of a GUID.</span></span>
3. <span data-ttu-id="406f4-324">Von der Web-API wird die Verarbeitung als separate Aufgabe initiiert.</span><span class="sxs-lookup"><span data-stu-id="406f4-324">The web API initiates the processing as a separate task.</span></span> <span data-ttu-id="406f4-325">Die Web-API zeichnet den Status der Aufgabe in der Tabelle als *Running* auf.</span><span class="sxs-lookup"><span data-stu-id="406f4-325">The web API records the state of the task in the table as *Running*.</span></span>
4. <span data-ttu-id="406f4-326">Die Web-API gibt eine Antwortnachricht mit dem HTTP-Statuscode 202 (Accepted) und der GUID des Tabelleneintrags im Text der Nachricht zurück.</span><span class="sxs-lookup"><span data-stu-id="406f4-326">The web API returns a response message with HTTP status code 202 (Accepted), and the GUID of the table entry in the body of the message.</span></span>
5. <span data-ttu-id="406f4-327">Wenn die Aufgabe abgeschlossen ist, speichert die Web-API die Ergebnisse in der Tabelle und legt den Status der Aufgabe auf *Complete* fest.</span><span class="sxs-lookup"><span data-stu-id="406f4-327">When the task has completed, the web API stores the results in the table, and sets the state of the task to *Complete*.</span></span> <span data-ttu-id="406f4-328">Beachten Sie Folgendes: Wenn die Durchführung der Aufgabe nicht erfolgreich ist, kann die Web-API auch Informationen zum Fehler speichern und den Status auf *Failed* festlegen.</span><span class="sxs-lookup"><span data-stu-id="406f4-328">Note that if the task fails, the web API could also store information about the failure and set the status to *Failed*.</span></span>
6. <span data-ttu-id="406f4-329">Während der Ausführung der Aufgabe kann der Client mit seiner eigenen Verarbeitung fortfahren.</span><span class="sxs-lookup"><span data-stu-id="406f4-329">While the task is running, the client can continue performing its own processing.</span></span> <span data-ttu-id="406f4-330">Er kann regelmäßig eine Anforderung an den URI */polling/{guid}* senden. Hierbei steht *{guid}* für die GUID, die von der Web-API in der 202-Antwortnachricht zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-330">It can periodically send a request to the URI */polling/{guid}* where *{guid}* is the GUID returned in the 202 response message by the web API.</span></span>
7. <span data-ttu-id="406f4-331">Die Web-API am URI */polling/{guid}* fragt den Status der entsprechenden Aufgabe in der Tabelle ab und gibt eine Antwortnachricht mit dem HTTP-Statuscode 200 (OK) und dem Status zurück (*Running*, *Complete* oder *Failed*).</span><span class="sxs-lookup"><span data-stu-id="406f4-331">The web API at the */polling/{guid}* URI queries the state of the corresponding task in the table and returns a response message with HTTP status code 200 (OK) containing this state (*Running*, *Complete*, or *Failed*).</span></span> <span data-ttu-id="406f4-332">Wenn die Aufgabe abgeschlossen ist oder nicht erfolgreich war, kann die Antwortnachricht auch die Ergebnisse der Verarbeitung oder Informationen enthalten, die zur Ursache des Fehlers verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="406f4-332">If the task has completed or failed, the response message can also include the results of the processing or any information available about the reason for the failure.</span></span>

<span data-ttu-id="406f4-333">Optionen zur Implementierung von Benachrichtigungen:</span><span class="sxs-lookup"><span data-stu-id="406f4-333">Options for implementing notifications include:</span></span>

- <span data-ttu-id="406f4-334">Verwenden Sie ein Azure Notification Hub, um asynchrone Antworten per Pushvorgang an Clientanwendungen zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="406f4-334">Using an Azure Notification Hub to push asynchronous responses to client applications.</span></span> <span data-ttu-id="406f4-335">Weitere Informationen finden Sie unter [Azure Notification Hubs – Benachrichtigen von Benutzern über .NET-Back-End](/azure/notification-hubs/notification-hubs-aspnet-backend-windows-dotnet-wns-notification/).</span><span class="sxs-lookup"><span data-stu-id="406f4-335">For more information, see [Azure Notification Hubs Notify Users](/azure/notification-hubs/notification-hubs-aspnet-backend-windows-dotnet-wns-notification/).</span></span>
- <span data-ttu-id="406f4-336">Verwenden Sie das Comet-Modell, um eine dauerhafte Netzwerkverbindung zwischen dem Client und dem Hostserver der Web-API aufrechtzuerhalten. Nutzen Sie diese Verbindung, um Nachrichten vom Server zurück an den Client zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="406f4-336">Using the Comet model to retain a persistent network connection between the client and the server hosting the web API, and using this connection to push messages from the server back to the client.</span></span> <span data-ttu-id="406f4-337">Eine Beispiellösung ist im Artikel [Erstellen einer einfachen Comet-Anwendung in Microsoft .NET Framework](https://msdn.microsoft.com/magazine/jj891053.aspx) des MSDN-Magazins enthalten.</span><span class="sxs-lookup"><span data-stu-id="406f4-337">The MSDN magazine article [Building a Simple Comet Application in the Microsoft .NET Framework](https://msdn.microsoft.com/magazine/jj891053.aspx) describes an example solution.</span></span>
- <span data-ttu-id="406f4-338">Verwenden Sie SignalR, um Daten über eine dauerhafte Netzwerkverbindung in Echtzeit vom Webserver auf den Client zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="406f4-338">Using SignalR to push data in real-time from the web server to the client over a persistent network connection.</span></span> <span data-ttu-id="406f4-339">SignalR ist für ASP.NET-Webanwendungen als NuGet-Paket verfügbar.</span><span class="sxs-lookup"><span data-stu-id="406f4-339">SignalR is available for ASP.NET web applications as a NuGet package.</span></span> <span data-ttu-id="406f4-340">Weitere Informationen finden Sie auf der Website [ASP.NET SignalR](https://www.asp.net/signalr).</span><span class="sxs-lookup"><span data-stu-id="406f4-340">You can find more information on the [ASP.NET SignalR](https://www.asp.net/signalr) website.</span></span>

### <a name="ensure-that-each-request-is-stateless"></a><span data-ttu-id="406f4-341">Sicherstellen, dass jede Anforderung zustandslos ist</span><span class="sxs-lookup"><span data-stu-id="406f4-341">Ensure that each request is stateless</span></span>

<span data-ttu-id="406f4-342">Jede Anforderung sollte als atomarisch angesehen werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-342">Each request should be considered atomic.</span></span> <span data-ttu-id="406f4-343">Es sollten keine Abhängigkeiten zwischen der Anforderung einer Clientanwendung und allen nachfolgenden Anforderungen bestehen, die von demselben Client übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-343">There should be no dependencies between one request made by a client application and any subsequent requests submitted by the same client.</span></span> <span data-ttu-id="406f4-344">Dieser Ansatz ist in Bezug auf die Skalierbarkeit hilfreich. Instanzen des Webdiensts können auf einer Reihe von Servern bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-344">This approach assists in scalability; instances of the web service can be deployed on a number of servers.</span></span> <span data-ttu-id="406f4-345">Clientanforderungen können an all diese Instanzen geleitet werden, und die Ergebnisse sollten immer gleich sein.</span><span class="sxs-lookup"><span data-stu-id="406f4-345">Client requests can be directed at any of these instances and the results should always be the same.</span></span> <span data-ttu-id="406f4-346">Die Verfügbarkeit wird aus einem ähnlichen Grund verbessert. Wenn ein Webserver ausfällt, können Anforderungen an eine andere Instanz weitergeleitet werden (per Azure Traffic Manager), während der Server neu gestartet wird. Dies hat keine negativen Auswirkungen auf Clientanwendungen.</span><span class="sxs-lookup"><span data-stu-id="406f4-346">It also improves availability for a similar reason; if a web server fails requests can be routed to another instance (by using Azure Traffic Manager) while the server is restarted with no ill effects on client applications.</span></span>

### <a name="track-clients-and-implement-throttling-to-reduce-the-chances-of-dos-attacks"></a><span data-ttu-id="406f4-347">Nachverfolgen von Clients und Implementieren der Drosselung, um die Gefahr von DoS-Angriffen zu verringern</span><span class="sxs-lookup"><span data-stu-id="406f4-347">Track clients and implement throttling to reduce the chances of DOS attacks</span></span>

<span data-ttu-id="406f4-348">Wenn ein bestimmter Client innerhalb eines bestimmten Zeitraums eine große Zahl von Anforderungen sendet, kann dies zu einer Monopolisierung des Diensts führen und die Leistung anderer Clients beeinträchtigen.</span><span class="sxs-lookup"><span data-stu-id="406f4-348">If a specific client makes a large number of requests within a given period of time it might monopolize the service and affect the performance of other clients.</span></span> <span data-ttu-id="406f4-349">Zur Beseitigung dieses Problems kann eine Web-API die Aufrufe von Clientanwendungen überwachen, indem entweder die IP-Adresse aller eingehenden Anforderungen nachverfolgt wird oder indem jeder authentifizierte Zugriff protokolliert wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-349">To mitigate this issue, a web API can monitor calls from client applications either by tracking the IP address of all incoming requests or by logging each authenticated access.</span></span> <span data-ttu-id="406f4-350">Sie können diese Informationen nutzen, um den Zugriff auf Ressourcen zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="406f4-350">You can use this information to limit resource access.</span></span> <span data-ttu-id="406f4-351">Wenn ein Client einen festgelegten Grenzwert überschreitet, kann die Web-API eine Antwortnachricht mit dem Status 503 (Service Unavailable) zurückgeben und einen Retry-After-Header einfügen. Mit diesem Header wird angegeben, wann der Client die nächste Anforderung senden kann, ohne dass diese abgelehnt wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-351">If a client exceeds a defined limit, the web API can return a response message with status 503 (Service Unavailable) and include a Retry-After header that specifies when the client can send the next request without it being declined.</span></span> <span data-ttu-id="406f4-352">Diese Strategie kann die Gefahr eines DoS-Angriffs (Denial Of Service) über Clients in Verbindung mit einem Zusammenbruch des Systems verringern.</span><span class="sxs-lookup"><span data-stu-id="406f4-352">This strategy can help to reduce the chances of a Denial Of Service (DOS) attack from a set of clients stalling the system.</span></span>

### <a name="manage-persistent-http-connections-carefully"></a><span data-ttu-id="406f4-353">Sorgfältiges Verwalten von dauerhaften HTTP-Verbindungen</span><span class="sxs-lookup"><span data-stu-id="406f4-353">Manage persistent HTTP connections carefully</span></span>

<span data-ttu-id="406f4-354">Das HTTP-Protokoll unterstützt dauerhafte HTTP-Verbindungen, sofern sie verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="406f4-354">The HTTP protocol supports persistent HTTP connections where they are available.</span></span> <span data-ttu-id="406f4-355">Mit der HTTP 1.0-Spezifikation wurde der Connection:Keep-Alive-Header hinzugefügt. Hiermit kann eine Clientanwendung für den Server angeben, dass dieselbe Verbindung zum Senden nachfolgender Anforderungen genutzt werden kann, anstatt neue Verbindungen zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="406f4-355">The HTTP 1.0 specificiation added the Connection:Keep-Alive header that enables a client application to indicate to the server that it can use the same connection to send subsequent requests rather than opening new ones.</span></span> <span data-ttu-id="406f4-356">Die Verbindung wird automatisch geschlossen, wenn der Client die Verbindung nicht innerhalb eines vom Host definierten Zeitraums wiederverwendet.</span><span class="sxs-lookup"><span data-stu-id="406f4-356">The connection closes automatically if the client does not reuse the connection within a period defined by the host.</span></span> <span data-ttu-id="406f4-357">Dies ist das Standardverhalten in HTTP 1.1, das von Azure-Diensten verwendet wird. Es ist also nicht erforderlich, Keep-Alive-Header in Nachrichten einzufügen.</span><span class="sxs-lookup"><span data-stu-id="406f4-357">This behavior is the default in HTTP 1.1 as used by Azure services, so there is no need to include Keep-Alive headers in messages.</span></span>

<span data-ttu-id="406f4-358">Das Offenhalten einer Verbindung kann die Reaktionsfähigkeit verbessern, indem die Latenz und Netzwerküberlastung reduziert wird. Aber es kann sich negativ auf die Skalierbarkeit auswirken, wenn nicht benötigte Verbindungen länger als erforderlich geöffnet bleiben, da das gleichzeitige Herstellen von Verbindungen für andere Clients eingeschränkt wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-358">Keeping a connection open can help to improve responsiveness by reducing latency and network congestion, but it can be detrimental to scalability by keeping unnecessary connections open for longer than required, limiting the ability of other concurrent clients to connect.</span></span> <span data-ttu-id="406f4-359">Außerdem kann es sich auf die Akkulaufzeit auswirken, wenn die Clientanwendung auf einem Mobilgerät ausgeführt wird. Falls die Anwendung nur gelegentlich Anforderungen an den Server sendet, kann das Aufrechterhalten einer offenen Verbindung dazu führen, dass der Akku schneller leer ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-359">It can also affect battery life if the client application is running on a mobile device; if the application only makes occasional requests to the server, maintaining an open connection can cause the battery to drain more quickly.</span></span> <span data-ttu-id="406f4-360">Um sicherzustellen, dass eine Verbindung unter HTTP 1.1 nicht dauerhaft eingerichtet wird, kann der Client einen Connection:Close-Header in Nachrichten einfügen, um das Standardverhalten außer Kraft zu setzen.</span><span class="sxs-lookup"><span data-stu-id="406f4-360">To ensure that a connection is not made persistent with HTTP 1.1, the client can include a Connection:Close header with messages to override the default behavior.</span></span> <span data-ttu-id="406f4-361">Wenn ein Server eine sehr große Anzahl von Clients behandelt, kann er einen Connection:Close-Header in Antwortnachrichten einfügen, mit dem die Verbindung geschlossen wird und Serverressourcen gespart werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-361">Similarly, if a server is handling a very large number of clients it can include a Connection:Close header in response messages which should close the connection and save server resources.</span></span>

> [!NOTE]
> <span data-ttu-id="406f4-362">Dauerhafte HTTP-Verbindungen sind ein rein optionales Feature zum Reduzieren des Netzwerkaufwands, der mit dem wiederholten Einrichten eines Kommunikationskanals verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-362">Persistent HTTP connections are a purely optional feature to reduce the network overhead associated with repeatedly establishing a communications channel.</span></span> <span data-ttu-id="406f4-363">Weder die Web-API noch die Clientanwendung sollten davon abhängig sein, dass eine dauerhafte HTTP-Verbindung verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-363">Neither the web API nor the client application should depend on a persistent HTTP connection being available.</span></span> <span data-ttu-id="406f4-364">Nutzen Sie keine dauerhaften HTTP-Verbindungen, um Benachrichtigungssysteme im Comet-Stil zu implementieren. Stattdessen sollten Sie Sockets (oder WebSockets, falls verfügbar) auf TCP-Ebene verwenden.</span><span class="sxs-lookup"><span data-stu-id="406f4-364">Do not use persistent HTTP connections to implement Comet-style notification systems; instead you should utilize sockets (or websockets if available) at the TCP layer.</span></span> <span data-ttu-id="406f4-365">Beachten Sie außerdem Folgendes: Der Nutzen von Keep-Alive-Headern ist eingeschränkt, wenn eine Clientanwendung mit einem Server über einen Proxy kommuniziert. Nur die Verbindung mit dem Client und dem Proxy ist dauerhafter Art.</span><span class="sxs-lookup"><span data-stu-id="406f4-365">Finally, note Keep-Alive headers are of limited use if a client application communicates with a server via a proxy; only the connection with the client and the proxy will be persistent.</span></span>

## <a name="publishing-and-managing-a-web-api"></a><span data-ttu-id="406f4-366">Veröffentlichung und Verwaltung einer Web-API</span><span class="sxs-lookup"><span data-stu-id="406f4-366">Publishing and managing a web API</span></span>

<span data-ttu-id="406f4-367">Die Web-API muss in einer Hostumgebung bereitgestellt werden, um sie für Clientanwendungen verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="406f4-367">To make a web API available for client applications, the web API must be deployed to a host environment.</span></span> <span data-ttu-id="406f4-368">Bei dieser Umgebung handelt es sich normalerweise um einen Webserver, aber es kann auch eine andere Art von Hostprozess sein.</span><span class="sxs-lookup"><span data-stu-id="406f4-368">This environment is typically a web server, although it may be some other type of host process.</span></span> <span data-ttu-id="406f4-369">Berücksichtigen Sie beim Veröffentlichen einer Web-API die folgenden Punkte:</span><span class="sxs-lookup"><span data-stu-id="406f4-369">You should consider the following points when publishing a web API:</span></span>

- <span data-ttu-id="406f4-370">Alle Anforderungen müssen authentifiziert und autorisiert werden, und die Zugriffssteuerung muss im angemessenen Umfang durchgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-370">All requests must be authenticated and authorized, and the appropriate level of access control must be enforced.</span></span>
- <span data-ttu-id="406f4-371">Eine kommerzielle Web-API kann in Bezug auf die Reaktionszeiten verschiedenen Qualitätsgarantien unterliegen.</span><span class="sxs-lookup"><span data-stu-id="406f4-371">A commercial web API might be subject to various quality guarantees concerning response times.</span></span> <span data-ttu-id="406f4-372">Es ist wichtig sicherzustellen, dass die Hostumgebung skalierbar ist, wenn die Auslastung im Laufe der Zeit erheblich variieren kann.</span><span class="sxs-lookup"><span data-stu-id="406f4-372">It is important to ensure that host environment is scalable if the load can vary significantly over time.</span></span>
- <span data-ttu-id="406f4-373">Es kann erforderlich sein, Anforderungen aus Gründen der Monetarisierung zu messen.</span><span class="sxs-lookup"><span data-stu-id="406f4-373">It may be necessary to meter requests for monetization purposes.</span></span>
- <span data-ttu-id="406f4-374">Es kann erforderlich sein, den Fluss des Datenverkehrs an die Web-API zu regulieren und für bestimmte Clients, die ihr Kontingent ausgeschöpft haben, eine Drosselung zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="406f4-374">It might be necessary to regulate the flow of traffic to the web API, and implement throttling for specific clients that have exhausted their quotas.</span></span>
- <span data-ttu-id="406f4-375">Unter Umständen ist es gesetzlich vorgeschrieben, alle Anforderungen und Antworten zu protokollieren und zu überwachen.</span><span class="sxs-lookup"><span data-stu-id="406f4-375">Regulatory requirements might mandate logging and auditing of all requests and responses.</span></span>
- <span data-ttu-id="406f4-376">Zum Sicherstellen der Verfügbarkeit kann es erforderlich sein, die Integrität des Servers zu überwachen, auf dem die Web-API gehostet wird, und ihn bei Bedarf neu zu starten.</span><span class="sxs-lookup"><span data-stu-id="406f4-376">To ensure availability, it may be necessary to monitor the health of the server hosting the web API and restart it if necessary.</span></span>

<span data-ttu-id="406f4-377">Es ist hilfreich, diese Probleme von den technischen Problemen in Bezug auf die Implementierung der Web-API abkoppeln zu können.</span><span class="sxs-lookup"><span data-stu-id="406f4-377">It is useful to be able to decouple these issues from the technical issues concerning the implementation of the web API.</span></span> <span data-ttu-id="406f4-378">Erwägen Sie deshalb das Erstellen einer [Fassade](https://en.wikipedia.org/wiki/Facade_pattern), die als separater Prozess ausgeführt wird und Anforderungen an die Web-API umleitet.</span><span class="sxs-lookup"><span data-stu-id="406f4-378">For this reason, consider creating a [façade](https://en.wikipedia.org/wiki/Facade_pattern), running as a separate process and that routes requests to the web API.</span></span> <span data-ttu-id="406f4-379">Mit dieser Fassade können die Verwaltungsvorgänge bereitgestellt und geprüfte Anforderungen an die Web-API weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-379">The façade can provide the management operations and forward validated requests to the web API.</span></span> <span data-ttu-id="406f4-380">Die Nutzung einer Fassade ist ferner mit vielen funktionellen Vorteilen verbunden, z. B.:</span><span class="sxs-lookup"><span data-stu-id="406f4-380">Using a façade can also bring many functional advantages, including:</span></span>

- <span data-ttu-id="406f4-381">Sie dient als Integrationspunkt für mehrere Web-APIs.</span><span class="sxs-lookup"><span data-stu-id="406f4-381">Acting as an integration point for multiple web APIs.</span></span>
- <span data-ttu-id="406f4-382">Sie ermöglicht das Transformieren von Nachrichten und das Übersetzen von Kommunikationsprotokollen für Clients, die mit unterschiedlicher Technologie erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="406f4-382">Transforming messages and translating communications protocols for clients built by using varying technologies.</span></span>
- <span data-ttu-id="406f4-383">Sie ermöglicht das Zwischenspeichern von Anforderungen und Antworten, um die Auslastung des Servers zu reduzieren, auf dem die Web-API gehostet wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-383">Caching requests and responses to reduce load on the server hosting the web API.</span></span>

## <a name="testing-a-web-api"></a><span data-ttu-id="406f4-384">Testen einer Web-API</span><span class="sxs-lookup"><span data-stu-id="406f4-384">Testing a web API</span></span>

<span data-ttu-id="406f4-385">Eine Web-API sollte so gründlich wie jede andere Software getestet werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-385">A web API should be tested as thoroughly as any other piece of software.</span></span> <span data-ttu-id="406f4-386">Es empfiehlt sich ggf., Komponententests zu erstellen, um die Funktion zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="406f4-386">You should consider creating unit tests to validate the functionality.</span></span>

<span data-ttu-id="406f4-387">Die Art einer Web-API bringt eigene zusätzliche Anforderungen in Bezug auf die Überprüfung der korrekten Funktionsweise mit sich.</span><span class="sxs-lookup"><span data-stu-id="406f4-387">The nature of a web API brings its own additional requirements to verify that it operates correctly.</span></span> <span data-ttu-id="406f4-388">Achten Sie besonders auf die folgenden Aspekte:</span><span class="sxs-lookup"><span data-stu-id="406f4-388">You should pay particular attention to the following aspects:</span></span>

- <span data-ttu-id="406f4-389">Testen Sie alle Routen, um zu überprüfen, ob dabei die richtigen Vorgänge aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-389">Test all routes to verify that they invoke the correct operations.</span></span> <span data-ttu-id="406f4-390">Achten Sie besonders darauf, ob der HTTP-Statuscode 405 (Method Not Allowed) unerwartet zurückgegeben wird. Dies kann auf eine fehlende Übereinstimmung zwischen einer Route und den HTTP-Methoden (GET, POST, PUT, DELETE) hindeuten, die auf dieser Route genutzt werden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-390">Be especially aware of HTTP status code 405 (Method Not Allowed) being returned unexpectedly as this can indicate a mismatch between a route and the HTTP methods (GET, POST, PUT, DELETE) that can be dispatched to that route.</span></span>

    <span data-ttu-id="406f4-391">Senden Sie HTTP-Anforderungen an Routen, die dafür keine Unterstützung aufweisen, z. B. per Übermittlung einer POST-Anforderung an eine bestimmte Ressource (POST-Anforderungen sollten nur an Ressourcenauflistungen gesendet werden).</span><span class="sxs-lookup"><span data-stu-id="406f4-391">Send HTTP requests to routes that do not support them, such as submitting a POST request to a specific resource (POST requests should only be sent to resource collections).</span></span> <span data-ttu-id="406f4-392">In diesen Fällen *muss* die einzig gültige Antwort der Statuscode 405 (Not Allowed) sein.</span><span class="sxs-lookup"><span data-stu-id="406f4-392">In these cases, the only valid response *should* be status code 405 (Not Allowed).</span></span>

- <span data-ttu-id="406f4-393">Vergewissern Sie sich, dass alle Routen richtig geschützt sind und geeignete Authentifizierungs- und Autorisierungsüberprüfungen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="406f4-393">Verify that all routes are protected properly and are subject to the appropriate authentication and authorization checks.</span></span>

  > [!NOTE]
  > <span data-ttu-id="406f4-394">Für einige Aspekte der Sicherheit, z. B. die Benutzerauthentifizierung, ist meist nicht die Web-API verantwortlich, sondern die Hostumgebung. Es ist trotzdem erforderlich, Sicherheitstests in den Bereitstellungsprozess einzubinden.</span><span class="sxs-lookup"><span data-stu-id="406f4-394">Some aspects of security such as user authentication are most likely to be the responsibility of the host environment rather than the web API, but it is still necessary to include security tests as part of the deployment process.</span></span>
  >
  >

- <span data-ttu-id="406f4-395">Testen Sie die Ausnahmebehandlung, die von den einzelnen Vorgängen durchgeführt wird, und stellen Sie sicher, dass eine passende und aussagekräftige HTTP-Antwort zurück an die Clientanwendung übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-395">Test the exception handling performed by each operation and verify that an appropriate and meaningful HTTP response is passed back to the client application.</span></span>

- <span data-ttu-id="406f4-396">Achten Sie darauf, dass Anforderungs- und Antwortnachrichten richtig formatiert sind.</span><span class="sxs-lookup"><span data-stu-id="406f4-396">Verify that request and response messages are well-formed.</span></span> <span data-ttu-id="406f4-397">Wenn eine HTTP POST-Anforderung beispielsweise die Daten für eine neue Ressource im Format „x-www-form-urlencoded“ enthält, müssen Sie bestätigen, dass der entsprechende Vorgang die Daten richtig analysiert, die Ressourcen erstellt und eine Antwort mit den Details der neuen Ressource zurückgibt, einschließlich des richtigen Location-Headers.</span><span class="sxs-lookup"><span data-stu-id="406f4-397">For example, if an HTTP POST request contains the data for a new resource in x-www-form-urlencoded format, confirm that the corresponding operation correctly parses the data, creates the resources, and returns a response containing the details of the new resource, including the correct Location header.</span></span>

- <span data-ttu-id="406f4-398">Überprüfen Sie alle Links und URIs in Antwortnachrichten.</span><span class="sxs-lookup"><span data-stu-id="406f4-398">Verify all links and URIs in response messages.</span></span> <span data-ttu-id="406f4-399">Beispielsweise sollte eine HTTP POST-Nachricht den URI der neu erstellten Ressource zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-399">For example, an HTTP POST message should return the URI of the newly-created resource.</span></span> <span data-ttu-id="406f4-400">Alle HATEOAS-Links müssen gültig sein.</span><span class="sxs-lookup"><span data-stu-id="406f4-400">All HATEOAS links should be valid.</span></span>

- <span data-ttu-id="406f4-401">Stellen Sie sicher, dass jeder Vorgang für unterschiedliche Eingabekombinationen die richtigen Statuscodes zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="406f4-401">Ensure that each operation returns the correct status codes for different combinations of input.</span></span> <span data-ttu-id="406f4-402">Beispiel: </span><span class="sxs-lookup"><span data-stu-id="406f4-402">For example:</span></span>

  - <span data-ttu-id="406f4-403">Wenn eine Abfrage erfolgreich ist, sollte der Vorgang den Statuscode 200 (OK) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-403">If a query is successful, it should return status code 200 (OK)</span></span>
  - <span data-ttu-id="406f4-404">Wenn eine Ressource nicht gefunden wird, sollte der Vorgang den HTTP-Statuscode 404 (Nicht gefunden) zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="406f4-404">If a resource is not found, the operation should return HTTP status code 404 (Not Found).</span></span>
  - <span data-ttu-id="406f4-405">Wenn der Client eine Anforderung sendet, mit der eine Ressource erfolgreich gelöscht wird, sollte der Statuscode 204 (No Content) lauten.</span><span class="sxs-lookup"><span data-stu-id="406f4-405">If the client sends a request that successfully deletes a resource, the status code should be 204 (No Content).</span></span>
  - <span data-ttu-id="406f4-406">Wenn der Client eine Anforderung sendet, mit der eine neue Ressource erstellt wird, sollte der Statuscode 201 (Created) lauten.</span><span class="sxs-lookup"><span data-stu-id="406f4-406">If the client sends a request that creates a new resource, the status code should be 201 (Created).</span></span>

<span data-ttu-id="406f4-407">Achten Sie auf unerwartete Antwortstatuscodes im Bereich 5xx.</span><span class="sxs-lookup"><span data-stu-id="406f4-407">Watch out for unexpected response status codes in the 5xx range.</span></span> <span data-ttu-id="406f4-408">Diese Nachrichten werden normalerweise vom Server gemeldet, um anzugeben, dass eine gültige Anforderung nicht erfüllt werden konnte.</span><span class="sxs-lookup"><span data-stu-id="406f4-408">These messages are usually reported by the host server to indicate that it was unable to fulfill a valid request.</span></span>

- <span data-ttu-id="406f4-409">Testen Sie die unterschiedlichen Anforderungsheaderkombinationen, die von einer Clientanwendung angegeben werden können, und stellen Sie sicher, dass die Web-API in Antwortnachrichten die erwarteten Informationen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="406f4-409">Test the different request header combinations that a client application can specify and ensure that the web API returns the expected information in response messages.</span></span>

- <span data-ttu-id="406f4-410">Testen Sie Abfragezeichenfolgen.</span><span class="sxs-lookup"><span data-stu-id="406f4-410">Test query strings.</span></span> <span data-ttu-id="406f4-411">Wenn ein Vorgang optionale Parameter verwenden kann (z. B. Paginierungsanforderungen), sollten Sie die unterschiedlichen Kombinationen und die Reihenfolge von Parametern testen.</span><span class="sxs-lookup"><span data-stu-id="406f4-411">If an operation can take optional parameters (such as pagination requests), test the different combinations and order of parameters.</span></span>

- <span data-ttu-id="406f4-412">Vergewissern Sie sich, dass asynchrone Vorgänge erfolgreich abgeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-412">Verify that asynchronous operations complete successfully.</span></span> <span data-ttu-id="406f4-413">Wenn die Web-API das Streamen für Anforderungen unterstützt, die große binäre Objekte zurückgeben (z. B. Video oder Audio), sollten Sie sicherstellen, dass Clientanforderungen beim Streamen der Daten nicht blockiert werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-413">If the web API supports streaming for requests that return large binary objects (such as video or audio), ensure that client requests are not blocked while the data is streamed.</span></span> <span data-ttu-id="406f4-414">Wenn die Web-API das Abrufen für Datenänderungsvorgänge mit langer Ausführungsdauer implementiert, sollten Sie sicherstellen, dass die Vorgänge ihren Status während des Ablaufs richtig melden.</span><span class="sxs-lookup"><span data-stu-id="406f4-414">If the web API implements polling for long-running data modification operations, verify that that the operations report their status correctly as they proceed.</span></span>

<span data-ttu-id="406f4-415">Außerdem sollten Sie Leistungstests erstellen und ausführen, um zu überprüfen, ob die Web-API auch in Notfällen zufriedenstellend arbeitet.</span><span class="sxs-lookup"><span data-stu-id="406f4-415">You should also create and run performance tests to check that the web API operates satisfactorily under duress.</span></span> <span data-ttu-id="406f4-416">Sie können mit Visual Studio Ultimate ein Projekt zum Testen der Webleistung und Auslastung erstellen.</span><span class="sxs-lookup"><span data-stu-id="406f4-416">You can build a web performance and load test project by using Visual Studio Ultimate.</span></span> <span data-ttu-id="406f4-417">Weitere Informationen finden Sie unter [Run performance tests on an application before a release](https://msdn.microsoft.com/library/dn250793.aspx) (Ausführen von Leistungstests für eine Anwendung vor der Veröffentlichung).</span><span class="sxs-lookup"><span data-stu-id="406f4-417">For more information, see [Run performance tests on an application before a release](https://msdn.microsoft.com/library/dn250793.aspx).</span></span>

## <a name="using-azure-api-management"></a><span data-ttu-id="406f4-418">Verwenden von Azure API Management</span><span class="sxs-lookup"><span data-stu-id="406f4-418">Using Azure API Management</span></span>

<span data-ttu-id="406f4-419">Erwägen Sie in Azure die Verwendung von [Azue API Management](/azure/api-management//services/api-management/) zum Veröffentlichen und Verwalten einer Web-API.</span><span class="sxs-lookup"><span data-stu-id="406f4-419">On Azure, consider using [Azue API Management](/azure/api-management//services/api-management/) to publish and manage a web API.</span></span> <span data-ttu-id="406f4-420">Mit dieser Funktion können Sie einen Dienst generieren, der als Fassade für mindestens eine Web-API dient.</span><span class="sxs-lookup"><span data-stu-id="406f4-420">Using this facility, you can generate a service that acts as a façade for one or more web APIs.</span></span> <span data-ttu-id="406f4-421">Bei diesem Dienst handelt es sich selbst um einen skalierbaren Webdienst, den Sie mit dem Azure-Verwaltungsportal erstellen und konfigurieren können.</span><span class="sxs-lookup"><span data-stu-id="406f4-421">The service is itself a scalable web service that you can create and configure by using the Azure Management portal.</span></span> <span data-ttu-id="406f4-422">Sie können diesen Dienst verwenden, um eine Web-API wie folgt zu veröffentlichen und zu verwalten:</span><span class="sxs-lookup"><span data-stu-id="406f4-422">You can use this service to publish and manage a web API as follows:</span></span>

1. <span data-ttu-id="406f4-423">Stellen Sie die Web-API auf einer Website, in einem Azure-Clouddienst oder auf einem virtuellen Azure-Computer bereit.</span><span class="sxs-lookup"><span data-stu-id="406f4-423">Deploy the web API to a website, Azure cloud service, or Azure virtual machine.</span></span>

2. <span data-ttu-id="406f4-424">Verbinden Sie den API Management-Dienst mit der Web-API.</span><span class="sxs-lookup"><span data-stu-id="406f4-424">Connect the API management service to the web API.</span></span> <span data-ttu-id="406f4-425">Anforderungen, die an die URL der Verwaltungs-API gesendet werden, werden den URIs in der Web-API zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="406f4-425">Requests sent to the URL of the management API are mapped to URIs in the web API.</span></span> <span data-ttu-id="406f4-426">Ein und derselbe API Management-Dienst kann Anforderungen an mehr als eine Web-API weiterleiten.</span><span class="sxs-lookup"><span data-stu-id="406f4-426">The same API management service can route requests to more than one web API.</span></span> <span data-ttu-id="406f4-427">So können Sie mehrere Web-APIs zu einem zentralen Management-Dienst zusammenfassen.</span><span class="sxs-lookup"><span data-stu-id="406f4-427">This enables you to aggregate multiple web APIs into a single management service.</span></span> <span data-ttu-id="406f4-428">Außerdem kann von mehr als einem API Management-Dienst auf dieselbe Web-API verwiesen werden, wenn Sie die Funktionalität, die für unterschiedliche Anwendungen verfügbar ist, einschränken oder partitionieren müssen.</span><span class="sxs-lookup"><span data-stu-id="406f4-428">Similarly, the same web API can be referenced from more than one API management service if you need to restrict or partition the functionality available to different applications.</span></span>

     > [!NOTE]
     > <span data-ttu-id="406f4-429">Die URIs in HATEOAS-Links, die als Teil der Antwort für HTTP GET-Anforderungen generiert werden, sollten auf die URL des API Management-Diensts verweisen, und nicht auf den Webserver, auf dem die Web-API gehostet wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-429">The URIs in HATEOAS links generated as part of the response for HTTP GET requests should reference the URL of the API management service and not the web server hosting the web API.</span></span>

3. <span data-ttu-id="406f4-430">Geben Sie für jede Web-API die HTTP-Vorgänge an, die von der Web-API zusammen mit den optionalen Parametern, die ein Vorgang als Eingabe verwenden kann, verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-430">For each web API, specify the HTTP operations that the web API exposes together with any optional parameters that an operation can take as input.</span></span> <span data-ttu-id="406f4-431">Sie können auch konfigurieren, ob der API Management-Dienst die von der Web-API empfangene Antwort zwischenspeichern soll, um wiederholte Anforderungen für dieselben Daten zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="406f4-431">You can also configure whether the API management service should cache the response received from the web API to optimize repeated requests for the same data.</span></span> <span data-ttu-id="406f4-432">Zeichnen Sie die Details der HTTP-Antworten auf, die von den einzelnen Vorgängen generiert werden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-432">Record the details of the HTTP responses that each operation can generate.</span></span> <span data-ttu-id="406f4-433">Diese Informationen werden zum Generieren der Dokumentation für Entwickler verwendet. Es ist also wichtig, dass sie richtig und vollständig sind.</span><span class="sxs-lookup"><span data-stu-id="406f4-433">This information is used to generate documentation for developers, so it is important that it is accurate and complete.</span></span>

    <span data-ttu-id="406f4-434">Sie können Vorgänge entweder manuell definieren, indem Sie die Assistenten im Azure-Verwaltungsportal verwenden, oder Sie können sie aus einer Datei importieren, in der die Definitionen im WADL- oder Swagger-Format enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="406f4-434">You can either define operations manually using the wizards provided by the Azure Management portal, or you can import them from a file containing the definitions in WADL or Swagger format.</span></span>

4. <span data-ttu-id="406f4-435">Konfigurieren Sie die Sicherheitseinstellungen zwischen dem API Management-Dienst und dem Webserver, auf dem die Web-API gehostet wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-435">Configure the security settings for communications between the API management service and the web server hosting the web API.</span></span> <span data-ttu-id="406f4-436">Der API Management-Dienst unterstützt derzeit die Standardauthentifizierung und die wechselseitige Authentifizierung mit Zertifikaten sowie die OAuth 2.0-Benutzerautorisierung.</span><span class="sxs-lookup"><span data-stu-id="406f4-436">The API management service currently supports Basic authentication and mutual authentication using certificates, and OAuth 2.0 user authorization.</span></span>

5. <span data-ttu-id="406f4-437">Erstellen Sie ein Produkt.</span><span class="sxs-lookup"><span data-stu-id="406f4-437">Create a product.</span></span> <span data-ttu-id="406f4-438">Ein Produkt ist die Einheit der Veröffentlichung. Sie fügen die Web-APIs, die Sie zuvor mit dem Management-Dienst verbunden haben, dem Produkt hinzu.</span><span class="sxs-lookup"><span data-stu-id="406f4-438">A product is the unit of publication; you add the web APIs that you previously connected to the management service to the product.</span></span> <span data-ttu-id="406f4-439">Wenn das Produkt veröffentlicht wird, werden die Web-APIs für Entwickler verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="406f4-439">When the product is published, the web APIs become available to developers.</span></span>

    > [!NOTE]
    > <span data-ttu-id="406f4-440">Vor dem Veröffentlichen eines Produkts können Sie auch Benutzergruppen definieren, die Zugriff auf das Produkt haben, und diesen Gruppen Benutzer hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="406f4-440">Prior to publishing a product, you can also define user-groups that can access the product and add users to these groups.</span></span> <span data-ttu-id="406f4-441">So haben Sie die Kontrolle darüber, welche Entwickler und Anwendungen die Web-API verwenden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-441">This gives you control over the developers and applications that can use the web API.</span></span> <span data-ttu-id="406f4-442">Wenn eine Web-API genehmigt werden muss, müssen Entwickler eine Anforderung an den Produktadministrator senden, bevor sie Zugriff erhalten können.</span><span class="sxs-lookup"><span data-stu-id="406f4-442">If a web API is subject to approval, prior to being able to access it a developer must send a request to the product administrator.</span></span> <span data-ttu-id="406f4-443">Der Administrator kann dem Entwickler den Zugriff gewähren oder verweigern.</span><span class="sxs-lookup"><span data-stu-id="406f4-443">The administrator can grant or deny access to the developer.</span></span> <span data-ttu-id="406f4-444">Außerdem können vorhandene Entwickler blockiert werden, wenn sich die Umstände ändern.</span><span class="sxs-lookup"><span data-stu-id="406f4-444">Existing developers can also be blocked if circumstances change.</span></span>

6. <span data-ttu-id="406f4-445">Konfigurieren Sie Richtlinien für jede Web-API.</span><span class="sxs-lookup"><span data-stu-id="406f4-445">Configure policies for each web API.</span></span> <span data-ttu-id="406f4-446">Mit Richtlinien werden beispielsweise folgende Aspekte geregelt: ob domänenübergreifende Aufrufe zulässig sind, wie Clients authentifiziert werden, ob zwischen den Datenformaten XML und JSON transparent konvertiert werden soll, ob Aufrufe für einen bestimmten IP-Bereich beschränkt werden sollen, Verwendungskontingente und ob die Aufrufrate begrenzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="406f4-446">Policies govern aspects such as whether cross-domain calls should be allowed, how to authenticate clients, whether to convert between XML and JSON data formats transparently, whether to restrict calls from a given IP range, usage quotas, and whether to limit the call rate.</span></span> <span data-ttu-id="406f4-447">Richtlinien können global über das gesamte Produkt hinweg, für eine einzelne Web-API in einem Produkt oder für einzelne Vorgänge in einer Web-API angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-447">Policies can be applied globally across the entire product, for a single web API in a product, or for individual operations in a web API.</span></span>

<span data-ttu-id="406f4-448">Weitere Informationen finden Sie in der [Dokumentation zu API Management](/azure/api-management/).</span><span class="sxs-lookup"><span data-stu-id="406f4-448">For more information, see the [API Management Documentation](/azure/api-management/).</span></span>

> [!TIP]
> <span data-ttu-id="406f4-449">Azure stellt den Azure Traffic Manager bereit, mit dem Sie das Failover und den Lastenausgleich implementieren und die Latenz über mehrere Instanzen einer Website hinweg, die an unterschiedlichen geografischen Orten gehostet wird, reduzieren können.</span><span class="sxs-lookup"><span data-stu-id="406f4-449">Azure provides the Azure Traffic Manager which enables you to implement failover and load-balancing, and reduce latency across multiple instances of a web site hosted in different geographic locations.</span></span> <span data-ttu-id="406f4-450">Sie können den Azure Traffic Manager zusammen mit dem API Management-Dienst verwenden. Der API Management-Dienst kann Anforderungen über den Azure Traffic Manager an die Instanzen einer Website weiterleiten.</span><span class="sxs-lookup"><span data-stu-id="406f4-450">You can use Azure Traffic Manager in conjunction with the API Management Service; the API Management Service can route requests to instances of a web site through Azure Traffic Manager.</span></span> <span data-ttu-id="406f4-451">Weitere Informationen finden Sie unter [Traffic Manager-Methoden für das Datenverkehrsrouting](/azure/traffic-manager/traffic-manager-routing-methods/).</span><span class="sxs-lookup"><span data-stu-id="406f4-451">For more information, see [Traffic Manager routing Methods](/azure/traffic-manager/traffic-manager-routing-methods/).</span></span>
>
> <span data-ttu-id="406f4-452">Wenn Sie benutzerdefinierte DNS-Namen für Ihre Websites verwenden, sollten Sie in dieser Struktur den richtigen CNAME-Eintrag für jede Website konfigurieren, damit jeweils auf den DNS-Namen der Azure Traffic Manager-Website verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-452">In this structure, if you are using custom DNS names for your web sites, you should configure the appropriate CNAME record for each web site to point to the DNS name of the Azure Traffic Manager web site.</span></span>

## <a name="supporting-client-side-developers"></a><span data-ttu-id="406f4-453">Unterstützung von clientseitigen Entwicklern</span><span class="sxs-lookup"><span data-stu-id="406f4-453">Supporting client-side developers</span></span>

<span data-ttu-id="406f4-454">Entwickler, die Clientanwendungen erstellen, benötigen normalerweise Informationen dazu, wie sie auf die Web-API zugreifen können. Außerdem benötigen sie Dokumentation zu den Parametern, Datentypen, Rückgabetypen und Rückgabecodes, mit denen die verschiedenen Anforderungen und Antworten zwischen dem Webdienst und der Clientanwendung beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-454">Developers constructing client applications typically require information on how to access the web API, and documentation concerning the parameters, data types, return types, and return codes that describe the different requests and responses between the web service and the client application.</span></span>

### <a name="document-the-rest-operations-for-a-web-api"></a><span data-ttu-id="406f4-455">Dokumentieren der REST-Vorgänge für eine Web-API</span><span class="sxs-lookup"><span data-stu-id="406f4-455">Document the REST operations for a web API</span></span>

<span data-ttu-id="406f4-456">Der Azure API Management-Dienst enthält ein Entwicklerportal, mit dem die von einer Web-API verfügbar gemachten REST-Vorgänge beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-456">The Azure API Management Service includes a developer portal that describes the REST operations exposed by a web API.</span></span> <span data-ttu-id="406f4-457">Wenn ein Produkt veröffentlicht wird, wird es in diesem Portal angezeigt.</span><span class="sxs-lookup"><span data-stu-id="406f4-457">When a product has been published it appears on this portal.</span></span> <span data-ttu-id="406f4-458">Entwickler können sich über dieses Portal für den Zugriff registrieren. Der Administrator kann die Anforderung dann genehmigen oder ablehnen.</span><span class="sxs-lookup"><span data-stu-id="406f4-458">Developers can use this portal to sign up for access; the administrator can then approve or deny the request.</span></span> <span data-ttu-id="406f4-459">Wenn Entwickler die Genehmigung erhalten, wird ihnen ein Abonnementschlüssel zugewiesen. Dieser wird zum Authentifizieren der Aufrufe von Clientanwendungen verwendet, die von den Entwicklern entwickelt werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-459">If the developer is approved, they are assigned a subscription key that is used to authenticate calls from the client applications that they develop.</span></span> <span data-ttu-id="406f4-460">Dieser Schlüssel muss bei jedem Web-API-Aufruf bereitgestellt werden. Andernfalls wird der Aufruf abgelehnt.</span><span class="sxs-lookup"><span data-stu-id="406f4-460">This key must be provided with each web API call otherwise it will be rejected.</span></span>

<span data-ttu-id="406f4-461">Außerdem bietet das Portal Folgendes:</span><span class="sxs-lookup"><span data-stu-id="406f4-461">This portal also provides:</span></span>

- <span data-ttu-id="406f4-462">Dokumentation zum Produkt mit den verfügbaren Vorgängen, den erforderlichen Parametern und den unterschiedlichen Antworten, die zurückgegeben werden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-462">Documentation for the product, listing the operations that it exposes, the parameters required, and the different responses that can be returned.</span></span> <span data-ttu-id="406f4-463">Beachten Sie, dass diese Informationen anhand der Details generiert werden, die im Abschnitt „Veröffentlichen einer Web-API mit dem Microsoft Azure API Management-Dienst“ in Schritt 3 der Liste enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="406f4-463">Note that this information is generated from the details provided in step 3 in the list in the Publishing a web API by using the Microsoft Azure API Management Service section.</span></span>
- <span data-ttu-id="406f4-464">Codeausschnitte, die das Aufrufen von Vorgängen für mehrere Sprachen veranschaulichen, z. B. JavaScript, C#, Java, Ruby, Python und PHP.</span><span class="sxs-lookup"><span data-stu-id="406f4-464">Code snippets that show how to invoke operations from several languages, including JavaScript, C#, Java, Ruby, Python, and PHP.</span></span>
- <span data-ttu-id="406f4-465">Eine Entwicklerkonsole, über die Entwickler eine HTTP-Anforderung zum Testen der Vorgänge im Produkt und zum Anzeigen der Ergebnisse senden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-465">A developers' console that enables a developer to send an HTTP request to test each operation in the product and view the results.</span></span>
- <span data-ttu-id="406f4-466">Eine Seite, auf der Entwickler Fehler oder aufgetretene Probleme melden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-466">A page where the developer can report any issues or problems found.</span></span>

<span data-ttu-id="406f4-467">Über das Azure-Verwaltungsportal können Sie das Entwicklerportal anpassen und die Formatierung und das Layout ändern, um es an das Branding Ihres Unternehmens anzugleichen.</span><span class="sxs-lookup"><span data-stu-id="406f4-467">The Azure Management portal enables you to customize the developer portal to change the styling and layout to match the branding of your organization.</span></span>

### <a name="implement-a-client-sdk"></a><span data-ttu-id="406f4-468">Implementieren eines Client-SDK</span><span class="sxs-lookup"><span data-stu-id="406f4-468">Implement a client SDK</span></span>

<span data-ttu-id="406f4-469">Das Erstellen einer Clientanwendung, mit der REST-Anforderungen zum Zugreifen auf eine Web-API aufgerufen werden, erfordert das Schreiben einer beträchtlichen Menge an Code. Jede Anforderung muss richtig erstellt und formatiert werden, die Anforderung muss an den Hostserver des Webdiensts gesendet werden, und die Antwort muss analysiert werden, um zu ermitteln, ob die Anforderung erfolgreich war. Außerdem müssen alle zurückgegebenen Daten extrahiert werden.</span><span class="sxs-lookup"><span data-stu-id="406f4-469">Building a client application that invokes REST requests to access a web API requires writing a significant amount of code to construct each request and format it appropriately, send the request to the server hosting the web service, and parse the response to work out whether the request succeeded or failed and extract any data returned.</span></span> <span data-ttu-id="406f4-470">Um die Clientanwendung hiervon abzukoppeln, können Sie ein SDK bereitstellen, das die REST-Schnittstelle umschließt und diese Low-Level-Details in einem funktionelleren Methodensatz abstrahiert.</span><span class="sxs-lookup"><span data-stu-id="406f4-470">To insulate the client application from these concerns, you can provide an SDK that wraps the REST interface and abstracts these low-level details inside a more functional set of methods.</span></span> <span data-ttu-id="406f4-471">Eine Clientanwendung verwendet diese Methoden, mit denen Aufrufe transparent in REST-Anforderungen konvertiert werden. Anschließend werden die Antworten zurück in Methodenrückgabewerte konvertiert.</span><span class="sxs-lookup"><span data-stu-id="406f4-471">A client application uses these methods, which transparently convert calls into REST requests and then convert the responses back into method return values.</span></span> <span data-ttu-id="406f4-472">Dies ist ein gängiges Verfahren, das von vielen Diensten implementiert wird, einschließlich des Azure-SDK.</span><span class="sxs-lookup"><span data-stu-id="406f4-472">This is a common technique that is implemented by many services, including the Azure SDK.</span></span>

<span data-ttu-id="406f4-473">Die Erstellung eines clientseitigen SDK ist ein aufwendiges Unterfangen, da es konsistent implementiert und sorgfältig getestet werden muss.</span><span class="sxs-lookup"><span data-stu-id="406f4-473">Creating a client-side SDK is a considerable undertaking as it has to be implemented consistently and tested carefully.</span></span> <span data-ttu-id="406f4-474">Ein Großteil dieses Prozesses kann aber „mechanisiert“ werden, und viele Anbieter stellen Tools bereit, mit denen viele Aufgaben automatisiert werden können.</span><span class="sxs-lookup"><span data-stu-id="406f4-474">However, much of this process can be made mechanical, and many vendors supply tools that can automate many of these tasks.</span></span>

## <a name="monitoring-a-web-api"></a><span data-ttu-id="406f4-475">Überwachen einer Web-API</span><span class="sxs-lookup"><span data-stu-id="406f4-475">Monitoring a web API</span></span>

<span data-ttu-id="406f4-476">Je nach Art der Veröffentlichung und Bereitstellung Ihrer Web-API können Sie die Web-API direkt überwachen, oder Sie können Informationen zur Verwendung und Integrität sammeln, indem Sie den Datenverkehr analysieren, der den API Management-Dienst durchläuft.</span><span class="sxs-lookup"><span data-stu-id="406f4-476">Depending on how you have published and deployed your web API you can monitor the web API directly, or you can gather usage and health information by analyzing the traffic that passes through the API Management service.</span></span>

### <a name="monitoring-a-web-api-directly"></a><span data-ttu-id="406f4-477">Direktes Überwachen einer Web-API</span><span class="sxs-lookup"><span data-stu-id="406f4-477">Monitoring a web API directly</span></span>

<span data-ttu-id="406f4-478">Wenn Sie Ihre Web-API mit der ASP.NET-Web-API-Vorlage (entweder als Web-API-Projekt oder Webrolle in einem Azure-Clouddienst) und Visual Studio 2013 implementiert haben, können Sie per ASP.NET Application Insights Daten zur Verfügbarkeit, Leistung und Verwendung sammeln.</span><span class="sxs-lookup"><span data-stu-id="406f4-478">If you have implemented your web API by using the ASP.NET Web API template (either as a Web API project or as a Web role in an Azure cloud service) and Visual Studio 2013, you can gather availability, performance, and usage data by using ASP.NET Application Insights.</span></span> <span data-ttu-id="406f4-479">Application Insights ist ein Paket, mit dem Informationen zu Anforderungen und Antworten transparent nachverfolgt und aufgezeichnet werden, wenn die Web-API in der Cloud bereitgestellt wird. Nachdem das Paket installiert und konfiguriert wurde, müssen Sie in Ihrer Web-API zur Nutzung keinen Code ändern.</span><span class="sxs-lookup"><span data-stu-id="406f4-479">Application Insights is a package that transparently tracks and records information about requests and responses when the web API is deployed to the cloud; once the package is installed and configured, you don't need to amend any code in your web API to use it.</span></span> <span data-ttu-id="406f4-480">Wenn Sie die Web-API auf einer Azure-Website bereitstellen, wird der gesamte Datenverkehr untersucht, und die folgenden statistischen Daten werden gesammelt:</span><span class="sxs-lookup"><span data-stu-id="406f4-480">When you deploy the web API to an Azure web site, all traffic is examined and the following statistics are gathered:</span></span>

- <span data-ttu-id="406f4-481">Reaktionszeit des Servers</span><span class="sxs-lookup"><span data-stu-id="406f4-481">Server response time.</span></span>
- <span data-ttu-id="406f4-482">Anzahl von Serveranforderungen und die Details jeder Anforderung</span><span class="sxs-lookup"><span data-stu-id="406f4-482">Number of server requests and the details of each request.</span></span>
- <span data-ttu-id="406f4-483">Langsamste Anforderungen in Bezug auf die durchschnittliche Reaktionszeit</span><span class="sxs-lookup"><span data-stu-id="406f4-483">The top slowest requests in terms of average response time.</span></span>
- <span data-ttu-id="406f4-484">Details nicht erfolgreicher Anforderungen</span><span class="sxs-lookup"><span data-stu-id="406f4-484">The details of any failed requests.</span></span>
- <span data-ttu-id="406f4-485">Anzahl von Sitzungen, die von unterschiedlichen Browsern und Benutzer-Agents initiiert werden</span><span class="sxs-lookup"><span data-stu-id="406f4-485">The number of sessions initiated by different browsers and user agents.</span></span>
- <span data-ttu-id="406f4-486">Am häufigsten angezeigte Seiten (vor allem nützlich für Webanwendungen und nicht für Web-APIs)</span><span class="sxs-lookup"><span data-stu-id="406f4-486">The most frequently viewed pages (primarily useful for web applications rather than web APIs).</span></span>
- <span data-ttu-id="406f4-487">Unterschiedliche Benutzerrollen, mit denen auf die Web-API zugegriffen wird</span><span class="sxs-lookup"><span data-stu-id="406f4-487">The different user roles accessing the web API.</span></span>

<span data-ttu-id="406f4-488">Sie können diese Daten im Azure-Verwaltungsportal in Echtzeit anzeigen.</span><span class="sxs-lookup"><span data-stu-id="406f4-488">You can view this data in real time from the Azure Management portal.</span></span> <span data-ttu-id="406f4-489">Außerdem können Sie WebTests erstellen, mit denen die Integrität der Web-API überwacht wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-489">You can also create webtests that monitor the health of the web API.</span></span> <span data-ttu-id="406f4-490">Ein WebTest sendet eine regelmäßige Anforderung an einen angegebenen URI in der Web-API und erfasst die Antwort.</span><span class="sxs-lookup"><span data-stu-id="406f4-490">A webtest sends a periodic request to a specified URI in the web API and captures the response.</span></span> <span data-ttu-id="406f4-491">Sie können die Definition einer erfolgreichen Antwort angeben (z. B. HTTP-Statuscode 200). Und wenn die Anforderung diese Antwort nicht zurückgibt, können Sie vorgeben, dass eine Warnung an einen Administrator gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="406f4-491">You can specify the definition of a successful response (such as HTTP status code 200), and if the request does not return this response you can arrange for an alert to be sent to an administrator.</span></span> <span data-ttu-id="406f4-492">Bei Bedarf kann der Administrator den Server neu starten, auf dem die Web-API gehostet wird, wenn er ausgefallen ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-492">If necessary, the administrator can restart the server hosting the web API if it has failed.</span></span>

<span data-ttu-id="406f4-493">Weitere Informationen finden Sie unter [Einrichten von Application Insights für Ihre ASP.NET-Website](/azure/application-insights/app-insights-asp-net/).</span><span class="sxs-lookup"><span data-stu-id="406f4-493">For more information, see [Application Insights - Get started with ASP.NET](/azure/application-insights/app-insights-asp-net/).</span></span>

### <a name="monitoring-a-web-api-through-the-api-management-service"></a><span data-ttu-id="406f4-494">Überwachen einer Web-API per API Management-Dienst</span><span class="sxs-lookup"><span data-stu-id="406f4-494">Monitoring a web API through the API Management Service</span></span>

<span data-ttu-id="406f4-495">Wenn Sie Ihre Web-API mit dem API Management-Dienst veröffentlicht haben, enthält die Seite „API Management“ im Azure-Verwaltungsportal ein Dashboard, auf dem Sie die allgemeine Leistung des Diensts anzeigen können.</span><span class="sxs-lookup"><span data-stu-id="406f4-495">If you have published your web API by using the API Management service, the API Management page on the Azure Management portal contains a dashboard that enables you to view the overall performance of the service.</span></span> <span data-ttu-id="406f4-496">Auf der Seite „Analytics“ können Sie auf die Details zur Verwendung des Produkts zugreifen.</span><span class="sxs-lookup"><span data-stu-id="406f4-496">The Analytics page enables you to drill down into the details of how the product is being used.</span></span> <span data-ttu-id="406f4-497">Diese Seite enthält die folgenden Registerkarten:</span><span class="sxs-lookup"><span data-stu-id="406f4-497">This page contains the following tabs:</span></span>

- <span data-ttu-id="406f4-498">**Verwendung**:</span><span class="sxs-lookup"><span data-stu-id="406f4-498">**Usage**.</span></span> <span data-ttu-id="406f4-499">Diese Registerkarte enthält Informationen zur Anzahl der durchgeführten API-Aufrufe und zur Bandbreite, die zum Behandeln dieser Aufrufe im Laufe der Zeit verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="406f4-499">This tab provides information about the number of API calls made and the bandwidth used to handle these calls over time.</span></span> <span data-ttu-id="406f4-500">Sie können die Verwendungsdetails nach Produkt, API und Vorgang filtern.</span><span class="sxs-lookup"><span data-stu-id="406f4-500">You can filter usage details by product, API, and operation.</span></span>
- <span data-ttu-id="406f4-501">**Integrität**:</span><span class="sxs-lookup"><span data-stu-id="406f4-501">**Health**.</span></span> <span data-ttu-id="406f4-502">Auf dieser Registerkarte können Sie das Ergebnis von API-Anforderungen (zurückgegebenen HTTP-Statuscodes), die Effektivität der Richtlinie für die Zwischenspeicherung, die API-Reaktionszeit und die Reaktionszeit des Diensts anzeigen.</span><span class="sxs-lookup"><span data-stu-id="406f4-502">This tab enables you to view the outcome of API requests (the HTTP status codes returned), the effectiveness of the caching policy, the API response time, and the service response time.</span></span> <span data-ttu-id="406f4-503">Sie können auch die Integritätsdaten nach Produkt, API und Vorgang filtern.</span><span class="sxs-lookup"><span data-stu-id="406f4-503">Again, you can filter health data by product, API, and operation.</span></span>
- <span data-ttu-id="406f4-504">**Aktivität**:</span><span class="sxs-lookup"><span data-stu-id="406f4-504">**Activity**.</span></span> <span data-ttu-id="406f4-505">Diese Registerkarte enthält eine Textzusammenfassung der Anzahl von erfolgreichen Aufrufen, fehlgeschlagenen Aufrufen, blockierten Aufrufen, der durchschnittlichen Reaktionszeit und Reaktionszeiten für Produkt, Web-API und Vorgang.</span><span class="sxs-lookup"><span data-stu-id="406f4-505">This tab provides a text summary of the numbers of successful calls, failed calls, blocked calls, average response time, and response times for each product, web API, and operation.</span></span> <span data-ttu-id="406f4-506">Auf dieser Seite ist auch die Anzahl von Aufrufen angegeben, die von den einzelnen Entwicklern durchgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="406f4-506">This page also lists the number of calls made by each developer.</span></span>
- <span data-ttu-id="406f4-507">**Auf einen Blick**:</span><span class="sxs-lookup"><span data-stu-id="406f4-507">**At a glance**.</span></span> <span data-ttu-id="406f4-508">Auf dieser Registerkarte wird eine Zusammenfassung der Leistungsdaten angezeigt, z. B. die Entwickler mit den meisten API-Aufrufen und die Produkte, Web-APIs und Vorgänge, von denen diese Aufrufe empfangen wurden.</span><span class="sxs-lookup"><span data-stu-id="406f4-508">This tab displays a summary of the performance data, including the developers responsible for making the most API calls, and the products, web APIs, and operations that received these calls.</span></span>

<span data-ttu-id="406f4-509">Anhand dieser Informationen können Sie bestimmen, ob eine bestimmte Web-API oder ein Vorgang einen Engpass verursacht, und bei Bedarf die Hostumgebung skalieren und weitere Server hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="406f4-509">You can use this information to determine whether a particular web API or operation is causing a bottleneck, and if necessary scale the host environment and add more servers.</span></span> <span data-ttu-id="406f4-510">Sie können auch prüfen, ob eine oder mehrere Anwendungen eine unangemessen hohe Menge an Ressourcen verbrauchen, und entsprechende Richtlinien anwenden, um Kontingente festzulegen und die Aufrufraten zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="406f4-510">You can also ascertain whether one or more applications are using a disproportionate volume of resources and apply the appropriate policies to set quotas and limit call rates.</span></span>

> [!NOTE]
> <span data-ttu-id="406f4-511">Sie können die Details für ein veröffentlichtes Produkt ändern. Die Änderungen werden dann sofort angewendet.</span><span class="sxs-lookup"><span data-stu-id="406f4-511">You can change the details for a published product, and the changes are applied immediately.</span></span> <span data-ttu-id="406f4-512">Beispielsweise können Sie einen Vorgang einer Web-API hinzufügen oder daraus entfernen, ohne dass Sie hierfür das Produkt neu veröffentlichen müssen, in dem die Web-API enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="406f4-512">For example, you can add or remove an operation from a web API without requiring that you republish the product that contains the web API.</span></span>

## <a name="more-information"></a><span data-ttu-id="406f4-513">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="406f4-513">More information</span></span>

- <span data-ttu-id="406f4-514">[ASP.NET-Web-API-OData](https://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api) enthält Beispiele und weitere Informationen zur Implementierung einer OData-Web-API per ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="406f4-514">[ASP.NET Web API OData](https://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api) contains examples and further information on implementing an OData web API by using ASP.NET.</span></span>
- <span data-ttu-id="406f4-515">Unter [Einführung der Batchunterstützung für die Web-API und Web-API-OData](https://blogs.msdn.microsoft.com/webdev/2013/11/01/introducing-batch-support-in-web-api-and-web-api-odata/) wird beschrieben, wie Sie Batchvorgänge in einer Web-API mit OData implementieren.</span><span class="sxs-lookup"><span data-stu-id="406f4-515">[Introducing batch support in Web API and Web API OData](https://blogs.msdn.microsoft.com/webdev/2013/11/01/introducing-batch-support-in-web-api-and-web-api-odata/) describes how to implement batch operations in a web API by using OData.</span></span>
- <span data-ttu-id="406f4-516">[Idempotency Patterns](https://blog.jonathanoliver.com/idempotency-patterns/) (Muster der Idempotenz) im Blog von Jonathan Oliver enthält eine Übersicht über die Idempotenz und ihre Verbindung mit Datenverwaltungsvorgängen.</span><span class="sxs-lookup"><span data-stu-id="406f4-516">[Idempotency patterns](https://blog.jonathanoliver.com/idempotency-patterns/) on Jonathan Oliver’s blog provides an overview of idempotency and how it relates to data management operations.</span></span>
- <span data-ttu-id="406f4-517">[Statuscodedefinitionen](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) auf der W3C-Website enthält eine vollständige Liste mit HTTP-Statuscodes und den dazugehörigen Beschreibungen.</span><span class="sxs-lookup"><span data-stu-id="406f4-517">[Status Code Definitions](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) on the W3C website contains a full list of HTTP status codes and their descriptions.</span></span>
- <span data-ttu-id="406f4-518">Unter [Ausführen von Hintergrundaufgaben mit WebJobs in Azure App Service](/azure/app-service-web/web-sites-create-web-jobs/) finden Sie Informationen und Beispiele zur Verwendung von WebJobs für die Durchführung von Hintergrundvorgängen.</span><span class="sxs-lookup"><span data-stu-id="406f4-518">[Run background tasks with WebJobs](/azure/app-service-web/web-sites-create-web-jobs/) provides information and examples on using WebJobs to perform background operations.</span></span>
- <span data-ttu-id="406f4-519">Unter [Azure Notification Hubs – Benachrichtigen von Benutzern](/azure/notification-hubs/notification-hubs-aspnet-backend-windows-dotnet-wns-notification/) erfahren Sie, wie Sie mithilfe einer Azure Notification Hub-Instanz asynchrone Antworten an Clientanwendungen pushen.</span><span class="sxs-lookup"><span data-stu-id="406f4-519">[Azure Notification Hubs notify users](/azure/notification-hubs/notification-hubs-aspnet-backend-windows-dotnet-wns-notification/) shows how to use an Azure Notification Hub to push asynchronous responses to client applications.</span></span>
- <span data-ttu-id="406f4-520">Unter [API Management](https://azure.microsoft.com/services/api-management/) wird beschrieben, wie Sie ein Produkt veröffentlichen, das kontrollierten und sicheren Zugriff auf eine Web-API ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="406f4-520">[API Management](https://azure.microsoft.com/services/api-management/) describes how to publish a product that provides controlled and secure access to a web API.</span></span>
- <span data-ttu-id="406f4-521">Unter [Azure API-Verwaltung für REST-API-Referenz](https://msdn.microsoft.com/library/azure/dn776326.aspx) erfahren Sie, wie Sie die API Management-REST-API zum Erstellen von benutzerdefinierten Verwaltungsanwendungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="406f4-521">[Azure API Management REST API reference](https://msdn.microsoft.com/library/azure/dn776326.aspx) describes how to use the API Management REST API to build custom management applications.</span></span>
- <span data-ttu-id="406f4-522">Unter [Traffic Manager-Routingmethoden](/azure/traffic-manager/traffic-manager-routing-methods/) wird zusammengefasst, wie Azure Traffic Manager verwendet werden kann, um für mehrere Instanzen einer Website, auf der eine Web-API gehostet wird, den Lastenausgleich für Anforderungen durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="406f4-522">[Traffic Manager routing methods](/azure/traffic-manager/traffic-manager-routing-methods/) summarizes how Azure Traffic Manager can be used to load-balance requests across multiple instances of a website hosting a web API.</span></span>
- <span data-ttu-id="406f4-523">Unter [Einrichten von Application Insights für ASP.NET](/azure/application-insights/app-insights-asp-net/) werden ausführliche Informationen zum Installieren und Konfigurieren von Application Insights in einem ASP.NET-Web-API-Projekt bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="406f4-523">[Application Insights - Get started with ASP.NET](/azure/application-insights/app-insights-asp-net/) provides detailed information on installing and configuring Application Insights in an ASP.NET Web API project.</span></span>

<!-- links -->

[api-design]: ./api-design.md
