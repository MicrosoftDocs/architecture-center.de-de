---
title: Technischer Leitfaden – Wiederherstellung nach lokalen Ausfällen in Azure
description: Artikel über die Grundlagen und den Entwurf von robusten, hoch verfügbaren, fehlertoleranten Anwendungen sowie die Planung der Notfallwiederherstellung nach lokalen Fehlern in Azure.
author: adamglick
ms.date: 08/18/2016
ms.openlocfilehash: 5fc929bd1affe3dd6616f908bae0e7d2fefb89d5
ms.sourcegitcommit: e67b751f230792bba917754d67789a20810dc76b
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2018
---
[!INCLUDE [header](../_includes/header.md)]

# <a name="azure-resiliency-technical-guidance-recovery-from-local-failures-in-azure"></a><span data-ttu-id="d0aa3-103">Technischer Leitfaden zur Resilienz in Azure – Wiederherstellung nach lokalen Ausfällen in Azure</span><span class="sxs-lookup"><span data-stu-id="d0aa3-103">Azure resiliency technical guidance: Recovery from local failures in Azure</span></span>

<span data-ttu-id="d0aa3-104">Es gibt zwei primäre Bedrohungen der Anwendungsverfügbarkeit:</span><span class="sxs-lookup"><span data-stu-id="d0aa3-104">There are two primary threats to application availability:</span></span>

* <span data-ttu-id="d0aa3-105">Ausfall von Geräten, z.B. Festplatten und Servern</span><span class="sxs-lookup"><span data-stu-id="d0aa3-105">The failure of devices, such as drives and servers</span></span>
* <span data-ttu-id="d0aa3-106">Volle Auslastung kritischer Ressourcen, z.B. von Computeressourcen bei Spitzenlast</span><span class="sxs-lookup"><span data-stu-id="d0aa3-106">The exhaustion of critical resources, such as compute under peak load conditions</span></span>

<span data-ttu-id="d0aa3-107">Um unter solchen Umständen für Hochverfügbarkeit zu sorgen, bietet Azure eine Kombination aus Ressourcenverwaltung, Elastizität, Lastenausgleich und Partitionierung.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-107">Azure provides a combination of resource management, elasticity, load balancing, and partitioning to enable high availability under these circumstances.</span></span> <span data-ttu-id="d0aa3-108">Einige dieser Funktionen werden automatisch für alle Azure-Dienste ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-108">Some of these features are performed automatically for all Azure services.</span></span> <span data-ttu-id="d0aa3-109">In einigen Fällen muss der Anwendungsentwickler aber zusätzliche Schritte ausführen, um davon zu profitieren.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-109">However, in some cases, the application developer must do some additional work to benefit from them.</span></span>

## <a name="cloud-services"></a><span data-ttu-id="d0aa3-110">Cloud Services</span><span class="sxs-lookup"><span data-stu-id="d0aa3-110">Cloud Services</span></span>
<span data-ttu-id="d0aa3-111">Azure Cloud Services besteht aus Sammlungen mit mindestens einer Web- oder Workerrolle.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-111">Azure Cloud Services consists of collections of one or more web or worker roles.</span></span> <span data-ttu-id="d0aa3-112">Eine oder mehrere Instanzen einer Rolle können gleichzeitig ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-112">One or more instances of a role can run concurrently.</span></span> <span data-ttu-id="d0aa3-113">Die Konfiguration bestimmt die Anzahl von Instanzen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-113">The configuration determines the number of instances.</span></span> <span data-ttu-id="d0aa3-114">Rolleninstanzen werden mithilfe einer Komponente überwacht und verwaltet, die als Fabric Controller bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-114">Role instances are monitored and managed through a component called the fabric controller.</span></span> <span data-ttu-id="d0aa3-115">Der Fabric Controller erkennt sowohl Software- als auch Hardwarefehler automatisch und reagiert darauf.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-115">The fabric controller detects and responds to both software and hardware failures automatically.</span></span>

<span data-ttu-id="d0aa3-116">Jede Rolleninstanz wird in einem eigenen virtuellen Computer ausgeführt und kommuniziert über einen Gast-Agent mit dem Fabric Controller.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-116">Every role instance runs in its own virtual machine (VM) and communicates with its fabric controller through a guest agent.</span></span> <span data-ttu-id="d0aa3-117">Der Gast-Agent sammelt Ressourcen- und Knotenmetriken, einschließlich VM-Nutzung, Status, Protokolle, Ressourcenauslastung, Ausnahmen und Fehlerbedingungen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-117">The guest agent collects resource and node metrics, including VM usage, status, logs, resource usage, exceptions, and failure conditions.</span></span> <span data-ttu-id="d0aa3-118">Der Fabric Controller fragt den Gast-Agent in konfigurierbaren Intervallen ab und startet die VM neu, wenn der Gast-Agent nicht antwortet.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-118">The fabric controller queries the guest agent at configurable intervals, and it restarts the VM if the guest agent fails to respond.</span></span> <span data-ttu-id="d0aa3-119">Bei einem Hardwarefehler verschiebt der zugehörige Fabric Controller alle betroffenen Rolleninstanzen in einen neuen Hardwareknoten und konfiguriert das Netzwerk neu, um den Datenverkehr an diesen Knoten zu leiten.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-119">In the event of hardware failure, the associated fabric controller moves all affected role instances to a new hardware node and reconfigures the network to route traffic there.</span></span>

<span data-ttu-id="d0aa3-120">Um von diesen Funktionen profitieren zu können, sollten Entwickler sicherstellen, dass Dienstrollen keinen Statusinformationen in den Rolleninstanzen speichern.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-120">To benefit from these features, developers should ensure that all service roles avoid storing state on the role instances.</span></span> <span data-ttu-id="d0aa3-121">Stattdessen sollte der Zugriff auf alle persistenten Daten über einen permanenten Speicher erfolgen, beispielsweise über Azure Storage oder Azure SQL-Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-121">Instead, all persistent data should be accessed from durable storage, such as Azure Storage or Azure SQL Database.</span></span> <span data-ttu-id="d0aa3-122">So wird allen Rollen die Behandlung von Anforderungen ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-122">This allows any roles to handle requests.</span></span> <span data-ttu-id="d0aa3-123">Das bedeutet auch, dass Rolleninstanzen jederzeit ausfallen können, ohne Inkonsistenzen im vorübergehenden oder permanenten Status des Diensts zu verursachen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-123">It also means that role instances can go down at any time without creating inconsistencies in the transient or persistent state of the service.</span></span>

<span data-ttu-id="d0aa3-124">Die Anforderung, den Status außerhalb der Rollen zu speichern, hat verschiedene Auswirkungen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-124">The requirement to store state externally to the roles has several implications.</span></span> <span data-ttu-id="d0aa3-125">Es sollten z.B. alle zugehörigen Änderungen an einem Azure-Tabellenspeicher nach Möglichkeit in einer einzigen Entitätsgruppentransaktion ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-125">It implies, for example, that all related changes to an Azure Storage table should be changed in a single entity-group transaction, if possible.</span></span> <span data-ttu-id="d0aa3-126">Es ist allerdings nicht immer möglich, alle Änderungen in einer einzigen Transaktion auszuführen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-126">Of course, it isn't always possible to make all changes in a single transaction.</span></span> <span data-ttu-id="d0aa3-127">Sie sollten sorgfältig darauf achten, dass Rolleninstanzfehler keine Probleme verursachen, wenn sie langfristige Vorgänge unterbrechen, die zwei oder mehr Updates am persistenten Status des Diensts umfassen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-127">You must take special care to ensure that role instance failures do not cause problems when they interrupt long-running operations that span two or more updates to the persistent state of the service.</span></span> <span data-ttu-id="d0aa3-128">Wenn eine andere Rolle versucht, einen solchen Vorgang erneut auszuführen, sollte sie den Fall voraussehen, dass die Arbeit nur teilweise abgeschlossen wurde, und entsprechend reagieren.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-128">If another role attempts to retry such an operation, it should anticipate and handle the case where the work was partially completed.</span></span>

<span data-ttu-id="d0aa3-129">Stellen Sie sich beispielsweise einen Dienst vor, bei dem Daten über mehrere Speicher hinweg partitioniert werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-129">For example, consider a service that partitions data across multiple stores.</span></span> <span data-ttu-id="d0aa3-130">Wenn eine Workerrolle ausfällt, während ein Shard neu angeordnet wird, wird dieser Vorgang unter Umständen nicht abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-130">If a worker role goes down while it's relocating a shard, the relocation of the shard might not finish.</span></span> <span data-ttu-id="d0aa3-131">Es kann auch sein, dass die Neuanordnung von einer anderen Workerrolle von Beginn an wiederholt wird. Dies kann unter Umständen zu verwaisten oder beschädigten Daten führen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-131">Or the relocation might be repeated from its inception by a different worker role, potentially causing orphaned data or data corruption.</span></span> <span data-ttu-id="d0aa3-132">Zur Verhinderung von Problemen müssen Vorgänge mit langer Ausführungsdauer mindestens eine der beiden folgenden Eigenschaften haben:</span><span class="sxs-lookup"><span data-stu-id="d0aa3-132">To prevent problems, long-running operations must be one or both of the following:</span></span>

* <span data-ttu-id="d0aa3-133">*Idempotent*: Eine Wiederholung ist ohne Nebeneffekte möglich.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-133">*Idempotent*: Repeatable without side effects.</span></span> <span data-ttu-id="d0aa3-134">Um idempotent zu sein, sollte ein langfristiger Vorgang immer die gleiche Auswirkung haben, und zwar unabhängig davon, wie oft er ausgeführt wird und ob er unterbrochen wird.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-134">To be idempotent, a long-running operation should have the same effect no matter how many times it's executed, even when it's interrupted during execution.</span></span>
* <span data-ttu-id="d0aa3-135">*Inkrementell erneut startbar*: Der Vorgang sollte ab der letzten Fehlerquelle fortgesetzt werden können.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-135">*Incrementally restartable*: Able to continue from the most recent point of failure.</span></span> <span data-ttu-id="d0aa3-136">Um dies zu ermöglichen, sollte ein Vorgang mit langer Ausführungsdauer aus einer Abfolge von kleineren „atomaren“ Vorgängen bestehen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-136">To be incrementally restartable, a long-running operation should consist of a sequence of smaller atomic operations.</span></span> <span data-ttu-id="d0aa3-137">Außerdem sollte der Status in permanentem Speicher aufgezeichnet werden, damit der Vorgang bei jedem nachfolgenden Aufruf an der Stelle fortgesetzt wird, an der der Vorgänger den Vorgang beendet hat.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-137">It should also record its progress in durable storage, so that each subsequent invocation picks up where its predecessor stopped.</span></span>

<span data-ttu-id="d0aa3-138">Alle langfristigen Vorgänge sollten wiederholt aufgerufen werden, bis sie erfolgreich abgeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-138">Finally, all long-running operations should be invoked repeatedly until they succeed.</span></span> <span data-ttu-id="d0aa3-139">Ein Bereitstellungsvorgang kann beispielsweise in einer Azure-Warteschlange platziert und von einer Workerrolle erst nach erfolgreicher Durchführung aus der Warteschlange entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-139">For example, a provisioning operation might be placed in an Azure queue, and then removed from the queue by a worker role only when it succeeds.</span></span> <span data-ttu-id="d0aa3-140">Zum Bereinigen von Daten, die durch unterbrochene Vorgänge erstellt wurden, ist möglicherweise eine Garbage Collection erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-140">Garbage collection might be necessary to clean up data that interrupted operations create.</span></span>

### <a name="elasticity"></a><span data-ttu-id="d0aa3-141">Elastizität</span><span class="sxs-lookup"><span data-stu-id="d0aa3-141">Elasticity</span></span>
<span data-ttu-id="d0aa3-142">Die anfängliche Anzahl von Instanzen, die für jede Rolle ausgeführt werden, ist in der Konfiguration jeder Rolle festgelegt.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-142">The initial number of instances running for each role is determined in each role’s configuration.</span></span> <span data-ttu-id="d0aa3-143">Administratoren sollten zu Beginn jede Rolle so konfigurieren, dass sie je nach erwarteter Auslastung mit mindestens zwei Instanzen ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-143">Administrators should initially configure each role to run with two or more instances based on expected load.</span></span> <span data-ttu-id="d0aa3-144">Sie können Rolleninstanzen aber problemlos nach oben oder unten skalieren, wenn sich Nutzungsmuster ändern.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-144">But you can easily scale role instances up or down as usage patterns change.</span></span> <span data-ttu-id="d0aa3-145">Dies ist manuell im Azure-Portal möglich, oder Sie können den Prozess automatisieren, indem Sie Windows PowerShell, die Dienstverwaltungs-API oder Drittanbietertools verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-145">You can do this manually in the Azure portal, or you can automate the process by using Windows PowerShell, the Service Management API, or third-party tools.</span></span> <span data-ttu-id="d0aa3-146">Weitere Informationen finden Sie unter [Automatisches Skalieren einer Anwendung](/azure/cloud-services/cloud-services-how-to-scale/).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-146">For more information, see [How to autoscale an application](/azure/cloud-services/cloud-services-how-to-scale/).</span></span>

### <a name="partitioning"></a><span data-ttu-id="d0aa3-147">Partitionierung</span><span class="sxs-lookup"><span data-stu-id="d0aa3-147">Partitioning</span></span>
<span data-ttu-id="d0aa3-148">Der Azure Fabric Controller verwendet zwei Arten von Partitionen:</span><span class="sxs-lookup"><span data-stu-id="d0aa3-148">The Azure fabric controller uses two types of partitions:</span></span>

* <span data-ttu-id="d0aa3-149">Eine *Updatedomäne* wird zum Aktualisieren der Rolleninstanzen eines Diensts in Gruppen verwendet.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-149">An *update domain* is used to upgrade a service’s role instances in groups.</span></span> <span data-ttu-id="d0aa3-150">Azure stellt Dienstinstanzen in mehreren Updatedomänen bereit.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-150">Azure deploys service instances into multiple update domains.</span></span> <span data-ttu-id="d0aa3-151">Für ein direktes Update fährt der Fabric Controller alle Instanzen in einer Updatedomäne herunter, aktualisiert sie und startet sie neu. Anschließend fährt der Fabric Controller mit der nächsten Updatedomäne fort.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-151">For an in-place update, the fabric controller brings down all the instances in one update domain, updates them, and then restarts them before moving to the next update domain.</span></span> <span data-ttu-id="d0aa3-152">Dieser Ansatz verhindert, dass während des Aktualisierungsvorgangs der komplette Dienst nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-152">This approach prevents the entire service from being unavailable during the update process.</span></span>
* <span data-ttu-id="d0aa3-153">Eine *Fehlerdomäne* definiert potenzielle Hardware- oder Netzwerkfehlerstellen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-153">A *fault domain* defines potential points of hardware or network failure.</span></span> <span data-ttu-id="d0aa3-154">Bei Rollen mit mehr als einer Instanz stellt der Fabric Controller sicher, dass die Instanzen auf mehrere Fehlerdomänen verteilt werden, um zu verhindern, dass isolierte Hardwarefehler zu Dienstunterbrechungen führen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-154">For any role that has more than one instance, the fabric controller ensures that the instances are distributed across multiple fault domains, to prevent isolated hardware failures from disrupting service.</span></span> <span data-ttu-id="d0aa3-155">Sämtliche Risiken hinsichtlich Server- und Clusterfehlern werden durch Fehlerdomänen abgedeckt.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-155">Fault domains govern all exposure to server and cluster failures.</span></span>

<span data-ttu-id="d0aa3-156">Gemäß der [Azure-Vereinbarung zum Servicelevel (SLA)](https://azure.microsoft.com/support/legal/sla/) garantiert Microsoft eine externe Konnektivität von mindestens 99,95%, wenn zwei oder mehr Webrolleninstanzen in verschiedenen Fehler- und Upgradedomänen bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-156">The [Azure service-level agreement (SLA)](https://azure.microsoft.com/support/legal/sla/) guarantees that when two or more web role instances are deployed to different fault and upgrade domains, they'll have external connectivity at least 99.95 percent of the time.</span></span> <span data-ttu-id="d0aa3-157">Im Gegensatz zu Updatedomänen gibt es keine Möglichkeit, die Anzahl von Fehlerdomänen zu steuern.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-157">Unlike update domains, there's no way to control the number of fault domains.</span></span> <span data-ttu-id="d0aa3-158">Azure weist Fehlerdomänen automatisch zu und verteilt Rolleninstanzen auf diese.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-158">Azure automatically allocates fault domains and distributes role instances across them.</span></span> <span data-ttu-id="d0aa3-159">Mindestens die ersten beiden Instanzen jeder Rolle werden in verschiedenen Fehler- und Upgradedomänen platziert, um sicherzustellen, dass jede Rolle mit mindestens zwei Instanzen die SLA erfüllt.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-159">At least the first two instances of every role are placed in different fault and upgrade domains to ensure that any role with at least two instances will satisfy the SLA.</span></span> <span data-ttu-id="d0aa3-160">Dies ist im folgenden Diagramm dargestellt:</span><span class="sxs-lookup"><span data-stu-id="d0aa3-160">This is represented in the following diagram.</span></span>

![Vereinfachte Darstellung der Fehlerdomänenisolation](./images/technical-guidance-recovery-local-failures/partitioning-1.png)

### <a name="load-balancing"></a><span data-ttu-id="d0aa3-162">Lastenausgleich</span><span class="sxs-lookup"><span data-stu-id="d0aa3-162">Load balancing</span></span>
<span data-ttu-id="d0aa3-163">Jeglicher eingehender Datenverkehr einer Webrolle wird durch einen zustandslosen Lastenausgleich geleitet, der Clientanforderungen zwischen den Rolleninstanzen verteilt.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-163">All inbound traffic to a web role passes through a stateless load balancer, which distributes client requests among the role instances.</span></span> <span data-ttu-id="d0aa3-164">Einzelne Rolleninstanzen besitzen keine öffentlichen IP-Adressen und sind nicht direkt aus dem Internet erreichbar.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-164">Individual role instances do not have public IP addresses, and they are not directly addressable from the Internet.</span></span> <span data-ttu-id="d0aa3-165">Webrollen sind zustandslos, sodass alle Clientanforderungen an jede Rolleninstanz weitergeleitet werden können.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-165">Web roles are stateless so that any client request can be routed to any role instance.</span></span> <span data-ttu-id="d0aa3-166">Alle 15 Sekunden wird ein [StatusCheck](https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleenvironment.statuscheck.aspx) -Ereignis ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-166">A [StatusCheck](https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleenvironment.statuscheck.aspx) event is raised every 15 seconds.</span></span> <span data-ttu-id="d0aa3-167">Sie können es verwenden, um anzugeben, ob die Rolle für den Empfang von Datenverkehr bereit ist oder ob sie beschäftigt ist und aus der Lastenausgleichsrotation herausgenommen werden sollte.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-167">You can use this to indicate whether the role is ready to receive traffic, or whether it's busy and should be taken out of the load-balancer rotation.</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="d0aa3-168">Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="d0aa3-168">Virtual Machines</span></span>
<span data-ttu-id="d0aa3-169">Virtuelle Azure-Computer unterscheiden sich von PaaS-Computerollen (Platform as a Service) im Zusammenhang mit Hochverfügbarkeit in mehreren Punkten.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-169">Azure Virtual Machines differs from platform as a service (PaaS) compute roles in several respects in relation to high availability.</span></span> <span data-ttu-id="d0aa3-170">In einigen Fällen müssen Sie zusätzliche Aufgaben ausführen, um Hochverfügbarkeit sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-170">In some instances, you must do additional work to ensure high availability.</span></span>

### <a name="disk-durability"></a><span data-ttu-id="d0aa3-171">Dauerhaftigkeit von Datenträgern</span><span class="sxs-lookup"><span data-stu-id="d0aa3-171">Disk durability</span></span>
<span data-ttu-id="d0aa3-172">Im Gegensatz zu PaaS-Rolleninstanzen sind auf virtuellen Computern gespeicherte Daten persistent, auch wenn der virtuelle Computer verschoben wird.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-172">Unlike PaaS role instances, data stored on virtual machine drives is persistent even when the virtual machine is relocated.</span></span> <span data-ttu-id="d0aa3-173">Virtuelle Azure-Computer verwenden VM-Datenträger, die in Azure Storage als Blobs vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-173">Azure virtual machines use VM disks that exist as blobs in Azure Storage.</span></span> <span data-ttu-id="d0aa3-174">Aufgrund der Verfügbarkeitsmerkmale von Azure Storage sind die Daten, die auf Laufwerken virtueller Computer gespeichert werden, ebenfalls hoch verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-174">Because of the availability characteristics of Azure Storage, the data stored on a virtual machine’s drives is also highly available.</span></span>

<span data-ttu-id="d0aa3-175">Beachten Sie, dass das Laufwerk D (auf Windows-VMs) eine Ausnahme von dieser Regel darstellt.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-175">Note that drive D (in Windows VMs) is the exception to this rule.</span></span> <span data-ttu-id="d0aa3-176">Das Laufwerk D ist eigentlich ein physischer Speicher auf dem Rackserver, der den virtuellen Computer hostet, und die Daten dieses Laufwerks gehen verloren, wenn der virtuelle Computer recycelt wird.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-176">Drive D is actually physical storage on the rack server that hosts the VM, and its data will be lost if the VM is recycled.</span></span> <span data-ttu-id="d0aa3-177">Das Laufwerk D ist nur für die temporäre Speicherung vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-177">Drive D is intended for temporary storage only.</span></span> <span data-ttu-id="d0aa3-178">Unter Linux macht Azure den lokalen temporären Datenträger „normalerweise“ (aber nicht immer) als /dev/sdb-Blockgerät verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-178">In Linux, Azure “usually” (but not always) exposes the local temporary disk as /dev/sdb block device.</span></span> <span data-ttu-id="d0aa3-179">Häufig wird er vom Azure Linux-Agent als „/mnt/resource“- oder „/mnt“-Bereitstellungspunkt bereitgestellt (konfigurierbar über „/etc/waagent.conf“).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-179">It is often mounted by the Azure Linux Agent as /mnt/resource or /mnt mount points (configurable via /etc/waagent.conf).</span></span>

### <a name="partitioning"></a><span data-ttu-id="d0aa3-180">Partitionierung</span><span class="sxs-lookup"><span data-stu-id="d0aa3-180">Partitioning</span></span>
<span data-ttu-id="d0aa3-181">Azure bietet native Unterstützung für die Ebenen einer PaaS-Anwendung (Webrolle und Workerrolle) und kann diese daher richtig auf Fehler- und Updatedomänen verteilen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-181">Azure natively understands the tiers in a PaaS application (web role and worker role) and thus can properly distribute them across fault and update domains.</span></span> <span data-ttu-id="d0aa3-182">Die Ebenen in einer IaaS-Anwendung (Infrastructure as a Service) müssen dagegen manuell über Verfügbarkeitsgruppen definiert werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-182">In contrast, the tiers in an infrastructure as a service (IaaS) application must be manually defined through availability sets.</span></span> <span data-ttu-id="d0aa3-183">Für ein IaaS-SLA sind Verfügbarkeitsgruppen erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-183">Availability sets are required for an SLA under IaaS.</span></span>

![Verfügbarkeitsgruppen für virtuelle Azure-Computer](./images/technical-guidance-recovery-local-failures/partitioning-2.png)

<span data-ttu-id="d0aa3-185">Im vorherigen Diagramm sind die IIS-Ebene (Internet Information Services), die als Web-App-Ebene fungiert, und die SQL-Ebene, die als Datenebene fungiert, verschiedenen Verfügbarkeitsgruppen zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-185">In the preceding diagram, the Internet Information Services (IIS) tier (which works as a web app tier) and the SQL tier (which works as a data tier) are assigned to different availability sets.</span></span> <span data-ttu-id="d0aa3-186">Indem virtuelle Computer auf verschiedene Fehlerdomänen verteilt werden, wird sichergestellt, dass alle Instanzen jeder Ebene über Hardwareredundanz verfügen und während einer Aktualisierung nicht ganze Ebenen heruntergefahren werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-186">This ensures that all instances of each tier have hardware redundancy by distributing virtual machines across fault domains, and that entire tiers are not taken down during an update.</span></span>

### <a name="load-balancing"></a><span data-ttu-id="d0aa3-187">Lastenausgleich</span><span class="sxs-lookup"><span data-stu-id="d0aa3-187">Load balancing</span></span>
<span data-ttu-id="d0aa3-188">Wenn der Datenverkehr auf die virtuellen Computer verteilt werden soll, müssen Sie die virtuellen Computer in einer Anwendung gruppieren und den Lastenausgleich über einen bestimmten TCP- oder UDP-Endpunkt ausführen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-188">If the VMs should have traffic distributed across them, you must group the VMs in an application and load balance across a specific TCP or UDP endpoint.</span></span> <span data-ttu-id="d0aa3-189">Weitere Informationen finden Sie unter [Lastenausgleich zwischen virtuellen Computern](/azure/virtual-machines/virtual-machines-linux-load-balance/?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-189">For more information, see [Load balancing virtual machines](/azure/virtual-machines/virtual-machines-linux-load-balance/?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span> <span data-ttu-id="d0aa3-190">Wenn die virtuellen Computer Eingaben aus einer anderen Quelle erhalten (beispielsweise einem Warteschlangenmechanismus), ist kein Lastenausgleich erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-190">If the VMs receive input from another source (for example, a queuing mechanism), a load balancer is not required.</span></span> <span data-ttu-id="d0aa3-191">Der Lastenausgleich verwendet eine grundlegende Integritätsprüfung, um zu ermitteln, ob der Datenverkehr an den Knoten gesendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-191">The load balancer uses a basic health check to determine whether traffic should be sent to the node.</span></span> <span data-ttu-id="d0aa3-192">Sie können auch selbst Tests erstellen, um anwendungsspezifische Integritätsmetriken zu implementieren, die bestimmen, ob der virtuelle Computer Datenverkehr empfangen soll.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-192">It's also possible to create your own probes to implement application-specific health metrics that determine whether the VM should receive traffic.</span></span>

## <a name="storage"></a><span data-ttu-id="d0aa3-193">Speicher</span><span class="sxs-lookup"><span data-stu-id="d0aa3-193">Storage</span></span>
<span data-ttu-id="d0aa3-194">Azure Storage ist der grundlegende permanente Datendienst für Azure.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-194">Azure Storage is the baseline durable data service for Azure.</span></span> <span data-ttu-id="d0aa3-195">Er stellt Blob-, Tabellen-, Warteschlangen- und VM-Datenträgerspeicher bereit.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-195">It provides blob, table, queue, and VM disk storage.</span></span> <span data-ttu-id="d0aa3-196">Storage verwendet eine Kombination aus Replikation und Ressourcenverwaltung, um innerhalb eines einzelnen Rechenzentrums Hochverfügbarkeit bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-196">It uses a combination of replication and resource management to provide high availability within a single datacenter.</span></span> <span data-ttu-id="d0aa3-197">Mit der Vereinbarung zum Servicelevel (SLA) zur Verfügbarkeit von Azure Storage wird gewährleistet, dass mindestens 99,9% der Zeit Folgendes sichergestellt ist:</span><span class="sxs-lookup"><span data-stu-id="d0aa3-197">The Azure Storage availability SLA guarantees that at least 99.9 percent of the time:</span></span>

* <span data-ttu-id="d0aa3-198">Richtig formatierte Anforderungen zum Hinzufügen, Aktualisieren, Lesen und Löschen von Daten werden erfolgreich und korrekt verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-198">Correctly formatted requests to add, update, read, and delete data will be successfully and correctly processed.</span></span>
* <span data-ttu-id="d0aa3-199">Speicherkonten verfügen über eine Verbindung mit dem Internetgateway.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-199">Storage accounts will have connectivity to the Internet gateway.</span></span>

### <a name="replication"></a><span data-ttu-id="d0aa3-200">Replikation</span><span class="sxs-lookup"><span data-stu-id="d0aa3-200">Replication</span></span>
<span data-ttu-id="d0aa3-201">Die Dauerhaftigkeit von Daten für Azure Storage wird ermöglicht, indem mehrere Kopien aller Daten auf verschiedenen Laufwerken gespeichert werden, die sich auf voneinander vollständig unabhängigen physischen Speichersubsystemen innerhalb der Region befinden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-201">Azure Storage facilitates data durability by maintaining multiple copies of all data on different drives across fully independent physical storage subsystems within the region.</span></span> <span data-ttu-id="d0aa3-202">Daten werden synchron repliziert, und für alle Kopien wird ein Commit ausgeführt, bevor ein Schreibvorgang bestätigt wird.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-202">Data is replicated synchronously, and all copies are committed before the write is acknowledged.</span></span> <span data-ttu-id="d0aa3-203">Azure Storage weist eine hohe Konsistenz auf, was bedeutet, dass Lesevorgänge garantiert die neuesten Schreibvorgänge widerspiegeln.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-203">Azure Storage is strongly consistent, meaning that reads are guaranteed to reflect the most recent writes.</span></span> <span data-ttu-id="d0aa3-204">Darüber hinaus werden Kopien der Daten fortlaufend überprüft, um Datenverfall zu erkennen und zu beheben – eine häufig übersehene Bedrohung der Integrität gespeicherter Daten.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-204">In addition, copies of data are continually scanned to detect and repair bit rot, an often overlooked threat to the integrity of stored data.</span></span>

<span data-ttu-id="d0aa3-205">Dienste profitieren bereits durch die reine Verwendung von Azure Storage von der Replikation.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-205">Services benefit from replication just by using Azure Storage.</span></span> <span data-ttu-id="d0aa3-206">Der Dienstentwickler muss für die Wiederherstellung nach einem lokalen Ausfall keine zusätzlichen Schritte ausführen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-206">The service developer doesn't need to do additional work to recover from a local failure.</span></span>

### <a name="resource-management"></a><span data-ttu-id="d0aa3-207">Ressourcenverwaltung</span><span class="sxs-lookup"><span data-stu-id="d0aa3-207">Resource management</span></span>
<span data-ttu-id="d0aa3-208">Speicherkonten, die nach Mai 2014 erstellt wurden, können auf bis zu 500 TB skaliert werden (zuvor lag die Höchstgrenze bei 200 TB).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-208">Storage accounts created after May 2014, can grow to up to 500 TB (the previous maximum was 200 TB).</span></span> <span data-ttu-id="d0aa3-209">Wenn zusätzlicher Speicherplatz erforderlich ist, müssen Anwendungen so entworfen werden, dass sie mehrere Speicherkonten verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-209">If additional space is required, applications must be designed to use multiple storage accounts.</span></span>

### <a name="virtual-machine-disks"></a><span data-ttu-id="d0aa3-210">VM-Datenträger</span><span class="sxs-lookup"><span data-stu-id="d0aa3-210">Virtual machine disks</span></span>
<span data-ttu-id="d0aa3-211">Ein VM-Datenträger wird als Seitenblob in Azure Storage gespeichert und erhält damit die gleichen Dauerhaftigkeits- und Skalierbarkeitseigenschaften wie Blobspeicher.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-211">A virtual machine’s disk is stored as a page blob in Azure Storage, giving it all the same durability and scalability properties as Blob storage.</span></span> <span data-ttu-id="d0aa3-212">Aufgrund dieses Designs sind die Daten auf dem Datenträger eines virtuellen Computers persistent. Dies gilt selbst dann, wenn der Server ausfällt, auf dem der virtuelle Computer ausgeführt wird, und der virtuelle Computer auf einem anderen Server neu gestartet werden muss.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-212">This design makes the data on a virtual machine’s disk persistent, even if the server running the VM fails and the VM must be restarted on another server.</span></span>

## <a name="database"></a><span data-ttu-id="d0aa3-213">Datenbank</span><span class="sxs-lookup"><span data-stu-id="d0aa3-213">Database</span></span>
### <a name="sql-database"></a><span data-ttu-id="d0aa3-214">SQL-Datenbank</span><span class="sxs-lookup"><span data-stu-id="d0aa3-214">SQL Database</span></span>
<span data-ttu-id="d0aa3-215">Azure SQL-Datenbank ermöglicht „Database as a Service“.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-215">Azure SQL Database provides database as a service.</span></span> <span data-ttu-id="d0aa3-216">Hierbei können Anwendungen relationale Datenbanken schnell bereitstellen, Daten einfügen und die Datenbanken abfragen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-216">It allows applications to quickly provision, insert data into, and query relational databases.</span></span> <span data-ttu-id="d0aa3-217">Azure SQL-Datenbank stellt viele der vertrauten SQL Server-Features und -Funktionen bereit und entbindet Sie gleichzeitig vom Aufwand für Hardware, Konfiguration, Patching und Resilienz.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-217">It provides many of the familiar SQL Server features and functionality, while abstracting the burden of hardware, configuration, patching, and resiliency.</span></span>

> [!NOTE]
> <span data-ttu-id="d0aa3-218">Azure SQL-Datenbank weist keine 1:1-Featureübereinstimmung mit SQL Server auf.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-218">Azure SQL Database does not provide one-to-one feature parity with SQL Server.</span></span> <span data-ttu-id="d0aa3-219">Es sollen andere Anforderungen erfüllt werden, und zwar speziell für Cloudanwendungen (elastische Skalierung, „Database as a Service“ zur Reduzierung von Wartungskosten usw.).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-219">It's intended to fulfill a different set of requirements--one that's uniquely suited to cloud applications (elastic scale, database as a service to reduce maintenance costs, and so on).</span></span> <span data-ttu-id="d0aa3-220">Weitere Informationen finden Sie unter [Wählen Sie eine SQL Server-Cloudoption: Azure SQL-Datenbank (PaaS) oder SQL Server auf Azure-VMs (IaaS)](/azure/sql-database/sql-database-paas-vs-sql-server-iaas/).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-220">For more information, see [Choose a cloud SQL Server option: Azure SQL (PaaS) Database or SQL Server on Azure VMs (IaaS)](/azure/sql-database/sql-database-paas-vs-sql-server-iaas/).</span></span>
> 
> 

#### <a name="replication"></a><span data-ttu-id="d0aa3-221">Replikation</span><span class="sxs-lookup"><span data-stu-id="d0aa3-221">Replication</span></span>
<span data-ttu-id="d0aa3-222">Azure SQL-Datenbank stellt integrierte Resilienz gegenüber Fehlern auf Knotenebene bereit.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-222">Azure SQL Database provides built-in resiliency to node-level failure.</span></span> <span data-ttu-id="d0aa3-223">Alle Schreibvorgänge in eine Datenbank werden automatisch mithilfe eines Commitverfahrens per Quorum auf mindestens zwei Hintergrundknoten repliziert.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-223">All writes into a database are automatically replicated to two or more background nodes through a quorum commit technique.</span></span> <span data-ttu-id="d0aa3-224">(Der primäre Knoten und mindestens ein sekundärer Knoten müssen bestätigen, dass die Aktivität in das Transaktionsprotokoll geschrieben wird, bevor die Transaktion als erfolgreich betrachtet und zurückgegeben wird.) Im Fall eines Knotenfehlers führt die Datenbank automatisch ein Failover auf eins der sekundären Replikate durch.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-224">(The primary and at least one secondary must confirm that the activity is written to the transaction log before the transaction is deemed successful and returns.) In the case of node failure, the database automatically fails over to one of the secondary replicas.</span></span> <span data-ttu-id="d0aa3-225">Dies verursacht eine vorübergehende Unterbrechung der Verbindung für Clientanwendungen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-225">This causes a transient connection interruption for client applications.</span></span> <span data-ttu-id="d0aa3-226">Aus diesem Grund müssen alle Azure SQL-Datenbank-Clients die Verarbeitung vorübergehender Verbindungen in irgendeiner Form implementieren.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-226">For this reason, all Azure SQL Database clients must implement some form of transient connection handling.</span></span> <span data-ttu-id="d0aa3-227">Weitere Informationen finden Sie unter [Anleitung zu dienstspezifischen Wiederholungsmechanismen](/azure/best-practices-retry-service-specific/).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-227">For more information, see [Retry service specific guidance](/azure/best-practices-retry-service-specific/).</span></span>

#### <a name="resource-management"></a><span data-ttu-id="d0aa3-228">Ressourcenverwaltung</span><span class="sxs-lookup"><span data-stu-id="d0aa3-228">Resource management</span></span>
<span data-ttu-id="d0aa3-229">Jede Datenbank wird bei der Erstellung mit einer Größenbeschränkung konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-229">Each database, when created, is configured with an upper size limit.</span></span> <span data-ttu-id="d0aa3-230">Die derzeit verfügbare maximale Größe beträgt 1 TB (Größenbeschränkungen variieren je nach Dienstebene, siehe [Tarife und Leistungsstufen von Azure SQL-Datenbanken](/azure/sql-database/sql-database-resource-limits/#service-tiers-and-performance-levels)).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-230">The currently available maximum size is 1 TB (size limits vary based on your service tier, see [service tiers and performance levels of Azure SQL Databases](/azure/sql-database/sql-database-resource-limits/#service-tiers-and-performance-levels).</span></span> <span data-ttu-id="d0aa3-231">Wenn eine Datenbank den oberen Grenzwert erreicht, werden weitere INSERT- oder UPDATE-Befehle zurückgewiesen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-231">When a database hits its upper size limit, it rejects additional INSERT or UPDATE commands.</span></span> <span data-ttu-id="d0aa3-232">(Das Abfragen und Löschen von Daten ist weiterhin möglich.)</span><span class="sxs-lookup"><span data-stu-id="d0aa3-232">(Querying and deleting data is still possible.)</span></span>

<span data-ttu-id="d0aa3-233">Innerhalb einer Datenbank verwendet Azure SQL-Datenbank ein Fabric zur Verwaltung von Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-233">Within a database, Azure SQL Database uses a fabric to manage resources.</span></span> <span data-ttu-id="d0aa3-234">Anstelle eines Fabric Controllers wird jedoch eine Ringtopologie eingesetzt, um Fehler zu erkennen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-234">However, instead of a fabric controller, it uses a ring topology to detect failures.</span></span> <span data-ttu-id="d0aa3-235">Jedes Replikat in einem Cluster besitzt zwei Nachbarn und ist dafür zuständig zu erkennen, wenn diese ausfallen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-235">Every replica in a cluster has two neighbors and is responsible for detecting when they go down.</span></span> <span data-ttu-id="d0aa3-236">Wenn ein Replikat ausfällt, lösen seine Nachbarn einen Reconfiguration Agent aus, um das Replikat auf einem anderen Computer neu zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-236">When a replica goes down, its neighbors trigger a reconfiguration agent to re-create it on another machine.</span></span> <span data-ttu-id="d0aa3-237">Mithilfe einer Engine-Drosselung wird sichergestellt, dass ein logischer Server nicht zu viele Ressourcen auf einem Computer verwendet oder die physischen Grenzwerte des Computers überschreitet.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-237">Engine throttling is provided to ensure that a logical server doesn't use too many resources on a machine or exceed the machine’s physical limits.</span></span>

### <a name="elasticity"></a><span data-ttu-id="d0aa3-238">Elastizität</span><span class="sxs-lookup"><span data-stu-id="d0aa3-238">Elasticity</span></span>
<span data-ttu-id="d0aa3-239">Wenn für die Anwendung mehr Speicherplatz als das von der Datenbank vorgegebene Limit von 1 TB erforderlich ist, muss ein Verfahren zur horizontalen Hochskalierung implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-239">If the application requires more than the 1 TB database limit, it must implement a scale-out approach.</span></span> <span data-ttu-id="d0aa3-240">Sie führen die horizontale Hochskalierung mit Azure SQL-Datenbank durch, indem Sie Daten über mehrere SQL-Datenbanken hinweg manuell partitionieren (auch als Sharding bezeichnet).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-240">You scale out with Azure SQL Database by manually partitioning, also known as sharding, data across multiple SQL databases.</span></span> <span data-ttu-id="d0aa3-241">Ein solcher Ansatz ermöglicht es, mithilfe der Skalierung einen nahezu linearen Kostenanstieg zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-241">This scale-out approach provides the opportunity to achieve nearly linear cost growth with scale.</span></span> <span data-ttu-id="d0aa3-242">Durch elastisches Wachstum bzw. bedarfsgesteuerte Kapazität können Systeme mit inkrementellem Kostenanstieg wachsen, da Datenbanken basierend auf der pro Tag tatsächlich durchschnittlich genutzten Größe berechnet werden, nicht basierend auf der möglichen Maximalgröße.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-242">Elastic growth or capacity on demand can grow with incremental costs as needed because databases are billed based on the average actual size used per day, not based on maximum possible size.</span></span>

## <a name="sql-server-on-virtual-machines"></a><span data-ttu-id="d0aa3-243">SQL Server auf virtuellen Computern</span><span class="sxs-lookup"><span data-stu-id="d0aa3-243">SQL Server on Virtual Machines</span></span>
<span data-ttu-id="d0aa3-244">Durch das Installieren von SQL Server auf virtuellen Azure-Computern (Version 2014 oder höher) können Sie die herkömmlichen Verfügbarkeitsfunktionen von SQL Server nutzen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-244">By installing SQL Server (version 2014 or later) on Azure Virtual Machines, you can take advantage of the traditional availability features of SQL Server.</span></span> <span data-ttu-id="d0aa3-245">Beispiele hierfür sind AlwaysOn-Verfügbarkeitsgruppen oder die Datenbankspiegelung.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-245">These features include AlwaysOn Availability Groups and database mirroring.</span></span> <span data-ttu-id="d0aa3-246">Beachten Sie, dass für virtuelle Computer, Speicher und Netzwerkressourcen von Azure andere Betriebsmerkmale gelten als für eine lokale, nicht virtualisierte IT-Infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-246">Note that Azure VMs, storage, and networking have different operational characteristics than an on-premises, non-virtualized IT infrastructure.</span></span> <span data-ttu-id="d0aa3-247">Für eine erfolgreiche Implementierung einer SQL Server-Lösung für Hochverfügbarkeit und Notfallwiederherstellung in Azure sollten Sie diese Unterschiede kennen und Ihre Lösung daran anpassen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-247">A successful implementation of a high availability/disaster recovery (HA/DR) SQL Server solution in Azure requires that you understand these differences and design your solution to accommodate them.</span></span>

### <a name="high-availability-nodes-in-an-availability-set"></a><span data-ttu-id="d0aa3-248">Hochverfügbarkeitsknoten in einer Verfügbarkeitsgruppe</span><span class="sxs-lookup"><span data-stu-id="d0aa3-248">High-availability nodes in an availability set</span></span>
<span data-ttu-id="d0aa3-249">Wenn Sie eine Hochverfügbarkeitslösung in Azure implementieren, können Sie mithilfe einer Verfügbarkeitsgruppe in Azure Hochverfügbarkeitsknoten in separaten Fehler- und Upgradedomänen platzieren.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-249">When you implement a high-availability solution in Azure, you can use the availability set in Azure to place the high-availability nodes into separate fault domains and upgrade domains.</span></span> <span data-ttu-id="d0aa3-250">Bei einer Verfügbarkeitsgruppe handelt es sich um ein Azure-Konzept.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-250">To be clear, the availability set is an Azure concept.</span></span> <span data-ttu-id="d0aa3-251">Sie sollten diese bewährte Methode befolgen, um sicherzustellen, dass Ihre Datenbanken tatsächlich hoch verfügbar sind – unabhängig davon, ob Sie AlwaysOn-Verfügbarkeitsgruppen, Datenbankspiegelung oder andere Verfahren verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-251">It's a best practice that you should follow to make sure that your databases are indeed highly available, whether you're using AlwaysOn Availability Groups, database mirroring, or something else.</span></span> <span data-ttu-id="d0aa3-252">Wenn Sie diese bewährte Methode nicht befolgen, gehen Sie unter Umständen fälschlicherweise davon aus, dass Ihr System hoch verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-252">If you don't follow this best practice, you might be under the false assumption that your system is highly available.</span></span> <span data-ttu-id="d0aa3-253">In Wahrheit können Ihre Knoten jedoch alle gleichzeitig ausfallen, weil sie zufällig in der gleichen Fehlerdomäne in der Azure-Region platziert wurden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-253">But in reality, your nodes can all fail simultaneously because they happen to be placed in the same fault domain in the Azure region.</span></span>

<span data-ttu-id="d0aa3-254">Diese Empfehlung gilt nicht im gleichen Ausmaß für den Protokollversand.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-254">This recommendation is not as applicable with log shipping.</span></span> <span data-ttu-id="d0aa3-255">Es handelt sich hierbei um eine Funktion der Notfallwiederherstellung. Sie sollten sicherstellen, dass die Server in separaten Azure-Regionen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-255">As a disaster recovery feature, you should ensure that the servers are running in separate Azure regions.</span></span> <span data-ttu-id="d0aa3-256">Der Definition nach handelt es sich bei diesen Regionen um separate Fehlerdomänen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-256">By definition, these regions are separate fault domains.</span></span>

<span data-ttu-id="d0aa3-257">Damit sich Azure Cloud Services-VMs, die über das klassische Portal bereitgestellt werden, in derselben Verfügbarkeitsgruppe befinden, müssen Sie sie in derselben Cloud Service-Instanz bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-257">For Azure Cloud Services VMs deployed through the classic portal to be in the same availability set, you must deploy them in the same Cloud Service.</span></span> <span data-ttu-id="d0aa3-258">Für VMs, die mit dem Azure Resource Manager (aktuelles Portal) bereitgestellt werden, besteht diese Einschränkung nicht.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-258">VMs deployed through Azure Resource Manager (the current portal) do not have this limitation.</span></span> <span data-ttu-id="d0aa3-259">Für VMs, die mit dem klassischen Portal in Azure Cloud Services bereitgestellt werden, können nur Knoten in derselben Cloud Services-Instanz an derselben Verfügbarkeitsgruppe beteiligt sein.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-259">For classic portal deployed VMs in Azure Cloud Service, only nodes in the same Cloud Service can participate in the same availability set.</span></span> <span data-ttu-id="d0aa3-260">Darüber hinaus sollten sich die Cloud Services-VMs in demselben virtuellen Netzwerk befinden, um sicherzustellen, dass sie auch nach einer Dienstreparatur ihre IPs beibehalten.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-260">In addition, the Cloud Services VMs should be in the same virtual network to ensure that they maintain their IPs even after service healing.</span></span> <span data-ttu-id="d0aa3-261">So können Störungen beim DNS-Update vermieden werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-261">This avoids DNS update disruptions.</span></span>

### <a name="azure-only-high-availability-solutions"></a><span data-ttu-id="d0aa3-262">Nur in Azure: Lösungen mit hoher Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="d0aa3-262">Azure-only: High-availability solutions</span></span>
<span data-ttu-id="d0aa3-263">Sie können eine Lösung mit hoher Verfügbarkeit für SQL Server-Datenbanken in Azure mit AlwaysOn-Verfügbarkeitsgruppen oder per Datenbankspiegelung umsetzen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-263">You can have a high-availability solution for your SQL Server databases in Azure by using AlwaysOn Availability Groups or database mirroring.</span></span>

<span data-ttu-id="d0aa3-264">Das folgende Diagramm veranschaulicht die Architektur von AlwaysOn-Verfügbarkeitsgruppen, die auf Azure Virtual Machines ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-264">The following diagram demonstrates the architecture of AlwaysOn Availability Groups running on Azure Virtual Machines.</span></span> <span data-ttu-id="d0aa3-265">Das Diagramm stammt aus dem detaillierten Artikel zu diesem Thema: [Hochverfügbarkeit und Notfallwiederherstellung für SQL Server auf virtuellen Azure-Computern](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-265">This diagram was taken from the in-depth article on this subject, [High availability and disaster recovery for SQL Server on Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

![AlwaysOn-Verfügbarkeitsgruppen in Microsoft Azure](./images/technical-guidance-recovery-local-failures/high_availability_solutions-1.png)

<span data-ttu-id="d0aa3-267">Sie können eine AlwaysOn-Verfügbarkeitsgruppe auch als automatische End-to-End-Bereitstellung auf virtuellen Azure-Computern implementieren, indem Sie die AlwaysOn-Vorlage im Azure-Portal verwenden.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-267">You can also automatically provision an AlwaysOn Availability Groups deployment end-to-end on Azure VMs by using the AlwaysOn template in the Azure portal.</span></span> <span data-ttu-id="d0aa3-268">Weitere Informationen finden Sie unter [SQL Server AlwaysOn Offering in Microsoft Azure Portal Gallery](https://blogs.technet.microsoft.com/dataplatforminsider/2014/08/25/sql-server-alwayson-offering-in-microsoft-azure-portal-gallery/)(in englischer Sprache).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-268">For more information, see [SQL Server AlwaysOn Offering in Microsoft Azure Portal Gallery](https://blogs.technet.microsoft.com/dataplatforminsider/2014/08/25/sql-server-alwayson-offering-in-microsoft-azure-portal-gallery/).</span></span>

<span data-ttu-id="d0aa3-269">Das folgende Diagramm veranschaulicht die Verwendung der Datenbankspiegelung auf Azure Virtual Machines.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-269">The following diagram demonstrates the use of database mirroring on Azure Virtual Machines.</span></span> <span data-ttu-id="d0aa3-270">Auch dieses Diagramm stammt aus dem detaillierten Artikel [Hochverfügbarkeit und Notfallwiederherstellung für SQL Server auf virtuellen Azure-Computern](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-270">It was also taken from the in-depth topic [High availability and disaster recovery for SQL Server on Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

![Datenbankspiegelung in Microsoft Azure](./images/technical-guidance-recovery-local-failures/high_availability_solutions-2.png)

> [!NOTE]
> <span data-ttu-id="d0aa3-272">Für beide Architekturen ist ein Domänencontroller erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-272">Both architectures require a domain controller.</span></span> <span data-ttu-id="d0aa3-273">Bei der Datenbankspiegelung können jedoch Serverzertifikate verwendet werden, sodass kein Domänencontroller benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-273">However, with database mirroring, it's possible to use server certificates to eliminate the need for a domain controller.</span></span>
> 
> 

## <a name="other-azure-platform-services"></a><span data-ttu-id="d0aa3-274">Weitere Azure Platform-Dienste</span><span class="sxs-lookup"><span data-stu-id="d0aa3-274">Other Azure platform services</span></span>
<span data-ttu-id="d0aa3-275">Anwendungen, die unter Azure erstellt werden, profitieren von Plattformfunktionen für die Wiederherstellung nach lokalen Ausfällen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-275">Applications that are built on Azure benefit from platform capabilities to recover from local failures.</span></span> <span data-ttu-id="d0aa3-276">In einigen Fällen können Sie bestimmte Aktionen durchführen, um die Verfügbarkeit für Ihr jeweiliges Szenario zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-276">In some cases, you can take specific actions to increase availability for your specific scenario.</span></span>

### <a name="service-bus"></a><span data-ttu-id="d0aa3-277">SERVICE BUS</span><span class="sxs-lookup"><span data-stu-id="d0aa3-277">Service Bus</span></span>
<span data-ttu-id="d0aa3-278">Um die Risiken durch einen vorübergehenden Ausfall von Azure Service Bus zu minimieren, können Sie eine dauerhafte clientseitige Warteschlange erstellen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-278">To mitigate against a temporary outage of Azure Service Bus, consider creating a durable client-side queue.</span></span> <span data-ttu-id="d0aa3-279">Diese Warteschlange verwendet vorübergehend einen alternativen, lokalen Speichermechanismus, um Nachrichten zu speichern, die der Service Bus-Warteschlange nicht hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-279">This temporarily uses an alternate, local storage mechanism to store messages that cannot be added to the Service Bus queue.</span></span> <span data-ttu-id="d0aa3-280">Die Anwendung kann entscheiden, wie die temporär gespeicherten Nachrichten verarbeitet werden sollen, nachdem der Dienst wiederhergestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-280">The application can decide how to handle the temporarily stored messages after the service is restored.</span></span> <span data-ttu-id="d0aa3-281">Weitere Informationen finden Sie unter [Bewährte Methoden für Leistungsoptimierungen mithilfe von Service Bus-Brokermessaging](/azure/service-bus-messaging/service-bus-performance-improvements/) sowie unter [Service Bus (Notfallwiederherstellung)](recovery-loss-azure-region.md#other-azure-platform-services).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-281">For more information, see [Best practices for performance improvements using Service Bus brokered messaging](/azure/service-bus-messaging/service-bus-performance-improvements/) and [Service Bus (disaster recovery)](recovery-loss-azure-region.md#other-azure-platform-services).</span></span>

### <a name="hdinsight"></a><span data-ttu-id="d0aa3-282">HDInsight</span><span class="sxs-lookup"><span data-stu-id="d0aa3-282">HDInsight</span></span>
<span data-ttu-id="d0aa3-283">Die mit Azure HDInsight verknüpften Daten werden standardmäßig in Azure Blob Storage gespeichert.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-283">The data that's associated with Azure HDInsight is stored by default in Azure Blob storage.</span></span> <span data-ttu-id="d0aa3-284">Azure Storage stellt Eigenschaften für hohe Verfügbarkeit und Dauerhaftigkeit für Blob Storage bereit.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-284">Azure Storage specifies high-availability and durability properties for Blob storage.</span></span> <span data-ttu-id="d0aa3-285">Die Verarbeitung über mehrere Knoten hinweg, die für Hadoop MapReduce-Aufträge erforderlich ist, erfolgt auf einem vorübergehenden Hadoop Distributed File System (HDFS), das bei Bedarf für HDInsight bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-285">The multiple-node processing that's associated with Hadoop MapReduce jobs occurs on a transient Hadoop Distributed File System (HDFS) that is provisioned when HDInsight needs it.</span></span> <span data-ttu-id="d0aa3-286">Die Ergebnisse eines MapReduce-Auftrags werden standardmäßig auch in Azure Blob Storage gespeichert, sodass die verarbeiteten Daten dauerhaft und hoch verfügbar sind, nachdem die Bereitstellung des Hadoop-Clusters aufgehoben wurde.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-286">Results from a MapReduce job are also stored by default in Azure Blob storage, so that the processed data is durable and remains highly available after the Hadoop cluster is deprovisioned.</span></span> <span data-ttu-id="d0aa3-287">Weitere Informationen finden Sie unter [HDInsight (Notfallwiederherstellung)](recovery-loss-azure-region.md#other-azure-platform-services).</span><span class="sxs-lookup"><span data-stu-id="d0aa3-287">For more information, see [HDInsight (disaster recovery)](recovery-loss-azure-region.md#other-azure-platform-services).</span></span>

## <a name="checklists-for-local-failures"></a><span data-ttu-id="d0aa3-288">Prüflisten für lokale Fehler</span><span class="sxs-lookup"><span data-stu-id="d0aa3-288">Checklists for local failures</span></span>
### <a name="cloud-services"></a><span data-ttu-id="d0aa3-289">Cloud Services</span><span class="sxs-lookup"><span data-stu-id="d0aa3-289">Cloud Services</span></span>
1. <span data-ttu-id="d0aa3-290">Lesen Sie den Abschnitt zu Cloud Services in diesem Dokument.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-290">Review the Cloud Services section of this document.</span></span>
2. <span data-ttu-id="d0aa3-291">Konfigurieren Sie mindestens zwei Instanzen für jede Rolle.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-291">Configure at least two instances for each role.</span></span>
3. <span data-ttu-id="d0aa3-292">Speichern Sie den Status in einem permanenten Speicher, nicht in Rolleninstanzen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-292">Persist state in durable storage, not on role instances.</span></span>
4. <span data-ttu-id="d0aa3-293">Verarbeiten Sie das StatusCheck-Ereignis richtig.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-293">Correctly handle the StatusCheck event.</span></span>
5. <span data-ttu-id="d0aa3-294">Fassen Sie aufeinander bezogene Änderungen in Transaktionen zusammen, sofern dies möglich ist.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-294">Wrap related changes in transactions when possible.</span></span>
6. <span data-ttu-id="d0aa3-295">Überprüfen Sie, ob die Workerrollenaufgaben idempotent sind und neu gestartet werden können.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-295">Verify that worker role tasks are idempotent and restartable.</span></span>
7. <span data-ttu-id="d0aa3-296">Rufen Sie Vorgänge so lange auf, bis sie erfolgreich sind.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-296">Continue to invoke operations until they succeed.</span></span>
8. <span data-ttu-id="d0aa3-297">Erwägen Sie die Verwendung von Strategien für eine automatische Skalierung.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-297">Consider autoscaling strategies.</span></span>

### <a name="virtual-machines"></a><span data-ttu-id="d0aa3-298">Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="d0aa3-298">Virtual Machines</span></span>
1. <span data-ttu-id="d0aa3-299">Lesen Sie den Abschnitt zu Virtual Machines in diesem Dokument.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-299">Review the Virtual Machines section of this document.</span></span>
2. <span data-ttu-id="d0aa3-300">Verwenden Sie Laufwerk D nicht zum dauerhaften Speichern.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-300">Do not use drive D for persistent storage.</span></span>
3. <span data-ttu-id="d0aa3-301">Gruppieren Sie Computer einer Dienstebene in einer Verfügbarkeitsgruppe.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-301">Group machines in a service tier into an availability set.</span></span>
4. <span data-ttu-id="d0aa3-302">Konfigurieren Sie den Lastenausgleich und optionale Tests.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-302">Configure load balancing and optional probes.</span></span>

### <a name="storage"></a><span data-ttu-id="d0aa3-303">Speicher</span><span class="sxs-lookup"><span data-stu-id="d0aa3-303">Storage</span></span>
1. <span data-ttu-id="d0aa3-304">Lesen Sie den Abschnitt zu Storage in diesem Dokument.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-304">Review the Storage section of this document.</span></span>
2. <span data-ttu-id="d0aa3-305">Verwenden Sie mehrere Speicherkonten, wenn Daten oder Bandbreite das Kontingent überschreiten.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-305">Use multiple storage accounts when data or bandwidth exceeds quotas.</span></span>

### <a name="sql-database"></a><span data-ttu-id="d0aa3-306">SQL-Datenbank</span><span class="sxs-lookup"><span data-stu-id="d0aa3-306">SQL Database</span></span>
1. <span data-ttu-id="d0aa3-307">Lesen Sie den Abschnitt zu SQL-Datenbank in diesem Dokument.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-307">Review the SQL Database section of this document.</span></span>
2. <span data-ttu-id="d0aa3-308">Implementieren Sie eine Wiederholungsrichtlinie zum Verarbeiten von vorübergehenden Fehlern.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-308">Implement a retry policy to handle transient errors.</span></span>
3. <span data-ttu-id="d0aa3-309">Verwenden Sie Partitionierung/Sharding als Strategie zum horizontalen Hochskalieren.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-309">Use partitioning/sharding as a scale-out strategy.</span></span>

### <a name="sql-server-on-virtual-machines"></a><span data-ttu-id="d0aa3-310">SQL Server auf virtuellen Computern</span><span class="sxs-lookup"><span data-stu-id="d0aa3-310">SQL Server on Virtual Machines</span></span>
1. <span data-ttu-id="d0aa3-311">Lesen Sie den Abschnitt zu SQL Server auf Virtual Machines in diesem Dokument.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-311">Review the SQL Server on Virtual Machines section of this document.</span></span>
2. <span data-ttu-id="d0aa3-312">Befolgen Sie die vorherigen Empfehlungen für Virtual Machines.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-312">Follow the previous recommendations for Virtual Machines.</span></span>
3. <span data-ttu-id="d0aa3-313">Verwenden Sie die Hochverfügbarkeitsfunktionen von SQL Server, z.B. AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-313">Use SQL Server high availability features, such as AlwaysOn.</span></span>

### <a name="service-bus"></a><span data-ttu-id="d0aa3-314">SERVICE BUS</span><span class="sxs-lookup"><span data-stu-id="d0aa3-314">Service Bus</span></span>
1. <span data-ttu-id="d0aa3-315">Lesen Sie den Abschnitt zu Service Bus in diesem Dokument.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-315">Review the Service Bus section of this document.</span></span>
2. <span data-ttu-id="d0aa3-316">Erstellen Sie ggf. eine dauerhafte clientseitige Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-316">Consider creating a durable client-side queue as a backup.</span></span>

### <a name="hdinsight"></a><span data-ttu-id="d0aa3-317">HDInsight</span><span class="sxs-lookup"><span data-stu-id="d0aa3-317">HDInsight</span></span>
1. <span data-ttu-id="d0aa3-318">Lesen Sie den Abschnitt zu HDInsight in diesem Dokument.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-318">Review the HDInsight section of this document.</span></span>
2. <span data-ttu-id="d0aa3-319">Es sind keine zusätzlichen Schritte erforderlich, um die Verfügbarkeit bei lokalen Fehlern sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="d0aa3-319">No additional availability steps are required for local failures.</span></span>

