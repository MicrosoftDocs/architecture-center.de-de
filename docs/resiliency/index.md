---
title: "Entwerfen robuster Anwendungen für Azure"
description: "Es wird beschrieben, wie Sie in Azure robuste Anwendungen mit Hochverfügbarkeit und Notfallwiederherstellung erstellen."
author: MikeWasson
ms.date: 05/26/2017
ms.custom: resiliency
pnp.series.title: Design for Resiliency
ms.openlocfilehash: 31a685e46da02fb59d93a210e6f14da5c68331de
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/14/2017
---
# <a name="designing-resilient-applications-for-azure"></a><span data-ttu-id="9e25c-103">Entwerfen robuster Anwendungen für Azure</span><span class="sxs-lookup"><span data-stu-id="9e25c-103">Designing resilient applications for Azure</span></span>

<span data-ttu-id="9e25c-104">In einem verteilten System kommt es unweigerlich zu Fehlern.</span><span class="sxs-lookup"><span data-stu-id="9e25c-104">In a distributed system, failures will happen.</span></span> <span data-ttu-id="9e25c-105">Hardware kann ausfallen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-105">Hardware can fail.</span></span> <span data-ttu-id="9e25c-106">Im Netzwerk können vorübergehende Fehler auftreten.</span><span class="sxs-lookup"><span data-stu-id="9e25c-106">The network can have transient failures.</span></span> <span data-ttu-id="9e25c-107">In seltenen Fällen kann ein gesamter Dienst oder eine Region ausfallen, aber auch hierfür muss eine Planung vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="9e25c-107">Rarely, an entire service or region may experience a disruption, but even those must be planned for.</span></span> 

<span data-ttu-id="9e25c-108">Das Erstellen einer zuverlässigen Anwendung in der Cloud unterscheidet sich vom Erstellen einer zuverlässigen Anwendung in einer Unternehmensumgebung.</span><span class="sxs-lookup"><span data-stu-id="9e25c-108">Building a reliable application in the cloud is different than building a reliable application in an enterprise setting.</span></span> <span data-ttu-id="9e25c-109">Bisher haben Sie höherwertige Hardware gekauft, um zentral hochzuskalieren, aber in einer Cloudumgebung müssen Sie stattdessen horizontal hochskalieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-109">While historically you may have purchased higher-end hardware to scale up, in a cloud environment you must scale out instead of scaling up.</span></span> <span data-ttu-id="9e25c-110">Die Kosten für Cloudumgebungen werden niedrig gehalten, indem Standardhardware eingesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-110">Costs for cloud environments are kept low through the use of commodity hardware.</span></span> <span data-ttu-id="9e25c-111">In dieser neuen Umgebung liegt der Schwerpunkt auf der mittleren Zeit bis zur Wiederherstellung (Mean Time To Restore) und nicht mehr auf der mittleren Zeit zwischen Ausfällen (Mean Time Between Failures).</span><span class="sxs-lookup"><span data-stu-id="9e25c-111">Instead of focusing on preventing failures and optimizing "mean time between failures," in this new environment the focus shifts to "mean time to restore."</span></span> <span data-ttu-id="9e25c-112">Das Ziel besteht hierbei darin, die Auswirkungen eines Ausfalls gering zu halten.</span><span class="sxs-lookup"><span data-stu-id="9e25c-112">The goal is to minimize the effect of a failure.</span></span>

<span data-ttu-id="9e25c-113">Dieser Artikel enthält eine Übersicht über die Erstellung von robusten Anwendungen in Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="9e25c-113">This article provides an overview of how to build resilient applications in Microsoft Azure.</span></span> <span data-ttu-id="9e25c-114">Zuerst werden der Begriff *Resilienz* und die dazugehörigen Konzepte definiert.</span><span class="sxs-lookup"><span data-stu-id="9e25c-114">It starts with a definition of the term *resiliency* and related concepts.</span></span> <span data-ttu-id="9e25c-115">Anschließend wird der Prozess zur Erreichung von Resilienz beschrieben. Hierzu wird ein strukturierter Ansatz für die Lebensdauer einer Anwendung verwendet – vom Entwurf und der Implementierung über die Bereitstellung bis zum Betrieb.</span><span class="sxs-lookup"><span data-stu-id="9e25c-115">Then it describes a process for achieving resiliency, using a structured approach over the lifetime of an application, from design and implementation to deployment and operations.</span></span>

## <a name="what-is-resiliency"></a><span data-ttu-id="9e25c-116">Was ist Resilienz?</span><span class="sxs-lookup"><span data-stu-id="9e25c-116">What is resiliency?</span></span>
<span data-ttu-id="9e25c-117">Bei der **Resilienz** (Robustheit) geht es um die Möglichkeit, nach Ausfällen für ein System eine Wiederherstellung durchzuführen und die Betriebsbereitschaft sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-117">**Resiliency** is the ability of a system to recover from failures and continue to function.</span></span> <span data-ttu-id="9e25c-118">Es geht nicht um das *Vermeiden* von Ausfällen, sondern um das *Reagieren* auf Ausfälle, um Ausfallzeiten oder Datenverluste zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-118">It's not about *avoiding* failures, but *responding* to failures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="9e25c-119">Das Ziel besteht bei der Resilienz darin, für die Anwendung nach einem Ausfall wieder die volle Funktionsfähigkeit herzustellen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-119">The goal of resiliency is to return the application to a fully functioning state following a failure.</span></span>

<span data-ttu-id="9e25c-120">Zwei wichtige Aspekte der Resilienz sind Hochverfügbarkeit und Notfallwiederherstellung.</span><span class="sxs-lookup"><span data-stu-id="9e25c-120">Two important aspects of resiliency are high availability and disaster recovery.</span></span>

* <span data-ttu-id="9e25c-121">**Hochverfügbarkeit** ist die Möglichkeit, die Anwendung ohne signifikante Ausfallzeit in einem fehlerfreien Zustand weiterzubetreiben.</span><span class="sxs-lookup"><span data-stu-id="9e25c-121">**High availability** (HA) is the ability of the application to continue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="9e25c-122">Mit „fehlerfreier Zustand“ ist gemeint, dass die Anwendung reagiert und Benutzer eine Verbindung mit der Anwendung herstellen und damit interagieren können.</span><span class="sxs-lookup"><span data-stu-id="9e25c-122">By "healthy state," we mean the application is responsive, and users can connect to the application and interact with it.</span></span>  
* <span data-ttu-id="9e25c-123">Die **Notfallwiederherstellung** (Disaster Recovery, DR) ist die Möglichkeit, nach seltenen, schwerwiegenderen Vorfällen (dauerhafte Ausfälle größeren Ausmaßes, z.B. eine Dienstunterbrechung in einer gesamten Region) eine Wiederherstellung durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-123">**Disaster recovery** (DR) is the ability to recover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="9e25c-124">Die Notfallwiederherstellung umfasst die Datensicherung und -archivierung und kann auch einen manuellen Eingriff beinhalten, z.B. das Wiederherstellen einer Datenbank aus einer Sicherung.</span><span class="sxs-lookup"><span data-stu-id="9e25c-124">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span> 

<span data-ttu-id="9e25c-125">Sie können sich die Hochverfügbarkeit und Notfallwiederherstellung beispielsweise wie folgt vorstellen: Die Notfallwiederherstellung beginnt, wenn ein Fehler so große Auswirkungen hat, dass diese von der Einrichtung für Hochverfügbarkeit nicht mehr bewältigt werden können.</span><span class="sxs-lookup"><span data-stu-id="9e25c-125">One way to think about HA versus DR is that DR starts when the impact of a fault exceeds the ability of the HA design to handle it.</span></span> <span data-ttu-id="9e25c-126">Wenn Sie mehrere VMs beispielsweise hinter einem Lastenausgleich anordnen, ist die Verfügbarkeit sichergestellt, falls eine VM ausfällt – aber nicht bei einem Ausfall aller VMs zur gleichen Zeit.</span><span class="sxs-lookup"><span data-stu-id="9e25c-126">For example, putting several VMs behind a load balancer will provide availability if one VM fails, but not if they all fail at the same time.</span></span> 

<span data-ttu-id="9e25c-127">Wenn Sie eine robuste Anwendung entwerfen möchten, müssen Sie sich über Ihre Verfügbarkeitsanforderungen im Klaren sein.</span><span class="sxs-lookup"><span data-stu-id="9e25c-127">When you design an application to be resilient, you have to understand your availability requirements.</span></span> <span data-ttu-id="9e25c-128">Wie viel Ausfallzeit ist akzeptabel?</span><span class="sxs-lookup"><span data-stu-id="9e25c-128">How much downtime is acceptable?</span></span> <span data-ttu-id="9e25c-129">Dies ist teilweise eine Kostenfunktion.</span><span class="sxs-lookup"><span data-stu-id="9e25c-129">This is partly a function of cost.</span></span> <span data-ttu-id="9e25c-130">Welche Kosten fallen bei potenziellen Ausfallzeiten für Ihr Unternehmen an?</span><span class="sxs-lookup"><span data-stu-id="9e25c-130">How much will potential downtime cost your business?</span></span> <span data-ttu-id="9e25c-131">Wie viel Geld sollten Sie investieren, um für die Anwendung die Hochverfügbarkeit sicherzustellen?</span><span class="sxs-lookup"><span data-stu-id="9e25c-131">How much should you invest in making the application highly available?</span></span> <span data-ttu-id="9e25c-132">Außerdem müssen Sie definieren, was die Verfügbarkeit der Anwendung bedeutet.</span><span class="sxs-lookup"><span data-stu-id="9e25c-132">You also have to define what it means for the application to be available.</span></span> <span data-ttu-id="9e25c-133">Gilt die Anwendung beispielsweise als „ausgefallen“, wenn ein Kunde eine Bestellung senden kann, diese aber vom System nicht innerhalb des normalen Zeitrahmens verarbeitet werden kann?</span><span class="sxs-lookup"><span data-stu-id="9e25c-133">For example, is the application "down" if a customer can submit an order but the system cannot process it within the normal timeframe?</span></span> <span data-ttu-id="9e25c-134">Berücksichtigen Sie außerdem die Wahrscheinlichkeit eines bestimmten Ausfalltyps und die Kosteneffektivität einer Lösungsstrategie.</span><span class="sxs-lookup"><span data-stu-id="9e25c-134">Also consider the probability of a particular type of outage occurring, and whether a mitigation strategy is cost-effective.</span></span>

<span data-ttu-id="9e25c-135">Ein weiterer häufig verwendeter Begriff ist **Geschäftskontinuität** (Business Continuity, BC). Hierbei geht es um die Möglichkeit, auch bei bzw. nach widrigen Umständen, z.B. einer Naturkatastrophe oder einem Dienstausfall, wichtige Geschäftsfunktionen aufrechterhalten zu können.</span><span class="sxs-lookup"><span data-stu-id="9e25c-135">Another common term is **business continuity** (BC), which is the ability to perform essential business functions during and after adverse conditions, such as a natural disaster or a downed service.</span></span> <span data-ttu-id="9e25c-136">Die Geschäftskontinuität erstreckt sich auf den gesamten Betrieb des Unternehmens, z.B. physische Einrichtungen, Personal, Kommunikation, Transport und IT.</span><span class="sxs-lookup"><span data-stu-id="9e25c-136">BC covers the entire operation of the business, including physical facilities, people, communications, transportation, and IT.</span></span> <span data-ttu-id="9e25c-137">In diesem Artikel geht es um Cloudanwendungen, aber die Resilienzplanung muss in Bezug auf alle Anforderungen der Geschäftskontinuität durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-137">This article focuses on cloud applications, but resilience planning must be done in the context of overall BC requirements.</span></span> <span data-ttu-id="9e25c-138">Weitere Informationen finden Sie im [Leitfaden zur Notfallplanung][capacity-planning-guide] des National Institute of Science and Technology (NIST).</span><span class="sxs-lookup"><span data-stu-id="9e25c-138">For more information, see the [Contingency Planning Guide][capacity-planning-guide] from the National Institute of Science and Technology (NIST).</span></span>

## <a name="process-to-achieve-resiliency"></a><span data-ttu-id="9e25c-139">Prozess zur Erreichung von Resilienz</span><span class="sxs-lookup"><span data-stu-id="9e25c-139">Process to achieve resiliency</span></span>
<span data-ttu-id="9e25c-140">Resilienz ist kein Add-On.</span><span class="sxs-lookup"><span data-stu-id="9e25c-140">Resiliency is not an add-on.</span></span> <span data-ttu-id="9e25c-141">Sie muss in das System integriert und im Betrieb umgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-141">It must be designed into the system and put into operational practice.</span></span> <span data-ttu-id="9e25c-142">Dieses allgemeine Modell dient hierbei als Grundlage:</span><span class="sxs-lookup"><span data-stu-id="9e25c-142">Here is a general model to follow:</span></span>

1. <span data-ttu-id="9e25c-143">**Definieren** Sie Ihre Verfügbarkeitsanforderungen basierend auf den geschäftlichen Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-143">**Define** your availability requirements, based on business needs.</span></span>
2. <span data-ttu-id="9e25c-144">**Entwerfen** Sie die Anwendung mit Blick auf Resilienz.</span><span class="sxs-lookup"><span data-stu-id="9e25c-144">**Design** the application for resiliency.</span></span> <span data-ttu-id="9e25c-145">Beginnen Sie mit einer Architektur, die auf bewährten Methoden basiert, und identifizieren Sie dann die möglichen Fehlerpunkte dieser Architektur.</span><span class="sxs-lookup"><span data-stu-id="9e25c-145">Start with an architecture that follows proven practices, and then identify the possible failure points in that architecture.</span></span>
3. <span data-ttu-id="9e25c-146">**Implementieren** Sie die Strategien für die Erkennung von Fehlern und die anschließende Wiederherstellung.</span><span class="sxs-lookup"><span data-stu-id="9e25c-146">**Implement** strategies to detect and recover from failures.</span></span> 
4. <span data-ttu-id="9e25c-147">**Testen** Sie die Implementierung, indem Sie Fehler simulieren und erzwungene Failover auslösen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-147">**Test** the implementation by simulating faults and triggering forced failovers.</span></span> 
5. <span data-ttu-id="9e25c-148">**Stellen Sie die Anwendung in der Produktion bereit**, indem Sie einen zuverlässigen und wiederholbaren Prozess verwenden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-148">**Deploy** the application into production using a reliable, repeatable process.</span></span> 
6. <span data-ttu-id="9e25c-149">**Überwachen** Sie die Anwendung, um Fehler zu erkennen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-149">**Monitor** the application to detect failures.</span></span> <span data-ttu-id="9e25c-150">Indem Sie das System überwachen, können Sie die Integrität der Anwendung messen und bei Bedarf auf Vorfälle reagieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-150">By monitoring the system, you can gauge the health of the application and respond to incidents if necessary.</span></span> 
7. <span data-ttu-id="9e25c-151">**Reagieren** Sie, wenn es zu Vorfällen kommt, für die manuelle Eingriffe erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="9e25c-151">**Respond** if there are incidents that require manual interventions.</span></span>

<span data-ttu-id="9e25c-152">Im weiteren Verlauf dieses Artikels werden diese Schritte ausführlicher beschrieben.</span><span class="sxs-lookup"><span data-stu-id="9e25c-152">In the remainder of this article, we discuss each of these steps in more detail.</span></span>

## <a name="defining-your-resiliency-requirements"></a><span data-ttu-id="9e25c-153">Definieren Ihrer Anforderungen an die Resilienz</span><span class="sxs-lookup"><span data-stu-id="9e25c-153">Defining your resiliency requirements</span></span>
<span data-ttu-id="9e25c-154">Die Resilienzplanung beginnt mit den geschäftlichen Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-154">Resiliency planning starts with business requirements.</span></span> <span data-ttu-id="9e25c-155">Hier sind einige Ansätze beschrieben, die für die Resilienz in diesem Zusammenhang geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="9e25c-155">Here are some approaches for thinking about resiliency in those terms.</span></span>

### <a name="decompose-by-workload"></a><span data-ttu-id="9e25c-156">Aufteilen von Workloads</span><span class="sxs-lookup"><span data-stu-id="9e25c-156">Decompose by workload</span></span>
<span data-ttu-id="9e25c-157">Viele Cloudlösungen bestehen aus mehreren Anwendungsworkloads.</span><span class="sxs-lookup"><span data-stu-id="9e25c-157">Many cloud solutions consist of multiple application workloads.</span></span> <span data-ttu-id="9e25c-158">Der Begriff „Workload“ steht in diesem Kontext für eine diskrete Funktion oder Computingaufgabe, die von anderen Aufgaben in Bezug auf die Geschäftslogik und die Datenspeicheranforderungen logisch getrennt werden kann.</span><span class="sxs-lookup"><span data-stu-id="9e25c-158">The term "workload" in this context means a discrete capability or computing task, which can be logically separated from other tasks, in terms of business logic and data storage requirements.</span></span> <span data-ttu-id="9e25c-159">Eine E-Commerce-App kann beispielsweise die folgenden Workloads enthalten:</span><span class="sxs-lookup"><span data-stu-id="9e25c-159">For example, an e-commerce app might include the following workloads:</span></span>

* <span data-ttu-id="9e25c-160">Suchen in einem Produktkatalog</span><span class="sxs-lookup"><span data-stu-id="9e25c-160">Browse and search a product catalog.</span></span>
* <span data-ttu-id="9e25c-161">Erstellen und Nachverfolgen von Aufträgen</span><span class="sxs-lookup"><span data-stu-id="9e25c-161">Create and track orders.</span></span>
* <span data-ttu-id="9e25c-162">Anzeigen von Empfehlungen</span><span class="sxs-lookup"><span data-stu-id="9e25c-162">View recommendations.</span></span>

<span data-ttu-id="9e25c-163">Für diese Workloads gelten unter Umständen unterschiedliche Anforderungen in Bezug auf die Verfügbarkeit, Skalierbarkeit, Datenkonsistenz, Notfallwiederherstellung usw.</span><span class="sxs-lookup"><span data-stu-id="9e25c-163">These workloads might have different requirements for availability, scalability, data consistency, disaster recovery, and so forth.</span></span> <span data-ttu-id="9e25c-164">Auch dies sind geschäftliche Entscheidungen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-164">Again, these are business decisions.</span></span>

<span data-ttu-id="9e25c-165">Berücksichtigen Sie außerdem die Nutzungsmuster.</span><span class="sxs-lookup"><span data-stu-id="9e25c-165">Also consider usage patterns.</span></span> <span data-ttu-id="9e25c-166">Gibt es bestimmte kritische Zeiträume, in denen das System verfügbar sein muss?</span><span class="sxs-lookup"><span data-stu-id="9e25c-166">Are there certain critical periods when the system must be available?</span></span> <span data-ttu-id="9e25c-167">Beispiele: Ein Dienst für Steuererklärungen darf kurz vor dem Einreichungsdatum nicht ausfallen, ein Dienst für Videostreams muss während eines großen Sportereignisses stabil bleiben usw.</span><span class="sxs-lookup"><span data-stu-id="9e25c-167">For example, a tax-filing service can't go down right before the filing deadline, a video streaming service must stay up during a big sports event, and so on.</span></span> <span data-ttu-id="9e25c-168">Während dieser kritischen Zeiträume verwenden Sie ggf. redundante Bereitstellungen in mehreren Regionen, damit für die Anwendung ein Failover durchgeführt werden kann, wenn eine Region ausfällt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-168">During the critical periods, you might have redundant deployments across several regions, so the application could fail over if one region failed.</span></span> <span data-ttu-id="9e25c-169">Aber da die Bereitstellung in mehreren Regionen mit höheren Kosten verbunden ist, kann es ratsam sein, die Anwendung zu weniger kritischen Zeiten nur in einer Region auszuführen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-169">However, a multi-region deployment is more expensive, so during less critical times, you might run the application in a single region.</span></span>

### <a name="rto-and-rpo"></a><span data-ttu-id="9e25c-170">RTO und RPO</span><span class="sxs-lookup"><span data-stu-id="9e25c-170">RTO and RPO</span></span>
<span data-ttu-id="9e25c-171">Zwei wichtige Metriken, die berücksichtigt werden sollten, sind Recovery Time Objective (RTO) und Recovery Point Objective (RPO).</span><span class="sxs-lookup"><span data-stu-id="9e25c-171">Two important metrics to consider are the recovery time objective and recovery point objective.</span></span>

* <span data-ttu-id="9e25c-172">**Recovery Time Objective** (RTO) ist der maximal zulässige Zeitraum, in dem eine Anwendung nach einem Vorfall nicht verfügbar sein darf.</span><span class="sxs-lookup"><span data-stu-id="9e25c-172">**Recovery time objective** (RTO) is the maximum acceptable time that an application can be unavailable after an incident.</span></span> <span data-ttu-id="9e25c-173">Wenn RTO bei Ihnen 90 Minuten beträgt, müssen Sie dazu in der Lage sein, die Anwendung innerhalb von 90 Minuten nach Beginn eines Notfalls wieder in den Ausführungszustand zu versetzen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-173">If your RTO is 90 minutes, you must be able to restore the application to a running state within 90 minutes from the start of a disaster.</span></span> <span data-ttu-id="9e25c-174">Falls für RTO ein sehr niedriger Wert angesetzt ist, führen Sie ggf. eine zweite Bereitstellung ständig im Standby aus, um vor einem regionalen Ausfall geschützt zu sein.</span><span class="sxs-lookup"><span data-stu-id="9e25c-174">If you have a very low RTO, you might keep a second deployment continually running on standby, to protect against a regional outage.</span></span>
* <span data-ttu-id="9e25c-175">**Recovery Point Objective** (RPO) ist die maximale Dauer eines Datenverlusts, die während eines Notfalls zulässig ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-175">**Recovery point objective** (RPO) is the maximum duration of data loss that is acceptable during a disaster.</span></span> <span data-ttu-id="9e25c-176">Wenn Sie Daten beispielsweise in einer einzelnen Datenbank ohne Replikation in anderen Datenbanken speichern und stündliche Sicherungen durchführen, können Daten für bis zu eine Stunde verloren gehen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-176">For example, if you store data in a single database, with no replication to other databases, and perform hourly backups, you could lose up to an hour of data.</span></span> 

<span data-ttu-id="9e25c-177">RTO und RPO sind geschäftliche Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-177">RTO and RPO are business requirements.</span></span> <span data-ttu-id="9e25c-178">Die Durchführung einer Risikobewertung kann hilfreich sein, um RTO und RPO für die Anwendung zu definieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-178">Conducting a risk assessment can help you define the application's RTO and RPO.</span></span> <span data-ttu-id="9e25c-179">Eine weitere häufig genutzte Metrik ist die **mittlere Zeit bis zur Wiederherstellung** (Mean Time To Recover, MTTR). Dies ist die durchschnittliche Dauer der Wiederherstellung einer Anwendung nach einem Ausfall.</span><span class="sxs-lookup"><span data-stu-id="9e25c-179">Another common metric is **mean time to recover** (MTTR), which is the average time that it takes to restore the application after a failure.</span></span> <span data-ttu-id="9e25c-180">MTTR ist ein empirischer Fakt eines Systems.</span><span class="sxs-lookup"><span data-stu-id="9e25c-180">MTTR is an empirical fact about a system.</span></span> <span data-ttu-id="9e25c-181">Wenn der MTTR-Wert größer als der RTO-Wert ist, führt ein Ausfall des Systems zu einer nicht akzeptablen geschäftlichen Störung, weil es nicht möglich ist, das System innerhalb des definierten RTO-Zeitraums wiederherzustellen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-181">If MTTR exceeds the RTO, then a failure in the system will cause an unacceptable business disruption, because it won't be possible to restore the system within the defined RTO.</span></span> 

### <a name="slas"></a><span data-ttu-id="9e25c-182">SLAs</span><span class="sxs-lookup"><span data-stu-id="9e25c-182">SLAs</span></span>
<span data-ttu-id="9e25c-183">In Azure wird in der [Vereinbarung zum Servicelevel (SLA)][sla] die garantierte Verfügbarkeit und Konnektivität beschrieben, die Microsoft zusichert.</span><span class="sxs-lookup"><span data-stu-id="9e25c-183">In Azure, the [Service Level Agreement][sla] (SLA) describes Microsoft’s commitments for uptime and connectivity.</span></span> <span data-ttu-id="9e25c-184">Wenn die Vereinbarung zum Servicelevel für einen bestimmten Dienst 99,9% beträgt, können Sie erwarten, dass der Dienst 99,9% der Zeit verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-184">If the SLA for a particular service is 99.9%, it means you should expect the service to be available 99.9% of the time.</span></span>

> [!NOTE]
> <span data-ttu-id="9e25c-185">Die Vereinbarung zum Servicelevel von Azure enthält auch Bestimmungen zum Erhalt einer Gutschrift, falls die Vereinbarung nicht erfüllt wird, sowie bestimmte Definitionen zur „Verfügbarkeit“ jedes Diensts.</span><span class="sxs-lookup"><span data-stu-id="9e25c-185">The Azure SLA also includes provisions for obtaining a service credit if the SLA is not met, along with specific definitions of "availability" for each service.</span></span> <span data-ttu-id="9e25c-186">Dieser Aspekt der Vereinbarung zum Servicelevel fungiert als Durchsetzungsrichtlinie.</span><span class="sxs-lookup"><span data-stu-id="9e25c-186">That aspect of the SLA acts as an enforcement policy.</span></span> 
> 
> 

<span data-ttu-id="9e25c-187">Sie sollten eigene Ziel-SLAs für jede Workload Ihrer Lösung definieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-187">You should define your own target SLAs for each workload in your solution.</span></span> <span data-ttu-id="9e25c-188">Anhand einer Vereinbarung zum Servicelevel kann ausgewertet werden, ob die Architektur die geschäftlichen Anforderungen erfüllt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-188">An SLA makes it possible to evaluate whether the architecture meets the business requirements.</span></span> <span data-ttu-id="9e25c-189">Wenn für eine Workload beispielsweise eine Betriebszeit von 99,99% erforderlich ist, dafür aber eine Abhängigkeit von einem Dienst mit einer Vereinbarung zum Servicelevel mit 99,9% besteht, kann dieser Dienst im System kein Single Point of Failure sein.</span><span class="sxs-lookup"><span data-stu-id="9e25c-189">For example, if a workload requires 99.99% uptime, but depends on a service with a 99.9% SLA, that service cannot be a single-point of failure in the system.</span></span> <span data-ttu-id="9e25c-190">Eine Lösung hierfür ist die Verwendung eines Fallbackpfads für den Fall, dass der Dienst ausfällt, oder das Treffen von anderen Maßnahmen zur Wiederherstellung nach einem Ausfall des Diensts.</span><span class="sxs-lookup"><span data-stu-id="9e25c-190">One remedy is to have a fallback path in case the service fails, or take other measures to recover from a failure in that service.</span></span> 

<span data-ttu-id="9e25c-191">In der folgenden Tabelle sind die potenziellen kumulativen Ausfallzeiten für verschiedene SLA-Ebenen angegeben.</span><span class="sxs-lookup"><span data-stu-id="9e25c-191">The following table shows the potential cumulative downtime for various SLA levels.</span></span> 

| <span data-ttu-id="9e25c-192">SLA</span><span class="sxs-lookup"><span data-stu-id="9e25c-192">SLA</span></span> | <span data-ttu-id="9e25c-193">Ausfallzeit pro Woche</span><span class="sxs-lookup"><span data-stu-id="9e25c-193">Downtime per week</span></span> | <span data-ttu-id="9e25c-194">Ausfallzeit pro Monat</span><span class="sxs-lookup"><span data-stu-id="9e25c-194">Downtime per month</span></span> | <span data-ttu-id="9e25c-195">Ausfallzeit pro Jahr</span><span class="sxs-lookup"><span data-stu-id="9e25c-195">Downtime per year</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="9e25c-196">99%</span><span class="sxs-lookup"><span data-stu-id="9e25c-196">99%</span></span> |<span data-ttu-id="9e25c-197">1,68 Stunden</span><span class="sxs-lookup"><span data-stu-id="9e25c-197">1.68 hours</span></span> |<span data-ttu-id="9e25c-198">7,2 Stunden</span><span class="sxs-lookup"><span data-stu-id="9e25c-198">7.2 hours</span></span> |<span data-ttu-id="9e25c-199">3,65 Tage</span><span class="sxs-lookup"><span data-stu-id="9e25c-199">3.65 days</span></span> |
| <span data-ttu-id="9e25c-200">99,9%</span><span class="sxs-lookup"><span data-stu-id="9e25c-200">99.9%</span></span> |<span data-ttu-id="9e25c-201">10,1 Minuten</span><span class="sxs-lookup"><span data-stu-id="9e25c-201">10.1 minutes</span></span> |<span data-ttu-id="9e25c-202">43,2 Minuten</span><span class="sxs-lookup"><span data-stu-id="9e25c-202">43.2 minutes</span></span> |<span data-ttu-id="9e25c-203">8,76 Stunden</span><span class="sxs-lookup"><span data-stu-id="9e25c-203">8.76 hours</span></span> |
| <span data-ttu-id="9e25c-204">99,95%</span><span class="sxs-lookup"><span data-stu-id="9e25c-204">99.95%</span></span> |<span data-ttu-id="9e25c-205">5 Minuten</span><span class="sxs-lookup"><span data-stu-id="9e25c-205">5 minutes</span></span> |<span data-ttu-id="9e25c-206">21,6 Minuten</span><span class="sxs-lookup"><span data-stu-id="9e25c-206">21.6 minutes</span></span> |<span data-ttu-id="9e25c-207">4,38 Stunden</span><span class="sxs-lookup"><span data-stu-id="9e25c-207">4.38 hours</span></span> |
| <span data-ttu-id="9e25c-208">99,99%</span><span class="sxs-lookup"><span data-stu-id="9e25c-208">99.99%</span></span> |<span data-ttu-id="9e25c-209">1,01 Minuten</span><span class="sxs-lookup"><span data-stu-id="9e25c-209">1.01 minutes</span></span> |<span data-ttu-id="9e25c-210">4,32 Minuten</span><span class="sxs-lookup"><span data-stu-id="9e25c-210">4.32 minutes</span></span> |<span data-ttu-id="9e25c-211">52,56 Minuten</span><span class="sxs-lookup"><span data-stu-id="9e25c-211">52.56 minutes</span></span> |
| <span data-ttu-id="9e25c-212">99,999%</span><span class="sxs-lookup"><span data-stu-id="9e25c-212">99.999%</span></span> |<span data-ttu-id="9e25c-213">6 Sekunden</span><span class="sxs-lookup"><span data-stu-id="9e25c-213">6 seconds</span></span> |<span data-ttu-id="9e25c-214">25,9 Sekunden</span><span class="sxs-lookup"><span data-stu-id="9e25c-214">25.9 seconds</span></span> |<span data-ttu-id="9e25c-215">5,26 Minuten</span><span class="sxs-lookup"><span data-stu-id="9e25c-215">5.26 minutes</span></span> |

<span data-ttu-id="9e25c-216">Sofern alle anderen Faktoren identisch sind, ist eine höhere Verfügbarkeit natürlich immer vorzuziehen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-216">Of course, higher availability is better, everything else being equal.</span></span> <span data-ttu-id="9e25c-217">Aber wenn eine noch höhere Verfügbarkeit angestrebt wird, erhöhen sich auch die Kosten und die Komplexität, um dies zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-217">But as you strive for more 9s, the cost and complexity to achieve that level of availability grows.</span></span> <span data-ttu-id="9e25c-218">Eine Betriebszeit von 99,99% entspricht einer Gesamtausfallzeit von ca. 5 Minuten pro Monat.</span><span class="sxs-lookup"><span data-stu-id="9e25c-218">An uptime of 99.99% translates to about 5 minutes of total downtime per month.</span></span> <span data-ttu-id="9e25c-219">Rechtfertigt die Erreichung von 99,999% die zusätzliche Komplexität und die höheren Kosten?</span><span class="sxs-lookup"><span data-stu-id="9e25c-219">Is it worth the additional complexity and cost to reach five 9s?</span></span> <span data-ttu-id="9e25c-220">Die Antwort hängt von Ihren geschäftlichen Anforderungen ab.</span><span class="sxs-lookup"><span data-stu-id="9e25c-220">The answer depends on the business requirements.</span></span> 

<span data-ttu-id="9e25c-221">Hier sind einige andere Aspekte aufgeführt, die für das Definieren einer Vereinbarung zum Servicelevel gelten:</span><span class="sxs-lookup"><span data-stu-id="9e25c-221">Here are some other considerations when defining an SLA:</span></span>

* <span data-ttu-id="9e25c-222">Wenn Sie 99,99% erreichen möchten, können Sie sich bei der Wiederherstellung nach Ausfällen wahrscheinlich nicht auf manuelle Eingriffe verlassen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-222">To achieve four 9's (99.99%), you probably can't rely on manual intervention to recover from failures.</span></span> <span data-ttu-id="9e25c-223">Die Anwendung muss eine Selbstdiagnose und Selbstreparatur durchführen können.</span><span class="sxs-lookup"><span data-stu-id="9e25c-223">The application must be self-diagnosing and self-healing.</span></span> 
* <span data-ttu-id="9e25c-224">Im Bereich über 99,99% stellt es eine große Herausforderung dar, Ausfälle schnell genug zu erkennen, um die SLA-Anforderungen zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-224">Beyond four 9's, it is challenging to detect outages quickly enough to meet the SLA.</span></span>
* <span data-ttu-id="9e25c-225">Betrachten Sie das Zeitfenster, auf das sich Ihre Vereinbarung zum Servicelevel bezieht.</span><span class="sxs-lookup"><span data-stu-id="9e25c-225">Think about the time window that your SLA is measured against.</span></span> <span data-ttu-id="9e25c-226">Je kleiner das Fenster, desto enger die Toleranzen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-226">The smaller the window, the tighter the tolerances.</span></span> <span data-ttu-id="9e25c-227">Vermutlich ist es nicht sinnvoll, Ihre Vereinbarung zum Servicelevel in Bezug auf die stündliche oder tägliche Betriebszeit zu definieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-227">It probably doesn't make sense to define your SLA in terms of hourly or daily uptime.</span></span> 

### <a name="composite-slas"></a><span data-ttu-id="9e25c-228">Zusammengesetzte SLAs</span><span class="sxs-lookup"><span data-stu-id="9e25c-228">Composite SLAs</span></span>
<span data-ttu-id="9e25c-229">Angenommen, eine App Service-Web-App führt Schreibvorgänge in eine Azure SQL-Datenbank durch.</span><span class="sxs-lookup"><span data-stu-id="9e25c-229">Consider an App Service web app that writes to Azure SQL Database.</span></span> <span data-ttu-id="9e25c-230">Zum Zeitpunkt der Erstellung dieses Artikels verfügen diese Azure-Dienste über die folgenden SLAs:</span><span class="sxs-lookup"><span data-stu-id="9e25c-230">At the time of this writing, these Azure services have the following SLAs:</span></span>

* <span data-ttu-id="9e25c-231">App Service-Web-Apps = 99,95%</span><span class="sxs-lookup"><span data-stu-id="9e25c-231">App Service Web Apps = 99.95%</span></span>
* <span data-ttu-id="9e25c-232">SQL-Datenbank = 99,99%</span><span class="sxs-lookup"><span data-stu-id="9e25c-232">SQL Database = 99.99%</span></span>

![Zusammengesetzte Vereinbarung zum Servicelevel](./images/sla1.png)

<span data-ttu-id="9e25c-234">Welche maximale Ausfallzeit erwarten Sie für diese Anwendung?</span><span class="sxs-lookup"><span data-stu-id="9e25c-234">What is the maximum downtime you would expect for this application?</span></span> <span data-ttu-id="9e25c-235">Wenn einer der Dienste ausfällt, kommt es zu einem Ausfall der gesamten Anwendung.</span><span class="sxs-lookup"><span data-stu-id="9e25c-235">If either service fails, the whole application fails.</span></span> <span data-ttu-id="9e25c-236">Im Allgemeinen ist die Wahrscheinlichkeit, dass jeder Dienst ausfällt, eine unabhängige Größe, und die zusammengesetzte Vereinbarung zum Servicelevel für diese Anwendung ist 99,95% &times; 99,99% = 99,94%.</span><span class="sxs-lookup"><span data-stu-id="9e25c-236">In general, the probability of each service failing is independent, so the composite SLA for this application is 99.95% &times; 99.99% = 99.94%.</span></span> <span data-ttu-id="9e25c-237">Dieser Wert ist niedriger als bei einzelnen SLAs. Dies ist nicht verwunderlich, da eine Anwendung, die von mehreren Diensten abhängig ist, über mehr potenzielle Fehlerpunkte verfügt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-237">That's lower than the individual SLAs, which isn't surprising, because an application that relies on multiple services has more potential failure points.</span></span> 

<span data-ttu-id="9e25c-238">Andererseits können Sie die zusammengesetzte Vereinbarung zum Servicelevel verbessern, indem Sie unabhängige Fallbackpfade erstellen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-238">On the other hand, you can improve the composite SLA by creating independent fallback paths.</span></span> <span data-ttu-id="9e25c-239">Wenn SQL-Datenbank beispielsweise nicht verfügbar ist, können Transaktionen zur späteren Verarbeitung in eine Warteschlange eingereiht werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-239">For example, if SQL Database is unavailable, put transactions into a queue, to be processed later.</span></span>

![Zusammengesetzte Vereinbarung zum Servicelevel](./images/sla2.png)

<span data-ttu-id="9e25c-241">Bei diesem Aufbau ist die Anwendung auch dann noch verfügbar, wenn keine Verbindung mit der Datenbank hergestellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="9e25c-241">With this design, the application is still available even if it can't connect to the database.</span></span> <span data-ttu-id="9e25c-242">Dies ist aber nicht mehr der Fall, wenn die Datenbank und die Warteschlange gleichzeitig ausfallen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-242">However, it fails if the database and the queue both fail at the same time.</span></span> <span data-ttu-id="9e25c-243">Der erwartete Zeitprozentwert für einen gleichzeitigen Ausfall ist 0,0001 &times; 0,001, sodass die zusammengesetzte Vereinbarung zum Servicelevel für diesen kombinierten Pfad wie folgt lautet:</span><span class="sxs-lookup"><span data-stu-id="9e25c-243">The expected percentage of time for a simultaneous failure is 0.0001 &times; 0.001, so the composite SLA for this combined path is:</span></span>  

* <span data-ttu-id="9e25c-244">Datenbank ODER Warteschlange = 1,0 &minus; (0,0001 &times; 0,001) = 99,99999%</span><span class="sxs-lookup"><span data-stu-id="9e25c-244">Database OR queue = 1.0 &minus; (0.0001 &times; 0.001) = 99.99999%</span></span>

<span data-ttu-id="9e25c-245">Für die gesamte zusammengesetzte Vereinbarung zum Servicelevel gilt:</span><span class="sxs-lookup"><span data-stu-id="9e25c-245">The total composite SLA is:</span></span>

* <span data-ttu-id="9e25c-246">Web-App UND (Datenbank ODER Warteschlange) = 99,95% &times; 99,99999% = 99,95% (ungefährer Wert)</span><span class="sxs-lookup"><span data-stu-id="9e25c-246">Web app AND (database OR queue) = 99.95% &times; 99.99999% = ~99.95%</span></span>

<span data-ttu-id="9e25c-247">Dieser Ansatz hat aber auch Nachteile.</span><span class="sxs-lookup"><span data-stu-id="9e25c-247">But there are tradeoffs to this approach.</span></span> <span data-ttu-id="9e25c-248">Die Anwendungslogik ist komplexer, es fallen Kosten für die Warteschlange an, und ggf. müssen Probleme mit der Datenkonsistenz gelöst werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-248">The application logic is more complex, you are paying for the queue, and there may be data consistency issues to consider.</span></span>

<span data-ttu-id="9e25c-249">**SLA für Bereitstellung in mehreren Regionen**.</span><span class="sxs-lookup"><span data-stu-id="9e25c-249">**SLA for multi-region deployments**.</span></span> <span data-ttu-id="9e25c-250">Ein weiteres Verfahren für Hochverfügbarkeit ist die Bereitstellung der Anwendung in mehr als einer Region und die Verwendung von Azure Traffic Manager zum Durchführen eines Failovers, wenn die Anwendung in einer Region ausfällt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-250">Another HA technique is to deploy the application in more than one region, and use Azure Traffic Manager to fail over if the application fails in one region.</span></span> <span data-ttu-id="9e25c-251">Für eine Bereitstellung in zwei Regionen wird die zusammengesetzte Vereinbarung zum Servicelevel wie folgt berechnet:</span><span class="sxs-lookup"><span data-stu-id="9e25c-251">For a two-region deployment, the composite SLA is calculated as follows.</span></span> 

<span data-ttu-id="9e25c-252">*N* steht für die zusammengesetzte Vereinbarung zum Servicelevel für die Anwendung, die in einer Region bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-252">Let *N* be the composite SLA for the application deployed in one region.</span></span> <span data-ttu-id="9e25c-253">Die erwartete Wahrscheinlichkeit, dass die Anwendung in beiden Regionen gleichzeitig ausfällt, ist (1 &minus; N) &times; (1 &minus; N).</span><span class="sxs-lookup"><span data-stu-id="9e25c-253">The expected chance that the application will fail in both regions at the same time is (1 &minus; N) &times; (1 &minus; N).</span></span> <span data-ttu-id="9e25c-254">Deshalb gilt Folgendes:</span><span class="sxs-lookup"><span data-stu-id="9e25c-254">Therefore,</span></span>

* <span data-ttu-id="9e25c-255">Kombinierte Vereinbarung zum Servicelevel für beide Regionen = 1 &minus; (1 &minus; N)(1 &minus; N) = N + (1 &minus; N)N</span><span class="sxs-lookup"><span data-stu-id="9e25c-255">Combined SLA for both regions = 1 &minus; (1 &minus; N)(1 &minus; N) = N + (1 &minus; N)N</span></span>

<span data-ttu-id="9e25c-256">Abschließend müssen Sie noch die [Vereinbarung zum Servicelevel für Traffic Manager][tm-sla] einbinden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-256">Finally, you must factor in the [SLA for Traffic Manager][tm-sla].</span></span> <span data-ttu-id="9e25c-257">Zum Zeitpunkt der Erstellung dieses Artikels verfügt die Vereinbarung zum Servicelevel für Traffic Manager über den Wert 99,99%.</span><span class="sxs-lookup"><span data-stu-id="9e25c-257">At the time of this writing, the SLA for Traffic Manager SLA is 99.99%.</span></span>

* <span data-ttu-id="9e25c-258">Zusammengesetzte Vereinbarung zum Servicelevel = 99,99% &times; (SLA kombiniert für beide Regionen)</span><span class="sxs-lookup"><span data-stu-id="9e25c-258">Composite SLA = 99.99% &times; (combined SLA for both regions)</span></span>

<span data-ttu-id="9e25c-259">Außerdem wird das Failover nicht sofort durchgeführt, und während eines Failovers kann es zu Ausfallzeit kommen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-259">Also, failing over is not instantaneous and can result in some downtime during a failover.</span></span> <span data-ttu-id="9e25c-260">Informationen hierzu finden Sie unter [Traffic Manager-Endpunktüberwachung und -failover][tm-failover].</span><span class="sxs-lookup"><span data-stu-id="9e25c-260">See [Traffic Manager endpoint monitoring and failover][tm-failover].</span></span>

<span data-ttu-id="9e25c-261">Der berechnete SLA-Wert ist ein nützlicher Anhaltspunkt, aber er hat in Bezug auf die Verfügbarkeit keine umfassende Aussagekraft.</span><span class="sxs-lookup"><span data-stu-id="9e25c-261">The calculated SLA number is a useful baseline, but it doesn't tell the whole story about availability.</span></span> <span data-ttu-id="9e25c-262">Häufig kann eine Anwendung korrekt herabgestuft werden, wenn ein nicht kritischer Pfad ausfällt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-262">Often, an application can degrade gracefully when a non-critical path fails.</span></span> <span data-ttu-id="9e25c-263">Stellen Sie sich eine Anwendung vor, in der ein Katalog mit Büchern angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-263">Consider an application that shows a catalog of books.</span></span> <span data-ttu-id="9e25c-264">Wenn die Anwendung das Miniaturbild für den Buchdeckel nicht abrufen kann, wird ggf. ein Platzhalterbild angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-264">If the application can't retrieve the thumbnail image for the cover, it might show a placeholder image.</span></span> <span data-ttu-id="9e25c-265">In diesem Fall wird die Betriebszeit der Anwendung durch das fehlende Abrufen des Bilds nicht reduziert, obwohl für Benutzer eine Beeinträchtigung besteht.</span><span class="sxs-lookup"><span data-stu-id="9e25c-265">In that case, failing to get the image does not reduce the application's uptime, although it affects the user experience.</span></span>  

## <a name="designing-for-resiliency"></a><span data-ttu-id="9e25c-266">Entwerfen mit Blick auf Resilienz</span><span class="sxs-lookup"><span data-stu-id="9e25c-266">Designing for resiliency</span></span>
<span data-ttu-id="9e25c-267">In der Entwurfsphase ist es ratsam, eine Fehlermodusanalyse (Failure Mode Analysis, FMA) durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-267">During the design phase, you should perform a failure mode analysis (FMA).</span></span> <span data-ttu-id="9e25c-268">Das Ziel einer FMA ist die Identifizierung von möglichen Fehlerpunkten, und es wird definiert, wie die Anwendung auf diese Fehler reagiert.</span><span class="sxs-lookup"><span data-stu-id="9e25c-268">The goal of an FMA is to identify possible points of failure, and define how the application will respond to those failures.</span></span>

* <span data-ttu-id="9e25c-269">Wie erkennt die Anwendung diese Art von Fehler?</span><span class="sxs-lookup"><span data-stu-id="9e25c-269">How will the application detect this type of failure?</span></span>
* <span data-ttu-id="9e25c-270">Wie reagiert die Anwendung auf diese Art von Fehler?</span><span class="sxs-lookup"><span data-stu-id="9e25c-270">How will the application respond to this type of failure?</span></span>
* <span data-ttu-id="9e25c-271">Wie protokollieren und überwachen Sie diese Art von Fehler?</span><span class="sxs-lookup"><span data-stu-id="9e25c-271">How will you log and monitor this type of failure?</span></span> 

<span data-ttu-id="9e25c-272">Weitere Informationen zum FMA-Prozess mit spezifischen Empfehlungen für Azure finden Sie unter [Azure resiliency guidance: Failure mode analysis][fma] (Azure-Leitfaden zur Resilienz: Fehlermodusanalyse).</span><span class="sxs-lookup"><span data-stu-id="9e25c-272">For more information about the FMA process, with specific recommendations for Azure, see [Azure resiliency guidance: Failure mode analysis][fma].</span></span>

### <a name="example-of-identifying-failure-modes-and-detection-strategy"></a><span data-ttu-id="9e25c-273">Beispiel für die Identifizierung von Fehlermodi und eine Erkennungsstrategie</span><span class="sxs-lookup"><span data-stu-id="9e25c-273">Example of identifying failure modes and detection strategy</span></span>
<span data-ttu-id="9e25c-274">**Fehlerpunkt:** Aufruf eines externen Webdiensts bzw. einer API.</span><span class="sxs-lookup"><span data-stu-id="9e25c-274">**Failure point:** Call to an external web service / API.</span></span>

| <span data-ttu-id="9e25c-275">Fehlermodus</span><span class="sxs-lookup"><span data-stu-id="9e25c-275">Failure mode</span></span> | <span data-ttu-id="9e25c-276">Erkennungsstrategie</span><span class="sxs-lookup"><span data-stu-id="9e25c-276">Detection strategy</span></span> |
| --- | --- |
| <span data-ttu-id="9e25c-277">Dienst nicht verfügbar</span><span class="sxs-lookup"><span data-stu-id="9e25c-277">Service is unavailable</span></span> |<span data-ttu-id="9e25c-278">HTTP 5xx</span><span class="sxs-lookup"><span data-stu-id="9e25c-278">HTTP 5xx</span></span> |
| <span data-ttu-id="9e25c-279">Drosselung</span><span class="sxs-lookup"><span data-stu-id="9e25c-279">Throttling</span></span> |<span data-ttu-id="9e25c-280">HTTP 429 (Zu viele Anforderungen)</span><span class="sxs-lookup"><span data-stu-id="9e25c-280">HTTP 429 (Too Many Requests)</span></span> |
| <span data-ttu-id="9e25c-281">Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="9e25c-281">Authentication</span></span> |<span data-ttu-id="9e25c-282">HTTP 401 (Nicht autorisiert)</span><span class="sxs-lookup"><span data-stu-id="9e25c-282">HTTP 401 (Unauthorized)</span></span> |
| <span data-ttu-id="9e25c-283">Langsame Reaktion</span><span class="sxs-lookup"><span data-stu-id="9e25c-283">Slow response</span></span> |<span data-ttu-id="9e25c-284">Timeout der Anforderung</span><span class="sxs-lookup"><span data-stu-id="9e25c-284">Request times out</span></span> |

## <a name="resiliency-strategies"></a><span data-ttu-id="9e25c-285">Resilienzstrategien</span><span class="sxs-lookup"><span data-stu-id="9e25c-285">Resiliency strategies</span></span>
<span data-ttu-id="9e25c-286">Dieser Abschnitt enthält eine Übersicht über einige häufig verwendete Resilienzstrategien.</span><span class="sxs-lookup"><span data-stu-id="9e25c-286">This section provides a survey of some common resiliency strategies.</span></span> <span data-ttu-id="9e25c-287">Die meisten davon sind nicht auf eine bestimmte Technologie beschränkt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-287">Most of these are not limited to a particular technology.</span></span> <span data-ttu-id="9e25c-288">In den Beschreibungen in diesem Abschnitt sind jeweils die grundlegenden Ideen jedes Verfahrens mit Links zu weiteren Informationen zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="9e25c-288">The descriptions in this section summarize the general idea behind each technique, with links to further reading.</span></span>

### <a name="retry-transient-failures"></a><span data-ttu-id="9e25c-289">Wiederholen des Vorgangs bei vorübergehenden Fehlern</span><span class="sxs-lookup"><span data-stu-id="9e25c-289">Retry transient failures</span></span>
<span data-ttu-id="9e25c-290">Vorübergehende Fehler können durch eine kurze Trennung der Netzwerkverbindung, einen Verlust der Verbindung zur Datenbank oder eine Zeitüberschreitung bei zu hoher Auslastung eines Diensts verursacht werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-290">Transient failures can be caused by momentary loss of network connectivity, a dropped database connection, or a timeout when a service is busy.</span></span> <span data-ttu-id="9e25c-291">Häufig kann ein vorübergehender Fehler einfach gelöst werden, indem versucht wird, die Anforderung erneut zu senden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-291">Often, a transient failure can be resolved simply by retrying the request.</span></span> <span data-ttu-id="9e25c-292">Für viele Azure-Dienste werden vom Client-SDK automatische Wiederholungen so implementiert, dass dies für den Aufrufer transparent ist. Informationen hierzu finden Sie unter [Anleitung zu dienstspezifischen Wiederholungsmechanismen][retry-service-specific guidance].</span><span class="sxs-lookup"><span data-stu-id="9e25c-292">For many Azure services, the client SDK implements automatic retries, in a way that is transparent to the caller; see [Retry service specific guidance][retry-service-specific guidance].</span></span>

<span data-ttu-id="9e25c-293">Jeder Wiederholungsversuch trägt zur Gesamtwartezeit bei.</span><span class="sxs-lookup"><span data-stu-id="9e25c-293">Each retry attempt adds to the total latency.</span></span> <span data-ttu-id="9e25c-294">Außerdem können zu viele fehlgeschlagene Anforderungsversuche zu einem Engpass führen, wenn sich ausstehende Anforderungen in der Warteschlange ansammeln.</span><span class="sxs-lookup"><span data-stu-id="9e25c-294">Also, too many failed requests can cause a bottleneck, as pending requests accumulate in the queue.</span></span> <span data-ttu-id="9e25c-295">Diese blockierten Anforderungen können kritische Systemressourcen belegen, z.B. Arbeitsspeicher, Threads, Datenbankverbindungen usw., sodass es zu kaskadierenden Fehlern kommen kann.</span><span class="sxs-lookup"><span data-stu-id="9e25c-295">These blocked requests might hold critical system resources such as memory, threads, database connections, and so on, which can cause cascading failures.</span></span> <span data-ttu-id="9e25c-296">Verlängern Sie die Verzögerungszeit zwischen den einzelnen Wiederholungsversuchen, und begrenzen Sie die Gesamtzahl von fehlgeschlagenen Anforderungen, um dies zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="9e25c-296">To avoid this, increase the delay between each retry attempt, and limit the total number of failed requests.</span></span>

![Zusammengesetzte Vereinbarung zum Servicelevel](./images/retry.png)

<span data-ttu-id="9e25c-298">Weitere Informationen finden Sie unter [Retry Pattern][retry-pattern] (Wiederholungsmuster).</span><span class="sxs-lookup"><span data-stu-id="9e25c-298">For more information, see [Retry Pattern][retry-pattern].</span></span>

### <a name="load-balance-across-instances"></a><span data-ttu-id="9e25c-299">Übergreifender Lastenausgleich für Instanzen</span><span class="sxs-lookup"><span data-stu-id="9e25c-299">Load balance across instances</span></span>
<span data-ttu-id="9e25c-300">Aus Gründen der Skalierbarkeit sollte eine Cloudanwendung horizontal hochskaliert werden können, indem mehr Instanzen hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-300">For scalability, a cloud application should be able to scale out by adding more instances.</span></span> <span data-ttu-id="9e25c-301">Mit diesem Ansatz wird auch die Resilienz verbessert, da fehlerhafte Instanzen aus der Rotation herausgenommen werden können.</span><span class="sxs-lookup"><span data-stu-id="9e25c-301">This approach also improves resiliency, because unhealthy instances can be removed from rotation.</span></span>  

<span data-ttu-id="9e25c-302">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="9e25c-302">For example:</span></span>

* <span data-ttu-id="9e25c-303">Ordnen Sie mindestens zwei VMs hinter einem Lastenausgleich an.</span><span class="sxs-lookup"><span data-stu-id="9e25c-303">Put two or more VMs behind a load balancer.</span></span> <span data-ttu-id="9e25c-304">Mit dem Lastenausgleichsmodul wird Datenverkehr auf alle VMs verteilt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-304">The load balancer distributes traffic to all the VMs.</span></span> <span data-ttu-id="9e25c-305">Informationen hierzu finden Sie unter [Run load-balanced VMs for scalability and availability][ra-multi-vm] (Ausführen von VMs mit Lastenausgleich, um Skalierbarkeit und Verfügbarkeit zu erzielen).</span><span class="sxs-lookup"><span data-stu-id="9e25c-305">See [Run load-balanced VMs for scalability and availability][ra-multi-vm].</span></span>
* <span data-ttu-id="9e25c-306">Führen Sie für eine Azure App Service-App das zentrale Hochskalieren auf mehrere Instanzen durch.</span><span class="sxs-lookup"><span data-stu-id="9e25c-306">Scale out an Azure App Service app to multiple instances.</span></span> <span data-ttu-id="9e25c-307">App Service verteilt die Last automatisch auf die Instanzen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-307">App Service automatically balances load across instances.</span></span> <span data-ttu-id="9e25c-308">Informationen hierzu finden Sie unter [Basic web application][ra-basic-web] (Einfache Webanwendung).</span><span class="sxs-lookup"><span data-stu-id="9e25c-308">See [Basic web application][ra-basic-web].</span></span>
* <span data-ttu-id="9e25c-309">Verwenden Sie [Azure Traffic Manager][tm], um Datenverkehr auf eine Gruppe von Endpunkten zu verteilen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-309">Use [Azure Traffic Manager][tm] to distribute traffic across a set of endpoints.</span></span>


### <a name="replicate-data"></a><span data-ttu-id="9e25c-310">Replizieren von Daten</span><span class="sxs-lookup"><span data-stu-id="9e25c-310">Replicate data</span></span>
<span data-ttu-id="9e25c-311">Das Replizieren von Daten ist eine allgemeine Strategie zum Verarbeiten von nicht vorübergehenden Fehlern in einem Datenspeicher.</span><span class="sxs-lookup"><span data-stu-id="9e25c-311">Replicating data is a general strategy for handling non-transient failures in a data store.</span></span> <span data-ttu-id="9e25c-312">Viele Speichertechnologien verfügen über eine integrierte Replikation, z.B. Azure SQL-Datenbank, Cosmos DB und Apache Cassandra.</span><span class="sxs-lookup"><span data-stu-id="9e25c-312">Many storage technologies provide built-in replication, including Azure SQL Database, Cosmos DB, and Apache Cassandra.</span></span>  

<span data-ttu-id="9e25c-313">Es ist wichtig, dass sowohl der Lese- als auch der Schreibpfad berücksichtigt wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-313">It's important to consider both the read and write paths.</span></span> <span data-ttu-id="9e25c-314">Je nach Speichertechnologie sind ggf. mehrere beschreibbare Replikate vorhanden (oder ein einzelnes beschreibbares Replikat und mehrere schreibgeschützte Replikate).</span><span class="sxs-lookup"><span data-stu-id="9e25c-314">Depending on the storage technology, you might have multiple writable replicas, or a single writable replica and multiple read-only replicas.</span></span> 

<span data-ttu-id="9e25c-315">Zur Maximierung der Verfügbarkeit können Replikate in mehreren Regionen angeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-315">To maximize availability, replicas can be placed in multiple regions.</span></span> <span data-ttu-id="9e25c-316">Hiermit wird aber die Wartezeit beim Replizieren der Daten erhöht.</span><span class="sxs-lookup"><span data-stu-id="9e25c-316">However, this increases the latency when replicating the data.</span></span> <span data-ttu-id="9e25c-317">Normalerweise wird das regionsübergreifende Replizieren asynchron durchgeführt. Dies ist mit einem Modell der letztlichen Konsistenz und potenziellem Datenverlust bei einem Ausfall eines Replikats verbunden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-317">Typically, replicating across regions is done asynchronously, which implies an eventual consistency model and potential data loss if a replica fails.</span></span> 

### <a name="degrade-gracefully"></a><span data-ttu-id="9e25c-318">Korrektes Herabstufen</span><span class="sxs-lookup"><span data-stu-id="9e25c-318">Degrade gracefully</span></span>
<span data-ttu-id="9e25c-319">Wenn ein Dienst ausfällt und kein Failoverpfad vorhanden ist, kann die Anwendung unter Umständen korrekt herabgestuft werden und trotzdem noch eine akzeptable Benutzerfreundlichkeit bieten.</span><span class="sxs-lookup"><span data-stu-id="9e25c-319">If a service fails and there is no failover path, the application may be able to degrade gracefully while still providing an acceptable user experience.</span></span> <span data-ttu-id="9e25c-320">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="9e25c-320">For example:</span></span>

* <span data-ttu-id="9e25c-321">Reihen Sie ein Arbeitselement zur späteren Verarbeitung in eine Warteschlange ein.</span><span class="sxs-lookup"><span data-stu-id="9e25c-321">Put a work item on a queue, to be handled later.</span></span> 
* <span data-ttu-id="9e25c-322">Geben Sie einen geschätzten Wert zurück.</span><span class="sxs-lookup"><span data-stu-id="9e25c-322">Return an estimated value.</span></span>
* <span data-ttu-id="9e25c-323">Verwenden Sie lokal zwischengespeicherte Daten.</span><span class="sxs-lookup"><span data-stu-id="9e25c-323">Use locally cached data.</span></span> 
* <span data-ttu-id="9e25c-324">Zeigen Sie eine Fehlermeldung für den Benutzer an.</span><span class="sxs-lookup"><span data-stu-id="9e25c-324">Show the user an error message.</span></span> <span data-ttu-id="9e25c-325">(Diese Option ist besser, als wenn die Anwendung nicht mehr auf Anforderungen reagiert.)</span><span class="sxs-lookup"><span data-stu-id="9e25c-325">(This option is better than having the application stop responding to requests.)</span></span>

### <a name="throttle-high-volume-users"></a><span data-ttu-id="9e25c-326">Drosseln von Benutzern mit hohem Volumen</span><span class="sxs-lookup"><span data-stu-id="9e25c-326">Throttle high-volume users</span></span>
<span data-ttu-id="9e25c-327">Es kann vorkommen, dass eine geringe Zahl von Benutzern für die Erzeugung sehr hoher Lasten verantwortlich ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-327">Sometimes a small number of users create excessive load.</span></span> <span data-ttu-id="9e25c-328">Dies kann negative Auswirkungen auf andere Benutzer haben und die Gesamtverfügbarkeit Ihrer Anwendung reduzieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-328">That can have an impact on other users, reducing the overall availability of your application.</span></span>

<span data-ttu-id="9e25c-329">Wenn von einem einzelnen Client übermäßig viele Anforderungen ausgehen, kann die Anwendung den Client ggf. für einen bestimmten Zeitraum drosseln.</span><span class="sxs-lookup"><span data-stu-id="9e25c-329">When a single client makes an excessive number of requests, the application might throttle the client for a certain period of time.</span></span> <span data-ttu-id="9e25c-330">Während des Drosselungszeitraums verweigert die Anwendung einige oder alle Anforderungen dieses Clients (je nach Drosselungsstrategie).</span><span class="sxs-lookup"><span data-stu-id="9e25c-330">During the throttling period, the application refuses some or all of the requests from that client (depending on the exact throttling strategy).</span></span> <span data-ttu-id="9e25c-331">Der Schwellenwert für die Drosselung richtet sich unter Umständen nach der Dienstebene des Kunden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-331">The threshold for throttling might depend on the customer's service tier.</span></span> 

<span data-ttu-id="9e25c-332">Die Drosselung muss nicht bedeuten, dass der Client in böser Absicht gehandelt hat, sondern nur, dass das Dienstkontingent überschritten wurde.</span><span class="sxs-lookup"><span data-stu-id="9e25c-332">Throttling does not imply the client was necessarily acting maliciously, only that it exceeded its service quota.</span></span> <span data-ttu-id="9e25c-333">In einigen Fällen kann es vorkommen, dass ein Consumer das Kontingent ständig überschreitet oder sich auf andere Weise unangemessen verhält.</span><span class="sxs-lookup"><span data-stu-id="9e25c-333">In some cases, a consumer might consistently exceed their quota or otherwise behave badly.</span></span> <span data-ttu-id="9e25c-334">Sie können dann weitere Maßnahmen treffen und den Benutzer blockieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-334">In that case, you might go further and block the user.</span></span> <span data-ttu-id="9e25c-335">Normalerweise wird hierzu ein API-Schlüssel oder ein IP-Adressbereich blockiert.</span><span class="sxs-lookup"><span data-stu-id="9e25c-335">Typically, this is done by blocking an API key or an IP address range.</span></span>

<span data-ttu-id="9e25c-336">Weitere Informationen finden Sie unter [Throttling Pattern][throttling-pattern] (Drosselungsmuster).</span><span class="sxs-lookup"><span data-stu-id="9e25c-336">For more information, see [Throttling Pattern][throttling-pattern].</span></span>

### <a name="use-a-circuit-breaker"></a><span data-ttu-id="9e25c-337">Verwenden eines Schutzschalters</span><span class="sxs-lookup"><span data-stu-id="9e25c-337">Use a circuit breaker</span></span>
<span data-ttu-id="9e25c-338">Mit einem Schutzschaltermuster kann verhindert werden, dass von einer Anwendung wiederholt versucht wird, einen Vorgang durchzuführen, der mit hoher Wahrscheinlichkeit fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-338">The Circuit Breaker pattern can prevent an application from repeatedly trying an operation that is likely to fail.</span></span> <span data-ttu-id="9e25c-339">Dies ähnelt der Verwendung eines physischen Schutzschalters, also eines Schalters zum Unterbrechen des Stromflusses, wenn ein Schaltkreis überlastet ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-339">This is similar to a physical circuit breaker, a switch that interrupts the flow of current when a circuit is overloaded.</span></span>

<span data-ttu-id="9e25c-340">Mit dem Schutzschalter werden Aufrufe eines Diensts zusammengefasst:</span><span class="sxs-lookup"><span data-stu-id="9e25c-340">The circuit breaker wraps calls to a service.</span></span> <span data-ttu-id="9e25c-341">Er kann drei Zustände aufweisen:</span><span class="sxs-lookup"><span data-stu-id="9e25c-341">It has three states:</span></span>

* <span data-ttu-id="9e25c-342">**Geschlossen**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-342">**Closed**.</span></span> <span data-ttu-id="9e25c-343">Dies ist der Normalzustand.</span><span class="sxs-lookup"><span data-stu-id="9e25c-343">This is the normal state.</span></span> <span data-ttu-id="9e25c-344">Der Schutzschalter sendet Anforderungen an den Dienst, und mit einem Zähler wird die Anzahl von kürzlich aufgetretenen Fehlern nachverfolgt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-344">The circuit breaker sends requests to the service, and a counter tracks the number of recent failures.</span></span> <span data-ttu-id="9e25c-345">Wenn die Anzahl von Fehlern innerhalb eines angegebenen Zeitraums einen Schwellenwert überschreitet, wechselt der Schutzschalter in den Zustand „Geöffnet“.</span><span class="sxs-lookup"><span data-stu-id="9e25c-345">If the failure count exceeds a threshold within a given time period, the circuit breaker switches to the Open state.</span></span> 
* <span data-ttu-id="9e25c-346">**Geöffnet**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-346">**Open**.</span></span> <span data-ttu-id="9e25c-347">In diesem Zustand sorgt der Schutzschalter dafür, dass alle Anforderungen sofort fehlschlagen, ohne dass der Dienst aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-347">In this state, the circuit breaker immediately fails all requests, without calling the service.</span></span> <span data-ttu-id="9e25c-348">Für die Anwendung sollte ein Lösungspfad verwendet werden, z.B. das Lesen von Daten von einem Replikat oder einfach das Anzeigen eines Fehlers für den Benutzer.</span><span class="sxs-lookup"><span data-stu-id="9e25c-348">The application should use a mitigation path, such as reading data from a replica or simply returning an error to the user.</span></span> <span data-ttu-id="9e25c-349">Wenn der Schutzschalter zu „Geöffnet“ wechselt, wird ein Timer gestartet.</span><span class="sxs-lookup"><span data-stu-id="9e25c-349">When the circuit breaker switches to Open, it starts a timer.</span></span> <span data-ttu-id="9e25c-350">Nachdem der Timer abgelaufen ist, wechselt der Schutzschalter in den Status „Halb geöffnet“.</span><span class="sxs-lookup"><span data-stu-id="9e25c-350">When the timer expires, the circuit breaker switches to the Half-open state.</span></span>
* <span data-ttu-id="9e25c-351">**Halb geöffnet**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-351">**Half-open**.</span></span> <span data-ttu-id="9e25c-352">In diesem Status lässt der Schutzstatus eine begrenzte Anzahl von Anforderungen für den Dienst passieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-352">In this state, the circuit breaker lets a limited number of requests go through to the service.</span></span> <span data-ttu-id="9e25c-353">Wenn diese Anforderungen erfolgreich sind, wird angenommen, dass der Dienst wieder betriebsbereit ist. Der Schutzschalter wechselt wieder in den Zustand „Geschlossen“.</span><span class="sxs-lookup"><span data-stu-id="9e25c-353">If they succeed, the service is assumed to be recovered, and the circuit breaker switches back to the Closed state.</span></span> <span data-ttu-id="9e25c-354">Andernfalls wechselt er zurück in den Zustand „Geöffnet“.</span><span class="sxs-lookup"><span data-stu-id="9e25c-354">Otherwise, it reverts to the Open state.</span></span> <span data-ttu-id="9e25c-355">Mit dem Zustand „Halb geöffnet“ wird verhindert, dass ein in der Wiederherstellung befindlicher Dienst plötzlich mit Anforderungen überschwemmt wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-355">The Half-Open state prevents a recovering service from suddenly being inundated with requests.</span></span>

<span data-ttu-id="9e25c-356">Weitere Informationen finden Sie unter [Circuit Breaker Pattern][circuit-breaker-pattern] (Schutzschaltermuster).</span><span class="sxs-lookup"><span data-stu-id="9e25c-356">For more information, see [Circuit Breaker Pattern][circuit-breaker-pattern].</span></span>

### <a name="use-load-leveling-to-smooth-out-spikes-in-traffic"></a><span data-ttu-id="9e25c-357">Verwenden eines Belastungsausgleichs zum Glätten von Datenverkehrsspitzen</span><span class="sxs-lookup"><span data-stu-id="9e25c-357">Use load leveling to smooth out spikes in traffic</span></span>
<span data-ttu-id="9e25c-358">Für Anwendungen kann es zu plötzlichen Datenverkehrsspitzen kommen, die von Diensten auf dem Back-End nicht mehr bewältigt werden können.</span><span class="sxs-lookup"><span data-stu-id="9e25c-358">Applications may experience sudden spikes in traffic, which can overwhelm services on the backend.</span></span> <span data-ttu-id="9e25c-359">Wenn ein Back-End-Dienst nicht schnell genug auf Anforderungen reagieren kann, kann dies dazu führen, dass Anforderungen in eine Warteschlange eingereiht werden (Rückstau) oder die Anwendung vom Dienst gedrosselt wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-359">If a backend service cannot respond to requests quickly enough, it may cause requests to queue (back up), or cause the service to throttle the application.</span></span>

<span data-ttu-id="9e25c-360">Sie können eine Warteschlange als Puffer verwenden, um dies zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="9e25c-360">To avoid this, you can use a queue as a buffer.</span></span> <span data-ttu-id="9e25c-361">Wenn ein neues Arbeitselement vorhanden ist, reiht die Anwendung ein Arbeitselement für die asynchrone Ausführung in die Warteschlange ein, anstatt sofort den Back-End-Dienst aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-361">When there is a new work item, instead of calling the backend service immediately, the application queues a work item to run asynchronously.</span></span> <span data-ttu-id="9e25c-362">Die Warteschlange fungiert als Puffer, um Lastspitzen zu glätten.</span><span class="sxs-lookup"><span data-stu-id="9e25c-362">The queue acts as a buffer that smooths out peaks in the load.</span></span> 

<span data-ttu-id="9e25c-363">Weitere Informationen finden Sie unter [Queue-Based Load Leveling Pattern][load-leveling-pattern] (Warteschlangenbasiertes Belastungsausgleichsmuster).</span><span class="sxs-lookup"><span data-stu-id="9e25c-363">For more information, see [Queue-Based Load Leveling Pattern][load-leveling-pattern].</span></span>

### <a name="isolate-critical-resources"></a><span data-ttu-id="9e25c-364">Isolieren von kritischen Ressourcen</span><span class="sxs-lookup"><span data-stu-id="9e25c-364">Isolate critical resources</span></span>
<span data-ttu-id="9e25c-365">Fehler in einem Subsystem können ggf. zu kaskadierenden Fehlern werden und Fehler in anderen Teilen der Anwendung verursachen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-365">Failures in one subsystem can sometimes cascade, causing failures in other parts of the application.</span></span> <span data-ttu-id="9e25c-366">Dies kann passieren, wenn ein Fehler dazu führt, dass einige Ressourcen, z.B. Threads oder Sockets, nicht rechtzeitig freigegeben werden und die Ressourcen erschöpft sind.</span><span class="sxs-lookup"><span data-stu-id="9e25c-366">This can happen if a failure causes some resources, such as threads or sockets, not to get freed in a timely manner, leading to resource exhaustion.</span></span> 

<span data-ttu-id="9e25c-367">Um dies zu vermeiden, können Sie ein System in isolierte Gruppen partitionieren, damit ein Ausfall in einer Partition nicht zum Ausfall des gesamten Systems führt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-367">To avoid this, you can partition a system into isolated groups, so that a failure in one partition does not bring down the entire system.</span></span> <span data-ttu-id="9e25c-368">Dieses Verfahren wird auch als „Bulkhead-Muster“ (Trennwandmuster) bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="9e25c-368">This technique is sometimes called the Bulkhead pattern.</span></span>

<span data-ttu-id="9e25c-369">Beispiele:</span><span class="sxs-lookup"><span data-stu-id="9e25c-369">Examples:</span></span>

* <span data-ttu-id="9e25c-370">Partitionieren Sie eine Datenbank (z.B. nach Mandant), und weisen Sie einen separaten Pool mit Webserverinstanzen für jede Partition zu.</span><span class="sxs-lookup"><span data-stu-id="9e25c-370">Partition a database (for example, by tenant) and assign a separate pool of web server instances for each partition.</span></span>  
* <span data-ttu-id="9e25c-371">Verwenden Sie separate Threadpools, um Aufrufe von unterschiedlichen Diensten zu isolieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-371">Use separate thread pools to isolate calls to different services.</span></span> <span data-ttu-id="9e25c-372">Auf diese Weise werden kaskadierende Fehler verhindert, wenn einer der Dienste ausfällt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-372">This helps to prevent cascading failures if one of the services fails.</span></span> <span data-ttu-id="9e25c-373">Ein Beispiel finden Sie in der [Hystrix-Bibliothek][hystrix] von Netflix.</span><span class="sxs-lookup"><span data-stu-id="9e25c-373">For an example, see the Netflix [Hystrix library][hystrix].</span></span>
* <span data-ttu-id="9e25c-374">Verwenden Sie [Container][containers], um die Ressourcen zu begrenzen, die für ein bestimmtes Subsystem verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="9e25c-374">Use [containers][containers] to limit the resources available to a particular subsystem.</span></span> 

![Zusammengesetzte Vereinbarung zum Servicelevel](./images/bulkhead.png)

### <a name="apply-compensating-transactions"></a><span data-ttu-id="9e25c-376">Anwenden von ausgleichenden Transaktionen</span><span class="sxs-lookup"><span data-stu-id="9e25c-376">Apply compensating transactions</span></span>
<span data-ttu-id="9e25c-377">Mit einer ausgleichenden Transaktion werden die Auswirkungen einer anderen abgeschlossenen Transaktion rückgängig gemacht.</span><span class="sxs-lookup"><span data-stu-id="9e25c-377">A compensating transaction is a transaction that undoes the effects of another completed transaction.</span></span>

<span data-ttu-id="9e25c-378">In einem verteilten System kann es sehr schwierig sein, eine hohe Transaktionskonsistenz zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-378">In a distributed system, it can be very difficult to achieve strong transactional consistency.</span></span> <span data-ttu-id="9e25c-379">Ausgleichende Transaktionen sind eine Möglichkeit, Konsistenz zu erreichen, indem eine Reihe von kleineren einzelnen Transaktionen verwendet wird, die in jedem Schritt rückgängig gemacht werden können.</span><span class="sxs-lookup"><span data-stu-id="9e25c-379">Compensating transactions are a way to achieve consistency by using a series of smaller, individual transactions that can be undone at each step.</span></span>

<span data-ttu-id="9e25c-380">Beim Buchen einer Reise kann ein Kunde beispielsweise einen Mietwagen, ein Hotelzimmer und einen Flug reservieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-380">For example, to book a trip, a customer might reserve a car, a hotel room, and a flight.</span></span> <span data-ttu-id="9e25c-381">Wenn einer dieser Schritte nicht erfolgreich ist, schlägt der gesamte Vorgang fehl.</span><span class="sxs-lookup"><span data-stu-id="9e25c-381">If any of these steps fails, the entire operation fails.</span></span> <span data-ttu-id="9e25c-382">Anstatt eine einzelne verteilte Transaktion für den gesamten Vorgang zu verwenden, können Sie für jeden Schritt eine ausgleichende Transaktion definieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-382">Instead of trying to use a single distributed transaction for the entire operation, you can define a compensating transaction for each step.</span></span> <span data-ttu-id="9e25c-383">Beispielsweise können Sie die Reservierung stornieren, um die Reservierung eines Mietwagens rückgängig zu machen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-383">For example, to undo a car reservation, you cancel the reservation.</span></span> <span data-ttu-id="9e25c-384">Ein Koordinator führt die einzelnen Schritte aus, um den gesamten Vorgang abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-384">In order to complete the whole operation, a coordinator executes each step.</span></span> <span data-ttu-id="9e25c-385">Falls ein Schritt fehlschlägt, wendet der Koordinator ausgleichende Transaktionen an, um abgeschlossene Schritte rückgängig zu machen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-385">If any step fails, the coordinator applies compensating transactions to undo any steps that were completed.</span></span> 

<span data-ttu-id="9e25c-386">Weitere Informationen finden Sie unter [Compensating Transaction Pattern][compensating-transaction-pattern] (Muster für eine ausgleichende Transaktion).</span><span class="sxs-lookup"><span data-stu-id="9e25c-386">For more information, see [Compensating Transaction Pattern][compensating-transaction-pattern].</span></span> 


## <a name="testing-for-resiliency"></a><span data-ttu-id="9e25c-387">Testen mit Blick auf Resilienz</span><span class="sxs-lookup"><span data-stu-id="9e25c-387">Testing for resiliency</span></span>
<span data-ttu-id="9e25c-388">Im Allgemeinen können Sie die Resilienz nicht auf die gleiche Weise wie die Anwendungsfunktionalität testen (per Ausführung von Komponententests usw.).</span><span class="sxs-lookup"><span data-stu-id="9e25c-388">Generally, you can't test resiliency in the same way that you test application functionality (by running unit tests and so on).</span></span> <span data-ttu-id="9e25c-389">Stattdessen müssen Sie testen, wie sich die End-to-End-Workload unter Fehlerbedingungen verhält, die nur zeitweise auftreten.</span><span class="sxs-lookup"><span data-stu-id="9e25c-389">Instead, you must test how the end-to-end workload performs under failure conditions which only occur intermittently.</span></span>

<span data-ttu-id="9e25c-390">Der Testvorgang ist ein iterativer Prozess.</span><span class="sxs-lookup"><span data-stu-id="9e25c-390">Testing is an iterative process.</span></span> <span data-ttu-id="9e25c-391">Testen Sie die Anwendung, messen Sie das Ergebnis, analysieren und beheben Sie alle aufgetretenen Fehler, und wiederholen Sie den Vorgang.</span><span class="sxs-lookup"><span data-stu-id="9e25c-391">Test the application, measure the outcome, analyze and address any failures that result, and repeat the process.</span></span>

<span data-ttu-id="9e25c-392">**Fault Injection-Tests**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-392">**Fault injection testing**.</span></span> <span data-ttu-id="9e25c-393">Testen Sie die Resilienz des Systems bei Fehlern, indem Sie entweder echte Fehler auslösen oder diese simulieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-393">Test the resiliency of the system during failures, either by triggering actual failures or by simulating them.</span></span> <span data-ttu-id="9e25c-394">Hier sind einige häufige Fehlerszenarien aufgeführt, die getestet werden können:</span><span class="sxs-lookup"><span data-stu-id="9e25c-394">Here are some common failure scenarios to test:</span></span>

* <span data-ttu-id="9e25c-395">Herunterfahren von VM-Instanzen</span><span class="sxs-lookup"><span data-stu-id="9e25c-395">Shut down VM instances.</span></span>
* <span data-ttu-id="9e25c-396">Absturz von Prozessen</span><span class="sxs-lookup"><span data-stu-id="9e25c-396">Crash processes.</span></span>
* <span data-ttu-id="9e25c-397">Ablauf von Zertifikaten</span><span class="sxs-lookup"><span data-stu-id="9e25c-397">Expire certificates.</span></span>
* <span data-ttu-id="9e25c-398">Ändern von Zugriffsschlüsseln</span><span class="sxs-lookup"><span data-stu-id="9e25c-398">Change access keys.</span></span>
* <span data-ttu-id="9e25c-399">Herunterfahren des DNS-Diensts auf Domänencontrollern</span><span class="sxs-lookup"><span data-stu-id="9e25c-399">Shut down the DNS service on domain controllers.</span></span>
* <span data-ttu-id="9e25c-400">Begrenzen von verfügbaren Systemressourcen, z.B. RAM oder Anzahl von Threads</span><span class="sxs-lookup"><span data-stu-id="9e25c-400">Limit available system resources, such as RAM or number of threads.</span></span>
* <span data-ttu-id="9e25c-401">Aufheben der Bereitstellung von Datenträgern</span><span class="sxs-lookup"><span data-stu-id="9e25c-401">Unmount disks.</span></span>
* <span data-ttu-id="9e25c-402">Erneutes Bereitstellen eines virtuellen Computers</span><span class="sxs-lookup"><span data-stu-id="9e25c-402">Redeploy a VM.</span></span>

<span data-ttu-id="9e25c-403">Messen Sie die Wiederherstellungszeiten, und stellen Sie sicher, dass Ihre geschäftlichen Anforderungen erfüllt werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-403">Measure the recovery times and verify that your business requirements are met.</span></span> <span data-ttu-id="9e25c-404">Testen Sie auch Kombinationen von Fehlermodi.</span><span class="sxs-lookup"><span data-stu-id="9e25c-404">Test combinations of failure modes as well.</span></span> <span data-ttu-id="9e25c-405">Vergewissern Sie sich, dass es nicht zu kaskadierenden Fehlern kommt und dass diese isoliert behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-405">Make sure that failures don't cascade, and are handled in an isolated way.</span></span>

<span data-ttu-id="9e25c-406">Dies ist ein weiterer Grund, warum es wichtig ist, mögliche Fehlerpunkte während der Entwurfsphase zu analysieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-406">This is another reason why it's important to analyze possible failure points during the design phase.</span></span> <span data-ttu-id="9e25c-407">Die Ergebnisse dieser Analyse sollten in Ihren Testplan einfließen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-407">The results of that analysis should be inputs into your test plan.</span></span>

<span data-ttu-id="9e25c-408">**Auslastungstests**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-408">**Load testing**.</span></span> <span data-ttu-id="9e25c-409">Führen Sie für die Anwendung einen Auslastungstest durch, indem Sie ein Tool wie [Visual Studio Team Services][vsts] oder [Apache JMeter][jmeter] verwenden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-409">Load test the application using a tool such as [Visual Studio Team Services][vsts] or [Apache JMeter][jmeter].</span></span> <span data-ttu-id="9e25c-410">Auslastungstests sind sehr wichtig zur Identifizierung von Fehlern, die nur bei hoher Auslastung auftreten, z.B. eine Überlastung der Back-End-Datenbank oder eine Drosselung des Diensts.</span><span class="sxs-lookup"><span data-stu-id="9e25c-410">Load testing is crucial for identifying failures that only happen under load, such as the backend database being overwhelmed or service throttling.</span></span> <span data-ttu-id="9e25c-411">Führen Sie Tests für Spitzenlasten durch, indem Sie Produktionsdaten oder synthetische Daten verwenden, die den Produktionsdaten möglichst genau ähneln.</span><span class="sxs-lookup"><span data-stu-id="9e25c-411">Test for peak load, using production data or synthetic data that is as close to production data as possible.</span></span> <span data-ttu-id="9e25c-412">Hierbei soll ermittelt werden, wie sich die Anwendung unter realen Bedingungen verhält.</span><span class="sxs-lookup"><span data-stu-id="9e25c-412">The goal is to see how the application behaves under real-world conditions.</span></span>   

## <a name="resilient-deployment"></a><span data-ttu-id="9e25c-413">Robuste Bereitstellung</span><span class="sxs-lookup"><span data-stu-id="9e25c-413">Resilient deployment</span></span>
<span data-ttu-id="9e25c-414">Nachdem eine Anwendung in der Produktion bereitgestellt wurde, sind Updates eine mögliche Fehlerquelle.</span><span class="sxs-lookup"><span data-stu-id="9e25c-414">Once an application is deployed to production, updates are a possible source of errors.</span></span> <span data-ttu-id="9e25c-415">Im schlimmsten Fall kann ein fehlerhaftes Update zu Ausfallzeiten führen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-415">In the worst case, a bad update can cause downtime.</span></span> <span data-ttu-id="9e25c-416">Der Bereitstellungsprozess muss vorhersagbar und wiederholbar sein, um dies zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-416">To avoid this, the deployment process must be predictable and repeatable.</span></span> <span data-ttu-id="9e25c-417">Die Bereitstellung umfasst auch die Bereitstellung von Azure-Ressourcen und -Anwendungscode und das Anwenden von Konfigurationseinstellungen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-417">Deployment includes provisioning Azure resources, deploying application code, and applying configuration settings.</span></span> <span data-ttu-id="9e25c-418">Ein Update kann alle drei Vorgänge oder einen Teil davon abdecken.</span><span class="sxs-lookup"><span data-stu-id="9e25c-418">An update may involve all three, or a subset.</span></span> 

<span data-ttu-id="9e25c-419">Der entscheidende Punkt ist, dass manuelle Bereitstellungen fehleranfällig sind.</span><span class="sxs-lookup"><span data-stu-id="9e25c-419">The crucial point is that manual deployments are prone to error.</span></span> <span data-ttu-id="9e25c-420">Daher wird empfohlen, einen automatisierten idempotenten Prozess zu verwenden, den Sie bedarfsabhängig und bei Fehlern auch erneut durchführen können.</span><span class="sxs-lookup"><span data-stu-id="9e25c-420">Therefore, it's recommended to have an automated, idempotent process that you can run on demand, and re-run if something fails.</span></span> 

* <span data-ttu-id="9e25c-421">Nutzen Sie Resource Manager-Vorlagen, um die Bereitstellung von Azure-Ressourcen zu automatisieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-421">Use Resource Manager templates to automate provisioning of Azure resources.</span></span>
* <span data-ttu-id="9e25c-422">Verwenden Sie die [Azure Automation-Konfiguration für den gewünschten Zustand][dsc] (Desired State Configuration, DSC) zum Konfigurieren von VMs.</span><span class="sxs-lookup"><span data-stu-id="9e25c-422">Use [Azure Automation Desired State Configuration][dsc] (DSC) to configure VMs.</span></span>
* <span data-ttu-id="9e25c-423">Verwenden Sie einen automatisierten Bereitstellungsprozess für Anwendungscode.</span><span class="sxs-lookup"><span data-stu-id="9e25c-423">Use an automated deployment process for application code.</span></span>

<span data-ttu-id="9e25c-424">Zwei Konzepte für die robuste Bereitstellung sind *Infrastruktur als Code* und *unveränderliche Infrastruktur*.</span><span class="sxs-lookup"><span data-stu-id="9e25c-424">Two concepts related to resilient deployment are *infrastructure as code* and *immutable infrastructure*.</span></span>

* <span data-ttu-id="9e25c-425">Bei **Infrastruktur als Code** wird Code zum Bereitstellen und Konfigurieren der Infrastruktur verwendet.</span><span class="sxs-lookup"><span data-stu-id="9e25c-425">**Infrastructure as code** is the practice of using code to provision and configure infrastructure.</span></span> <span data-ttu-id="9e25c-426">Für Infrastruktur als Code kann ein deklarativer Ansatz oder ein imperativer Ansatz genutzt werden (oder eine Kombination).</span><span class="sxs-lookup"><span data-stu-id="9e25c-426">Infrastructure as code may use a declarative approach or an imperative approach (or a combination of both).</span></span> <span data-ttu-id="9e25c-427">Resource Manager-Vorlagen sind ein Beispiel für einen deklarativen Ansatz.</span><span class="sxs-lookup"><span data-stu-id="9e25c-427">Resource Manager templates are an example of a declarative approach.</span></span> <span data-ttu-id="9e25c-428">PowerShell-Skripts sind ein Beispiel für einen imperativen Ansatz.</span><span class="sxs-lookup"><span data-stu-id="9e25c-428">PowerShell scripts are an example of an imperative approach.</span></span>
* <span data-ttu-id="9e25c-429">Bei **unveränderlicher Infrastruktur** geht es darum, die Infrastruktur nicht mehr zu ändern, nachdem sie in der Produktion bereitgestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="9e25c-429">**Immutable infrastructure** is the principle that you shouldn’t modify infrastructure after it’s deployed to production.</span></span> <span data-ttu-id="9e25c-430">Andernfalls kann es zu einem Zustand kommen, in dem Ad-hoc-Änderungen angewendet wurden. In diesem Fall ist es schwierig, die genauen Änderungen zu erkennen und Entscheidungen für das System zu treffen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-430">Otherwise, you can get into a state where ad hoc changes have been applied, so it's hard to know exactly what changed, and hard to reason about the system.</span></span> 

<span data-ttu-id="9e25c-431">Eine andere Frage ist, wie das Rollout für ein Anwendungsupdate durchgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="9e25c-431">Another question is how to roll out an application update.</span></span> <span data-ttu-id="9e25c-432">Wir empfehlen die Nutzung von Verfahren wie eine Blaugrün-Bereitstellung oder Canary-Releases, bei denen Updates unter starker Kontrolle übertragen werden, um mögliche negative Auswirkungen einer fehlerhaften Bereitstellung zu verringern.</span><span class="sxs-lookup"><span data-stu-id="9e25c-432">We recommend techniques such as blue-green deployment or canary releases, which push updates in highly controlled way to minimize possible impacts from a bad deployment.</span></span>

* <span data-ttu-id="9e25c-433">Die [Blaugrün-Bereitstellung][blue-green] ist ein Verfahren, bei dem ein Update in einer Produktionsumgebung separat von der Liveanwendung bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-433">[Blue-green deployment][blue-green] is a technique where an update is deployed into a production environment separate from the live application.</span></span> <span data-ttu-id="9e25c-434">Wechseln Sie für das Routing von Datenverkehr nach der Überprüfung der Bereitstellung dann zur aktualisierten Version.</span><span class="sxs-lookup"><span data-stu-id="9e25c-434">After you validate the deployment, switch the traffic routing to the updated version.</span></span> <span data-ttu-id="9e25c-435">Für Azure App Service-Web-Apps wird dies beispielsweise durch Stagingslots ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="9e25c-435">For example, Azure App Service Web Apps enables this with staging slots.</span></span>
* <span data-ttu-id="9e25c-436">[Canary-Releases][canary-release] ähneln Blaugrün-Bereitstellungen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-436">[Canary releases][canary-release] are similar to blue-green deployments.</span></span> <span data-ttu-id="9e25c-437">Anstatt für den gesamten Datenverkehr auf die aktualisierte Version umzustellen, führen Sie für das Update den Rollout für einen kleinen Prozentsatz der Benutzer durch, indem Sie einen Teil des Datenverkehrs an die neue Bereitstellung weiterleiten.</span><span class="sxs-lookup"><span data-stu-id="9e25c-437">Instead of switching all traffic to the updated version, you roll out the update to a small percentage of users, by routing a portion of the traffic to the new deployment.</span></span> <span data-ttu-id="9e25c-438">Falls ein Problem auftritt, können Sie den Vorgang stoppen und wieder auf die alte Bereitstellung zurückgreifen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-438">If there is a problem, back off and revert to the old deployment.</span></span> <span data-ttu-id="9e25c-439">Wenn alles in Ordnung ist, können Sie mehr Datenverkehr an die neue Version weiterleiten, bis die Umstellung für den gesamten Datenverkehr erfolgt ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-439">Otherwise, route more of the traffic to the new version, until it gets 100% of the traffic.</span></span>

<span data-ttu-id="9e25c-440">Stellen Sie unabhängig vom gewählten Ansatz sicher, dass Sie einen Rollback auf die letzte als fehlerfrei bekannte Bereitstellung durchführen können, falls die neue Version nicht funktioniert.</span><span class="sxs-lookup"><span data-stu-id="9e25c-440">Whatever approach you take, make sure that you can roll back to the last-known-good deployment, in case the new version is not functioning.</span></span> <span data-ttu-id="9e25c-441">Wenn Fehler auftreten, muss in den Anwendungsprotokollen angegeben werden, welche Version den Fehler verursacht hat.</span><span class="sxs-lookup"><span data-stu-id="9e25c-441">Also, if errors occur, the application logs must indicate which version caused the error.</span></span> 

## <a name="monitoring-and-diagnostics"></a><span data-ttu-id="9e25c-442">Überwachung und Diagnose</span><span class="sxs-lookup"><span data-stu-id="9e25c-442">Monitoring and diagnostics</span></span>
<span data-ttu-id="9e25c-443">Die Überwachung und die Diagnose sind für die Resilienz von entscheidender Bedeutung.</span><span class="sxs-lookup"><span data-stu-id="9e25c-443">Monitoring and diagnostics are crucial for resiliency.</span></span> <span data-ttu-id="9e25c-444">Wenn ein Fehler auftritt, müssen Sie darüber informiert werden, und Sie müssen über Erkenntnisse zur Fehlerursache verfügen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-444">If something fails, you need to know that it failed, and you need insights into the cause of the failure.</span></span> 

<span data-ttu-id="9e25c-445">Die Überwachung eines umfangreichen verteilten Systems stellt eine erhebliche Herausforderung dar.</span><span class="sxs-lookup"><span data-stu-id="9e25c-445">Monitoring a large-scale distributed system poses a significant challenge.</span></span> <span data-ttu-id="9e25c-446">Angenommen, eine Anwendung wird auf einigen Dutzend VMs ausgeführt. Es ist nicht effizient, sich einzeln nacheinander an jeder VM anzumelden und sich die Protokolldateien anzusehen, um die Problembehandlung durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-446">Think about an application that runs on a few dozen VMs &mdash; it's not practical to log into each VM, one at a time, and look through log files, trying to troubleshoot a problem.</span></span> <span data-ttu-id="9e25c-447">Die Anzahl von VM-Instanzen ist außerdem wahrscheinlich nicht statisch.</span><span class="sxs-lookup"><span data-stu-id="9e25c-447">Moreover, the number of VM instances is probably not static.</span></span> <span data-ttu-id="9e25c-448">VMs werden hinzugefügt und entfernt, wenn die Anwendung horizontal herunter- und hochskaliert wird, und gelegentlich kann es zu einem Ausfall einer Instanz kommen, sodass eine erneute Bereitstellung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-448">VMs get added and removed as the application scales in and out, and occasionally an instance may fail and need to be reprovisioned.</span></span> <span data-ttu-id="9e25c-449">Außerdem können für eine typische Cloudanwendung mehrere Datenspeicher verwendet werden (Azure Storage, SQL-Datenbank, Cosmos DB, Redis Cache), und eine einzelne Benutzeraktion kann auf mehrere Subsysteme verteilt sein.</span><span class="sxs-lookup"><span data-stu-id="9e25c-449">In addition, a typical cloud application might use multiple data stores (Azure storage, SQL Database, Cosmos DB, Redis cache), and a single user action may span multiple subsystems.</span></span> 

<span data-ttu-id="9e25c-450">Sie können sich den Überwachungs- und Diagnoseprozess als Pipeline mit mehreren einzelnen Phasen vorstellen:</span><span class="sxs-lookup"><span data-stu-id="9e25c-450">You can think of the monitoring and diagnostics process as a pipeline with several distinct stages:</span></span>

![Zusammengesetzte Vereinbarung zum Servicelevel](./images/monitoring.png)

* <span data-ttu-id="9e25c-452">**Instrumentierung**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-452">**Instrumentation**.</span></span> <span data-ttu-id="9e25c-453">Die Rohdaten für die Überwachung und Diagnose stammen aus vielen verschiedenen Quellen, z.B. Anwendungsprotokollen, Webserverprotokollen, Leistungsindikatoren des Betriebssystems, Datenbankprotokollen und Diagnosemodulen, die in die Azure Platform integriert sind.</span><span class="sxs-lookup"><span data-stu-id="9e25c-453">The raw data for monitoring and diagnostics comes from a variety of sources, including application logs, web server logs, OS performance counters, database logs, and diagnostics built into the Azure platform.</span></span> <span data-ttu-id="9e25c-454">Die meisten Azure-Dienste verfügen über eine Diagnosefunktion, die Sie verwenden können, um die Ursache von Problemen zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="9e25c-454">Most Azure services have a diagnostics feature that you can use to determine the cause of problems.</span></span>
* <span data-ttu-id="9e25c-455">**Sammlung und Speicherung**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-455">**Collection and storage**.</span></span> <span data-ttu-id="9e25c-456">Rohdaten der Instrumentierung können an verschiedenen Orten und in unterschiedlichen Formaten (z.B. Ablaufverfolgungsprotokolle von Anwendungen, IIS-Protokolle, Leistungsindikatoren) vorgehalten werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-456">Raw instrumentation data can be held in various locations and with various formats (e.g., application trace logs, IIS logs, performance counters).</span></span> <span data-ttu-id="9e25c-457">Die Daten dieser unterschiedlichen Datenquellen werden gesammelt, zusammengefasst und zuverlässig gespeichert.</span><span class="sxs-lookup"><span data-stu-id="9e25c-457">These disparate sources are collected, consolidated, and put into reliable storage.</span></span>
* <span data-ttu-id="9e25c-458">**Analyse und Diagnose**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-458">**Analysis and diagnosis**.</span></span> <span data-ttu-id="9e25c-459">Nachdem die Daten zusammengefasst wurden, können sie analysiert werden, um die Problembehandlung durchzuführen und eine Gesamtansicht der Anwendungsintegrität bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-459">After the data is consolidated, it can be analyzed to troubleshoot issues and provide an overall view of application health.</span></span>
* <span data-ttu-id="9e25c-460">**Visualisierung und Warnungen**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-460">**Visualization and alerts**.</span></span> <span data-ttu-id="9e25c-461">In dieser Phase werden Telemetriedaten so dargestellt, dass ein Bediener Probleme oder Trends schnell erkennen kann.</span><span class="sxs-lookup"><span data-stu-id="9e25c-461">In this stage, telemetry data is presented in such a way that an operator can quickly notice problems or trends.</span></span> <span data-ttu-id="9e25c-462">Beispiele hierfür sind Dashboards oder E-Mail-Warnungen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-462">Example include dashboards or email alerts.</span></span>  

<span data-ttu-id="9e25c-463">Die Überwachung ist nicht dasselbe wie die Fehlererkennung.</span><span class="sxs-lookup"><span data-stu-id="9e25c-463">Monitoring is not the same as failure detection.</span></span> <span data-ttu-id="9e25c-464">Es kann beispielsweise sein, dass Ihre Anwendung einen vorübergehenden Fehler erkennt und einen Wiederholungsversuch durchführt, ohne dass es zu Ausfallzeit kommt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-464">For example, your application might detect a transient error and retry, resulting in no downtime.</span></span> <span data-ttu-id="9e25c-465">Es sollte aber auch der Wiederholungsvorgang protokolliert werden, damit Sie die Fehlerrate überwachen können, um ein Gesamtbild der Anwendungsintegrität zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="9e25c-465">But it should also log the retry operation, so that you can monitor the error rate, in order to get an overall picture of application health.</span></span> 

<span data-ttu-id="9e25c-466">Anwendungsprotokolle sind eine wichtige Quelle für Diagnosedaten.</span><span class="sxs-lookup"><span data-stu-id="9e25c-466">Application logs are an important source of diagnostics data.</span></span> <span data-ttu-id="9e25c-467">Bewährte Methoden für die Anwendungsprotokollierung sind:</span><span class="sxs-lookup"><span data-stu-id="9e25c-467">Best practices for application logging include:</span></span>

* <span data-ttu-id="9e25c-468">Protokollieren in der Produktion:</span><span class="sxs-lookup"><span data-stu-id="9e25c-468">Log in production.</span></span> <span data-ttu-id="9e25c-469">Andernfalls fehlen Ihnen die Erkenntnisse in dem Bereich, für den Sie diese am dringendsten benötigen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-469">Otherwise, you lose insight where you need it most.</span></span>
* <span data-ttu-id="9e25c-470">Protokollieren von Ereignissen an den Dienstgrenzen:</span><span class="sxs-lookup"><span data-stu-id="9e25c-470">Log events at service boundaries.</span></span> <span data-ttu-id="9e25c-471">Binden Sie eine Korrelations-ID ein, die über Dienstgrenzen hinweg gilt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-471">Include a correlation ID that flows across service boundaries.</span></span> <span data-ttu-id="9e25c-472">Wenn eine Transaktion mehrere Dienste durchläuft und einer davon ausfällt, können Sie anhand der Korrelations-ID ermitteln, warum es zum Transaktionsfehler gekommen ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-472">If a transaction flows through multiple services and one of them fails, the correlation ID will help you pinpoint why the transaction failed.</span></span>
* <span data-ttu-id="9e25c-473">Verwenden Sie die semantische Protokollierung, die auch als strukturierte Protokollierung bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-473">Use semantic logging, also known as structured logging.</span></span> <span data-ttu-id="9e25c-474">Unstrukturierte Protokolle erschweren die Automatisierung des Verbrauchs und der Analyse von Protokolldaten, die auf Cloudebene erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-474">Unstructured logs make it hard to automate the consumption and analysis of the log data, which is needed at cloud scale.</span></span>
* <span data-ttu-id="9e25c-475">Verwenden der asynchronen Protokollierung:</span><span class="sxs-lookup"><span data-stu-id="9e25c-475">Use asynchronous logging.</span></span> <span data-ttu-id="9e25c-476">Andernfalls kann das Protokollierungssystem selbst zu einem Fehler der Anwendung führen, wenn es zu einem Stau von Anforderungen und somit zu einer Blockade kommt, während auf das Schreiben eines Protokollierungsereignisses gewartet wird.</span><span class="sxs-lookup"><span data-stu-id="9e25c-476">Otherwise, the logging system itself can cause the application to fail by causing requests to back up, as they block while waiting to write a logging event.</span></span>
* <span data-ttu-id="9e25c-477">Die Anwendungsprotokollierung ist nicht dasselbe wie die Überwachung per Auditing.</span><span class="sxs-lookup"><span data-stu-id="9e25c-477">Application logging is not the same as auditing.</span></span> <span data-ttu-id="9e25c-478">Das Auditing muss unter Umständen aus Konformitätsgründen oder zur Einhaltung von Bestimmungen durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-478">Auditing may be done for compliance or regulatory reasons.</span></span> <span data-ttu-id="9e25c-479">Daher müssen die Überwachungsdatensätze vollständig sein, und es ist nicht zulässig, beim Verarbeiten von Transaktionen Datensätze zu verwerfen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-479">As such, audit records must be complete, and it's not acceptible to drop any while processing transactions.</span></span> <span data-ttu-id="9e25c-480">Wenn für eine Anwendung das Auditing erforderlich ist, sollte dies von der Diagnoseprotokollierung getrennt werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-480">If an application requires auditing, this should be kept separate from diagnostics logging.</span></span> 

<span data-ttu-id="9e25c-481">Weitere Informationen zur Überwachung und Diagnose finden Sie unter [Anleitung zur Überwachung und Diagnose][monitoring-guidance].</span><span class="sxs-lookup"><span data-stu-id="9e25c-481">For more information about monitoring and diagnostics, see [Monitoring and diagnostics guidance][monitoring-guidance].</span></span>

## <a name="manual-failure-responses"></a><span data-ttu-id="9e25c-482">Manuelle Reaktionen auf Fehler</span><span class="sxs-lookup"><span data-stu-id="9e25c-482">Manual failure responses</span></span>
<span data-ttu-id="9e25c-483">In den vorherigen Abschnitten wurden Strategien für die automatisierte Wiederherstellung beschrieben, die für die Hochverfügbarkeit wichtig sind.</span><span class="sxs-lookup"><span data-stu-id="9e25c-483">Previous sections have focused on automated recovery strategies, which are critical for high availability.</span></span> <span data-ttu-id="9e25c-484">Aber in einigen Fällen sind manuelle Eingriffe erforderlich.</span><span class="sxs-lookup"><span data-stu-id="9e25c-484">However, sometimes manual intervention is needed.</span></span>

* <span data-ttu-id="9e25c-485">**Warnungen**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-485">**Alerts**.</span></span> <span data-ttu-id="9e25c-486">Überwachen Sie Ihre Anwendung auf Warnsignale, die proaktive Eingriffe nötig machen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-486">Monitor your application for warning signs that may require proactive intervention.</span></span> <span data-ttu-id="9e25c-487">Wenn Sie beispielsweise sehen, dass Ihre Anwendung von SQL-Datenbank oder Cosmos DB ständig gedrosselt wird, müssen Sie ggf. Ihre Datenbankkapazität erhöhen oder Ihre Abfragen optimieren.</span><span class="sxs-lookup"><span data-stu-id="9e25c-487">For example, if you see that SQL Database or Cosmos DB consistently throttles your application, you might need to increase your database capacity or optimize your queries.</span></span> <span data-ttu-id="9e25c-488">In diesem Beispiel sollte Ihre Telemetrie auch dann eine Warnung auslösen, wenn die Anwendung Drosselungsfehler transparent behandelt, damit Sie Maßnahmen treffen können.</span><span class="sxs-lookup"><span data-stu-id="9e25c-488">In this example, even though the application might handle the throttling errors transparently, your telemetry should still raise an alert so that you can follow up.</span></span>  
* <span data-ttu-id="9e25c-489">**Durchführen eines manuellen Failovers**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-489">**Manual failover**.</span></span> <span data-ttu-id="9e25c-490">Für einige Systeme kann ein Failover nicht automatisch durchgeführt werden, sodass ein manuelles Failover erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-490">Some systems cannot fail over automatically and require a manual failover.</span></span> 
* <span data-ttu-id="9e25c-491">**Testen der Betriebsbereitschaft**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-491">**Operational readiness testing**.</span></span> <span data-ttu-id="9e25c-492">Wenn für Ihre Anwendung ein Failover in eine sekundäre Region durchgeführt wird, sollten Sie die Betriebsbereitschaft testen, bevor das Failback in die primäre Region erfolgt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-492">If your application fails over to a secondary region, you should perform an operational readiness test before you fail back to the primary region.</span></span> <span data-ttu-id="9e25c-493">Bei diesem Test sollte sichergestellt werden, dass die primäre Region betriebsbereit und fehlerfrei ist und wieder für den Empfang von Datenverkehr bereit ist.</span><span class="sxs-lookup"><span data-stu-id="9e25c-493">The test should verify that the primary region is healthy and ready to receive traffic again.</span></span>
* <span data-ttu-id="9e25c-494">**Prüfen der Datenkonsistenz**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-494">**Data consistency check**.</span></span> <span data-ttu-id="9e25c-495">Wenn in einem Datenspeicher ein Fehler auftritt, kann es zu Inkonsistenzen bei den Daten kommen, sobald der Speicher wieder verfügbar ist. Dies gilt besonders, wenn die Daten repliziert wurden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-495">If a failure happens in a data store, there may be data inconsistencies when the store becomes available again, especially if the data was replicated.</span></span> 
* <span data-ttu-id="9e25c-496">**Wiederherstellen einer Sicherung**:</span><span class="sxs-lookup"><span data-stu-id="9e25c-496">**Restoring from backup**.</span></span> <span data-ttu-id="9e25c-497">Wenn es beispielsweise für SQL-Datenbank zu einem regionalen Ausfall kommt, können Sie für die Datenbank basierend auf der letzten Sicherung die Geowiederherstellung durchführen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-497">For example, if SQL Database experiences a regional outage, you can geo-restore the database from the latest backup.</span></span>

<span data-ttu-id="9e25c-498">Dokumentieren und testen Sie Ihren Plan für die Notfallwiederherstellung.</span><span class="sxs-lookup"><span data-stu-id="9e25c-498">Document and test your disaster recovery plan.</span></span> <span data-ttu-id="9e25c-499">Werten Sie die geschäftlichen Auswirkungen von Anwendungsausfällen aus.</span><span class="sxs-lookup"><span data-stu-id="9e25c-499">Evaluate the business impact of application failures.</span></span> <span data-ttu-id="9e25c-500">Automatisieren Sie den Prozess so weit wie möglich, und dokumentieren Sie alle manuellen Schritte, z.B. manuelles Failover oder die Datenwiederherstellung aus Sicherungen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-500">Automate the process as much as possible, and document any manual steps, such as manual failover or data restoration from backups.</span></span> <span data-ttu-id="9e25c-501">Testen Sie Ihren Prozess für die Notfallwiederherstellung regelmäßig, um den Plan zu überprüfen und zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="9e25c-501">Regularly test your disaster recovery process to validate and improve the plan.</span></span> 

## <a name="summary"></a><span data-ttu-id="9e25c-502">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="9e25c-502">Summary</span></span>
<span data-ttu-id="9e25c-503">In diesem Artikel wurde die Resilienz aus einer ganzheitlichen Perspektive beschrieben, und es wurden einige besondere Anforderungen der Cloud erläutert.</span><span class="sxs-lookup"><span data-stu-id="9e25c-503">This article discussed resiliency from a holistic perspective, emphasizing some of the unique challenges of the cloud.</span></span> <span data-ttu-id="9e25c-504">Hierzu gehörten die verteilte Struktur des Cloud Computing, die Nutzung von Standardhardware und das Auftreten von vorübergehenden Netzwerkfehlern.</span><span class="sxs-lookup"><span data-stu-id="9e25c-504">These include the distributed nature of cloud computing, the use of commodity hardware, and the presence of transient network faults.</span></span>

<span data-ttu-id="9e25c-505">Hier sind noch einmal die wichtigsten Punkte dieses Artikels aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="9e25c-505">Here are the major points to take away from this article:</span></span>

* <span data-ttu-id="9e25c-506">Resilienz führt zu einer höheren Verfügbarkeit und geringeren mittleren Zeit bis zur Wiederherstellung nach Ausfällen.</span><span class="sxs-lookup"><span data-stu-id="9e25c-506">Resiliency leads to higher availability, and lower mean time to recover from failures.</span></span> 
* <span data-ttu-id="9e25c-507">Zur Erreichung von Resilienz in der Cloud sind andere Verfahren als bei herkömmlichen lokalen Lösungen erforderlich.</span><span class="sxs-lookup"><span data-stu-id="9e25c-507">Achieving resiliency in the cloud requires a different set of techniques from traditional on-premises solutions.</span></span> 
* <span data-ttu-id="9e25c-508">Resilienz ist kein Zufallsprodukt.</span><span class="sxs-lookup"><span data-stu-id="9e25c-508">Resiliency does not happen by accident.</span></span> <span data-ttu-id="9e25c-509">Sie muss von Beginn an gezielt entworfen und integriert werden.</span><span class="sxs-lookup"><span data-stu-id="9e25c-509">It must be designed and built in from the start.</span></span>
* <span data-ttu-id="9e25c-510">Resilienz betrifft alle Bereiche des Anwendungslebenszyklus – von der Planung und Codierung bis zum Betrieb.</span><span class="sxs-lookup"><span data-stu-id="9e25c-510">Resiliency touches every part of the application lifecycle, from planning and coding to operations.</span></span>
* <span data-ttu-id="9e25c-511">Testen und überwachen Sie!</span><span class="sxs-lookup"><span data-stu-id="9e25c-511">Test and monitor!</span></span>


<!-- links -->

[blue-green]: http://martinfowler.com/bliki/BlueGreenDeployment.html
[canary-release]: http://martinfowler.com/bliki/CanaryRelease.html
[circuit-breaker-pattern]: https://msdn.microsoft.com/library/dn589784.aspx
[compensating-transaction-pattern]: https://msdn.microsoft.com/library/dn589804.aspx
[containers]: https://en.wikipedia.org/wiki/Operating-system-level_virtualization
[dsc]: /azure/automation/automation-dsc-overview
[contingency-planning-guide]: http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-34r1.pdf
[fma]: failure-mode-analysis.md
[hystrix]: http://techblog.netflix.com/2012/11/hystrix.html
[jmeter]: http://jmeter.apache.org/
[load-leveling-pattern]: ../patterns/queue-based-load-leveling.md
[monitoring-guidance]: ../best-practices/monitoring.md
[ra-basic-web]: ../reference-architectures/app-service-web-app/basic-web-app.md
[ra-multi-vm]: ../reference-architectures/virtual-machines-windows/multi-vm.md
[checklist]: ../checklist/resiliency.md
[retry-pattern]: ../patterns/retry.md
[retry-service-specific guidance]: ../best-practices/retry-service-specific.md
[sla]: https://azure.microsoft.com/support/legal/sla/
[throttling-pattern]: ../patterns/throttling.md
[tm]: https://azure.microsoft.com/services/traffic-manager/
[tm-failover]: /azure/traffic-manager/traffic-manager-monitoring
[tm-sla]: https://azure.microsoft.com/support/legal/sla/traffic-manager/v1_0/
[vsts]: https://www.visualstudio.com/features/vso-cloud-load-testing-vs.aspx
